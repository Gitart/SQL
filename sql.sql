USE [Weer]
GO
/****** Object:  Role [accounting]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [accounting] AUTHORIZATION [dbo]
GO
/****** Object:  Role [Administrators]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [Administrators] AUTHORIZATION [dbo]
GO
/****** Object:  Role [Customs]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [Customs] AUTHORIZATION [dbo]
GO
/****** Object:  Role [Dealers]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [Dealers] AUTHORIZATION [dbo]
GO
/****** Object:  Role [Directorat]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [Directorat] AUTHORIZATION [dbo]
GO
/****** Object:  Role [Finance]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [Finance] AUTHORIZATION [dbo]
GO
/****** Object:  Role [lawyer]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [lawyer] AUTHORIZATION [dbo]
GO
/****** Object:  Role [Logistics]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [Logistics] AUTHORIZATION [dbo]
GO
/****** Object:  Role [Managers]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [Managers] AUTHORIZATION [dbo]
GO
/****** Object:  Role [Other]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [Other] AUTHORIZATION [dbo]
GO
/****** Object:  Role [Pdi]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [Pdi] AUTHORIZATION [dbo]
GO
/****** Object:  Role [Pricing]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [Pricing] AUTHORIZATION [dbo]
GO
/****** Object:  Role [Reporting]    Script Date: 10/29/2010 14:30:37 ******/
CREATE ROLE [Reporting] AUTHORIZATION [dbo]
GO
/****** Object:  View [dbo].[A_cldb]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_cldb]
AS
SELECT     *
FROM         Cldb...cl_deb$ AS cl_deb$_1
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "cl_deb$_1"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 54
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_cldb'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_cldb'
GO
/****** Object:  StoredProcedure [dbo].[ShowOrphanUsers]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[ShowOrphanUsers]
AS
BEGIN
	CREATE TABLE #Results
	(
		[Database Name] sysname COLLATE Latin1_General_CI_AS, 
		[Orphaned User] sysname COLLATE Latin1_General_CI_AS
	)

	SET NOCOUNT ON	

	DECLARE @DBName sysname, @Qry nvarchar(4000)

	SET @Qry = ''
	SET @DBName = ''

	WHILE @DBName IS NOT NULL
	BEGIN
		SET @DBName = 
				(
					SELECT MIN(name) 
					FROM master..sysdatabases 
					WHERE 	name NOT IN 
						(
						 'master', 'model', 'tempdb', 'msdb', 
						 'distribution', 'pubs', 'northwind'
						)
						AND DATABASEPROPERTY(name, 'IsOffline') = 0 
						AND DATABASEPROPERTY(name, 'IsSuspect') = 0 
						AND name > @DBName
				)
		
		IF @DBName IS NULL BREAK

		SET @Qry = '	SELECT ''' + @DBName + ''' AS [Database Name], 
				CAST(name AS sysname) COLLATE Latin1_General_CI_AS  AS [Orphaned User]
				FROM ' + QUOTENAME(@DBName) + '..sysusers su
				WHERE su.islogin = 1
				AND su.name <> ''guest''
				AND NOT EXISTS
				(
					SELECT 1
					FROM master..sysxlogins sl
					WHERE su.sid = sl.sid
				)'

		INSERT INTO #Results EXEC (@Qry)
	END

	SELECT * 
	FROM #Results 
	ORDER BY [Database Name], [Orphaned User]
END
GO
/****** Object:  UserDefinedFunction [dbo].[CALHOURS]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Author : Savchenko Arthur 
-- Date   : 14-05-2009
-- Вычисляет количество часов:минут между двумя датами
-- PRINT DBO.CalHours ('2008-01-02 12:30','2008-01-06 15:50')

CREATE FUNCTION [dbo].[CALHOURS] (@DATE1 DATETIME, @DATE2 DATETIME)
RETURNS VARCHAR(10)
AS
BEGIN
  DECLARE @DR VARCHAR(10)
  SET @DR = RIGHT('0' + CONVERT(VARCHAR(4), DATEDIFF(hh,@DATE1,@DATE2)),2) + ':'
                 + RIGHT('0'+CONVERT(VARCHAR(2),(DATEDIFF(mi,@DATE1 ,@DATE2)
                 - (DATEDIFF(hh,@DATE1,@DATE2)*60))),2)
  RETURN(@DR)
END


/*
declare @a datetime, @b datetime
select  @a = '2009-12-27 21:37:19'
select  @b = '2009-12-28 22:49:18'

-- Расчет до минут
select right('0'+convert(varchar(4),datediff(hh,@a,@b)),2 )+':'+right('0'+convert(varchar(2),(datediff(mi,@a ,@b)
          - (datediff(hh,@a,@b)*60))),2)

-- Расчет до секунд
select right('0'+convert(varchar(4),datediff(hh,@a,@b)),2 )+':'+right('0'+convert(varchar(2),(datediff(mi,@a ,@b)
          - (datediff(hh,@a,@b)*60))),2)+':'+right('0'+ convert(varchar(2),(datediff(ss,@a,@b) - (datediff(mi,@a,@b)*60))),2)

*/
GO
/****** Object:  StoredProcedure [dbo].[App_BrendUpdate]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Updates a record in the [dbo].[S_Brend] table.
-- Concurreny is supported by using checksum method.
CREATE PROCEDURE [dbo].[App_BrendUpdate]
    @pk_ID int,
    @p_Naz nvarchar(30),
    @p_Sokr nvarchar(3),
    @p_Pic image,
    @p_By_split1 int,
    @p_By_split2 int,
    @p_By_split3 int,
    @p_Remarks nvarchar(500),
    @p_Discount_remark nvarchar(50),
    @p_Discount_value money,
    @p_prevConValue nvarchar(4000),
    @p_force_update  char(1)
AS
DECLARE
    @l_newValue nvarchar(4000),
    @return_status int,
    @l_rowcount int
BEGIN
-- Check whether the record still exists before doing update
    IF NOT EXISTS (SELECT * FROM [dbo].[S_Brend] WHERE [ID] = @pk_ID)
        RAISERROR ('Concurrency Error: The record has been deleted by another user. Table [dbo].[S_Brend]', 16, 1)

    -- If user wants to force update to happen even if 
    -- the record has been modified by a concurrent user,
    -- then we do this.
    IF (@p_force_update = 'Y')
        BEGIN

            -- Update the record with the passed parameters
            UPDATE [dbo].[S_Brend]
            SET 
            [Naz] = @p_Naz,
            [Sokr] = @p_Sokr,
            [Pic] = @p_Pic,
            [By_split1] = @p_By_split1,
            [By_split2] = @p_By_split2,
            [By_split3] = @p_By_split3,
            [Remarks] = @p_Remarks,
            [Discount_remark] = @p_Discount_remark,
            [Discount_value] = @p_Discount_value
            WHERE [ID] = @pk_ID

            -- Make sure only one record is affected
            SET @l_rowcount = @@ROWCOUNT
            IF @l_rowcount = 0
                RAISERROR ('The record cannot be updated.', 16, 1)
            IF @l_rowcount > 1
                RAISERROR ('duplicate object instances.', 16, 1)

        END
    ELSE
        BEGIN
            -- Get the checksum value for the record 
            -- and put an update lock on the record to 
            -- ensure transactional integrity.  The lock
            -- will be release when the transaction is 
            -- later committed or rolled back.
            Select @l_newValue = CAST(BINARY_CHECKSUM([ID],[Naz],[Sokr],[Pic],[By_split1],[By_split2],[By_split3],[Remarks],[Discount_remark],[Discount_value]) AS nvarchar(4000)) 
            FROM [dbo].[S_Brend] with (rowlock, holdlock)
            WHERE [ID] = @pk_ID


            -- Check concurrency by comparing the checksum values
            IF (@p_prevConValue = @l_newValue)
                SET @return_status = 0     -- pass
            ElSE
                SET @return_status = 1     -- fail

            -- Concurrency check passed.  Go ahead and 
            -- update the record
            IF (@return_status = 0)
                BEGIN

                    UPDATE [dbo].[S_Brend]
                    SET 
                    [Naz] = @p_Naz,
                    [Sokr] = @p_Sokr,
                    [Pic] = @p_Pic,
                    [By_split1] = @p_By_split1,
                    [By_split2] = @p_By_split2,
                    [By_split3] = @p_By_split3,
                    [Remarks] = @p_Remarks,
                    [Discount_remark] = @p_Discount_remark,
                    [Discount_value] = @p_Discount_value
                    WHERE [ID] = @pk_ID

                    SET @l_rowcount = @@ROWCOUNT
                    IF @l_rowcount = 0
                        RAISERROR ('The record cannot be updated.', 16, 1)
                    IF @l_rowcount > 1
                        RAISERROR ('duplicate object instances.', 16, 1)

                END
            ELSE
            -- Concurrency check failed.  Inform the user by raising the error
                RAISERROR ('Concurrency Error: The record has been updated by another user. Table [dbo].[S_Brend]', 16, 1)

        END
END
GO
/****** Object:  StoredProcedure [dbo].[Sale_car_status]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Просмотр продаж автомобилей в разрезе статусов
-- EXEC Sale_car_status 1, 3

CREATE PROCEDURE [dbo].[Sale_car_status] @Brand INT, 
                                @Status INT
AS  
SELECT   Dlr                     AS [Dealer Owner], 
         Loc                     AS [Location], 
         Status                  AS [Status],  
         Model                   AS [Model],  
         Version                 AS [Version], 
        "Full VIN"               AS [Full VIN Code], 
        "Day at Dlr"             AS [Day At Dealer] , 
        "Sold to DLR"            AS [Sold To Dealer] ,   
        "Order Type"             AS [Order Type] ,  
        "CIF/CIP"                AS [CIF CIP], 
        "Dealer price"           AS [Dealer Price], 
         MSRP                    AS [MSRP], 
        "Dealer Payment"         AS [Dealer Payment],
        "Payment to Supplier"    AS [Payment to Supplier],  
         Pay_Suppl_Date          AS [Payment Supplier Date], 
         Pay_Dlr_Date            AS [Pay Dealer Date] 
FROM     A_Status      
WHERE   (Id_Brand  = @Brand) 
  AND   (Id_Status < @Status)
ORDER BY Id_Status,
         Dlr, 
         Loc, 
         Model
GO
/****** Object:  Table [dbo].[W_Fc1]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Fc1](
	[F1] [nvarchar](255) NULL,
	[F2] [float] NULL,
	[F3] [datetime] NULL,
	[F4] [datetime] NULL,
	[F5] [datetime] NULL,
	[F6] [float] NULL,
	[F7] [datetime] NULL,
	[F8] [float] NULL,
	[F9] [float] NULL,
	[F10] [nvarchar](255) NULL,
	[F11] [float] NULL,
	[F12] [float] NULL,
	[F13] [nvarchar](255) NULL,
	[F14] [nvarchar](255) NULL,
	[F15] [nvarchar](255) NULL,
	[F16] [nvarchar](255) NULL,
	[F17] [float] NULL,
	[F18] [float] NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[A_Sales]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Sales]
AS
SELECT     dbo.dlr_Sales.VIN, dbo.S_Diler.ID, dbo.dlr_Sales.DEALER, dbo.dlr_Sales.SUM_CURR
FROM         dbo.dlr_Sales INNER JOIN
                      dbo.S_Diler ON dbo.dlr_Sales.DEALER = dbo.S_Diler.Last_Name
GROUP BY dbo.dlr_Sales.VIN, dbo.dlr_Sales.DEALER, dbo.dlr_Sales.SUM_CURR, dbo.S_Diler.ID
GO
/****** Object:  Table [dbo].[S_Type]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Type](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Kod] [nvarchar](10) NULL,
	[Naz] [nvarchar](50) NULL,
	[Note] [nvarchar](100) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Build_Up]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Build_Up](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [real] NULL,
	[Code] [int] NULL,
	[Indicces] [int] NULL,
	[Retail] [real] NULL
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[Tranclate]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
 Функция конвертирует украинские фамилия имя и отчество
 в английскую транскрипцию
 необходима для отчет deyly report ford

 Автор : Savchenko Arthur
 Date  : 03-08-2008  21:02 

Samples :
 PRINT DBO.Tranclate ('СОЛОВЬЕВ ИГОРЬ СЕРГЕЕВИЧ')
 PRINT DBO.Tranclate ('САВЧЕНКО АРТУР АРКАДЬЕВИЧ')
 PRINT DBO.Tranclate ('ЧАЙКА АЛЕКСЕЙ ВЛАДИМИРОВИЧ')
 PRINT DBO.Tranclate ('САВЧЕНКО ЕЛЕНА АНАТОЛЬЕВНА')
 PRINT DBO.Tranclate ('САВЧЕНКО НИКИТА АРТУРОВИЧ')
 PRINT DBO.Tranclate ('ГРЕХОВ АЛЕКСАНДР ЛЬВОВИЧ')
 PRINT DBO.Tranclate ('ЖУРКОВА ОЛЕНА ЛЬВОВОВНА') 
 PRINT DBO.Tranclate ('Граділь Максим Іванович')
 PRINT DBO.Tranclate ('Дубовецька Юлія Іванівна')
 PRINT DBO.Tranclate ('Яковенко Інна Іванівна')
 PRINT DBO.Tranclate ('Шиповський Андрій Анатолійович')
 PRINT DBO.Tranclate ('Богдан Кульчицький')
 PRINT DBO.Tranclate ('Юрій Горбунов')
 PRINT DBO.Tranclate ('Максим Селюцький')
*/
CREATE FUNCTION [dbo].[Tranclate] (@Name nvarchar(100))
RETURNS NVARCHAR(100)
AS
BEGIN
     SET @NAME = REPLACE(@NAME,'А','A')
     SET @NAME = REPLACE(@NAME,'Б','B')
     SET @NAME = REPLACE(@NAME,'В','V')
     SET @NAME = REPLACE(@NAME,'Г','G')
     SET @NAME = REPLACE(@NAME,'Д','D')
     SET @NAME = REPLACE(@NAME,'Е','E')
     SET @NAME = REPLACE(@NAME,'Ё','E')
     SET @NAME = REPLACE(@NAME,'Ж','ZH')
     SET @NAME = REPLACE(@NAME,'З','Z')
     SET @NAME = REPLACE(@NAME,'И','I')
     SET @NAME = REPLACE(@NAME,'І','I')
     SET @NAME = REPLACE(@NAME,'Й','Y')
     SET @NAME = REPLACE(@NAME,'Ї','Y')
     SET @NAME = REPLACE(@NAME,'К','K')
     SET @NAME = REPLACE(@NAME,'Л','L')
     SET @NAME = REPLACE(@NAME,'М','M')
     SET @NAME = REPLACE(@NAME,'Н','N')
     SET @NAME = REPLACE(@NAME,'О','O')
     SET @NAME = REPLACE(@NAME,'П','P')
     SET @NAME = REPLACE(@NAME,'Р','R')
     SET @NAME = REPLACE(@NAME,'С','S')
     SET @NAME = REPLACE(@NAME,'Т','T')
     SET @NAME = REPLACE(@NAME,'У','U')
     SET @NAME = REPLACE(@NAME,'Ф','PH')
     SET @NAME = REPLACE(@NAME,'Х','KH')
     SET @NAME = REPLACE(@NAME,'Ц','TC')
     SET @NAME = REPLACE(@NAME,'Ч','CH')
     SET @NAME = REPLACE(@NAME,'Ш','SH')
     SET @NAME = REPLACE(@NAME,'Щ','SH')
     SET @NAME = REPLACE(@NAME,'Є','E')
     SET @NAME = REPLACE(@NAME,'Э','E')
     SET @NAME = REPLACE(@NAME,'Ь','')
     SET @NAME = REPLACE(@NAME,'Э','E')
     SET @NAME = REPLACE(@NAME,'Ъ','')
     SET @NAME = REPLACE(@NAME,'Ю','YU')
     SET @NAME = REPLACE(@NAME,'Я','YA')
     RETURN @NAME
END
GO
/****** Object:  StoredProcedure [dbo].[App_Get_Brands]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns a query resultset from table [dbo].[S_Brend]
-- given the search criteria and sorting condition.
-- It will return a subset of the data based
-- on the current page number and batch size.  Table joins can
-- be performed if the join clause is specified.
-- 
-- If the resultset is not empty, it will return:
--    1) The total number of rows which match the condition;
--    2) The resultset in the current page
-- If nothing matches the search condition, it will return:
--    1) count is 0 ;
--    2) empty resultset.
CREATE PROCEDURE [dbo].[App_Get_Brands]
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_sort_str nvarchar(4000),
        @p_page_number int,
        @p_batch_size int
AS
DECLARE
    @l_temp_insert nvarchar(4000),
    @l_temp_select nvarchar(4000),
    @l_temp_from nvarchar(4000),
    @l_final_sort nvarchar(4000),
    @l_temp_cols nvarchar(4000),
    @l_temp_colsWithAlias nvarchar(4000),
    @l_query_select nvarchar(4000),
    @l_query_from nvarchar(4000),
    @l_query_where nvarchar(4000),
    @l_query_cols nvarchar(4000),
    @l_from_str nvarchar(4000),
    @l_join_str nvarchar(4000),
    @l_sort_str nvarchar(4000),
    @l_where_str nvarchar(4000),
    @l_count_query nvarchar(4000),
    @l_end_gen_row_num integer,
    @l_start_gen_row_num integer
BEGIN
    -- Set up the from string as the base table.
    SET @l_from_str = '[dbo].[S_Brend] S_Brend_'

    -- Set up the join string.
    SET @l_join_str = @p_join_str
    IF @p_join_str is null
        SET @l_join_str = ' '

    -- Set up the where string.
    SET @l_where_str = ' '
        IF @p_where_str is not null
        SET @l_where_str = 'WHERE ' + @p_where_str

    -- Get the total count of rows the query will return
    IF @p_page_number > 0 and @p_batch_size >= 0
    BEGIN
        SET @l_count_query = 
            'SELECT count(*) ' +
            'FROM ' + @l_from_str + ' ' + @l_join_str + ' ' +
            @l_where_str + ' '

        -- Run the count query
        EXECUTE (@l_count_query)
    END

    -- Get the list.
    IF @p_page_number > 0 AND @p_batch_size > 0
    BEGIN
        -- If the caller did not pass a sort string, use a default value
        IF @p_sort_str IS NOT NULL
            SET @l_sort_str = 'ORDER BY ' + @p_sort_str
        ELSE
            SET @l_sort_str = N'ORDER BY S_Brend_.[ID] asc '

        -- Calculate the rows to be included in the list
        -- before geting the list.
        SET @l_end_gen_row_num = @p_page_number * @p_batch_size;
        SET @l_start_gen_row_num = @l_end_gen_row_num - (@p_batch_size-1);

        -- Create a temporary table to keep the numbering
        -- of the rows returned.  It contains the necessary colums
        -- from base table plus an identity field used for numbering

        SELECT 1 AS IS_SECONDARY_TEMP_T_GETLIST_COL INTO #IS_SECONDARY_TEMP_T_GETLIST
        SELECT Identity(int,1,1) AS IS_ROWNUM_COL,
            [ID]
         INTO #IS_TEMP_T_GETLIST 
         FROM [dbo].[S_Brend], #IS_SECONDARY_TEMP_T_GETLIST
             WHERE 1=2 

        -- Now copy column data into temporary table.
        SET @l_temp_insert = 
            'INSERT INTO #IS_TEMP_T_GETLIST ('
        SET @l_temp_cols = 
            N'[ID]'
        SET @l_temp_select = 
            ') ' + 
            'SELECT ' + 
            'TOP ' + convert(varchar, @l_end_gen_row_num) + ' '
        SET @l_temp_colsWithAlias = 
            N'S_Brend_.[ID]'
        SET @l_temp_from = 
            ' FROM ' + @l_from_str + ' ' + @l_join_str + ' ' + 
            @l_where_str + ' ' + 
            @l_sort_str

        EXECUTE (@l_temp_insert + @l_temp_cols + @l_temp_select + @l_temp_colsWithAlias + @l_temp_from)

        -- Construct the main query
        SET @l_query_select = 'SELECT '
        SET @l_query_cols = 
            N'S_Brend_.[ID],
            S_Brend_.[Naz],
            S_Brend_.[Sokr],
            S_Brend_.[Pic],
            S_Brend_.[By_split1],
            S_Brend_.[By_split2],
            S_Brend_.[By_split3],
            S_Brend_.[Remarks],
            S_Brend_.[Discount_remark],
            S_Brend_.[Discount_value],
            CAST(BINARY_CHECKSUM(S_Brend_.[ID],S_Brend_.[Naz],S_Brend_.[Sokr],S_Brend_.[Pic],S_Brend_.[By_split1],S_Brend_.[By_split2],S_Brend_.[By_split3],S_Brend_.[Remarks],S_Brend_.[Discount_remark],S_Brend_.[Discount_value]) AS nvarchar(4000)) AS IS_CHECKSUM_COLUMN_12345 '
        SET @l_query_from = 
            'FROM ( ' +
                N'SELECT TOP 100 PERCENT IS_ROWNUM_COL, [ID] from #IS_TEMP_T_GETLIST ' +
                'WHERE IS_ROWNUM_COL >= '+ convert(varchar, @l_start_gen_row_num) + 
                ') IS_ALIAS, ' +
                @l_from_str + ' ';

        SET @l_query_where = 
            N'WHERE S_Brend_.[ID] = IS_ALIAS.[ID] ' 

        SET @l_final_sort = 'ORDER BY IS_ROWNUM_COL Asc '

        -- Run the query
        EXECUTE (@l_query_select + @l_query_cols + @l_query_from + @l_query_where + @l_final_sort)

    END
    ELSE
    BEGIN
        -- If page number and batch size are not valid numbers
        -- return an empty result set
        SET @l_query_select = 'SELECT '
        SET @l_query_cols = 
            N'S_Brend_.[ID],
            S_Brend_.[Naz],
            S_Brend_.[Sokr],
            S_Brend_.[Pic],
            S_Brend_.[By_split1],
            S_Brend_.[By_split2],
            S_Brend_.[By_split3],
            S_Brend_.[Remarks],
            S_Brend_.[Discount_remark],
            S_Brend_.[Discount_value],
            CAST(BINARY_CHECKSUM(S_Brend_.[ID],S_Brend_.[Naz],S_Brend_.[Sokr],S_Brend_.[Pic],S_Brend_.[By_split1],S_Brend_.[By_split2],S_Brend_.[By_split3],S_Brend_.[Remarks],S_Brend_.[Discount_remark],S_Brend_.[Discount_value]) AS nvarchar(4000)) AS IS_CHECKSUM_COLUMN_12345'
        SET @l_query_from = 
            ' FROM [dbo].[S_Brend] S_Brend_ ' + 
            'WHERE 1=2;'
        EXECUTE (@l_query_select + @l_query_cols + @l_query_from);
    END

END
GO
/****** Object:  Table [dbo].[D_Deyli_Rep]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[D_Deyli_Rep](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Dlr] [nvarchar](50) NULL,
	[Dat] [datetime] NULL,
	[Walk] [int] NULL,
	[Call] [int] NULL,
	[Contracts] [nvarchar](250) NULL,
	[Sold] [nvarchar](250) NULL,
	[Td_Fiesta] [int] NULL,
	[Td_Fusion] [int] NULL,
	[Td_Focus] [int] NULL,
	[Td_Cmax] [int] NULL,
	[Td_Smax] [int] NULL,
	[Td_Mondeo] [int] NULL,
	[Td_Galaxy] [int] NULL,
	[Td_Conect] [int] NULL,
	[Td_Transit] [int] NULL,
	[Td_Kuga] [int] NULL,
	[Ask_Fiesta] [int] NULL,
	[Ask_Fusion] [int] NULL,
	[Ask_Focus] [int] NULL,
	[Ask_Cmax] [int] NULL,
	[Ask_Smax] [int] NULL,
	[Ask_Mondeo] [int] NULL,
	[Ask_Galaxy] [int] NULL,
	[Ask_Conect] [int] NULL,
	[Ask_Transit] [int] NULL,
	[Ask_Kuga] [int] NULL,
 CONSTRAINT [PK_D_deyli_rep] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Parts_link]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Parts_link](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Lnk] [nvarchar](20) NULL,
	[Lnkto] [nvarchar](20) NULL,
	[Brand] [int] NULL,
 CONSTRAINT [PK__W_Parts_link__7F827F98] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Sprunnsql]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Пример обработки ошибок
-- 
CREATE PROCEDURE [dbo].[Sprunnsql]
                 @STATMENT VARCHAR(2000)
AS

-- Initialization 
DECLARE @Errnum  INT
DECLARE @STARTTIME DATETIME
DECLARE @ENDTIME DATETIME
DECLARE @ExecutionTime INT

SET @STARTTIME = GETDATE()

-- Выполнение
EXECUTE (@STATMENT)

-- Фиксация ошибки если есть 
SET @Errnum = @@Error

-- Обработка ошибок
IF @Errnum = 207   -- Bad Column
   RAISERROR 50001 'Bad Column Name'
ELSE IF  @Errnum = 208
   RAISERROR 50002 'Bad object name'
ELSE IF  @Errnum = 0
   BEGIN 
       SET    @EndTime = GETDATE()
       SET    @ExecutionTime = DATEDIFF(MILLISECOND, @STARTTIME, @ENDTIME)
       RETURN @ExecutionTime
   END
GO
/****** Object:  StoredProcedure [dbo].[ONOffTrigger]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[ONOffTrigger]
AS

--Отключение триггера
DISABLE TRIGGER [Proverks_price] ON [dbo].[W_Order]    -- Если надо блокировать триггер
print 'Off' + CONVERT(NVARCHAR(20),GETDATE())

-- Задержка 
WAITFOR DELAY '0:5:0';

--Включение триггера
ENABLE TRIGGER  [Proverks_price] ON [dbo].[W_Order]    -- Если надо разблокировать триггер
print 'ON' + CONVERT(NVARCHAR(20),GETDATE())
GO
/****** Object:  Table [dbo].[S_Vehicles_Supply_Chain]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Vehicles_Supply_Chain](
	[ID] [nvarchar](5) NOT NULL,
	[Brand] [int] NULL,
	[Process] [nvarchar](255) NULL,
	[Sector] [nvarchar](255) NULL,
	[Status] [nvarchar](255) NULL,
	[Notes] [nvarchar](255) NULL,
	[Answerable] [nvarchar](255) NULL,
 CONSTRAINT [PK_S_Vehicles_Supply_Chain] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Opt]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Opt](
	[F1] [nvarchar](255) NULL,
	[F2] [nvarchar](255) NULL,
	[F3] [nvarchar](255) NULL,
	[F4] [nvarchar](255) NULL,
	[F5] [float] NULL,
	[F6] [float] NULL,
	[F7] [float] NULL,
	[Brend] [int] NULL,
	[Model] [int] NULL,
	[Vers] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[DayOnly]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Функция возвращает только день
-- PRINT dbo.DAYONLY(GETDATE())
-- Дата : 14-11-2008 8:02
-- Savchenko Arthur
-- Name : DayOnly
-- Number : D-0001
-- Description: Return Only Day

CREATE FUNCTION [dbo].[DayOnly] (@Date DATETIME)
RETURNS VARCHAR(12)
AS
BEGIN 
    RETURN CONVERT(VARCHAR(12),@Date, 101)
END
GO
/****** Object:  Table [dbo].[S_Cat_Client]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Cat_Client](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[OoOffTrigger]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[OoOffTrigger]
AS
----Отключение триггера
--DISABLE TRIGGER [Proverks_price] ON [dbo].[W_Order]    -- Если надо блокировать триггер
--print 'Off' + CONVERT(NVARCHAR(20),GETDATE())
--GO
---- Задержка 
--WAITFOR DELAY '0:5:0';
--GO
----Включение триггера
--ENABLE TRIGGER  [Proverks_price] ON [dbo].[W_Order]    -- Если надо разблокировать триггер
--print 'ON' + CONVERT(NVARCHAR(20),GETDATE())
GO
/****** Object:  StoredProcedure [dbo].[App_BrendGetStats]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Runs a SQL function against a column
-- and returns the result back giving the current 
-- page number and batch size.  SQL functions can include 
-- sum, avg, max, etc
CREATE PROCEDURE [dbo].[App_BrendGetStats]
        @p_select_str nvarchar(4000),
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_sort_str nvarchar(4000),
        @p_page_number integer,
        @p_batch_size integer
    AS
    DECLARE
        @l_query nvarchar(4000),
        @l_from_str nvarchar(4000),
        @l_join_str nvarchar(4000),
        @l_sort_str nvarchar(4000),
        @l_where_str nvarchar(4000),
        @l_count_query nvarchar(4000),
        @l_end_gen_row_num integer,
        @l_start_gen_row_num integer,
        @l_select_str nvarchar(4000),
        @l_stat_col nvarchar(4000),
        @l_insert_to_temp nvarchar(4000),
        @l_create_temp nvarchar(4000),
        @l_stat_col_alias nvarchar(20)
    BEGIN

        -- Extract the col only that we need to run statistics on.
        -- First extract the content in the function call.
        SET @l_stat_col = @p_select_str
        SET @l_stat_col = SUBSTRING(@l_stat_col, 
                    PATINDEX('%(%', @l_stat_col) + 1,
                    PATINDEX('%)%', @l_stat_col) - PATINDEX('%(%', @l_stat_col) - 1)

        -- Then extract the column from the distinct clause.
        SET @l_stat_col = LTRIM(RTRIM(@l_stat_col))
        IF PATINDEX('%DISTINCT %', UPPER(@l_stat_col)) = 1
            SET @l_stat_col = SUBSTRING(@l_stat_col, PATINDEX('% %', @l_stat_col) + 1, LEN(@l_stat_col))

        -- Get the select column name without alias.
        SET @l_select_str = SUBSTRING(@l_stat_col, PATINDEX('%.%', @l_stat_col) + 1, LEN(@l_stat_col))

        -- Set up the from string.
        SET @l_from_str = '[dbo].[S_Brend] S_Brend_'

        -- Set up the join string.
        SET @l_join_str = @p_join_str
        IF @p_join_str IS NULL
            SET @l_join_str = ' '

        -- Set up the search string.
        SET @l_where_str = ' '
        IF @p_where_str IS NOT NULL
            SET @l_where_str = @l_where_str + 'WHERE ' + @p_where_str

        -- Get the list.
        IF @p_page_number > 0 AND @p_batch_size > 0
        BEGIN
            -- If the caller did not pass a sort string,
            -- use a default value.
            IF @p_sort_str IS NOT NULL
                SET @l_sort_str = 'ORDER BY ' + @p_sort_str;
            ELSE
                SET @l_sort_str = N'ORDER BY S_Brend_.[ID] asc '

            -- Calculate the rows to be included in the list
            -- before geting the list.
            SET @l_end_gen_row_num = @p_page_number * @p_batch_size
            SET @l_start_gen_row_num = @l_end_gen_row_num - (@p_batch_size-1)

            -- Creating a temporary table to keep the numbering
            -- of the rows returned.  It keeps the same primary
            -- key columns as the base table besides an identity
            -- field which keeps the numbering.
            Select 1 As tempCol Into #IS_TEMP_TABLE_SECONDARY;

            -- Create the temporary table from the
            SET @l_create_temp = 
                'SELECT Identity(int, 1, 1) As IS_ROWNUM_COL, ' + 
                @l_stat_col + 
                ' INTO #IS_TEMP_FROM' + 
                ' FROM ' + @l_from_str + ' ' + 
                ' CROSS JOIN #IS_TEMP_TABLE_SECONDARY' + 
                ' WHERE 1=2'
            -- Insert records into the temporary table from the
            -- base table
            SET @l_insert_to_temp = 
                'INSERT INTO #IS_TEMP_FROM ' + 
                '(' + @l_select_str + ') ' + 
                'SELECT ' + @l_stat_col + 
                ' FROM ' + @l_from_str + ' ' + @l_join_str + ' ' + 
                @l_where_str + ' ' + 
                @l_sort_str

            -- Construct the query for the current page
            SET @l_query = 
                'SELECT ' + @p_select_str + ' ' +
                'FROM ( ' +
                'SELECT ' + @l_select_str + ', IS_ROWNUM_COL ' +
                'FROM #IS_TEMP_FROM ' +
                'WHERE IS_ROWNUM_COL >= ' + convert(varchar, @l_start_gen_row_num) +
                ' AND IS_ROWNUM_COL <= ' + convert(varchar, @l_end_gen_row_num) +
                ') ' + 'S_Brend_'

            -- Run the query and get the result for the current page
            EXECUTE (@l_create_temp + '     ' + @l_insert_to_temp + '     ' + @l_query + ' ');

        END
        ELSE
        -- Return the empty result if page number or batch size
        -- has invalid number
        BEGIN
            SET @l_query = 
                'SELECT count(*) from ' + '[dbo].[S_Brend] S_Brend_ ' +
                'WHERE 1=2;'
            EXECUTE (@l_query)
        END
    END
GO
/****** Object:  StoredProcedure [dbo].[App_Brend_Export]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns the query result set in a CSV format
-- so that the data can be exported to a CSV file
CREATE PROCEDURE [dbo].[App_Brend_Export]
        @p_separator_str nvarchar(15),
        @p_title_str nvarchar(4000),
        @p_select_str nvarchar(4000),
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_num_exported int output
    AS
    DECLARE
        @l_title_str nvarchar(4000),
        @l_select_str nvarchar(4000),
        @l_from_str nvarchar(4000),
        @l_join_str nvarchar(4000),
        @l_where_str nvarchar(4000),
        @l_query_select nvarchar(4000),
        @l_query_union nvarchar(4000),
        @l_query_from nvarchar(4000)
    BEGIN
        -- Set up the title string from the column names.  Excel 
        -- will complain if the first column value is ID. So wrap
        -- the value with "".
        SET @l_title_str = @p_title_str + char(13)
        IF @p_title_str IS NULL
            BEGIN
            SET @l_title_str = 
                N'"XID"' + @p_separator_str +
                N'"Naz"' + @p_separator_str +
                N'"Sokr"' + @p_separator_str +
                N'"By_split1"' + @p_separator_str +
                N'"By_split2"' + @p_separator_str +
                N'"By_split3"' + @p_separator_str +
                N'"Remarks"' + @p_separator_str +
                N'"Discount_remark"' + @p_separator_str +
                N'"Discount_value"' + ' ';
            END
        ELSE IF SUBSTRING(@l_title_str, 1, 2) = 'ID'
            SET @l_title_str = 
                '"' + 
                SUBSTRING(@l_title_str, 1, PATINDEX('%,%', @l_title_str)-1) + 
                '"' + 
                SUBSTRING(@l_title_str, PATINDEX('%,%', @l_title_str), LEN(@l_title_str)); 

        -- Set up the select string
        SET @l_select_str = @p_select_str
        IF @p_select_str IS NULL
            BEGIN
            SET @l_select_str = 
                N'IsNULL(Convert(nvarchar, S_Brend_.[ID]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Brend_.[Naz], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Brend_.[Sokr], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Brend_.[By_split1]), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Brend_.[By_split2]), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Brend_.[By_split3]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Brend_.[Remarks], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Brend_.[Discount_remark], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Brend_.[Discount_value]), '''') + '' ''';
            END

        -- Set up the from string (with table alias) and the join string
        SET @l_from_str = '[dbo].[S_Brend] S_Brend_';

        SET @l_join_str = @p_join_str
        if @p_join_str is null
            SET @l_join_str = ' ';

        -- Set up the where string
        SET @l_where_str = ' ';
        IF @p_where_str IS NOT NULL
            SET @l_where_str = @l_where_str + 'WHERE ' + @p_where_str;

        -- Construct the query string.  Append the result set with the title.
        SET @l_query_select = 
                'SELECT '''
        SET @l_query_union = 
                ''' UNION ALL ' +
                'SELECT '
        SET @l_query_from = 
                ' FROM ' + @l_from_str + ' ' + @l_join_str + ' ' +
                @l_where_str;

        -- Run the query
        EXECUTE (@l_query_select + @l_title_str + @l_query_union + @l_select_str+ @l_query_from)

        -- Return the total number of rows of the query
        SELECT @p_num_exported = @@rowcount
    END
GO
/****** Object:  UserDefinedFunction [dbo].[AGING]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Code.......:   F_0001
Version ...:   1.005
Remarks....:   Функция в вычисляет промежуток времени в который попадает машина
Company....:   Winner Imports Ukraine, LTD
Author.....:   Savchenko Arthur
Name.......:   Dbo.Aging (Большая дата,Меньшая дата)
Date.......:   10/02/2008
Time.......:   10:37
Usege......:   SET DATEFORMAT dmy
               PRINT DBO.AGING ('06/02/2008','02/02/2008')
*/

CREATE FUNCTION [dbo].[AGING] (@DATE1 DATETIME, @DATE2 DATETIME, @BRAND INT)
RETURNS NVARCHAR(30)
AS
BEGIN
DECLARE @ISO INT
DECLARE @AGINGG NVARCHAR(30)

IF @DATE2 IS NULL
   SET   @ISO = 0
ELSE
   BEGIN
     IF @DATE1 IS NULL
        SET  @ISO = DATEDIFF(DAY,@DATE2,GETDATE())
          

      ELSE
        SET  @ISO = DATEDIFF(DAY,@DATE2 , @DATE1)
   END   

--Ford
IF @Brand=1
   BEGIN 
    SET @AGINGG  =  CASE 
                    WHEN @ISO BETWEEN -10   AND 30   THEN '0-30 Days'         
                    WHEN @ISO BETWEEN 31  AND 60   THEN '31-60 Days'        
                    WHEN @ISO BETWEEN 61  AND 90   THEN '61-90 Days'   
                    WHEN @ISO BETWEEN 91  AND 120  THEN '91-120 Days'   
                    WHEN @ISO BETWEEN 121 AND 150  THEN '121-150 Days'   
                    WHEN @ISO BETWEEN 151 AND 180  THEN '151-180 Days' 
                    WHEN @ISO BETWEEN 181 AND 6000 THEN '181 And More' 
                    ELSE ' '                              
                END 
   END

-- Volvo
IF @Brand=2
   BEGIN 
    SET @AGINGG  =  CASE 
                    WHEN @ISO BETWEEN 0   AND 30   THEN '0-30 Days'         
                    WHEN @ISO BETWEEN 31  AND 60   THEN '31-60 Days'        
                    WHEN @ISO BETWEEN 61  AND 90   THEN '61-90 Days'        
                    WHEN @ISO BETWEEN 91  AND 180  THEN '91-180 Days' 
                    WHEN @ISO BETWEEN 181 AND 6000 THEN '180 And More' 
                    ELSE ' '                              
                END 
   END

-- Jaguar
IF @Brand=3
   BEGIN 
    SET @AGINGG  =  CASE 
                    WHEN @ISO BETWEEN 0   AND 30   THEN '0-30 Days'         
                    WHEN @ISO BETWEEN 31  AND 60   THEN '31-60 Days'        
                    WHEN @ISO BETWEEN 61  AND 90   THEN '61-90 Days'        
                    WHEN @ISO BETWEEN 91  AND 180  THEN '91-180 Days' 
                    WHEN @ISO BETWEEN 181 AND 6000 THEN '180 And More' 
                    ELSE ' '                              
                END 
   END

-- Land Rover
IF @Brand=4
   BEGIN 
    SET @AGINGG  =  CASE 
                    WHEN @ISO BETWEEN 0   AND 30   THEN '0-30 Days'         
                    WHEN @ISO BETWEEN 31  AND 60   THEN '31-60 Days'        
                    WHEN @ISO BETWEEN 61  AND 90   THEN '61-90 Days'        
                    WHEN @ISO BETWEEN 91  AND 120  THEN '91-120 Days' 
                    WHEN @ISO BETWEEN 121 AND 6000 THEN '120 And More' 
                    ELSE ' '                              
                END 
   END

-- Porsche
IF @Brand=5
   BEGIN 
    SET @AGINGG  =  CASE 
                    WHEN @ISO BETWEEN 0   AND 30   THEN '0-30 Days'         
                    WHEN @ISO BETWEEN 31  AND 60   THEN '31-60 Days'        
                    WHEN @ISO BETWEEN 61  AND 90   THEN '61-90 Days'        
                    WHEN @ISO BETWEEN 91  AND 180  THEN '91-180 Days' 
                    WHEN @ISO BETWEEN 181 AND 6000 THEN '180 And More' 
                    ELSE ' '                              
                END 
   END

RETURN(@AGINGG)
END

-- можно попробывать все сделать используя только конструкцию IF
GO
/****** Object:  Table [dbo].[S_Kurs]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Kurs](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Dat] [smalldatetime] NULL,
	[Kurs_e] [money] NOT NULL,
	[Kurs_d] [money] NULL,
	[Note] [nvarchar](50) NULL,
 CONSTRAINT [PK_S_Kurs] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Kurs', @level2type=N'COLUMN',@level2name=N'ID'
GO
/****** Object:  View [dbo].[EX1]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[EX1]
AS
SELECT     [№ картки   ], [Дата отримання ], [Назва дилера   ], [Автомобіль ], [VIN ], [Державний номер], [Ім’я та прізвище ], [Контактна інформація ]
FROM         G1...basa AS basa_1
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "basa_1"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 114
               Right = 233
            End
            DisplayFlags = 280
            TopColumn = 1
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'EX1'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'EX1'
GO
/****** Object:  Table [dbo].[W_Rdf_Contract]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Rdf_Contract](
	[IDD] [int] IDENTITY(1,1) NOT NULL,
	[ID] [int] NOT NULL,
	[Zakaz] [nvarchar](50) NULL,
	[D_zakaza] [smalldatetime] NULL,
	[Brend] [int] NULL,
	[Model] [int] NULL,
	[Vers] [int] NULL,
	[Sorder] [nvarchar](30) NULL,
	[Dpo] [nvarchar](30) NULL,
	[Dlr] [int] NULL,
	[Loc] [int] NULL,
	[Status] [int] NULL,
	[VIN] [nvarchar](20) NULL,
	[Engine] [int] NULL,
	[Spec1] [nvarchar](20) NULL,
	[Colour] [int] NULL,
	[Colours] [int] NULL,
	[Trimm] [int] NULL,
	[OrderType] [int] NULL,
	[Comments] [nvarchar](255) NULL,
	[MY] [numeric](18, 0) NULL,
	[Isppol] [int] NULL,
	[Priz] [int] NULL,
	[Note] [nvarchar](200) NULL,
	[Package] [int] NULL,
	[Rdf_dlr] [nvarchar](50) NULL,
	[Rdf_Vid] [nvarchar](50) NULL,
	[Rdf_prod] [nvarchar](50) NULL,
	[Rdf_rikv] [smalldatetime] NULL,
	[Rdf_resource] [nvarchar](30) NULL,
	[Rdf_Zamov] [nvarchar](50) NULL,
	[Rdf_CodRadio] [nvarchar](15) NULL,
	[Rdf_numkey] [nvarchar](15) NULL,
	[Rdf_NumContract] [nvarchar](20) NULL,
	[Rdf_DateContract] [smalldatetime] NULL,
	[Rdf_PriceClient] [money] NULL,
	[Rdf_FleetCode] [nvarchar](20) NULL,
	[Rdf_DateSale] [smalldatetime] NULL,
	[Rdf_Category] [nvarchar](50) NULL,
	[Rdf_NameClient] [nvarchar](50) NULL,
	[Rdf_NameCompany] [nvarchar](50) NULL,
	[Rdf_Vik] [int] NULL,
	[Rdf_BornClient] [nvarchar](50) NULL,
	[Rdf_Adres] [nvarchar](100) NULL,
	[Rdf_Cyti] [nvarchar](20) NULL,
	[Rdf_Phone] [nvarchar](20) NULL,
	[Rdf_Phoneh] [nvarchar](50) NULL,
	[Rdf_Phonew] [nvarchar](50) NULL,
	[Rdf_Fax] [nvarchar](50) NULL,
	[Rdf_Prof] [nvarchar](50) NULL,
	[Rdf_Post] [nvarchar](10) NULL,
	[Rdf_Marka] [nvarchar](20) NULL,
	[Rdf_Model] [nvarchar](20) NULL,
	[Rdf_Vupusk] [nvarchar](20) NULL,
	[Rdf_Salesman] [int] NULL,
	[Rdf_changed] [nvarchar](30) NULL,
 CONSTRAINT [PK_W_Rdf_Contract] PRIMARY KEY CLUSTERED 
(
	[IDD] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[EvridayBak]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[EvridayBak] AS

BACKUP DATABASE [Winner] TO  DISK = N'C:\data\MsSqlBackup\Dbase\2007-08-23' 
WITH  NOINIT ,  
NOUNLOAD ,  
NAME = N'Winner backup',  
NOSKIP ,  
STATS = 10, 
NOFORMAT
GO
/****** Object:  Table [dbo].[S_Client]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Client](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Postav] [smalldatetime] NULL,
	[Fio] [nvarchar](100) NULL,
	[Fleet] [nvarchar](30) NULL,
	[Company] [nvarchar](30) NULL,
	[Age] [nvarchar](30) NULL,
	[Born] [smalldatetime] NULL,
	[Adress] [nvarchar](50) NULL,
	[PostCode] [nvarchar](10) NULL,
	[Сity] [nvarchar](50) NULL,
	[T_hom] [nvarchar](20) NULL,
	[T_wrk] [nvarchar](20) NULL,
	[T_mob] [nvarchar](20) NULL,
	[T_Fax] [nvarchar](20) NULL,
	[Proff] [nvarchar](50) NULL,
	[Oldavto] [nvarchar](20) NULL,
	[Oldmodel] [nvarchar](20) NULL,
	[Oldyear] [nvarchar](4) NULL,
	[Remarks] [nvarchar](50) NULL,
	[Brand] [int] NULL,
	[Data_start] [smalldatetime] NULL,
	[Data_finish] [smalldatetime] NULL,
	[Model] [nvarchar](50) NULL,
	[Version] [nvarchar](50) NULL,
	[Engine] [nvarchar](50) NULL,
	[Vid_engine] [nvarchar](50) NULL,
	[VIN] [nvarchar](20) NULL,
	[Territoriya] [nvarchar](50) NULL,
	[Data_finish_ex] [smalldatetime] NULL,
	[Notes] [nvarchar](200) NULL,
	[Priznak] [nvarchar](10) NULL,
	[Ispol] [nvarchar](50) NULL,
	[Comp] [nvarchar](50) NULL,
	[Data_input] [datetime] NULL,
	[God] [int] NULL,
	[Mes] [nvarchar](20) NULL,
	[Dlr] [nvarchar](50) NULL,
	[Fam] [nvarchar](50) NULL,
	[Im] [nvarchar](50) NULL,
	[Otch] [nvarchar](50) NULL,
	[Pol] [nvarchar](1) NULL,
	[Street] [nvarchar](50) NULL,
	[E_mail] [nvarchar](50) NULL,
	[Data_sale] [datetime] NULL,
 CONSTRAINT [PK__S_Cl__3A5795F5] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Packs]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Packs](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Pack #] [nvarchar](255) NULL,
	[Model] [nvarchar](255) NULL,
	[Derivative] [nvarchar](255) NULL,
	[Engine] [nvarchar](255) NULL,
	[Spec 1] [nvarchar](255) NULL,
	[Spec 3] [nvarchar](255) NULL,
	[Spec 2] [nvarchar](255) NULL,
	[Optional Equipment] [nvarchar](255) NULL,
	[CIF] [money] NULL,
	[Dealer Cost] [money] NULL,
	[MSRP] [money] NULL,
	[EXW] [money] NULL,
	[OPTIONS] [nvarchar](255) NULL,
	[F14] [float] NULL,
	[after 01Jan07] [money] NULL,
	[before] [money] NULL
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Ebak]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Ежедневный архив базы
CREATE PROCEDURE [dbo].[Ebak] AS

BACKUP DATABASE [Winner] TO  DISK = N'C:\DATA\basa.bak' 
WITH  NOINIT ,  
NOUNLOAD ,  
NAME = N'Winner backup',  
NOSKIP ,  
STATS = 10, 
NOFORMAT
GO
/****** Object:  StoredProcedure [dbo].[Linked_Data]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Author      :  Savchenko Arthur
Date        :  08-05-2008
Description :  Linked Server Data

Применение процедуры
EXEC  LINKED_DATA 'G1', 
                  'Excel', 
                  'Microsoft.Jet.OLEDB.4.0',
                  'c:\DATA\KG.xls',
                  'Excel 8.0'
 

*/

CREATE PROCEDURE [dbo].[Linked_Data](@server     nvarchar(128),
                             @srvproduct nvarchar(128)  = 'Excel',
                             @provider   nvarchar(128)  = 'Microsoft.Jet.OLEDB.4.0',
                             @datasrc    nvarchar(4000),
                             @location   nvarchar(4000),
                             @provstr    nvarchar(4000) = 'Excel 8.0',
                             @catalog    nvarchar(128))
AS
DECLARE @RC int


--EXEC @RC = [master].[dbo].[sp_addlinkedserver] @server, @srvproduct, @provider, @datasrc, @location, @provstr, @catalog
  EXEC @RC = [master].[dbo].[sp_addlinkedserver] @server, 'Excel',  'Microsoft.Jet.OLEDB.4.0', @datasrc, @location, 'Excel 8.0', @catalog
GO
/****** Object:  Table [dbo].[Tr]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Tr](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](30) NULL,
	[Key] [nvarchar](10) NULL,
	[Ch] [nvarchar](10) NULL,
	[Jir] [bit] NULL,
	[Colr] [float] NULL,
	[Chk] [bit] NULL,
	[Noviz] [bit] NULL,
	[Nom] [float] NULL,
	[Ic] [float] NULL,
	[Iсo] [float] NULL,
	[Zad] [int] NULL,
	[Grups] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Gr_Pack]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Gr_Pack](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Kod] [nvarchar](10) NULL,
	[Naz] [nvarchar](50) NULL,
 CONSTRAINT [PK_S_Gr_Pack] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Links]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Links](
	[IDN] [int] IDENTITY(1,1) NOT NULL,
	[IDD] [int] NULL,
	[Opis] [nvarchar](50) NULL,
	[Links] [ntext] NULL,
 CONSTRAINT [PK_W_Links] PRIMARY KEY CLUSTERED 
(
	[IDN] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Reg_Cn]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Reg_Cn](
	[F1] [nvarchar](255) NULL,
	[F2] [datetime] NULL,
	[F3] [nvarchar](255) NULL,
	[F4] [nvarchar](255) NULL,
	[F5] [nvarchar](255) NULL,
	[F6] [nvarchar](255) NULL,
	[F7] [nvarchar](255) NULL,
	[F8] [nvarchar](255) NULL,
	[F9] [nvarchar](255) NULL,
	[F10] [nvarchar](255) NULL,
	[F11] [nvarchar](255) NULL,
	[F12] [nvarchar](255) NULL,
	[F13] [nvarchar](255) NULL,
	[F14] [float] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Sales_Payments]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Sales_Payments](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [int] NULL,
	[God] [int] NULL,
	[Mont] [int] NULL,
	[Weeks] [int] NULL,
	[Start] [datetime] NULL,
	[Finish] [datetime] NULL,
	[Units] [int] NULL,
	[Sales] [money] NULL,
	[Paid] [money] NULL,
	[Notes] [nvarchar](100) NULL,
	[Priznak] [char](10) NULL,
 CONSTRAINT [PK_W_Sales_payments] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  StoredProcedure [dbo].[App_ClientGetList]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns a query resultset from table [dbo].[S_Client]
-- given the search criteria and sorting condition.
-- It will return a subset of the data based
-- on the current page number and batch size.  Table joins can
-- be performed if the join clause is specified.
-- 
-- If the resultset is not empty, it will return:
--    1) The total number of rows which match the condition;
--    2) The resultset in the current page
-- If nothing matches the search condition, it will return:
--    1) count is 0 ;
--    2) empty resultset.
CREATE PROCEDURE [dbo].[App_ClientGetList]
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_sort_str nvarchar(4000),
        @p_page_number int,
        @p_batch_size int
AS
DECLARE
    @l_temp_insert nvarchar(4000),
    @l_temp_select nvarchar(4000),
    @l_temp_from nvarchar(4000),
    @l_final_sort nvarchar(4000),
    @l_temp_cols nvarchar(4000),
    @l_temp_colsWithAlias nvarchar(4000),
    @l_query_select nvarchar(4000),
    @l_query_from nvarchar(4000),
    @l_query_where nvarchar(4000),
    @l_query_cols nvarchar(4000),
    @l_from_str nvarchar(4000),
    @l_join_str nvarchar(4000),
    @l_sort_str nvarchar(4000),
    @l_where_str nvarchar(4000),
    @l_count_query nvarchar(4000),
    @l_end_gen_row_num integer,
    @l_start_gen_row_num integer
BEGIN
    -- Set up the from string as the base table.
    SET @l_from_str = '[dbo].[S_Client] S_Client_'

    -- Set up the join string.
    SET @l_join_str = @p_join_str
    IF @p_join_str is null
        SET @l_join_str = ' '

    -- Set up the where string.
    SET @l_where_str = ' '
        IF @p_where_str is not null
        SET @l_where_str = 'WHERE ' + @p_where_str

    -- Get the total count of rows the query will return
    IF @p_page_number > 0 and @p_batch_size >= 0
    BEGIN
        SET @l_count_query = 
            'SELECT count(*) ' +
            'FROM ' + @l_from_str + ' ' + @l_join_str + ' ' +
            @l_where_str + ' '

        -- Run the count query
        EXECUTE (@l_count_query)
    END

    -- Get the list.
    IF @p_page_number > 0 AND @p_batch_size > 0
    BEGIN
        -- If the caller did not pass a sort string, use a default value
        IF @p_sort_str IS NOT NULL
            SET @l_sort_str = 'ORDER BY ' + @p_sort_str
        ELSE
            SET @l_sort_str = N'ORDER BY S_Client_.[Id] asc '

        -- Calculate the rows to be included in the list
        -- before geting the list.
        SET @l_end_gen_row_num = @p_page_number * @p_batch_size;
        SET @l_start_gen_row_num = @l_end_gen_row_num - (@p_batch_size-1);

        -- Create a temporary table to keep the numbering
        -- of the rows returned.  It contains the necessary colums
        -- from base table plus an identity field used for numbering

        SELECT 1 AS IS_SECONDARY_TEMP_T_GETLIST_COL INTO #IS_SECONDARY_TEMP_T_GETLIST
        SELECT Identity(int,1,1) AS IS_ROWNUM_COL,
            [Id]
         INTO #IS_TEMP_T_GETLIST 
         FROM [dbo].[S_Client], #IS_SECONDARY_TEMP_T_GETLIST
             WHERE 1=2 

        -- Now copy column data into temporary table.
        SET @l_temp_insert = 
            'INSERT INTO #IS_TEMP_T_GETLIST ('
        SET @l_temp_cols = 
            N'[Id]'
        SET @l_temp_select = 
            ') ' + 
            'SELECT ' + 
            'TOP ' + convert(varchar, @l_end_gen_row_num) + ' '
        SET @l_temp_colsWithAlias = 
            N'S_Client_.[Id]'
        SET @l_temp_from = 
            ' FROM ' + @l_from_str + ' ' + @l_join_str + ' ' + 
            @l_where_str + ' ' + 
            @l_sort_str

        EXECUTE (@l_temp_insert + @l_temp_cols + @l_temp_select + @l_temp_colsWithAlias + @l_temp_from)

        -- Construct the main query
        SET @l_query_select = 'SELECT '
        SET @l_query_cols = 
            N'S_Client_.[Id],
            S_Client_.[Postav],
            S_Client_.[Fio],
            S_Client_.[Fleet],
            S_Client_.[Company],
            S_Client_.[Age],
            S_Client_.[Born],
            S_Client_.[Adress],
            S_Client_.[PostCode],
            S_Client_.[Сity],
            S_Client_.[T_hom],
            S_Client_.[T_wrk],
            S_Client_.[T_mob],
            S_Client_.[T_Fax],
            S_Client_.[Proff],
            S_Client_.[Oldavto],
            S_Client_.[Oldmodel],
            S_Client_.[Oldyear],
            S_Client_.[Remarks],
            S_Client_.[Brand],
            S_Client_.[Data_start],
            S_Client_.[Data_finish],
            S_Client_.[Model],
            S_Client_.[Version],
            S_Client_.[Engine],
            S_Client_.[Vid_engine],
            S_Client_.[VIN],
            S_Client_.[Territoriya],
            S_Client_.[Data_finish_ex],
            S_Client_.[Notes],
            S_Client_.[Priznak],
            S_Client_.[Ispol],
            S_Client_.[Comp],
            S_Client_.[Data_input],
            S_Client_.[God],
            S_Client_.[Mes],
            S_Client_.[Dlr],
            S_Client_.[Fam],
            S_Client_.[Im],
            S_Client_.[Otch],
            S_Client_.[Pol],
            S_Client_.[Street],
            S_Client_.[E_mail],
            S_Client_.[Data_sale],
            CAST(BINARY_CHECKSUM(S_Client_.[Id],S_Client_.[Postav],S_Client_.[Fio],S_Client_.[Fleet],S_Client_.[Company],S_Client_.[Age],S_Client_.[Born],S_Client_.[Adress],S_Client_.[PostCode],S_Client_.[Сity],S_Client_.[T_hom],S_Client_.[T_wrk],S_Client_.[T_mob],S_Client_.[T_Fax],S_Client_.[Proff],S_Client_.[Oldavto],S_Client_.[Oldmodel],S_Client_.[Oldyear],S_Client_.[Remarks],S_Client_.[Brand],S_Client_.[Data_start],S_Client_.[Data_finish],S_Client_.[Model],S_Client_.[Version],S_Client_.[Engine],S_Client_.[Vid_engine],S_Client_.[VIN],S_Client_.[Territoriya],S_Client_.[Data_finish_ex],S_Client_.[Notes],S_Client_.[Priznak],S_Client_.[Ispol],S_Client_.[Comp],S_Client_.[Data_input],S_Client_.[God],S_Client_.[Mes],S_Client_.[Dlr],S_Client_.[Fam],S_Client_.[Im],S_Client_.[Otch],S_Client_.[Pol],S_Client_.[Street],S_Client_.[E_mail],S_Client_.[Data_sale]) AS nvarchar(4000)) AS IS_CHECKSUM_COLUMN_12345 '
        SET @l_query_from = 
            'FROM ( ' +
                N'SELECT TOP 100 PERCENT IS_ROWNUM_COL, [Id] from #IS_TEMP_T_GETLIST ' +
                'WHERE IS_ROWNUM_COL >= '+ convert(varchar, @l_start_gen_row_num) + 
                ') IS_ALIAS, ' +
                @l_from_str + ' ';

        SET @l_query_where = 
            N'WHERE S_Client_.[Id] = IS_ALIAS.[Id] ' 

        SET @l_final_sort = 'ORDER BY IS_ROWNUM_COL Asc '

        -- Run the query
        EXECUTE (@l_query_select + @l_query_cols + @l_query_from + @l_query_where + @l_final_sort)

    END
    ELSE
    BEGIN
        -- If page number and batch size are not valid numbers
        -- return an empty result set
        SET @l_query_select = 'SELECT '
        SET @l_query_cols = 
            N'S_Client_.[Id],
            S_Client_.[Postav],
            S_Client_.[Fio],
            S_Client_.[Fleet],
            S_Client_.[Company],
            S_Client_.[Age],
            S_Client_.[Born],
            S_Client_.[Adress],
            S_Client_.[PostCode],
            S_Client_.[Сity],
            S_Client_.[T_hom],
            S_Client_.[T_wrk],
            S_Client_.[T_mob],
            S_Client_.[T_Fax],
            S_Client_.[Proff],
            S_Client_.[Oldavto],
            S_Client_.[Oldmodel],
            S_Client_.[Oldyear],
            S_Client_.[Remarks],
            S_Client_.[Brand],
            S_Client_.[Data_start],
            S_Client_.[Data_finish],
            S_Client_.[Model],
            S_Client_.[Version],
            S_Client_.[Engine],
            S_Client_.[Vid_engine],
            S_Client_.[VIN],
            S_Client_.[Territoriya],
            S_Client_.[Data_finish_ex],
            S_Client_.[Notes],
            S_Client_.[Priznak],
            S_Client_.[Ispol],
            S_Client_.[Comp],
            S_Client_.[Data_input],
            S_Client_.[God],
            S_Client_.[Mes],
            S_Client_.[Dlr],
            S_Client_.[Fam],
            S_Client_.[Im],
            S_Client_.[Otch],
            S_Client_.[Pol],
            S_Client_.[Street],
            S_Client_.[E_mail],
            S_Client_.[Data_sale],
            CAST(BINARY_CHECKSUM(S_Client_.[Id],S_Client_.[Postav],S_Client_.[Fio],S_Client_.[Fleet],S_Client_.[Company],S_Client_.[Age],S_Client_.[Born],S_Client_.[Adress],S_Client_.[PostCode],S_Client_.[Сity],S_Client_.[T_hom],S_Client_.[T_wrk],S_Client_.[T_mob],S_Client_.[T_Fax],S_Client_.[Proff],S_Client_.[Oldavto],S_Client_.[Oldmodel],S_Client_.[Oldyear],S_Client_.[Remarks],S_Client_.[Brand],S_Client_.[Data_start],S_Client_.[Data_finish],S_Client_.[Model],S_Client_.[Version],S_Client_.[Engine],S_Client_.[Vid_engine],S_Client_.[VIN],S_Client_.[Territoriya],S_Client_.[Data_finish_ex],S_Client_.[Notes],S_Client_.[Priznak],S_Client_.[Ispol],S_Client_.[Comp],S_Client_.[Data_input],S_Client_.[God],S_Client_.[Mes],S_Client_.[Dlr],S_Client_.[Fam],S_Client_.[Im],S_Client_.[Otch],S_Client_.[Pol],S_Client_.[Street],S_Client_.[E_mail],S_Client_.[Data_sale]) AS nvarchar(4000)) AS IS_CHECKSUM_COLUMN_12345'
        SET @l_query_from = 
            ' FROM [dbo].[S_Client] S_Client_ ' + 
            'WHERE 1=2;'
        EXECUTE (@l_query_select + @l_query_cols + @l_query_from);
    END

END
GO
/****** Object:  Table [dbo].[Parts]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Parts](
	[F1] [float] NULL,
	[F2] [nvarchar](255) NULL,
	[F3] [nvarchar](255) NULL,
	[F4] [nvarchar](255) NULL,
	[F5] [float] NULL,
	[F6] [nvarchar](255) NULL,
	[F7] [float] NULL,
	[F8] [float] NULL,
	[F9] [float] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Pakage]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Pakage](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Datt] [smalldatetime] NOT NULL,
	[Model] [int] NOT NULL,
	[Brend] [int] NOT NULL,
	[Vers] [int] NULL,
	[Sokr] [nvarchar](10) NOT NULL,
	[Naz] [nvarchar](250) NOT NULL,
	[Vubor] [bit] NULL,
	[Trim] [int] NOT NULL,
	[Engine] [int] NOT NULL,
	[GearBox] [int] NOT NULL,
	[Spec1] [int] NOT NULL,
	[Spec2] [int] NOT NULL,
	[Spec3] [int] NOT NULL,
	[Cif] [money] NOT NULL,
	[Dlr_cost] [money] NOT NULL,
	[Exw] [money] NOT NULL,
	[Notes] [nvarchar](250) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[Min_hoursmin]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Solution : Time sheet
-- Author : Savchenko Arthur 
-- Date   : 14-05-2009
-- Возвращает количество ЧЧ:ММ из количества отработанных минут по человеку
-- PRINT DBO.Min_hoursmin  ( DATEDIFF(mi,'2009-01-02 12:10','2009-01-03 19:52'))
CREATE FUNCTION [dbo].[Min_hoursmin] (@Totalmin INT)
RETURNS VARCHAR(10)
AS
BEGIN
     DECLARE @hd  INT               -- Колличество часов
     DECLARE @md  INT               -- Колличество минут
     DECLARE @dd  INT               -- Общее количество минут между двумя датами
     DECLARE @Rez VARCHAR(50)       -- Результирующий итог

     -- set @Totalmin = DATEDIFF(mi,'2009-01-02 12:10','2009-02-03 19:52')
     set @hd = @Totalmin / 60 
     set @md = @Totalmin - @hd * 60
     
     -- print 'Total ' + convert(varchar(10), @dd)
     -- print 'Hours ' + convert(varchar(10), @hd)
     -- print 'min '   + convert(varchar(10), @md)

    SET @Rez = CONVERT(VARCHAR(10), @hd) + 'h. ' + CONVERT(VARCHAR(10), @md) + 'm.'
    
RETURN (@Rez)
END
GO
/****** Object:  Table [dbo].[S_Gr_Pack_Sub]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Gr_Pack_Sub](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Kod] [nvarchar](10) NULL,
	[Naz] [nvarchar](50) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Avtovoz]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Avtovoz](
	[IDN] [int] IDENTITY(1,1) NOT NULL,
	[Date_transfer] [datetime] NULL,
	[Carrier] [int] NULL,
	[Marka] [varchar](20) NULL,
	[Car_num] [int] NULL,
	[Trailer_num] [int] NULL,
	[Driver] [int] NULL,
	[Notice] [nvarchar](50) NULL,
	[Priznak] [nvarchar](10) NULL,
	[Acc_Number] [nvarchar](20) NULL,
	[Acc_Date] [datetime] NULL,
	[Acc_Sum] [money] NULL,
	[Blocked] [nchar](10) NULL,
	[Remarks] [varchar](50) NULL,
	[Date_Planing] [datetime] NULL,
	[Dlr_Actual_Arrival] [datetime] NULL,
	[Loc] [int] NULL,
	[Commentary] [nvarchar](255) NULL,
 CONSTRAINT [PK_W_Avtovoz] PRIMARY KEY CLUSTERED 
(
	[IDN] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Уникальный номер автовоза' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'IDN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'109' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'IDN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'IDN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'IDN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата перевозки' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Date_transfer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Date_transfer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Date_transfer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Date_transfer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Ид перевозчика' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'109' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'weww' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Marka'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'109' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Marka'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Marka'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Marka'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Ид машины' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Car_num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'109' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Car_num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Car_num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Car_num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Ид прицепа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Trailer_num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'109' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Trailer_num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Trailer_num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Trailer_num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Ид водителя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Driver'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'109' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Driver'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Driver'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Driver'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Примечание' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Notice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'109' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Notice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Notice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Notice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Признак' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Priznak'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'109' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Priznak'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Priznak'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz', @level2type=N'COLUMN',@level2name=N'Priznak'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Orientation', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Avtovoz'
GO
/****** Object:  Table [dbo].[S_Weight]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Weight](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [int] NOT NULL,
	[Model] [int] NOT NULL,
	[Vers] [int] NOT NULL,
	[Body] [int] NOT NULL,
	[Ves] [int] NOT NULL,
	[Note] [nvarchar](100) NULL,
	[Contry] [int] NULL,
	[Compound] [int] NULL,
	[Insurance] [numeric](18, 2) NULL,
	[Freight] [numeric](18, 2) NULL,
	[Weight] [int] NULL,
 CONSTRAINT [PK__S_Weight__10A21EA2] PRIMARY KEY CLUSTERED 
(
	[ID] ASC,
	[Brand] ASC,
	[Model] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY],
 CONSTRAINT [W0001] UNIQUE NONCLUSTERED 
(
	[Brand] ASC,
	[Model] ASC,
	[Vers] ASC,
	[Body] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[App_ClientGetStats]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Runs a SQL function against a column
-- and returns the result back giving the current 
-- page number and batch size.  SQL functions can include 
-- sum, avg, max, etc
CREATE PROCEDURE [dbo].[App_ClientGetStats]
        @p_select_str nvarchar(4000),
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_sort_str nvarchar(4000),
        @p_page_number integer,
        @p_batch_size integer
    AS
    DECLARE
        @l_query nvarchar(4000),
        @l_from_str nvarchar(4000),
        @l_join_str nvarchar(4000),
        @l_sort_str nvarchar(4000),
        @l_where_str nvarchar(4000),
        @l_count_query nvarchar(4000),
        @l_end_gen_row_num integer,
        @l_start_gen_row_num integer,
        @l_select_str nvarchar(4000),
        @l_stat_col nvarchar(4000),
        @l_insert_to_temp nvarchar(4000),
        @l_create_temp nvarchar(4000),
        @l_stat_col_alias nvarchar(20)
    BEGIN

        -- Extract the col only that we need to run statistics on.
        -- First extract the content in the function call.
        SET @l_stat_col = @p_select_str
        SET @l_stat_col = SUBSTRING(@l_stat_col, 
                    PATINDEX('%(%', @l_stat_col) + 1,
                    PATINDEX('%)%', @l_stat_col) - PATINDEX('%(%', @l_stat_col) - 1)

        -- Then extract the column from the distinct clause.
        SET @l_stat_col = LTRIM(RTRIM(@l_stat_col))
        IF PATINDEX('%DISTINCT %', UPPER(@l_stat_col)) = 1
            SET @l_stat_col = SUBSTRING(@l_stat_col, PATINDEX('% %', @l_stat_col) + 1, LEN(@l_stat_col))

        -- Get the select column name without alias.
        SET @l_select_str = SUBSTRING(@l_stat_col, PATINDEX('%.%', @l_stat_col) + 1, LEN(@l_stat_col))

        -- Set up the from string.
        SET @l_from_str = '[dbo].[S_Client] S_Client_'

        -- Set up the join string.
        SET @l_join_str = @p_join_str
        IF @p_join_str IS NULL
            SET @l_join_str = ' '

        -- Set up the search string.
        SET @l_where_str = ' '
        IF @p_where_str IS NOT NULL
            SET @l_where_str = @l_where_str + 'WHERE ' + @p_where_str

        -- Get the list.
        IF @p_page_number > 0 AND @p_batch_size > 0
        BEGIN
            -- If the caller did not pass a sort string,
            -- use a default value.
            IF @p_sort_str IS NOT NULL
                SET @l_sort_str = 'ORDER BY ' + @p_sort_str;
            ELSE
                SET @l_sort_str = N'ORDER BY S_Client_.[Id] asc '

            -- Calculate the rows to be included in the list
            -- before geting the list.
            SET @l_end_gen_row_num = @p_page_number * @p_batch_size
            SET @l_start_gen_row_num = @l_end_gen_row_num - (@p_batch_size-1)

            -- Creating a temporary table to keep the numbering
            -- of the rows returned.  It keeps the same primary
            -- key columns as the base table besides an identity
            -- field which keeps the numbering.
            Select 1 As tempCol Into #IS_TEMP_TABLE_SECONDARY;

            -- Create the temporary table from the
            SET @l_create_temp = 
                'SELECT Identity(int, 1, 1) As IS_ROWNUM_COL, ' + 
                @l_stat_col + 
                ' INTO #IS_TEMP_FROM' + 
                ' FROM ' + @l_from_str + ' ' + 
                ' CROSS JOIN #IS_TEMP_TABLE_SECONDARY' + 
                ' WHERE 1=2'
            -- Insert records into the temporary table from the
            -- base table
            SET @l_insert_to_temp = 
                'INSERT INTO #IS_TEMP_FROM ' + 
                '(' + @l_select_str + ') ' + 
                'SELECT ' + @l_stat_col + 
                ' FROM ' + @l_from_str + ' ' + @l_join_str + ' ' + 
                @l_where_str + ' ' + 
                @l_sort_str

            -- Construct the query for the current page
            SET @l_query = 
                'SELECT ' + @p_select_str + ' ' +
                'FROM ( ' +
                'SELECT ' + @l_select_str + ', IS_ROWNUM_COL ' +
                'FROM #IS_TEMP_FROM ' +
                'WHERE IS_ROWNUM_COL >= ' + convert(varchar, @l_start_gen_row_num) +
                ' AND IS_ROWNUM_COL <= ' + convert(varchar, @l_end_gen_row_num) +
                ') ' + 'S_Client_'

            -- Run the query and get the result for the current page
            EXECUTE (@l_create_temp + '     ' + @l_insert_to_temp + '     ' + @l_query + ' ');

        END
        ELSE
        -- Return the empty result if page number or batch size
        -- has invalid number
        BEGIN
            SET @l_query = 
                'SELECT count(*) from ' + '[dbo].[S_Client] S_Client_ ' +
                'WHERE 1=2;'
            EXECUTE (@l_query)
        END
    END
GO
/****** Object:  StoredProcedure [dbo].[Mail_Send]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--EXEC mail_send 'asavchenko@winner.ua', 'Машина оплачена', 'Оплата машин по почте'

-- Отправка сособщений на почту
CREATE PROCEDURE [dbo].[Mail_Send] (@M_ADRES NVARCHAR(100), @M_BODY NVARCHAR(2000), @M_TITLE NVARCHAR(100))
AS

 --EXEC msdb.dbo.sp_send_dbmail  @profile_name = 'Robot_mail',   @recipients = 'yprysich@winner.ua',   @body = @NazvanEW , @subject = 'Data Base Reminder...'
EXEC msdb.dbo.sp_send_dbmail
        @profile_name = 'ROBOT_Mail',
        @recipients   = @M_ADRES ,
        @body         = @M_BODY ,
        @subject      = @M_TITLE
GO
/****** Object:  Table [dbo].[S_Rate]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Rate](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[date] [datetime] NULL,
	[code] [nvarchar](255) NULL,
	[char3] [nvarchar](255) NULL,
	[size] [int] NULL,
	[name] [nvarchar](255) NULL,
	[rate] [float] NULL,
	[change] [float] NULL,
	[Rate_ed]  AS ([Rate]/[size]) PERSISTED,
	[Date_curr]  AS (replace(CONVERT([varchar](10),[DATE],(102)),'.','')+[char3]),
	[Date_insert]  AS (getdate()),
 CONSTRAINT [PK_S_Rate] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Ключ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Rate', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата валюты' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Rate', @level2type=N'COLUMN',@level2name=N'date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код валюты' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Rate', @level2type=N'COLUMN',@level2name=N'code'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код валюты' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Rate', @level2type=N'COLUMN',@level2name=N'char3'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Размерность за единицу валюты' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Rate', @level2type=N'COLUMN',@level2name=N'size'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Наименование курса валют' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Rate', @level2type=N'COLUMN',@level2name=N'name'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Курс валюты' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Rate', @level2type=N'COLUMN',@level2name=N'rate'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Изменение курса валют' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Rate', @level2type=N'COLUMN',@level2name=N'change'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'За единицу валюты' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Rate', @level2type=N'COLUMN',@level2name=N'Rate_ed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Уникальный код для поискка' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Rate', @level2type=N'COLUMN',@level2name=N'Date_curr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата вставки информации' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Rate', @level2type=N'COLUMN',@level2name=N'Date_insert'
GO
/****** Object:  StoredProcedure [dbo].[App_ClientExport]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns the query result set in a CSV format
-- so that the data can be exported to a CSV file
CREATE PROCEDURE [dbo].[App_ClientExport]
        @p_separator_str nvarchar(15),
        @p_title_str nvarchar(4000),
        @p_select_str nvarchar(4000),
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_num_exported int output
    AS
    DECLARE
        @l_title_str nvarchar(4000),
        @l_select_str1 nvarchar(4000),
        @l_select_str2 nvarchar(4000),
        @l_from_str nvarchar(4000),
        @l_join_str nvarchar(4000),
        @l_where_str nvarchar(4000),
        @l_query_select nvarchar(4000),
        @l_query_union nvarchar(4000),
        @l_query_from nvarchar(4000)
    BEGIN
        -- Set up the title string from the column names.  Excel 
        -- will complain if the first column value is ID. So wrap
        -- the value with "".
        SET @l_title_str = @p_title_str + char(13)
        IF @p_title_str IS NULL
            BEGIN
            SET @l_title_str = 
                N'"XId"' + @p_separator_str +
                N'"Postav"' + @p_separator_str +
                N'"Fio"' + @p_separator_str +
                N'"Fleet"' + @p_separator_str +
                N'"Company"' + @p_separator_str +
                N'"Age"' + @p_separator_str +
                N'"Born"' + @p_separator_str +
                N'"Adress"' + @p_separator_str +
                N'"PostCode"' + @p_separator_str +
                N'"Сity"' + @p_separator_str +
                N'"T_hom"' + @p_separator_str +
                N'"T_wrk"' + @p_separator_str +
                N'"T_mob"' + @p_separator_str +
                N'"T_Fax"' + @p_separator_str +
                N'"Proff"' + @p_separator_str +
                N'"Oldavto"' + @p_separator_str +
                N'"Oldmodel"' + @p_separator_str +
                N'"Oldyear"' + @p_separator_str +
                N'"Remarks"' + @p_separator_str +
                N'"Brand"' + @p_separator_str +
                N'"Data_start"' + @p_separator_str +
                N'"Data_finish"' + @p_separator_str +
                N'"Model"' + @p_separator_str +
                N'"Version"' + @p_separator_str +
                N'"Engine"' + @p_separator_str +
                N'"Vid_engine"' + @p_separator_str +
                N'"VIN"' + @p_separator_str +
                N'"Territoriya"' + @p_separator_str +
                N'"Data_finish_ex"' + @p_separator_str +
                N'"Notes"' + @p_separator_str +
                N'"Priznak"' + @p_separator_str +
                N'"Ispol"' + @p_separator_str +
                N'"Comp"' + @p_separator_str +
                N'"Data_input"' + @p_separator_str +
                N'"God"' + @p_separator_str +
                N'"Mes"' + @p_separator_str +
                N'"Dlr"' + @p_separator_str +
                N'"Fam"' + @p_separator_str +
                N'"Im"' + @p_separator_str +
                N'"Otch"' + @p_separator_str +
                N'"Pol"' + @p_separator_str +
                N'"Street"' + @p_separator_str +
                N'"E_mail"' + @p_separator_str +
                N'"Data_sale"' + ' ';
            END
        ELSE IF SUBSTRING(@l_title_str, 1, 2) = 'ID'
            SET @l_title_str = 
                '"' + 
                SUBSTRING(@l_title_str, 1, PATINDEX('%,%', @l_title_str)-1) + 
                '"' + 
                SUBSTRING(@l_title_str, PATINDEX('%,%', @l_title_str), LEN(@l_title_str)); 

        -- Set up the select string
        SET @l_select_str1 = @p_select_str
        SET @l_select_str2 = @p_select_str
        IF @p_select_str IS NULL
            BEGIN
            SET @l_select_str1 = 
                N'IsNULL(Convert(nvarchar, S_Client_.[Id]), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Client_.[Postav], 21), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Fio], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Fleet], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Company], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Age], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Client_.[Born], 21), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Adress], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[PostCode], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Сity], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[T_hom], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[T_wrk], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[T_mob], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[T_Fax], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Proff], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Oldavto], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Oldmodel], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Oldyear], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Remarks], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Client_.[Brand]), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Client_.[Data_start], 21), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Client_.[Data_finish], 21), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Model], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Version], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Engine], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Vid_engine], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[VIN], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Territoriya], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Client_.[Data_finish_ex], 21), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Notes], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Priznak], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' 
            SET @l_select_str2 = 
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Ispol], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Comp], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Client_.[Data_input], 21), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Client_.[God]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Mes], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Dlr], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Fam], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Im], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Otch], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Pol], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[Street], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Client_.[E_mail], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Client_.[Data_sale], 21), '''') + '' ''';
            END

        -- Set up the from string (with table alias) and the join string
        SET @l_from_str = '[dbo].[S_Client] S_Client_';

        SET @l_join_str = @p_join_str
        if @p_join_str is null
            SET @l_join_str = ' ';

        -- Set up the where string
        SET @l_where_str = ' ';
        IF @p_where_str IS NOT NULL
            SET @l_where_str = @l_where_str + 'WHERE ' + @p_where_str;

        -- Construct the query string.  Append the result set with the title.
        SET @l_query_select = 
                'SELECT '''
        SET @l_query_union = 
                ''' UNION ALL ' +
                'SELECT '
        SET @l_query_from = 
                ' FROM ' + @l_from_str + ' ' + @l_join_str + ' ' +
                @l_where_str;

        -- Run the query
        EXECUTE (@l_query_select + @l_title_str + @l_query_union + @l_select_str1 + @l_select_str2+ @l_query_from)

        -- Return the total number of rows of the query
        SELECT @p_num_exported = @@rowcount
    END
GO
/****** Object:  Table [dbo].[W_Pack_History]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Pack_History](
	[IDN] [int] IDENTITY(1,1) NOT NULL,
	[IDP] [int] NOT NULL,
	[Curr_Date] [datetime] NULL,
	[Brand] [int] NULL,
	[Base] [money] NULL,
	[Metalic] [money] NULL,
	[Door_Lock] [money] NULL,
	[Mirror] [money] NULL,
	[Alloys] [money] NULL,
	[Roof] [money] NULL,
	[K_092] [money] NULL,
	[Transport] [money] NULL,
	[Insurance] [money] NULL,
	[Cif_Cip] [money] NULL,
	[Dc] [money] NULL,
	[Msrp] [money] NULL,
	[Rate] [money] NULL,
	[Curensy] [int] NOT NULL,
	[Dc_val]  AS ([Rate]*[Dc]),
	[Msrp_val]  AS ([Rate]*[Msrp]),
	[Priz] [int] NULL,
 CONSTRAINT [PK__W_Pack_History__00A0C103] PRIMARY KEY CLUSTERED 
(
	[IDN] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Order_Engine_Package]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Order_Engine_Package](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[BREND] [int] NULL,
	[MODEL] [int] NULL,
	[VERS] [int] NULL,
	[ENGINE] [int] NULL,
	[PACKAGE] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Reports]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Reports](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Name_report] [nvarchar](50) NULL,
	[Nam_report] [nvarchar](50) NULL,
	[Users_report] [nvarchar](50) NULL,
 CONSTRAINT [PK_S_Reports] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Timesheet_Task]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Timesheet_Task](
	[ID] [int] IDENTITY(1,2) NOT NULL,
	[ID_employee] [int] NULL,
	[ID_company] [int] NULL,
	[Year_number] [int] NULL,
	[Week_number] [int] NULL,
	[Id_group] [int] NULL,
	[Id_task] [int] NULL,
	[Start] [datetime] NULL,
	[Finish] [datetime] NULL,
	[Norm_0] [float] NULL,
	[Over_0] [float] NULL,
	[Norm_1] [float] NULL,
	[Over_1] [float] NULL,
	[Norm_2] [float] NULL,
	[Over_2] [float] NULL,
	[Norm_3] [float] NULL,
	[Over_3] [float] NULL,
	[Norm_4] [float] NULL,
	[Over_4] [float] NULL,
	[Norm_5] [float] NULL,
	[Over_5] [float] NULL,
	[Over_6] [float] NULL,
	[Over_7] [float] NULL,
	[Total_time] [float] NULL,
	[Flag] [int] NULL,
	[Remark] [nvarchar](250) NULL,
	[Aproval] [int] NULL,
	[Employee] [nvarchar](50) NULL,
 CONSTRAINT [PK__W_Timesheet_task__73BBC731] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Order_Engine_Package1]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Order_Engine_Package1](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[BREND] [int] NULL,
	[MODEL] [int] NULL,
	[VERS] [int] NULL,
	[ENGINE] [int] NULL,
	[PACKAGE] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Trim_S]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Trim_S](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Nazv] [nvarchar](50) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Del_Car_Check]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Окончательное удаление машин из базы помеченных на удаление
CREATE PROCEDURE [dbo].[Del_Car_Check] (@BRAND INT)
AS
DELETE FROM w_order WHERE viev  = -1   AND  brend = @BRAND
GO
/****** Object:  Table [dbo].[W_Insurance]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Insurance](
	[PID] [int] IDENTITY(1,1) NOT NULL,
	[Num_strax] [nvarchar](20) NOT NULL,
	[Datas] [datetime] NULL,
	[Summa_grn] [money] NOT NULL,
	[Summa_val] [money] NULL,
	[Kurs_val] [money] NOT NULL,
	[Ttn] [nvarchar](250) NULL,
	[Vid] [nvarchar](50) NULL,
	[Currier] [int] NULL,
	[Doc] [nvarchar](50) NULL,
	[Period] [nvarchar](50) NULL,
	[Mrschrut] [nvarchar](250) NULL,
	[Franshiza] [money] NULL,
	[Tarif] [money] NULL,
	[Remarks] [nvarchar](20) NULL,
	[Priznak] [nvarchar](1) NULL,
	[Del_Date] [datetime] NULL,
	[Request] [nvarchar](20) NULL,
	[Request_Date] [datetime] NULL,
	[Rls] [nvarchar](20) NULL,
	[Loading_Date] [datetime] NULL,
	[Route] [nvarchar](250) NULL,
	[Driver] [int] NULL,
	[Track] [int] NULL,
	[Country] [int] NULL,
	[Trailer_num] [int] NULL,
	[Car_num] [int] NULL,
	[Sender] [nvarchar](max) NULL,
	[Recepient] [nvarchar](max) NULL,
 CONSTRAINT [PK__W_Insurance__6049000A] PRIMARY KEY CLUSTERED 
(
	[PID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Реквест номер' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Insurance', @level2type=N'COLUMN',@level2name=N'Request'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Реквест дата' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Insurance', @level2type=N'COLUMN',@level2name=N'Request_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер релиза' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Insurance', @level2type=N'COLUMN',@level2name=N'Rls'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата загрузки' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Insurance', @level2type=N'COLUMN',@level2name=N'Loading_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер маршрута из справочника маршрутов S_Path' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Insurance', @level2type=N'COLUMN',@level2name=N'Route'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код водителя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Insurance', @level2type=N'COLUMN',@level2name=N'Driver'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код прицепа ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Insurance', @level2type=N'COLUMN',@level2name=N'Track'
GO
/****** Object:  Table [dbo].[S_Trim]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Trim](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [int] NULL,
	[Model] [int] NULL,
	[Version] [int] NULL,
	[Body] [int] NULL,
	[Ves] [int] NULL,
 CONSTRAINT [PK__S_Trim__3D491139] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'109' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Trim', @level2type=N'COLUMN',@level2name=N'Body'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Trim', @level2type=N'COLUMN',@level2name=N'Body'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Trim', @level2type=N'COLUMN',@level2name=N'Body'
GO
/****** Object:  UserDefinedFunction [dbo].[CRVIN]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Корриеткровка VIN Cods до 17 символов
-- Добавление слева 6 символов до полного вин кода
-- Обновление по признаку
-- UPDATE W_ORDER SET  VIN = dbo.CRVIN (VIN) WHERE  BREND=1  AND LEN(VIN)=11 
-- AND ID IN (39849,39848,39847)
-- SELECT BREND,VIN FROM W_ORDER WHERE  BREND = 1    AND LEN(VIN)=11 

-- Проверка работоспособности функции
-- PRINT [dbo].[CRVIN] ('GAJUBE19883')
/*
Если 11 символов добиваем до 17 символов
если 17 символов то оставляем все как есть т.е. 17 символам
*/

CREATE FUNCTION [dbo].[CRVIN] (@VINCODE AS NVARCHAR(17))
RETURNS VARCHAR (17)
AS  
BEGIN 

 DECLARE @DOP1     VARCHAR(3)
 DECLARE @DOP2     VARCHAR(2)
 DECLARE @BUKVA    VARCHAR(1)
 DECLARE @FULLVIN  VARCHAR(17)


-- Проверка на длину кода
   IF LEN(@VINCODE) = 11
      BEGIN 
           SET @DOP1  = 'WF0'
           SET @DOP2  = 'XX'
           SET @BUKVA = SUBSTRING(@VINCODE,4,1)
           
           -- Формирование окончательного 17 значного кода
           SET @FULLVIN = @DOP1 + @BUKVA + @DOP2 + @VINCODE
       END  
    ELSE
       BEGIN 
           SET  @FULLVIN = @VINCODE
       END

RETURN @FULLVIN
END
GO
/****** Object:  Table [dbo].[W_Fin_Inventory_History]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Fin_Inventory_History](
	[IDN] [int] IDENTITY(1,1) NOT NULL,
	[Curr_Date] [datetime] NULL,
	[Brand] [int] NOT NULL,
	[God] [int] NULL,
	[Mes] [int] NOT NULL,
	[Kol_At_Dlr] [int] NULL,
	[Kol_Compl] [int] NULL,
	[Kol_In_Tr] [int] NULL,
	[Kol_In_Com] [int] NULL,
	[Kol_In_Ukr] [int] NULL,
	[Kol_Vic] [int] NULL,
	[Kol_Total] [int] NULL,
	[Day_At_Dlr] [int] NULL,
	[Day_Compl] [int] NULL,
	[Day_In_Tr] [int] NULL,
	[Day_In_Com] [int] NULL,
	[Day_In_Ukr] [int] NULL,
	[Day_Vic] [int] NULL,
	[Day_Total] [int] NULL,
	[Priznak] [nvarchar](1) NULL,
	[Notes] [nvarchar](200) NULL,
 CONSTRAINT [PK__W_Fin_Inventory___16A510BB] PRIMARY KEY CLUSTERED 
(
	[IDN] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[App_DilerGetList]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns a query resultset from table [dbo].[S_Diler]
-- given the search criteria and sorting condition.
-- It will return a subset of the data based
-- on the current page number and batch size.  Table joins can
-- be performed if the join clause is specified.
-- 
-- If the resultset is not empty, it will return:
--    1) The total number of rows which match the condition;
--    2) The resultset in the current page
-- If nothing matches the search condition, it will return:
--    1) count is 0 ;
--    2) empty resultset.
CREATE PROCEDURE [dbo].[App_DilerGetList]
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_sort_str nvarchar(4000),
        @p_page_number int,
        @p_batch_size int
AS
DECLARE
    @l_temp_insert nvarchar(4000),
    @l_temp_select nvarchar(4000),
    @l_temp_from nvarchar(4000),
    @l_final_sort nvarchar(4000),
    @l_temp_cols nvarchar(4000),
    @l_temp_colsWithAlias nvarchar(4000),
    @l_query_select nvarchar(4000),
    @l_query_from nvarchar(4000),
    @l_query_where nvarchar(4000),
    @l_query_cols nvarchar(4000),
    @l_from_str nvarchar(4000),
    @l_join_str nvarchar(4000),
    @l_sort_str nvarchar(4000),
    @l_where_str nvarchar(4000),
    @l_count_query nvarchar(4000),
    @l_end_gen_row_num integer,
    @l_start_gen_row_num integer
BEGIN
    -- Set up the from string as the base table.
    SET @l_from_str = '[dbo].[S_Diler] S_Diler_'

    -- Set up the join string.
    SET @l_join_str = @p_join_str
    IF @p_join_str is null
        SET @l_join_str = ' '

    -- Set up the where string.
    SET @l_where_str = ' '
        IF @p_where_str is not null
        SET @l_where_str = 'WHERE ' + @p_where_str

    -- Get the total count of rows the query will return
    IF @p_page_number > 0 and @p_batch_size >= 0
    BEGIN
        SET @l_count_query = 
            'SELECT count(*) ' +
            'FROM ' + @l_from_str + ' ' + @l_join_str + ' ' +
            @l_where_str + ' '

        -- Run the count query
        EXECUTE (@l_count_query)
    END

    -- Get the list.
    IF @p_page_number > 0 AND @p_batch_size > 0
    BEGIN
        -- If the caller did not pass a sort string, use a default value
        IF @p_sort_str IS NOT NULL
            SET @l_sort_str = 'ORDER BY ' + @p_sort_str
        ELSE
            SET @l_sort_str = N'ORDER BY S_Diler_.[ID] asc '

        -- Calculate the rows to be included in the list
        -- before geting the list.
        SET @l_end_gen_row_num = @p_page_number * @p_batch_size;
        SET @l_start_gen_row_num = @l_end_gen_row_num - (@p_batch_size-1);

        -- Create a temporary table to keep the numbering
        -- of the rows returned.  It contains the necessary colums
        -- from base table plus an identity field used for numbering

        SELECT 1 AS IS_SECONDARY_TEMP_T_GETLIST_COL INTO #IS_SECONDARY_TEMP_T_GETLIST
        SELECT Identity(int,1,1) AS IS_ROWNUM_COL,
            [ID]
         INTO #IS_TEMP_T_GETLIST 
         FROM [dbo].[S_Diler], #IS_SECONDARY_TEMP_T_GETLIST
             WHERE 1=2 

        -- Now copy column data into temporary table.
        SET @l_temp_insert = 
            'INSERT INTO #IS_TEMP_T_GETLIST ('
        SET @l_temp_cols = 
            N'[ID]'
        SET @l_temp_select = 
            ') ' + 
            'SELECT ' + 
            'TOP ' + convert(varchar, @l_end_gen_row_num) + ' '
        SET @l_temp_colsWithAlias = 
            N'S_Diler_.[ID]'
        SET @l_temp_from = 
            ' FROM ' + @l_from_str + ' ' + @l_join_str + ' ' + 
            @l_where_str + ' ' + 
            @l_sort_str

        EXECUTE (@l_temp_insert + @l_temp_cols + @l_temp_select + @l_temp_colsWithAlias + @l_temp_from)

        -- Construct the main query
        SET @l_query_select = 'SELECT '
        SET @l_query_cols = 
            N'S_Diler_.[ID],
            S_Diler_.[Region],
            S_Diler_.[Code],
            S_Diler_.[Naz],
            S_Diler_.[Sokr],
            S_Diler_.[Last_Name],
            S_Diler_.[Adres],
            S_Diler_.[Dir],
            S_Diler_.[Zam],
            S_Diler_.[Buch],
            S_Diler_.[Manedger],
            S_Diler_.[Email],
            S_Diler_.[Tel],
            S_Diler_.[Fax],
            S_Diler_.[Mob],
            S_Diler_.[Note],
            S_Diler_.[Cl1],
            S_Diler_.[Cl2],
            S_Diler_.[Cl3],
            S_Diler_.[Cl4],
            S_Diler_.[Account],
            S_Diler_.[Bank],
            S_Diler_.[Edrpou],
            S_Diler_.[Pin],
            S_Diler_.[Pdv],
            S_Diler_.[Brand],
            S_Diler_.[Statut],
            S_Diler_.[B_Name],
            S_Diler_.[B_Mfo],
            S_Diler_.[B_Adress],
            S_Diler_.[B_Fhone],
            S_Diler_.[B_Mob],
            S_Diler_.[B_Fax],
            S_Diler_.[B_Director],
            S_Diler_.[B_Buch],
            S_Diler_.[B_Manager],
            S_Diler_.[B_Oper],
            S_Diler_.[B_Tel_oper],
            S_Diler_.[B_Email],
            S_Diler_.[Dogovor],
            S_Diler_.[Dogovor_data],
            S_Diler_.[Fin_code],
            S_Diler_.[Sokr_naz],
            S_Diler_.[Bank_ukr],
            S_Diler_.[Edrpo],
            S_Diler_.[Svid],
            S_Diler_.[IndNomer],
            S_Diler_.[Direktor],
            S_Diler_.[Sokr_naz_ang],
            S_Diler_.[Bank_ukr_ang],
            S_Diler_.[Edrpo_ang],
            S_Diler_.[Svid_ang],
            S_Diler_.[IndNomer_ang],
            S_Diler_.[Direktor_ang],
            S_Diler_.[Adres_avto_ukr],
            S_Diler_.[Adres_avto_ang],
            S_Diler_.[Adres_unload],
            S_Diler_.[Max_Act],
            S_Diler_.[Mfo],
            S_Diler_.[Accnt],
            S_Diler_.[Dolj_ang],
            S_Diler_.[Dolj_ukr],
            S_Diler_.[Description],
            CAST(BINARY_CHECKSUM(S_Diler_.[ID],S_Diler_.[Region],S_Diler_.[Code],S_Diler_.[Naz],S_Diler_.[Sokr],S_Diler_.[Last_Name],S_Diler_.[Adres],S_Diler_.[Dir],S_Diler_.[Zam],S_Diler_.[Buch],S_Diler_.[Manedger],S_Diler_.[Email],S_Diler_.[Tel],S_Diler_.[Fax],S_Diler_.[Mob],S_Diler_.[Note],S_Diler_.[Cl1],S_Diler_.[Cl2],S_Diler_.[Cl3],S_Diler_.[Cl4],S_Diler_.[Account],S_Diler_.[Bank],S_Diler_.[Edrpou],S_Diler_.[Pin],S_Diler_.[Pdv],S_Diler_.[Brand],S_Diler_.[Statut],S_Diler_.[B_Name],S_Diler_.[B_Mfo],S_Diler_.[B_Adress],S_Diler_.[B_Fhone],S_Diler_.[B_Mob],S_Diler_.[B_Fax],S_Diler_.[B_Director],S_Diler_.[B_Buch],S_Diler_.[B_Manager],S_Diler_.[B_Oper],S_Diler_.[B_Tel_oper],S_Diler_.[B_Email],S_Diler_.[Dogovor],S_Diler_.[Dogovor_data],S_Diler_.[Fin_code],S_Diler_.[Sokr_naz],S_Diler_.[Bank_ukr],S_Diler_.[Edrpo],S_Diler_.[Svid],S_Diler_.[IndNomer],S_Diler_.[Direktor],S_Diler_.[Sokr_naz_ang],S_Diler_.[Bank_ukr_ang],S_Diler_.[Edrpo_ang],S_Diler_.[Svid_ang],S_Diler_.[IndNomer_ang],S_Diler_.[Direktor_ang],S_Diler_.[Adres_avto_ukr],S_Diler_.[Adres_avto_ang],S_Diler_.[Adres_unload],S_Diler_.[Max_Act],S_Diler_.[Mfo],S_Diler_.[Accnt],S_Diler_.[Dolj_ang],S_Diler_.[Dolj_ukr],S_Diler_.[Description]) AS nvarchar(4000)) AS IS_CHECKSUM_COLUMN_12345 '
        SET @l_query_from = 
            'FROM ( ' +
                N'SELECT TOP 100 PERCENT IS_ROWNUM_COL, [ID] from #IS_TEMP_T_GETLIST ' +
                'WHERE IS_ROWNUM_COL >= '+ convert(varchar, @l_start_gen_row_num) + 
                ') IS_ALIAS, ' +
                @l_from_str + ' ';

        SET @l_query_where = 
            N'WHERE S_Diler_.[ID] = IS_ALIAS.[ID] ' 

        SET @l_final_sort = 'ORDER BY IS_ROWNUM_COL Asc '

        -- Run the query
        EXECUTE (@l_query_select + @l_query_cols + @l_query_from + @l_query_where + @l_final_sort)

    END
    ELSE
    BEGIN
        -- If page number and batch size are not valid numbers
        -- return an empty result set
        SET @l_query_select = 'SELECT '
        SET @l_query_cols = 
            N'S_Diler_.[ID],
            S_Diler_.[Region],
            S_Diler_.[Code],
            S_Diler_.[Naz],
            S_Diler_.[Sokr],
            S_Diler_.[Last_Name],
            S_Diler_.[Adres],
            S_Diler_.[Dir],
            S_Diler_.[Zam],
            S_Diler_.[Buch],
            S_Diler_.[Manedger],
            S_Diler_.[Email],
            S_Diler_.[Tel],
            S_Diler_.[Fax],
            S_Diler_.[Mob],
            S_Diler_.[Note],
            S_Diler_.[Cl1],
            S_Diler_.[Cl2],
            S_Diler_.[Cl3],
            S_Diler_.[Cl4],
            S_Diler_.[Account],
            S_Diler_.[Bank],
            S_Diler_.[Edrpou],
            S_Diler_.[Pin],
            S_Diler_.[Pdv],
            S_Diler_.[Brand],
            S_Diler_.[Statut],
            S_Diler_.[B_Name],
            S_Diler_.[B_Mfo],
            S_Diler_.[B_Adress],
            S_Diler_.[B_Fhone],
            S_Diler_.[B_Mob],
            S_Diler_.[B_Fax],
            S_Diler_.[B_Director],
            S_Diler_.[B_Buch],
            S_Diler_.[B_Manager],
            S_Diler_.[B_Oper],
            S_Diler_.[B_Tel_oper],
            S_Diler_.[B_Email],
            S_Diler_.[Dogovor],
            S_Diler_.[Dogovor_data],
            S_Diler_.[Fin_code],
            S_Diler_.[Sokr_naz],
            S_Diler_.[Bank_ukr],
            S_Diler_.[Edrpo],
            S_Diler_.[Svid],
            S_Diler_.[IndNomer],
            S_Diler_.[Direktor],
            S_Diler_.[Sokr_naz_ang],
            S_Diler_.[Bank_ukr_ang],
            S_Diler_.[Edrpo_ang],
            S_Diler_.[Svid_ang],
            S_Diler_.[IndNomer_ang],
            S_Diler_.[Direktor_ang],
            S_Diler_.[Adres_avto_ukr],
            S_Diler_.[Adres_avto_ang],
            S_Diler_.[Adres_unload],
            S_Diler_.[Max_Act],
            S_Diler_.[Mfo],
            S_Diler_.[Accnt],
            S_Diler_.[Dolj_ang],
            S_Diler_.[Dolj_ukr],
            S_Diler_.[Description],
            CAST(BINARY_CHECKSUM(S_Diler_.[ID],S_Diler_.[Region],S_Diler_.[Code],S_Diler_.[Naz],S_Diler_.[Sokr],S_Diler_.[Last_Name],S_Diler_.[Adres],S_Diler_.[Dir],S_Diler_.[Zam],S_Diler_.[Buch],S_Diler_.[Manedger],S_Diler_.[Email],S_Diler_.[Tel],S_Diler_.[Fax],S_Diler_.[Mob],S_Diler_.[Note],S_Diler_.[Cl1],S_Diler_.[Cl2],S_Diler_.[Cl3],S_Diler_.[Cl4],S_Diler_.[Account],S_Diler_.[Bank],S_Diler_.[Edrpou],S_Diler_.[Pin],S_Diler_.[Pdv],S_Diler_.[Brand],S_Diler_.[Statut],S_Diler_.[B_Name],S_Diler_.[B_Mfo],S_Diler_.[B_Adress],S_Diler_.[B_Fhone],S_Diler_.[B_Mob],S_Diler_.[B_Fax],S_Diler_.[B_Director],S_Diler_.[B_Buch],S_Diler_.[B_Manager],S_Diler_.[B_Oper],S_Diler_.[B_Tel_oper],S_Diler_.[B_Email],S_Diler_.[Dogovor],S_Diler_.[Dogovor_data],S_Diler_.[Fin_code],S_Diler_.[Sokr_naz],S_Diler_.[Bank_ukr],S_Diler_.[Edrpo],S_Diler_.[Svid],S_Diler_.[IndNomer],S_Diler_.[Direktor],S_Diler_.[Sokr_naz_ang],S_Diler_.[Bank_ukr_ang],S_Diler_.[Edrpo_ang],S_Diler_.[Svid_ang],S_Diler_.[IndNomer_ang],S_Diler_.[Direktor_ang],S_Diler_.[Adres_avto_ukr],S_Diler_.[Adres_avto_ang],S_Diler_.[Adres_unload],S_Diler_.[Max_Act],S_Diler_.[Mfo],S_Diler_.[Accnt],S_Diler_.[Dolj_ang],S_Diler_.[Dolj_ukr],S_Diler_.[Description]) AS nvarchar(4000)) AS IS_CHECKSUM_COLUMN_12345'
        SET @l_query_from = 
            ' FROM [dbo].[S_Diler] S_Diler_ ' + 
            'WHERE 1=2;'
        EXECUTE (@l_query_select + @l_query_cols + @l_query_from);
    END

END
GO
/****** Object:  Table [dbo].[S_Categoriy]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Categoriy](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NULL,
 CONSTRAINT [PK_S_Categoriy] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Undel_car_check]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Окончательное удаление машин из базы помеченных на удаление
CREATE PROCEDURE [dbo].[Undel_car_check] (@BRAND INT, @ORD NVARCHAR(30))
AS
UPDATE W_Order  
   SET Viev  = 0  
 WHERE Viev  = -1  
   AND Brend = @BRAND 
   AND Zakaz = @ORD
GO
/****** Object:  Table [dbo].[S_Role]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Role](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Isp] [int] NOT NULL,
	[Brend] [int] NOT NULL,
	[Richts] [int] NOT NULL,
	[Remark] [char](100) NULL,
	[Views] [int] NULL,
	[Recrd] [int] NULL,
	[Chang] [int] NULL,
	[Delet] [int] NULL,
	[Print] [int] NULL,
 CONSTRAINT [PK__S_role__2E06CDA9] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  StoredProcedure [dbo].[Create_login_user]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Процедура создания логина и юзера в базе
-- EXEC Create_login_user kstatnyk
-- 

CREATE PROCEDURE [dbo].[Create_login_user]  
                 @LoginUser Nvarchar(50)
AS

DECLARE @Lsuser   NVARCHAR(50)   -- имя пользователя


--SET @Lsuser = '[WIU\' + @LoginUser + ']'
--SET @Lsuser = "[WIU\kstatnyk]"



-- Create login
CREATE LOGIN [WIU\kstatnyk] FROM WINDOWS WITH DEFAULT_DATABASE=[Winner], DEFAULT_LANGUAGE=[us_english]

--USE [Winner]

CREATE USER [WIU\kstatnyk] FOR LOGIN [WIU\kstatnyk] --WITH DEFAULT_SCHEMA=[kstatnyk]
GO
/****** Object:  StoredProcedure [dbo].[App_DilerExport]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns the query result set in a CSV format
-- so that the data can be exported to a CSV file
CREATE PROCEDURE [dbo].[App_DilerExport]
        @p_separator_str nvarchar(15),
        @p_title_str nvarchar(4000),
        @p_select_str nvarchar(4000),
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_num_exported int output
    AS
    DECLARE
        @l_title_str nvarchar(4000),
        @l_select_str1 nvarchar(4000),
        @l_select_str2 nvarchar(4000),
        @l_select_str3 nvarchar(4000),
        @l_from_str nvarchar(4000),
        @l_join_str nvarchar(4000),
        @l_where_str nvarchar(4000),
        @l_query_select nvarchar(4000),
        @l_query_union nvarchar(4000),
        @l_query_from nvarchar(4000)
    BEGIN
        -- Set up the title string from the column names.  Excel 
        -- will complain if the first column value is ID. So wrap
        -- the value with "".
        SET @l_title_str = @p_title_str + char(13)
        IF @p_title_str IS NULL
            BEGIN
            SET @l_title_str = 
                N'"XID"' + @p_separator_str +
                N'"Region"' + @p_separator_str +
                N'"Code"' + @p_separator_str +
                N'"Naz"' + @p_separator_str +
                N'"Sokr"' + @p_separator_str +
                N'"Last_Name"' + @p_separator_str +
                N'"Adres"' + @p_separator_str +
                N'"Dir"' + @p_separator_str +
                N'"Zam"' + @p_separator_str +
                N'"Buch"' + @p_separator_str +
                N'"Manedger"' + @p_separator_str +
                N'"Email"' + @p_separator_str +
                N'"Tel"' + @p_separator_str +
                N'"Fax"' + @p_separator_str +
                N'"Mob"' + @p_separator_str +
                N'"Note"' + @p_separator_str +
                N'"Cl1"' + @p_separator_str +
                N'"Cl2"' + @p_separator_str +
                N'"Cl3"' + @p_separator_str +
                N'"Cl4"' + @p_separator_str +
                N'"Account"' + @p_separator_str +
                N'"Bank"' + @p_separator_str +
                N'"Edrpou"' + @p_separator_str +
                N'"Pdv"' + @p_separator_str +
                N'"Brand"' + @p_separator_str +
                N'"Statut"' + @p_separator_str +
                N'"B_Name"' + @p_separator_str +
                N'"B_Mfo"' + @p_separator_str +
                N'"B_Adress"' + @p_separator_str +
                N'"B_Fhone"' + @p_separator_str +
                N'"B_Mob"' + @p_separator_str +
                N'"B_Fax"' + @p_separator_str +
                N'"B_Director"' + @p_separator_str +
                N'"B_Buch"' + @p_separator_str +
                N'"B_Manager"' + @p_separator_str +
                N'"B_Oper"' + @p_separator_str +
                N'"B_Tel_oper"' + @p_separator_str +
                N'"B_Email"' + @p_separator_str +
                N'"Dogovor"' + @p_separator_str +
                N'"Dogovor_data"' + @p_separator_str +
                N'"Fin_code"' + @p_separator_str +
                N'"Sokr_naz"' + @p_separator_str +
                N'"Bank_ukr"' + @p_separator_str +
                N'"Edrpo"' + @p_separator_str +
                N'"Svid"' + @p_separator_str +
                N'"IndNomer"' + @p_separator_str +
                N'"Direktor"' + @p_separator_str +
                N'"Sokr_naz_ang"' + @p_separator_str +
                N'"Bank_ukr_ang"' + @p_separator_str +
                N'"Edrpo_ang"' + @p_separator_str +
                N'"Svid_ang"' + @p_separator_str +
                N'"IndNomer_ang"' + @p_separator_str +
                N'"Direktor_ang"' + @p_separator_str +
                N'"Adres_avto_ukr"' + @p_separator_str +
                N'"Adres_avto_ang"' + @p_separator_str +
                N'"Adres_unload"' + @p_separator_str +
                N'"Max_Act"' + @p_separator_str +
                N'"Mfo"' + @p_separator_str +
                N'"Accnt"' + @p_separator_str +
                N'"Dolj_ang"' + @p_separator_str +
                N'"Dolj_ukr"' + @p_separator_str +
                N'"Description"' + ' ';
            END
        ELSE IF SUBSTRING(@l_title_str, 1, 2) = 'ID'
            SET @l_title_str = 
                '"' + 
                SUBSTRING(@l_title_str, 1, PATINDEX('%,%', @l_title_str)-1) + 
                '"' + 
                SUBSTRING(@l_title_str, PATINDEX('%,%', @l_title_str), LEN(@l_title_str)); 

        -- Set up the select string
        SET @l_select_str1 = @p_select_str
        SET @l_select_str2 = @p_select_str
        SET @l_select_str3 = @p_select_str
        IF @p_select_str IS NULL
            BEGIN
            SET @l_select_str1 = 
                N'IsNULL(Convert(nvarchar, S_Diler_.[ID]), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Diler_.[Region]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Code], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Naz], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Sokr], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Last_Name], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Adres], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Dir], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Zam], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Buch], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Manedger], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Email], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Tel], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Fax], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Mob], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Note], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Diler_.[Cl1]), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Diler_.[Cl2]), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Diler_.[Cl3]), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Diler_.[Cl4]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Account], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Bank], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Edrpou], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Pdv], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Brand], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Statut], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[B_Name], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[B_Mfo], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[B_Adress], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[B_Fhone], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[B_Mob], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' 
            SET @l_select_str2 = 
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[B_Fax], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[B_Director], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[B_Buch], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[B_Manager], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[B_Oper], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[B_Tel_oper], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[B_Email], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Dogovor], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Diler_.[Dogovor_data], 21), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Diler_.[Fin_code]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Sokr_naz], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Bank_ukr], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Edrpo], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Svid], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[IndNomer], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Direktor], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Sokr_naz_ang], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Bank_ukr_ang], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Edrpo_ang], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Svid_ang], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[IndNomer_ang], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Direktor_ang], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Adres_avto_ukr], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Adres_avto_ang], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Adres_unload], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Max_Act], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Mfo], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Accnt], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Diler_.[Dolj_ang]), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Diler_.[Dolj_ukr]), '''') + ''' + @p_separator_str + ''' +' 
            SET @l_select_str3 = 
                N'N''"'' + REPLACE(IsNULL(S_Diler_.[Description], ''''), N''"'', N''""'') + N''"''  + '' ''';
            END

        -- Set up the from string (with table alias) and the join string
        SET @l_from_str = '[dbo].[S_Diler] S_Diler_';

        SET @l_join_str = @p_join_str
        if @p_join_str is null
            SET @l_join_str = ' ';

        -- Set up the where string
        SET @l_where_str = ' ';
        IF @p_where_str IS NOT NULL
            SET @l_where_str = @l_where_str + 'WHERE ' + @p_where_str;

        -- Construct the query string.  Append the result set with the title.
        SET @l_query_select = 
                'SELECT '''
        SET @l_query_union = 
                ''' UNION ALL ' +
                'SELECT '
        SET @l_query_from = 
                ' FROM ' + @l_from_str + ' ' + @l_join_str + ' ' +
                @l_where_str;

        -- Run the query
        EXECUTE (@l_query_select + @l_title_str + @l_query_union + @l_select_str1 + @l_select_str2 + @l_select_str3+ @l_query_from)

        -- Return the total number of rows of the query
        SELECT @p_num_exported = @@rowcount
    END
GO
/****** Object:  UserDefinedFunction [dbo].[Dmm]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--PRINT DBO.DMM ('02/08/2009 03:10','06/08/2009 04:11')
--PRINT substring(CONVERT(NVARCHAR(50),'02/08/2009 03:50'),12,2)
--print substring(CONVERT(NVARCHAR(30),GETDATE()),15,2)
--print substring(CONVERT(NVARCHAR(30),'02/05/2009 03:50'),12,2) -  substring(CONVERT(NVARCHAR(30),'02/05/2009 01:50'),12,2)
--PRINT CONVERT(GETDATE(),108)
--UPDATE W_TIMESHEET SET REMARK = DBO.DMM(W_TIMESHEET.[START],W_TIMESHEET.[FINISH])

-- Вычисление количество дней-часов-минут между двумя датами
-- set dateformat dmy

CREATE FUNCTION [dbo].[Dmm] (@DAT1 DATETIME, @DAT2 DATETIME)
RETURNS NVARCHAR(50)
AS
  BEGIN
       -- Инициализация переменных
       DECLARE @MINS  INT
       DECLARE @MINF  INT
       DECLARE @MINA  INT
       DECLARE @HRSS  INT
       DECLARE @HRSF  INT
       DECLARE @HRSA  INT
       DECLARE @DRSA  NVARCHAR(50)
       DECLARE @RAZ   NVARCHAR(50)  
       DECLARE @PER   NVARCHAR(50)  
       DECLARE @PER1  NVARCHAR(50)  
       
       -- Присвоение перменным значений
       SET @HRSS = CONVERT(INT, substring(CONVERT(NVARCHAR(10),@DAT1,108),1,2))
       SET @HRSF = CONVERT(INT, substring(CONVERT(NVARCHAR(10),@DAT2,108),1,2))
       SET @HRSA = @HRSF - @HRSS

IF  @HRSA < 0 
        BEGIN
             SET  @HRSA = 24 - @HRSS
        END
ELSE
        BEGIN
            SET @HRSA =  @HRSF - @HRSS
        END

SET @MINS = CONVERT(INT, substring(CONVERT(NVARCHAR(10),@DAT1,108),4,2))
SET @MINF = CONVERT(INT, substring(CONVERT(NVARCHAR(10),@DAT2,108),4,2))
SET @MINA = @MINF - @MINS

IF  @MINA < 0 
        BEGIN
             SET  @MINA = 60 - @MINS
        END
ELSE
        BEGIN
            SET @MINA = @MINF - @MINS
        END
      
    
        SET @PER1= CONVERT(NVARCHAR(10),@MINA)
        SET @PER = CONVERT(NVARCHAR(2),@HRSA)
        SET @DRSA =  CONVERT(NVARCHAR(30),DATEDIFF(D,@DAT1,@DAT2))
        SET @RAZ = @DRSA + 'д. ' + @PER + 'г. ' + @PER1 + 'хв.'
RETURN(@RAZ)
END
GO
/****** Object:  Table [dbo].[W_Order_Back]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Order_Back](
	[ID] [int] NOT NULL,
	[Zakaz] [nvarchar](50) NULL,
	[D_zakaza] [smalldatetime] NULL,
	[Brend] [int] NULL,
	[Vers] [int] NULL,
	[Sorder] [nvarchar](30) NULL,
	[Wiou] [nvarchar](30) NULL,
	[ProductionMonth] [smalldatetime] NULL,
	[DLR_Order_placed] [smalldatetime] NULL,
	[Dealer_order_placed] [int] NULL,
	[Dpo] [nvarchar](30) NULL,
	[Dlr] [int] NULL,
	[Loc] [int] NULL,
	[Status] [int] NULL,
	[Model] [int] NULL,
	[VIN] [nvarchar](20) NULL,
	[Engine] [int] NULL,
	[Spec1] [nvarchar](20) NULL,
	[Spec2] [nvarchar](20) NULL,
	[Spec3] [nvarchar](20) NULL,
	[Colour] [int] NULL,
	[Colours] [int] NULL,
	[Trimm] [int] NULL,
	[OrderType] [int] NULL,
	[Comments] [nvarchar](255) NULL,
	[MY] [numeric](18, 0) NULL,
	[Cif_cip_calc] [money] NULL,
	[Cif_cip] [money] NULL,
	[Dealer_price] [money] NULL,
	[MSRP] [money] NULL,
	[OrderPlaced] [smalldatetime] NULL,
	[DeadlineChange] [smalldatetime] NULL,
	[Req] [nvarchar](255) NULL,
	[Product_confirmed] [smalldatetime] NULL,
	[ProdM] [smalldatetime] NULL,
	[Start_Production] [smalldatetime] NULL,
	[Date_completed] [smalldatetime] NULL,
	[Invoice_Number] [nvarchar](20) NULL,
	[Invoice_Date] [smalldatetime] NULL,
	[Compound] [smalldatetime] NULL,
	[RLS] [nvarchar](30) NULL,
	[RLS_placed] [smalldatetime] NULL,
	[Start_transit] [smalldatetime] NULL,
	[WIU_Arrived] [smalldatetime] NULL,
	[ContractDD] [smalldatetime] NULL,
	[DLR_Suggested_Arrival] [smalldatetime] NULL,
	[DLR_Actual_Arrival] [smalldatetime] NULL,
	[Sold_to_DLR] [smalldatetime] NULL,
	[Sold_to_Client] [smalldatetime] NULL,
	[Rls_left_compound] [smalldatetime] NULL,
	[Price_check] [smalldatetime] NULL,
	[Days_in_prod] [int] NULL,
	[Days_Compound] [int] NULL,
	[Days_deliv] [int] NULL,
	[Days_WIU] [int] NULL,
	[DAYS_DLR] [int] NULL,
	[Days_Total] [int] NULL,
	[DLR_Payment] [money] NULL,
	[PMNT_Supplier] [money] NULL,
	[Payment_Suppl_Date] [smalldatetime] NULL,
	[Dat_zak] [smalldatetime] NULL,
	[Derivate] [nvarchar](255) NULL,
	[GearBox] [int] NULL,
	[Optional] [int] NULL,
	[Options] [nvarchar](3000) NULL,
	[Client] [int] NULL,
	[Confirms] [nvarchar](50) NULL,
	[REF] [smalldatetime] NULL,
	[REF#] [nvarchar](50) NULL,
	[Compound_RLS] [smalldatetime] NULL,
	[Get_release_Date] [smalldatetime] NULL,
	[Omdp] [smalldatetime] NULL,
	[Aging_Compound] [int] NULL,
	[Aging_Dealer] [int] NULL,
	[Aging_Total] [int] NULL,
	[Aging] [nvarchar](255) NULL,
	[Dlrs] [money] NULL,
	[WIU] [nvarchar](255) NULL,
	[Credit_Line] [nvarchar](255) NULL,
	[Stock_Position] [nvarchar](255) NULL,
	[SalesDialer] [money] NULL,
	[Payment] [money] NULL,
	[Payment_Due] [datetime] NULL,
	[Remain] [money] NULL,
	[PDI] [nvarchar](255) NULL,
	[Car_credit] [nvarchar](255) NULL,
	[Payments_Due_Aging] [nvarchar](255) NULL,
	[Isp_dat] [smalldatetime] NULL,
	[Isp] [nvarchar](50) NULL,
	[Comp] [nvarchar](50) NULL,
	[Isppol] [int] NULL,
	[Priz] [int] NULL,
	[Note] [nvarchar](200) NULL,
	[Package] [int] NULL,
	[Rdf_dlr] [nvarchar](50) NULL,
	[Rdf_Vid] [nvarchar](50) NULL,
	[Rdf_prod] [nvarchar](50) NULL,
	[Rdf_rikv] [smalldatetime] NULL,
	[Rdf_Zamov] [nvarchar](50) NULL,
	[Rdf_CodRadio] [nvarchar](15) NULL,
	[Rdf_numkey] [nvarchar](15) NULL,
	[Rdf_NumContract] [nvarchar](20) NULL,
	[Rdf_DateContract] [smalldatetime] NULL,
	[Rdf_PriceClient] [money] NULL,
	[Rdf_FleetCode] [nvarchar](20) NULL,
	[Rdf_DateSale] [smalldatetime] NULL,
	[Rdf_Category] [nvarchar](50) NULL,
	[Rdf_NameClient] [nvarchar](50) NULL,
	[Rdf_NameCompany] [nvarchar](50) NULL,
	[Rdf_Vik] [int] NULL,
	[Rdf_BornClient] [nvarchar](50) NULL,
	[Rdf_Adres] [nvarchar](100) NULL,
	[Rdf_Cyti] [nvarchar](20) NULL,
	[Rdf_Phone] [nvarchar](20) NULL,
	[Rdf_Phoneh] [nvarchar](50) NULL,
	[Rdf_Phonew] [nvarchar](50) NULL,
	[Rdf_Fax] [nvarchar](50) NULL,
	[Rdf_Prof] [nvarchar](50) NULL,
	[Rdf_Post] [nvarchar](10) NULL,
	[Rdf_Marka] [nvarchar](20) NULL,
	[Rdf_Model] [nvarchar](20) NULL,
	[Rdf_Vupusk] [nvarchar](20) NULL,
	[Rdf_Salesman] [int] NULL,
	[Viev] [int] NULL,
	[Vubor_pr] [int] NULL,
	[Vubor] [int] NULL,
	[Log_Ttn] [int] NULL,
	[Log_Akt] [int] NULL,
	[Log_Dat_otgruzki] [smalldatetime] NULL,
	[Log_acc] [nvarchar](20) NULL,
	[Log_sum] [money] NULL,
	[Log_noNDS] [money] NULL,
	[Log_remark] [nvarchar](300) NULL,
	[Log_mont] [int] NULL,
	[Log_kurs] [money] NULL,
	[Log_perevoz] [int] NULL,
	[Log_Dat_prib] [smalldatetime] NULL,
	[Log_Dat_razgr] [smalldatetime] NULL,
	[Log_Dat_priem] [smalldatetime] NULL,
	[Log_fio_prinyal] [nvarchar](50) NULL,
	[Log_fio_perevoz] [nvarchar](50) NULL,
	[Log_choice] [int] NULL,
	[Inv_Charges] [money] NULL,
	[Inv_Insurance] [money] NULL,
	[Inv_Country] [int] NULL,
	[Inv_Weight] [int] NULL,
	[Boc_number] [int] NULL,
	[Boc_date] [datetime] NULL,
	[Akc_Dlr_price] [money] NULL,
	[Akc_Msrp] [money] NULL,
	[Akc_valute] [int] NULL,
	[Log_Dealer_order] [datetime] NULL,
	[Fin_Recived_Approved] [datetime] NULL,
	[Brd_Recived_Approved] [datetime] NULL,
	[Brd_wiu_reguest_fin_approval] [datetime] NULL,
	[Brd_WTF_approval] [datetime] NULL,
	[Brd_WIU_Transport_invoice] [datetime] NULL,
	[Brd_configuration_check] [datetime] NULL,
	[Log_reguest_send_WTF] [datetime] NULL,
	[Log_WTF_confirmation] [datetime] NULL,
	[Log_invoice_send_to_inbound_carrier] [datetime] NULL,
	[Log_Insurance_date] [datetime] NULL,
	[Log_Vechicle_Unloaded_VIC] [datetime] NULL,
	[Log_Customs_clearance] [datetime] NULL,
	[Log_dealer_payment_check] [datetime] NULL,
	[Log_invoice_send_carrier] [datetime] NULL,
	[Log_VIC_departure] [datetime] NULL,
	[Log_estimated_delivery_dlr] [datetime] NULL,
	[Log_actual_delivery_dlr] [datetime] NULL,
	[Log_reguest_sale] [datetime] NULL,
	[Fin_accouting_doc_issued] [datetime] NULL,
	[Fin_accouting_doc_send] [datetime] NULL,
	[Fin_accouting_doc_recived] [datetime] NULL,
	[Fin_payment_supplier] [datetime] NULL,
	[Fin_payment_dealer] [datetime] NULL,
	[Fin_sale_dealer] [datetime] NULL,
	[Log_order_relocation] [datetime] NULL,
	[Log_estimated_relocation] [datetime] NULL,
	[Fin_return_dlr_deposit] [datetime] NULL,
	[Log_copy_dlr_sale] [datetime] NULL,
	[Log_original_dlr_send] [datetime] NULL,
	[Log_received_dlr] [datetime] NULL,
	[Log_inbound_carrier] [datetime] NULL,
	[Fin_invoice_pay_carrier] [datetime] NULL,
	[Log_invoice_out_carrier] [datetime] NULL,
	[Log_invoice_paid] [datetime] NULL,
	[Svin] [varchar](30) NULL,
	[Statuss] [int] NULL,
	[A_Financial_Desicsion_Days] [int] NULL,
	[A_Sales_Desicsion_Days] [int] NULL,
	[A_Days_Place_Orders] [int] NULL,
	[A_FC_Desicsion_Days] [int] NULL,
	[A_Estimated_Production_Days] [int] NULL,
	[A_Actual_Prodaction_Days] [int] NULL,
	[A_Production_Delivation_Days] [int] NULL,
	[A_Days_Transit_Compound] [int] NULL,
	[A_Days_Compound] [int] NULL,
	[A_FC_Release_Confirmation_Days] [int] NULL,
	[A_Compound_Preparation_Days] [int] NULL,
	[A_Days_Transit_Ukraine] [int] NULL,
	[A_Days_Customs] [int] NULL,
	[A_Dayst_VIC] [int] NULL,
	[A_Days_Transit_Dealer] [int] NULL,
	[A_Days_Dealer] [int] NULL,
	[A_Days_WIU_Customer_Sold] [int] NULL,
	[A_Tatal_Days] [int] NULL,
	[Mes_zakaza] [int] NULL,
	[Blocked_f] [int] NULL,
	[Blocked_l] [int] NULL,
	[Fyon] [char](30) NULL,
	[Boq] [nvarchar](50) NULL,
	[D_in_prodaction] [int] NULL,
	[D_in_compound] [int] NULL,
	[D_in_delivery] [int] NULL,
	[D_in_wiu] [int] NULL,
	[D_in_dlr] [int] NULL,
	[D_in_total] [int] NULL,
	[A_Compound] [nvarchar](25) NULL,
	[A_Dealer] [nvarchar](25) NULL,
	[A_Total] [nvarchar](25) NULL,
	[Kontrakt] [smalldatetime] NULL,
	[Svvin] [varchar](30) NULL,
	[Sale_VIN] [nvarchar](20) NULL,
	[Sale_MARK] [nvarchar](1) NULL,
	[Sale_MODEL] [nvarchar](30) NULL,
	[Sale_IFIRMS] [int] NULL,
	[Sale_DATE] [smalldatetime] NULL,
	[Sale_CURR] [nvarchar](3) NULL,
	[Sale_SUM_CURR] [money] NULL,
	[Sale_DEALER] [nvarchar](30) NULL,
	[Sale_ID] [nvarchar](20) NULL,
	[Sale_OPRID] [int] NULL,
	[Sale_CRDCODE] [int] NULL,
	[Sale_NUM_DOC] [nvarchar](20) NULL,
	[Sale_NOTE] [nvarchar](200) NULL,
	[Sale_PAYM_TERM] [nvarchar](20) NULL,
	[Sale_PAYM_DATE] [smalldatetime] NULL,
	[Sale_IS_CLOSED] [int] NULL,
	[Sale_EUR] [money] NULL,
	[Sale_SUM_EUR] [money] NULL,
	[Pymnt_IDD] [int] NULL,
	[Pymnt_ID] [nvarchar](10) NULL,
	[Pymnt_DATE] [smalldatetime] NULL,
	[Pymnt_CURR] [nvarchar](3) NULL,
	[Pymnt_SUM_CURR] [money] NULL,
	[Pymnt_IFIRMS] [int] NULL,
	[Pymnt_N_ORD] [nvarchar](20) NULL,
	[Pymnt_MARK] [nvarchar](1) NULL,
	[Pymnt_NOTE] [nvarchar](200) NULL,
	[Pymnt_EUR] [money] NULL,
	[Pymnt_SUM_EUR] [money] NULL,
	[Pymnt_NUM_DOC] [nvarchar](20) NULL,
	[Pymnt_L_NUM] [nvarchar](10) NULL,
	[Pymnt_L_DATE] [smalldatetime] NULL,
	[Pymnt_SUM_TOTAL] [money] NULL,
	[Msrp1] [money] NULL,
	[Dc1] [money] NULL
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  StoredProcedure [dbo].[MyYError]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Create procedure basic template
-- =============================================
-- creating the store procedure

CREATE PROCEDURE [dbo].[MyYError] @Par varchar (20)
AS
RAISERROR (@par ,16,1)
GO
/****** Object:  Table [dbo].[S_Brend]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Brend](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](30) NOT NULL,
	[Sokr] [nvarchar](3) NOT NULL,
	[Pic] [image] NULL,
	[By_split1] [int] NULL,
	[By_split2] [int] NULL,
	[By_split3] [int] NULL,
	[Remarks] [nvarchar](1000) NULL,
	[Discount_remark] [nvarchar](50) NULL,
	[Discount_value] [money] NULL,
 CONSTRAINT [PK__S_Brend__5DEAEAF5] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend', @level2type=N'COLUMN',@level2name=N'Sokr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend', @level2type=N'COLUMN',@level2name=N'Sokr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend', @level2type=N'COLUMN',@level2name=N'Sokr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend', @level2type=N'COLUMN',@level2name=N'Pic'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend', @level2type=N'COLUMN',@level2name=N'Pic'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend', @level2type=N'COLUMN',@level2name=N'Pic'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DatasheetBackColor', @value=13434828 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DefaultView', @value=0x02 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Filter', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_LinkChildFields', @value=N'Brend' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_LinkMasterFields', @value=N'ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderBy', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderByOn', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Orientation', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_SubdatasheetName', @value=N'dbo.S_Model' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_TableMaxRecords', @value=10000 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Brend'
GO
/****** Object:  Table [dbo].[S_Insurance]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Insurance](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Brend] [int] NOT NULL,
	[Model] [int] NOT NULL,
	[Version] [int] NOT NULL,
	[Inv_City] [nvarchar](50) NULL,
	[Inv_Freight] [money] NULL,
	[Inv_Insurance] [money] NULL,
	[Inv_Weight] [numeric](18, 3) NULL,
 CONSTRAINT [PK_S_Insurance] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Бренд' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Insurance', @level2type=N'COLUMN',@level2name=N'Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Модель' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Insurance', @level2type=N'COLUMN',@level2name=N'Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Версия' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Insurance', @level2type=N'COLUMN',@level2name=N'Version'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Город для производителя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Insurance', @level2type=N'COLUMN',@level2name=N'Inv_City'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Freight charges' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Insurance', @level2type=N'COLUMN',@level2name=N'Inv_Freight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Insurance - страховка' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Insurance', @level2type=N'COLUMN',@level2name=N'Inv_Insurance'
GO
/****** Object:  Table [dbo].[W_Descree]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Descree](
	[Idn] [int] IDENTITY(1,1) NOT NULL,
	[Descree] [nvarchar](30) NULL,
	[Dat_Des] [datetime] NULL,
	[Rls] [nvarchar](30) NULL,
	[Brand] [int] NULL,
	[Dat] [datetime] NULL,
	[Num_Car] [nvarchar](30) NULL,
	[Driver] [nvarchar](30) NULL,
	[Company] [nvarchar](30) NULL,
	[Telphone] [nvarchar](30) NULL,
	[Dat_Depart] [datetime] NULL,
	[Total_Sum] [money] NULL,
	[Creator] [nvarchar](250) NULL,
	[Note] [nvarchar](250) NULL,
	[Vubor] [nchar](1) NULL,
 CONSTRAINT [PK__W_Descree__1472AF86] PRIMARY KEY CLUSTERED 
(
	[Idn] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY],
 CONSTRAINT [WD_0001] UNIQUE NONCLUSTERED 
(
	[Descree] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Read_Reestr]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Чтение реестра
CREATE PROCEDURE [dbo].[Read_Reestr] (@Vvod int)
AS
SET NOCOUNT ON

declare @SQLPath varchar(255)
 exec master..xp_regread
        'HKEY_LOCAL_MACHINE'
       ,'SOFTWARE\Microsoft\MSSQLServer\Setup'
       ,'SQLPath', @SQLPath   OUTPUT

print @sqlpath
GO
/****** Object:  Table [dbo].[W_Version]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Version](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[D_change] [smalldatetime] NULL,
	[Descr] [nvarchar](20) NULL,
	[Notes] [nvarchar](255) NULL,
	[USS] [nvarchar](50) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[App_Diler_subGetList]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns a query resultset from table [dbo].[S_Diler_sub]
-- given the search criteria and sorting condition.
-- It will return a subset of the data based
-- on the current page number and batch size.  Table joins can
-- be performed if the join clause is specified.
-- 
-- If the resultset is not empty, it will return:
--    1) The total number of rows which match the condition;
--    2) The resultset in the current page
-- If nothing matches the search condition, it will return:
--    1) count is 0 ;
--    2) empty resultset.
CREATE PROCEDURE [dbo].[App_Diler_subGetList]
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_sort_str nvarchar(4000),
        @p_page_number int,
        @p_batch_size int
AS
DECLARE
    @l_temp_insert nvarchar(4000),
    @l_temp_select nvarchar(4000),
    @l_temp_from nvarchar(4000),
    @l_final_sort nvarchar(4000),
    @l_temp_cols nvarchar(4000),
    @l_temp_colsWithAlias nvarchar(4000),
    @l_query_select nvarchar(4000),
    @l_query_from nvarchar(4000),
    @l_query_where nvarchar(4000),
    @l_query_cols nvarchar(4000),
    @l_from_str nvarchar(4000),
    @l_join_str nvarchar(4000),
    @l_sort_str nvarchar(4000),
    @l_where_str nvarchar(4000),
    @l_count_query nvarchar(4000),
    @l_end_gen_row_num integer,
    @l_start_gen_row_num integer
BEGIN
    -- Set up the from string as the base table.
    SET @l_from_str = '[dbo].[S_Diler_sub] S_Diler_sub_'

    -- Set up the join string.
    SET @l_join_str = @p_join_str
    IF @p_join_str is null
        SET @l_join_str = ' '

    -- Set up the where string.
    SET @l_where_str = ' '
        IF @p_where_str is not null
        SET @l_where_str = 'WHERE ' + @p_where_str

    -- Get the total count of rows the query will return
    IF @p_page_number > 0 and @p_batch_size >= 0
    BEGIN
        SET @l_count_query = 
            'SELECT count(*) ' +
            'FROM ' + @l_from_str + ' ' + @l_join_str + ' ' +
            @l_where_str + ' '

        -- Run the count query
        EXECUTE (@l_count_query)
    END

    -- Get the list.
    IF @p_page_number > 0 AND @p_batch_size > 0
    BEGIN
        -- If the caller did not pass a sort string, use a default value
        IF @p_sort_str IS NOT NULL
            SET @l_sort_str = 'ORDER BY ' + @p_sort_str
        ELSE
            SET @l_sort_str = N'ORDER BY S_Diler_sub_.[Id] asc '

        -- Calculate the rows to be included in the list
        -- before geting the list.
        SET @l_end_gen_row_num = @p_page_number * @p_batch_size;
        SET @l_start_gen_row_num = @l_end_gen_row_num - (@p_batch_size-1);

        -- Create a temporary table to keep the numbering
        -- of the rows returned.  It contains the necessary colums
        -- from base table plus an identity field used for numbering

        SELECT 1 AS IS_SECONDARY_TEMP_T_GETLIST_COL INTO #IS_SECONDARY_TEMP_T_GETLIST
        SELECT Identity(int,1,1) AS IS_ROWNUM_COL,
            [Id]
         INTO #IS_TEMP_T_GETLIST 
         FROM [dbo].[S_Diler_sub], #IS_SECONDARY_TEMP_T_GETLIST
             WHERE 1=2 

        -- Now copy column data into temporary table.
        SET @l_temp_insert = 
            'INSERT INTO #IS_TEMP_T_GETLIST ('
        SET @l_temp_cols = 
            N'[Id]'
        SET @l_temp_select = 
            ') ' + 
            'SELECT ' + 
            'TOP ' + convert(varchar, @l_end_gen_row_num) + ' '
        SET @l_temp_colsWithAlias = 
            N'S_Diler_sub_.[Id]'
        SET @l_temp_from = 
            ' FROM ' + @l_from_str + ' ' + @l_join_str + ' ' + 
            @l_where_str + ' ' + 
            @l_sort_str

        EXECUTE (@l_temp_insert + @l_temp_cols + @l_temp_select + @l_temp_colsWithAlias + @l_temp_from)

        -- Construct the main query
        SET @l_query_select = 'SELECT '
        SET @l_query_cols = 
            N'S_Diler_sub_.[Id],
            S_Diler_sub_.[Idn],
            S_Diler_sub_.[Position],
            S_Diler_sub_.[Fist_Name],
            S_Diler_sub_.[Last_name],
            S_Diler_sub_.[Short_Name],
            S_Diler_sub_.[Mob_tel],
            S_Diler_sub_.[Work_tel],
            S_Diler_sub_.[Home_tel],
            S_Diler_sub_.[E_mail],
            S_Diler_sub_.[Post_code],
            S_Diler_sub_.[Area],
            S_Diler_sub_.[City],
            S_Diler_sub_.[Street],
            S_Diler_sub_.[Build],
            CAST(BINARY_CHECKSUM(S_Diler_sub_.[Id],S_Diler_sub_.[Idn],S_Diler_sub_.[Position],S_Diler_sub_.[Fist_Name],S_Diler_sub_.[Last_name],S_Diler_sub_.[Short_Name],S_Diler_sub_.[Mob_tel],S_Diler_sub_.[Work_tel],S_Diler_sub_.[Home_tel],S_Diler_sub_.[E_mail],S_Diler_sub_.[Post_code],S_Diler_sub_.[Area],S_Diler_sub_.[City],S_Diler_sub_.[Street],S_Diler_sub_.[Build]) AS nvarchar(4000)) AS IS_CHECKSUM_COLUMN_12345 '
        SET @l_query_from = 
            'FROM ( ' +
                N'SELECT TOP 100 PERCENT IS_ROWNUM_COL, [Id] from #IS_TEMP_T_GETLIST ' +
                'WHERE IS_ROWNUM_COL >= '+ convert(varchar, @l_start_gen_row_num) + 
                ') IS_ALIAS, ' +
                @l_from_str + ' ';

        SET @l_query_where = 
            N'WHERE S_Diler_sub_.[Id] = IS_ALIAS.[Id] ' 

        SET @l_final_sort = 'ORDER BY IS_ROWNUM_COL Asc '

        -- Run the query
        EXECUTE (@l_query_select + @l_query_cols + @l_query_from + @l_query_where + @l_final_sort)

    END
    ELSE
    BEGIN
        -- If page number and batch size are not valid numbers
        -- return an empty result set
        SET @l_query_select = 'SELECT '
        SET @l_query_cols = 
            N'S_Diler_sub_.[Id],
            S_Diler_sub_.[Idn],
            S_Diler_sub_.[Position],
            S_Diler_sub_.[Fist_Name],
            S_Diler_sub_.[Last_name],
            S_Diler_sub_.[Short_Name],
            S_Diler_sub_.[Mob_tel],
            S_Diler_sub_.[Work_tel],
            S_Diler_sub_.[Home_tel],
            S_Diler_sub_.[E_mail],
            S_Diler_sub_.[Post_code],
            S_Diler_sub_.[Area],
            S_Diler_sub_.[City],
            S_Diler_sub_.[Street],
            S_Diler_sub_.[Build],
            CAST(BINARY_CHECKSUM(S_Diler_sub_.[Id],S_Diler_sub_.[Idn],S_Diler_sub_.[Position],S_Diler_sub_.[Fist_Name],S_Diler_sub_.[Last_name],S_Diler_sub_.[Short_Name],S_Diler_sub_.[Mob_tel],S_Diler_sub_.[Work_tel],S_Diler_sub_.[Home_tel],S_Diler_sub_.[E_mail],S_Diler_sub_.[Post_code],S_Diler_sub_.[Area],S_Diler_sub_.[City],S_Diler_sub_.[Street],S_Diler_sub_.[Build]) AS nvarchar(4000)) AS IS_CHECKSUM_COLUMN_12345'
        SET @l_query_from = 
            ' FROM [dbo].[S_Diler_sub] S_Diler_sub_ ' + 
            'WHERE 1=2;'
        EXECUTE (@l_query_select + @l_query_cols + @l_query_from);
    END

END
GO
/****** Object:  StoredProcedure [dbo].[Myday]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--PRINT DATEDIFF(DAY, , '2008-06-14')

CREATE proc [dbo].[Myday]
as

SELECT  ID, 
        ORDERPLACED, 
        DEADLINECHANGE, 
        ISNULL(DEADLINECHANGE,GETDATE()) AS Dead_Line,
        DATEDIFF(DAY, ISNULL(DEADLINECHANGE,GETDATE()), ISNULL(ORDERPLACED,GETDATE())) AS RASNICA 
   FROM W_ORDER 
--WHERE ID=405
GO
/****** Object:  StoredProcedure [dbo].[App_Diler_subDrillDown]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- This stored procedure will return query result based on 
-- the passed in select, search and ORDER BY clauses.
CREATE PROCEDURE [dbo].[App_Diler_subDrillDown]
        @p_select_str nvarchar(4000),
        @p_is_distinct int,
        @p_select_str_b nvarchar(4000),
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_sort_str nvarchar(4000),
        @p_page_number int,
        @p_batch_size int
AS
DECLARE
    @l_createtemp_select nvarchar(4000),
    @l_createtemp_into nvarchar(4000),
    @l_createtemp_from nvarchar(4000),
    @l_createtemp_where nvarchar(4000),
    @l_temp_insert nvarchar(4000),
    @l_temp_select nvarchar(4000),
    @l_temp_from nvarchar(4000),
    @l_final_sort nvarchar(4000),
    @l_query_select nvarchar(4000),
    @l_query_from nvarchar(4000),
    @l_query_where nvarchar(4000),
    @l_from_str nvarchar(4000),
    @l_join_str nvarchar(4000),
    @l_sort_str nvarchar(4000),
    @l_where_str nvarchar(4000),
    @l_count_query nvarchar(4000),
    @l_end_gen_row_num integer,
    @l_start_gen_row_num integer
BEGIN
    -- Set up the from string as the base table.
    SET @l_from_str = '[dbo].[S_Diler_sub] S_Diler_sub_'

    -- Set up the join string.
    SET @l_join_str = @p_join_str
    IF @p_join_str is null
        SET @l_join_str = ' '

    -- Set up the where string.
    SET @l_where_str = ' '
        IF @p_where_str is not null
        SET @l_where_str = 'WHERE ' + @p_where_str

    -- Get the total count of rows the query will return
    IF @p_page_number > 0 and @p_batch_size >= 0
    BEGIN
        IF @p_is_distinct = 0
        BEGIN
            SET @l_count_query = 
                'SELECT count(*) FROM ( SELECT ' + @p_select_str + 
                ' As __Two FROM ' + @l_from_str + ' ' + @l_join_str + ' ' +
                @l_where_str + ' ) countAlias'

        END
        ELSE
        BEGIN
            SET @l_count_query = 
                'SELECT COUNT(*) FROM ( SELECT DISTINCT ' + @p_select_str + ' As __Two, 1 As __One  ' +
                'FROM ' + @l_from_str + ' ' + @l_join_str + ' ' +
                @l_where_str + ' ) pass1 '

        END
    END

    ELSE

    BEGIN
        SET @l_count_query = ' '
    END

    -- Get the list.
    IF @p_page_number > 0 AND @p_batch_size > 0
    BEGIN
        -- If the caller did not pass a sort string, use a default value
        IF @p_sort_str IS NULL OR LTRIM(RTRIM(@p_sort_str)) = ''
            SET @l_sort_str = 'ORDER BY 1 '

        ELSE
            SET @l_sort_str = 'ORDER BY ' + @p_sort_str
        -- Calculate the rows to be included in the list
        -- before geting the list.
        SET @l_end_gen_row_num = @p_page_number * @p_batch_size;
        SET @l_start_gen_row_num = @l_end_gen_row_num - (@p_batch_size-1);

        -- Create a temporary table to keep the numbering
        -- of the rows returned.  It contains the necessary colums
        -- from base table plus an identity field used for numbering

        SELECT 1 AS IS_SECONDARY_TEMP_T_GETLIST_COL INTO #IS_SECONDARY_TEMP_T_GETLIST

        SET @l_createtemp_select = 
            'SELECT Identity(int,1,1) AS IS_ROWNUM_COL, ' + 
            @p_select_str + ' __Two '
        SET @l_createtemp_into = 
            ' INTO #IS_TEMP_T_GETLIST '
        SET @l_createtemp_from = 
            ' FROM [dbo].[S_Diler_sub] AS [S_Diler_sub_], #IS_SECONDARY_TEMP_T_GETLIST'
        SET @l_createtemp_where = 
            ' WHERE 1=2 '
        -- Now copy column data into temporary table.
        SET @l_temp_insert = 
            'INSERT INTO #IS_TEMP_T_GETLIST ( __Two ) ' 
        IF @p_is_distinct = 0 OR @p_sort_str IS NULL OR LTRIM(RTRIM(@p_sort_str)) = ''
        BEGIN
            IF @p_is_distinct = 0
            BEGIN
                SET @l_temp_select = 
                    'SELECT '
            END
            ELSE
            BEGIN
                SET @l_temp_select = 
                    'SELECT DISTINCT '
            END
        SET @l_temp_select = 
            @l_temp_select + 
            'TOP ' + convert(varchar, @l_end_gen_row_num) + ' ' + 
            @p_select_str
        END
        ELSE
        BEGIN
                -- Need to construct query differently when sorting by expanded DFKA, 
                -- So get the TOP DISTINCT values after selecting, joining, and sorting ALL the values 
                SET @l_temp_select = 
                    'SELECT __ReturnCol FROM ( ' + 
                    'SELECT ' + 
                    'DISTINCT ' + 
                    'TOP ' + convert(varchar, @l_end_gen_row_num) + ' ' + 
                    @p_select_str + 
                    ' As __ReturnCol, ' + 
                    @p_select_str_b
                -- Close and alias the outer FROM clause after the inner ORDER BY clause 
                SET @l_sort_str = 
                    @l_sort_str + 
                    ' ) pass1 '
        END
        SET @l_temp_from = 
            ' FROM ' + @l_from_str + ' ' + @l_join_str
        -- Construct the main query
        SET @l_query_select = 'SELECT '
        SET @l_query_from = 
            'FROM #IS_TEMP_T_GETLIST ' +
            'AS [S_Diler_sub_]' +
            ' WHERE IS_ROWNUM_COL >= '+ convert(varchar, @l_start_gen_row_num) 

        SET @l_final_sort = 'ORDER BY IS_ROWNUM_COL Asc '

        -- Run all the queries as a batch so the temp tables won't lose scope
        EXECUTE (@l_count_query + '     ' + @l_createtemp_select + @l_createtemp_into + @l_createtemp_from + @l_createtemp_where + '     ' + @l_temp_insert + @l_temp_select + @l_temp_from + ' ' + @l_where_str + ' ' + @l_sort_str + '     ' + @l_query_select + ' __Two ' + @l_query_from + @l_query_where + @l_final_sort)

    END
    ELSE
    BEGIN
        -- If page number and batch size are not valid numbers
        -- return the empty result set
        SET @l_query_select = 'SELECT '
        SET @l_query_from = 
            ' FROM [dbo].[S_Diler_sub] S_Diler_sub_ ' + 
            'WHERE 1=2;'
        EXECUTE (@l_query_select + @p_select_str + @l_query_from);
    END

END
GO
/****** Object:  Table [dbo].[S_Error]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Error](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](100) NOT NULL,
	[Gr] [int] NULL,
 CONSTRAINT [PK__S_Error__76B698BF] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_City]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_City](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Country] [int] NULL,
	[Name_city] [nvarchar](50) NOT NULL,
	[PostCode] [char](10) NULL,
	[Adress] [nvarchar](50) NULL,
	[Telephone] [nvarchar](50) NULL,
	[Fax] [nvarchar](50) NULL,
	[Boss] [nvarchar](50) NULL,
 CONSTRAINT [PK_S_City] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код страны' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_City', @level2type=N'COLUMN',@level2name=N'Country'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Название города' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_City', @level2type=N'COLUMN',@level2name=N'Name_city'
GO
/****** Object:  Table [dbo].[W_Pay_suppl_1]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Pay_suppl_1](
	[IDD] [int] IDENTITY(1,1) NOT NULL,
	[Ndoc] [nvarchar](30) NULL,
	[Dat_pay] [datetime] NULL,
	[Boq] [nvarchar](30) NULL,
	[Brand] [int] NULL,
	[Ammount] [money] NULL,
	[Supplers] [int] NULL,
	[Status] [int] NULL,
	[Notise] [nvarchar](100) NULL,
	[Isp] [int] NULL,
	[Isp_name] [nvarchar](50) NULL,
	[Deletted] [int] NULL,
 CONSTRAINT [PK_W_Pay_suppl_1] PRIMARY KEY CLUSTERED 
(
	[IDD] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код платежа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_suppl_1', @level2type=N'COLUMN',@level2name=N'IDD'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата платежа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_suppl_1', @level2type=N'COLUMN',@level2name=N'Dat_pay'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'БОК' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_suppl_1', @level2type=N'COLUMN',@level2name=N'Boq'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Бренд' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_suppl_1', @level2type=N'COLUMN',@level2name=N'Brand'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Сумма оплаты' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_suppl_1', @level2type=N'COLUMN',@level2name=N'Ammount'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Производитель' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_suppl_1', @level2type=N'COLUMN',@level2name=N'Supplers'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Статус оплаты' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_suppl_1', @level2type=N'COLUMN',@level2name=N'Status'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Примечание' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_suppl_1', @level2type=N'COLUMN',@level2name=N'Notise'
GO
/****** Object:  StoredProcedure [dbo].[App_Diler_subExport]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns the query result set in a CSV format
-- so that the data can be exported to a CSV file
CREATE PROCEDURE [dbo].[App_Diler_subExport]
        @p_separator_str nvarchar(15),
        @p_title_str nvarchar(4000),
        @p_select_str nvarchar(4000),
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_num_exported int output
    AS
    DECLARE
        @l_title_str nvarchar(4000),
        @l_select_str nvarchar(4000),
        @l_from_str nvarchar(4000),
        @l_join_str nvarchar(4000),
        @l_where_str nvarchar(4000),
        @l_query_select nvarchar(4000),
        @l_query_union nvarchar(4000),
        @l_query_from nvarchar(4000)
    BEGIN
        -- Set up the title string from the column names.  Excel 
        -- will complain if the first column value is ID. So wrap
        -- the value with "".
        SET @l_title_str = @p_title_str + char(13)
        IF @p_title_str IS NULL
            BEGIN
            SET @l_title_str = 
                N'"XId"' + @p_separator_str +
                N'"XIdn"' + @p_separator_str +
                N'"""XIdn"" Last_Name"' + @p_separator_str +
                N'"Position"' + @p_separator_str +
                N'"Fist_Name"' + @p_separator_str +
                N'"Last_name"' + @p_separator_str +
                N'"Short_Name"' + @p_separator_str +
                N'"Mob_tel"' + @p_separator_str +
                N'"Work_tel"' + @p_separator_str +
                N'"Home_tel"' + @p_separator_str +
                N'"E_mail"' + @p_separator_str +
                N'"Post_code"' + @p_separator_str +
                N'"Area"' + @p_separator_str +
                N'"City"' + @p_separator_str +
                N'"Street"' + @p_separator_str +
                N'"Build"' + ' ';
            END
        ELSE IF SUBSTRING(@l_title_str, 1, 2) = 'ID'
            SET @l_title_str = 
                '"' + 
                SUBSTRING(@l_title_str, 1, PATINDEX('%,%', @l_title_str)-1) + 
                '"' + 
                SUBSTRING(@l_title_str, PATINDEX('%,%', @l_title_str), LEN(@l_title_str)); 

        -- Set up the select string
        SET @l_select_str = @p_select_str
        IF @p_select_str IS NULL
            BEGIN
            SET @l_select_str = 
                N'IsNULL(Convert(nvarchar, S_Diler_sub_.[Id]), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Diler_sub_.[Idn]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL( t0.[Last_Name], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[Position], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[Fist_Name], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[Last_name], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[Short_Name], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[Mob_tel], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[Work_tel], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[Home_tel], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[E_mail], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[Post_code], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[Area], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[City], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[Street], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Diler_sub_.[Build], ''''), N''"'', N''""'') + N''"''  + '' ''';
            END

        -- Set up the from string (with table alias) and the join string
        SET @l_from_str = '[dbo].[S_Diler_sub] S_Diler_sub_ LEFT OUTER JOIN [dbo].[S_Diler] t0 ON (S_Diler_sub_.[Idn] =  t0.[ID])';

        SET @l_join_str = @p_join_str
        if @p_join_str is null
            SET @l_join_str = ' ';

        -- Set up the where string
        SET @l_where_str = ' ';
        IF @p_where_str IS NOT NULL
            SET @l_where_str = @l_where_str + 'WHERE ' + @p_where_str;

        -- Construct the query string.  Append the result set with the title.
        SET @l_query_select = 
                'SELECT '''
        SET @l_query_union = 
                ''' UNION ALL ' +
                'SELECT '
        SET @l_query_from = 
                ' FROM ' + @l_from_str + ' ' + @l_join_str + ' ' +
                @l_where_str;

        -- Run the query
        EXECUTE (@l_query_select + @l_title_str + @l_query_union + @l_select_str+ @l_query_from)

        -- Return the total number of rows of the query
        SELECT @p_num_exported = @@rowcount
    END
GO
/****** Object:  Table [dbo].[S_Document]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Document](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](100) NOT NULL,
	[Gr] [int] NULL,
 CONSTRAINT [PK__S_Document__2665ABE1] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Program]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Program](
	[IDN] [int] IDENTITY(1,1) NOT NULL,
	[Curr_Date] [datetime] NULL,
	[Proizv] [int] NULL,
	[Date_Start] [datetime] NULL,
	[Date_Finish] [datetime] NULL,
	[Brand] [int] NOT NULL,
	[Model] [int] NULL,
	[Vers] [int] NULL,
	[NameProgram] [nvarchar](150) NOT NULL,
	[DiscrProgram] [nvarchar](150) NOT NULL,
	[Term] [nvarchar](50) NULL,
	[Support] [nvarchar](50) NULL,
	[Skidka] [smallmoney] NULL,
	[Priz] [nvarchar](1) NULL,
	[Notes] [nvarchar](200) NULL,
 CONSTRAINT [PK__S_Program__1C5DEA11] PRIMARY KEY CLUSTERED 
(
	[IDN] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Optional]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Optional](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Vers] [int] NULL,
	[Datavers] [smalldatetime] NULL,
	[DataChange] [smalldatetime] NULL,
	[Grup] [int] NULL,
	[Brend] [int] NOT NULL,
	[Model] [int] NOT NULL,
	[Version] [int] NOT NULL,
	[Sokr] [nvarchar](10) NOT NULL,
	[Naz] [nvarchar](250) NOT NULL,
	[Naz_ukr] [nvarchar](250) NULL,
	[Vubor] [int] NULL,
	[Code] [char](10) NULL,
	[Code2] [char](10) NULL,
	[Type] [char](10) NULL,
	[Opt] [char](10) NULL,
	[Remark] [char](10) NULL,
	[Pr_exw] [money] NULL,
	[Pr_dlr] [money] NULL,
	[Pr_msrp] [money] NULL,
	[Inv_City] [nvarchar](50) NULL,
	[Inv_Freight] [money] NULL,
	[Inv_Insurance] [money] NULL,
	[Inv_Weight] [numeric](18, 3) NULL,
	[Active] [int] NULL,
	[Vubr] [smallint] NULL,
	[Notice] [nvarchar](200) NULL,
	[Pr_dlr_ddu] [money] NULL,
	[Pr_msrp_ddu] [money] NULL,
 CONSTRAINT [PK__S_Optional__7C6F7215] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Уникальный номер' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Версия справочника' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Vers'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Datavers'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'(convert(char(12),getdate(),3))' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'DataChange'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Группа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Grup'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Бренд' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Модель' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Версия' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Version'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код опции' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Sokr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Наименование по английски' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Наименование по украински' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Naz_ukr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Выбор' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Vubor'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дополнительный код' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Code'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дополнительный код' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Code2'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Тип' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Type'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Примечание' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Remark'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цена производителя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Pr_exw'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цена для дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Pr_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цена для клиента' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Pr_msrp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Город для производителя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Inv_City'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Freight charges' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Inv_Freight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Insurance - страховка' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Inv_Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Выбор' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Active'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цена производителя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Pr_dlr_ddu'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цена для дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Optional', @level2type=N'COLUMN',@level2name=N'Pr_msrp_ddu'
GO
/****** Object:  Table [dbo].[S_Group]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Group](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
 CONSTRAINT [PK__S_Group__789EE131] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_ErrNotes]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_ErrNotes](
	[IDC] [int] IDENTITY(1,1) NOT NULL,
	[NameError] [nvarchar](50) NULL,
	[Grup] [int] NULL,
	[Description] [nchar](255) NULL,
 CONSTRAINT [PK_S_ErrNotes] PRIMARY KEY CLUSTERED 
(
	[IDC] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[A_Release]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Release]
AS
SELECT     TOP (100) PERCENT dbo.W_Order.Brend AS [Brand ID], dbo.S_Brend.Naz AS [Brand Name], dbo.W_Order.RLS AS [Release Number], COUNT(*) 
                      AS [Count Release], SUM(dbo.W_Order.Cif_cip) AS [Cif - Cip]
FROM         dbo.W_Order WITH (nolock) INNER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID
WHERE     (dbo.W_Order.RLS IS NOT NULL) AND (dbo.W_Order.Brend <> 1)
GROUP BY dbo.W_Order.RLS, dbo.S_Brend.Naz, dbo.W_Order.Brend
ORDER BY [Brand Name], [Release Number], [Cif - Cip]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[22] 4[28] 2[14] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 160
               Right = 316
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 6
               Left = 354
               Bottom = 114
               Right = 521
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 3105
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Release'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Release'
GO
/****** Object:  Table [dbo].[S_Company]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Company](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [varchar](50) NULL,
	[Flag] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[S_Optional_group]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Optional_group](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NULL,
	[Ukr] [nvarchar](50) NULL,
 CONSTRAINT [PK_S_Optional_group] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Taxi]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Taxi](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Department] [int] NULL,
	[Employee] [nvarchar](100) NULL,
	[DateWork] [datetime] NULL,
	[Meta] [nvarchar](255) NULL,
	[Talon] [nvarchar](50) NULL,
	[driver] [nvarchar](50) NULL,
	[Numberavto] [nvarchar](50) NULL,
	[Way] [int] NULL,
	[Cost] [money] NULL,
	[Dateinput] [datetime] NULL,
	[Approval] [int] NULL,
	[ApprovalName] [nvarchar](255) NULL,
	[Reasons] [nvarchar](255) NULL,
	[Notice] [nvarchar](255) NULL,
	[Priznak] [int] NULL,
	[Employee1] [nvarchar](100) NULL,
	[DepName] [nvarchar](100) NULL,
	[Marchrut] [nvarchar](200) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Co]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Co](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [nvarchar](50) NOT NULL,
	[Brend] [int] NOT NULL,
	[Model] [int] NOT NULL,
	[Vers] [int] NOT NULL,
	[Dat] [datetime] NULL,
	[Engine] [int] NULL,
	[Spec1] [varchar](20) NULL,
	[Spec2] [varchar](20) NULL,
	[Spec3] [varchar](20) NULL,
	[Trimm] [int] NULL,
	[Gearbox] [int] NULL,
	[Comments] [nvarchar](255) NULL,
	[Options] [nvarchar](3000) NULL,
	[Package] [int] NULL,
	[Colour] [nvarchar](50) NULL,
	[Colour_id] [int] NULL,
	[Colours] [nvarchar](50) NULL,
	[Colours_id] [int] NULL,
	[Dlr] [int] NULL,
	[Ordertype] [int] NULL,
	[Orderplaced] [smalldatetime] NULL,
	[Productionmonth] [smalldatetime] NULL,
	[Remark] [nvarchar](100) NULL,
	[Priz] [int] NULL,
 CONSTRAINT [PK_W_Co] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[S_Mounth]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Mounth](
	[ID] [int] NOT NULL,
	[Kod] [nvarchar](1) NOT NULL,
	[Naz] [nvarchar](10) NOT NULL,
	[Nazv] [nvarchar](3) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Updates]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Updates](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Path] [nvarchar](50) NULL,
	[List] [nvarchar](50) NULL,
	[Diap] [nvarchar](50) NULL,
	[Vub] [bit] NULL,
	[Grups] [int] NULL,
 CONSTRAINT [PK_W_Updates] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Сохранение путей к файлам обновления' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Updates', @level2type=N'COLUMN',@level2name=N'Id'
GO
/****** Object:  UserDefinedFunction [dbo].[NumPhrase]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*************************************************************************/
/*                  NumPhrase function for MSSQL2000                     */
/*                   Gleb Oufimtsev (dnkvpb@nm.ru)                       */
/*                       http://www.gvu.newmail.ru                       */
/*                          Moscow  Russia  2001                         */
/*************************************************************************/
CREATE function [dbo].[NumPhrase] (@Num BIGINT, @IsMaleGender bit=1)
returns varchar(255)
as
begin
  declare @nword varchar(255), @th tinyint, @gr smallint, @d3 tinyint, @d2 tinyint, @d1 tinyint
  if @Num<0 return '*** Error: Negative value' 
     else 
         if @Num=0 return 'Ноль'

/* особый случай */
  while @Num>0
  begin
    set @th=IsNull(@th,0)+1    set @gr=@Num%1000    set @Num=(@Num-@gr)/1000
    if @gr>0
    begin
      set @d3=(@gr-@gr%100)/100
      set @d1=@gr%10
      set @d2=(@gr-@d3*100-@d1)/10
      if  @d2=1 set @d1=10+@d1
      set @nword=case @d3
                  when 1 then ' сто' when 2 then ' двести' when 3 then 'триста'
                  when 4 then ' четыреста' when 5 then ' пятьсот' when 6 then ' шестьсот'
                  when 7 then ' семьсот' when 8 then ' восемьсот' when 9 then ' девятьсот' else '' end              +case @d2
                  when 2 then ' двадцать' when 3 then ' тридцать' when 4 then ' сорок'
                  when 5 then ' пятьдесят' when 6 then ' шестьдесят' when 7 then ' семьдесят'
                  when 8 then ' восемьдесят' when 9 then ' девяносто' else '' end      +case @d1
                  when 1 then (case when @th=2 or (@th=1 and @IsMaleGender=0) then ' одна' else ' один' end)
                  when 2 then (case when @th=2 or (@th=1 and @IsMaleGender=0) then ' две' else ' два' end)
                  when 3 then ' три' when 4 then ' четыре' when 5 then 'пять'
                  when 6 then ' шесть' when 7 then ' семь' when 8 then 'восемь'
                  when 9 then ' девять' when 10 then ' десять' when 11 then ' одиннадцать'
                  when 12 then ' двенадцать' when 13 then ' тринадцать' when 14 then ' четырнадцать'
                  when 15 then ' пятнадцать' when 16 then ' шестнадцать' when 17 then ' семнадцать'
                  when 18 then ' восемнадцать' when 19 then ' девятнадцать' else '' end + case @th
                  when 2 then ' тысяч'     +(case when @d1=1 then 'а' when @d1 in (2,3,4) then 'и' else ''   end)
                  when 3 then ' миллион' when 4 then ' миллиард' when 5 then ' триллион' 
                  when 6 then ' квадрилион' when 7 then ' квинтилион'  else '' end + case 
                  when @th in (3,4,5,6,7) then (case when @d1=1 then ''
                  when @d1 in (2,3,4) then 'а' else 'ов' end) else '' end  +IsNull(@nword,'')
    end
  end
  return upper(substring(@nword,2,1))+substring(@nword,3,len(@nword)-2)
end
GO
/****** Object:  Table [dbo].[W_Log_Wa]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Log_Wa](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Akt] [nvarchar](50) NULL,
	[Dat] [datetime] NULL,
	[Ord] [int] NULL,
	[VIN] [nvarchar](20) NULL,
	[Brand] [int] NULL,
	[Cls] [datetime] NULL,
	[Ttn] [nvarchar](20) NULL,
	[Avt] [nvarchar](50) NULL,
	[Carrier] [int] NULL,
	[Dat_voda] [datetime] NULL,
	[Vub] [int] NULL,
	[Priz] [nvarchar](10) NULL,
	[Remark] [nvarchar](200) NULL,
	[Dlr] [int] NULL,
 CONSTRAINT [PK_W_Log_WA] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Group_Task]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Group_Task](
	[Id] [int] NOT NULL,
	[Id_Company] [int] NOT NULL,
	[Id_Department] [int] NOT NULL,
	[Naz] [varchar](50) NULL,
	[Flag] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[Dlr_Payment]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Dlr_Payment](
	[IDD] [int] IDENTITY(1,1) NOT NULL,
	[ID] [nvarchar](10) NULL,
	[OPRID] [float] NULL,
	[DATE] [datetime] NULL,
	[CURR] [nvarchar](3) NULL,
	[RATE] [float] NULL,
	[SUM_CURR] [float] NULL,
	[IFIRMS] [float] NULL,
	[HFIRMS] [nvarchar](60) NULL,
	[DEALER] [nvarchar](15) NULL,
	[VIN] [nvarchar](10) NULL,
	[N_ORD] [nvarchar](10) NULL,
	[MARK] [nvarchar](1) NULL,
	[NOTE] [nvarchar](150) NULL,
	[IS_NEW] [bit] NULL,
	[IS_CLOSED] [bit] NULL,
	[EUR] [float] NULL,
	[SUM_EUR] [float] NULL,
	[NUM_DOC] [nvarchar](20) NULL,
	[L_NUM] [nvarchar](10) NULL,
	[L_DATE] [datetime] NULL,
	[SUM_TOTAL] [float] NULL,
	[MY] [int] NULL,
 CONSTRAINT [PK_dlr_Payment] PRIMARY KEY CLUSTERED 
(
	[IDD] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Diler2]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Diler2](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Region] [int] NULL,
	[Naz] [nvarchar](100) NOT NULL,
	[Sokr] [nvarchar](10) NULL,
	[Adres] [nvarchar](50) NULL,
	[Dir] [nvarchar](50) NULL,
	[Zam] [nvarchar](50) NULL,
	[Buch] [nvarchar](50) NULL,
	[Manedger] [nvarchar](50) NULL,
	[Email] [nvarchar](50) NULL,
	[Tel] [nvarchar](50) NULL,
	[Fax] [nvarchar](50) NULL,
	[Mob] [nvarchar](50) NULL,
	[Note] [nvarchar](250) NULL,
	[Cl1] [money] NULL,
	[Cl2] [money] NULL,
	[Cl3] [money] NULL,
	[Cl4] [money] NULL,
	[Account] [nvarchar](30) NULL,
	[Bank] [nvarchar](100) NULL,
	[Edrpou] [nvarchar](50) NULL,
	[Pin] [nvarchar](50) NULL,
	[Pdv] [nvarchar](30) NULL,
	[Brand] [nvarchar](50) NULL,
	[Statut] [char](10) NULL,
 CONSTRAINT [PK__S_Diler__6D2D2E85] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Кредитная линия 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Diler2', @level2type=N'COLUMN',@level2name=N'Cl1'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Кредитная линия 2' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Diler2', @level2type=N'COLUMN',@level2name=N'Cl2'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Кредитная линия 3' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Diler2', @level2type=N'COLUMN',@level2name=N'Cl3'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Кредитная линия 4' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Diler2', @level2type=N'COLUMN',@level2name=N'Cl4'
GO
/****** Object:  Table [dbo].[S_Vic]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Vic](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Post_code] [nvarchar](6) NULL,
	[Adres_city_ukr] [nvarchar](250) NULL,
	[Adres_city_ang] [nvarchar](250) NULL,
	[Phone] [nvarchar](20) NULL,
	[Fax] [nvarchar](20) NULL,
	[Mob] [nvarchar](20) NULL,
	[Adres_st_ukr] [nvarchar](250) NULL,
	[Adres_st_ang] [nvarchar](250) NULL,
	[Inspector] [int] NOT NULL,
	[Path_in] [nvarchar](250) NOT NULL,
	[Path_out] [nvarchar](250) NOT NULL,
	[Date_upd] [datetime] NULL,
	[Date_in] [datetime] NULL,
	[Date_out] [datetime] NULL,
	[Vers_pdi] [nvarchar](50) NULL,
	[Vers_bd] [nvarchar](50) NULL,
	[Vers_base] [nvarchar](50) NULL,
	[Vers_db] [nvarchar](50) NULL,
	[Description] [nvarchar](50) NULL,
	[Priznak] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[KolAnging]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- set dateformat dmy
-- select dbo.KolAnging (1)
CREATE FUNCTION [dbo].[KolAnging] (@ISO AS INTEGER)
RETURNS NVARCHAR(25)
AS
BEGIN
   DECLARE @SLOVO NVARCHAR(25)
if (@ISO < 30)
   SET @slovo='Less then 30'
if (@ISO between 31 and 60)
   SET @slovo='31-60'
if (@ISO between 61 and 90)
   SET @slovo='61-90'
if (@ISO between 91 and 120)
   SET @slovo='91-120'
if (@ISO between 121 and 180)
   SET @slovo='121-180'
if (@ISO between 181 and 200)
   SET @slovo='More then 180'
if (@ISO between 201 and 300)
   SET @slovo='More then 200'
   RETURN(@SLOVO)
END
GO
/****** Object:  Table [dbo].[S_Product]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Product](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Sokr] [nvarchar](10) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Task]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Task](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Id_Group] [int] NOT NULL,
	[Naz] [varchar](50) NULL,
	[Flag] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  StoredProcedure [dbo].[App_SalesmanExport]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns the query result set in a CSV format
-- so that the data can be exported to a CSV file
CREATE PROCEDURE [dbo].[App_SalesmanExport]
        @p_separator_str nvarchar(15),
        @p_title_str nvarchar(4000),
        @p_select_str nvarchar(4000),
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_num_exported int output
    AS
    DECLARE
        @l_title_str nvarchar(4000),
        @l_select_str nvarchar(4000),
        @l_from_str nvarchar(4000),
        @l_join_str nvarchar(4000),
        @l_where_str nvarchar(4000),
        @l_query_select nvarchar(4000),
        @l_query_union nvarchar(4000),
        @l_query_from nvarchar(4000)
    BEGIN
        -- Set up the title string from the column names.  Excel 
        -- will complain if the first column value is ID. So wrap
        -- the value with "".
        SET @l_title_str = @p_title_str + char(13)
        IF @p_title_str IS NULL
            BEGIN
            SET @l_title_str = 
                N'"XID"' + @p_separator_str +
                N'"Brand"' + @p_separator_str +
                N'"""Brand"" Naz"' + @p_separator_str +
                N'"Dlr"' + @p_separator_str +
                N'"""Dlr"" Last_Name"' + @p_separator_str +
                N'"Fam"' + @p_separator_str +
                N'"Nam"' + @p_separator_str +
                N'"Tel"' + @p_separator_str +
                N'"Isp"' + @p_separator_str +
                N'"Dat"' + @p_separator_str +
                N'"Notice"' + ' ';
            END
        ELSE IF SUBSTRING(@l_title_str, 1, 2) = 'ID'
            SET @l_title_str = 
                '"' + 
                SUBSTRING(@l_title_str, 1, PATINDEX('%,%', @l_title_str)-1) + 
                '"' + 
                SUBSTRING(@l_title_str, PATINDEX('%,%', @l_title_str), LEN(@l_title_str)); 

        -- Set up the select string
        SET @l_select_str = @p_select_str
        IF @p_select_str IS NULL
            BEGIN
            SET @l_select_str = 
                N'IsNULL(Convert(nvarchar, S_Salesman_.[ID]), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Salesman_.[Brand]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL( t0.[Naz], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_Salesman_.[Dlr]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL( t1.[Last_Name], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Salesman_.[Fam], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Salesman_.[Nam], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Salesman_.[Tel], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Salesman_.[Isp], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Salesman_.[Dat], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_Salesman_.[Notice], ''''), N''"'', N''""'') + N''"''  + '' ''';
            END

        -- Set up the from string (with table alias) and the join string
        SET @l_from_str = '[dbo].[S_Salesman] S_Salesman_ LEFT OUTER JOIN [dbo].[S_Brend] t0 ON (S_Salesman_.[Brand] =  t0.[ID]) LEFT OUTER JOIN [dbo].[S_Diler] t1 ON (S_Salesman_.[Dlr] =  t1.[ID])';

        SET @l_join_str = @p_join_str
        if @p_join_str is null
            SET @l_join_str = ' ';

        -- Set up the where string
        SET @l_where_str = ' ';
        IF @p_where_str IS NOT NULL
            SET @l_where_str = @l_where_str + 'WHERE ' + @p_where_str;

        -- Construct the query string.  Append the result set with the title.
        SET @l_query_select = 
                'SELECT '''
        SET @l_query_union = 
                ''' UNION ALL ' +
                'SELECT '
        SET @l_query_from = 
                ' FROM ' + @l_from_str + ' ' + @l_join_str + ' ' +
                @l_where_str;

        -- Run the query
        EXECUTE (@l_query_select + @l_title_str + @l_query_union + @l_select_str+ @l_query_from)

        -- Return the total number of rows of the query
        SELECT @p_num_exported = @@rowcount
    END
GO
/****** Object:  UserDefinedFunction [dbo].[Perr]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE FUNCTION [dbo].[Perr] (@Dat1 dAteTIME, @Dat2 DATETIME)
RETURNS integer 
AS  
BEGIN 
return DATEDIFF(day,@dat1, @dat2)
END
GO
/****** Object:  Table [dbo].[S_Typ_Engenie]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Typ_Engenie](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Kod] [nvarchar](1) NOT NULL,
	[Naz] [nvarchar](20) NOT NULL,
	[Nazv] [nvarchar](20) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Supp_Vf]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Supp_Vf](
	[IDD] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [int] NULL,
	[VIN] [nvarchar](20) NULL,
	[Sum] [money] NULL,
	[Date_Pay] [smalldatetime] NULL,
	[Date_Load] [smalldatetime] NULL,
	[Priz] [int] NULL,
	[Remark] [nvarchar](50) NULL,
 CONSTRAINT [PK_W_Supp_VF] PRIMARY KEY CLUSTERED 
(
	[IDD] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Files]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Files](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Path] [varchar](8000) NULL,
	[Dateload] [datetime] NULL,
	[Processed] [int] NULL,
 CONSTRAINT [PK_W_files] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[S_Delivery]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Delivery](
	[IDN] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [int] NOT NULL,
	[Model] [int] NULL,
	[Version] [int] NULL,
	[Naz] [nvarchar](255) NOT NULL,
	[Country] [int] NULL,
	[Priz] [nvarchar](1) NULL,
	[Notes] [nvarchar](200) NULL,
	[Country_Origin] [int] NOT NULL,
	[Insurance] [money] NOT NULL,
	[Freight] [money] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[IDN] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY],
 CONSTRAINT [W_DELIVERY_001] UNIQUE NONCLUSTERED 
(
	[Country] ASC,
	[Country_Origin] ASC,
	[Brand] ASC,
	[Model] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Inspector]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Inspector](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Fio] [nvarchar](50) NOT NULL,
	[Mob] [nvarchar](10) NOT NULL,
	[Tel] [nvarchar](10) NOT NULL,
	[Home] [nvarchar](10) NOT NULL,
	[Priz] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[Angg]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- set dateformat dmy
-- select dbo.Angg ('02-09-2007','01-02-2007')
CREATE FUNCTION [dbo].[Angg] (@ISO AS INTEGER)
RETURNS NVARCHAR(25)
AS
BEGIN
   DECLARE @SLOVO NVARCHAR(25)
if (@ISO between 1 and 30)     set @slovo='Less then 30'
if (@ISO between 31 and 60)    set @slovo='31-60'
if (@ISO between 61 and 90)    set @slovo='61-90'
if (@ISO between 91 and 120)   set @slovo='91-120'
if (@ISO between 121 and 180)  set @slovo='121-180'
if (@ISO between 181 and 200)  set @slovo='More then 180'
if (@ISO between 201 and 300)  set @slovo='More then 200'
   RETURN(@SLOVO)
END
GO
/****** Object:  Table [dbo].[S_Region]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Region](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Sokr] [nvarchar](10) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Diler]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Diler](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Region] [int] NULL,
	[Code] [char](20) NULL,
	[Naz] [nvarchar](150) NULL,
	[Fvlastnosti] [nvarchar](10) NULL,
	[Sokr] [nvarchar](50) NULL,
	[Last_Name] [nvarchar](50) NULL,
	[Adres] [nvarchar](100) NULL,
	[Dir] [nvarchar](50) NULL,
	[Zam] [nvarchar](50) NULL,
	[Buch] [nvarchar](50) NULL,
	[Manedger] [nvarchar](50) NULL,
	[Email] [nvarchar](50) NULL,
	[Tel] [nvarchar](50) NULL,
	[Fax] [nvarchar](50) NULL,
	[Mob] [nvarchar](50) NULL,
	[Note] [nvarchar](250) NULL,
	[Cl1] [money] NULL,
	[Cl2] [money] NULL,
	[Cl3] [money] NULL,
	[Cl4] [money] NULL,
	[Account] [nvarchar](30) NULL,
	[Bank] [nvarchar](100) NULL,
	[Edrpou] [nvarchar](50) NULL,
	[Pin] [nvarchar](50) NULL,
	[Pdv] [nvarchar](30) NULL,
	[Brand] [nvarchar](50) NULL,
	[Statut] [nvarchar](10) NULL,
	[B_Name] [nvarchar](50) NULL,
	[B_Mfo] [nvarchar](6) NULL,
	[B_Adress] [nvarchar](50) NULL,
	[B_Fhone] [nvarchar](50) NULL,
	[B_Mob] [nvarchar](10) NULL,
	[B_Fax] [nvarchar](50) NULL,
	[B_Director] [nvarchar](50) NULL,
	[B_Buch] [nvarchar](50) NULL,
	[B_Manager] [nvarchar](200) NULL,
	[B_Oper] [nvarchar](200) NULL,
	[B_Tel_oper] [nvarchar](50) NULL,
	[B_Email] [nvarchar](50) NULL,
	[Dogovor] [nvarchar](15) NULL,
	[Dogovor_data] [smalldatetime] NULL,
	[Fin_code] [int] NULL,
	[Sokr_naz] [nvarchar](300) NULL,
	[Bank_ukr] [nvarchar](300) NULL,
	[Edrpo] [nvarchar](20) NULL,
	[Svid] [nvarchar](20) NULL,
	[IndNomer] [nvarchar](20) NULL,
	[Direktor] [nvarchar](50) NULL,
	[Sokr_naz_ang] [nvarchar](300) NULL,
	[Bank_ukr_ang] [nvarchar](300) NULL,
	[Edrpo_ang] [nvarchar](20) NULL,
	[Svid_ang] [nvarchar](20) NULL,
	[IndNomer_ang] [nvarchar](20) NULL,
	[Direktor_ang] [nvarchar](50) NULL,
	[Adres_avto_ukr] [nvarchar](250) NULL,
	[Adres_avto_ang] [nvarchar](250) NULL,
	[Adres_unload] [nvarchar](250) NULL,
	[Max_Act] [nvarchar](30) NULL,
	[Mfo] [nvarchar](6) NULL,
	[Accnt] [nchar](30) NULL,
	[Dolj_ang] [int] NULL,
	[Dolj_ukr] [int] NULL,
	[Description] [nvarchar](50) NULL,
	[Priznak] [int] NULL,
	[Closed] [int] NULL,
	[Closed_date] [datetime] NULL,
	[Firm_size] [varchar](10) NULL,
	[Data_create] [datetime] NULL,
	[Gd_fam] [varchar](50) NULL,
	[Gd_Ima] [varchar](50) NULL,
	[Gd_Otc] [varchar](50) NULL,
	[Gd_born] [datetime] NULL,
	[Ms_fam] [varchar](50) NULL,
	[Ms_ima] [varchar](50) NULL,
	[Ms_otc] [varchar](50) NULL,
	[Ms_born] [datetime] NULL,
	[As_fam] [varchar](50) NULL,
	[As_ima] [varchar](50) NULL,
	[As_otc] [varchar](50) NULL,
	[As_born] [datetime] NULL,
	[Data_open] [datetime] NULL,
	[E_logistics] [nvarchar](250) NULL,
	[Num_dog] [nvarchar](50) NULL,
	[Postcode] [nvarchar](50) NULL,
	[Id_fin_code] [int] NULL,
	[Code_login] [nvarchar](50) NULL,
	[Active] [int] NULL,
 CONSTRAINT [PK_S_Diler] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY],
 CONSTRAINT [UNIQ_1] UNIQUE NONCLUSTERED 
(
	[Last_Name] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY],
 CONSTRAINT [UNIQ_2] UNIQUE NONCLUSTERED 
(
	[Sokr] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY],
 CONSTRAINT [UNIQ_3] UNIQUE NONCLUSTERED 
(
	[Code] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код по английски' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Diler', @level2type=N'COLUMN',@level2name=N'Code'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код в финансовой программе ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Diler', @level2type=N'COLUMN',@level2name=N'Fin_code'
GO
/****** Object:  StoredProcedure [dbo].[App_UserExport]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns the query result set in a CSV format
-- so that the data can be exported to a CSV file
CREATE PROCEDURE [dbo].[App_UserExport]
        @p_separator_str nvarchar(15),
        @p_title_str nvarchar(4000),
        @p_select_str nvarchar(4000),
        @p_join_str nvarchar(4000),
        @p_where_str nvarchar(4000),
        @p_num_exported int output
    AS
    DECLARE
        @l_title_str nvarchar(4000),
        @l_select_str nvarchar(4000),
        @l_from_str nvarchar(4000),
        @l_join_str nvarchar(4000),
        @l_where_str nvarchar(4000),
        @l_query_select nvarchar(4000),
        @l_query_union nvarchar(4000),
        @l_query_from nvarchar(4000)
    BEGIN
        -- Set up the title string from the column names.  Excel 
        -- will complain if the first column value is ID. So wrap
        -- the value with "".
        SET @l_title_str = @p_title_str + char(13)
        IF @p_title_str IS NULL
            BEGIN
            SET @l_title_str = 
                N'"XID"' + @p_separator_str +
                N'"Fio"' + @p_separator_str +
                N'"Gr"' + @p_separator_str +
                N'"Dep"' + @p_separator_str +
                N'"Note"' + @p_separator_str +
                N'"Secur"' + @p_separator_str +
                N'"Phone"' + @p_separator_str +
                N'"Mob"' + @p_separator_str +
                N'"Remarks"' + @p_separator_str +
                N'"Iskl"' + @p_separator_str +
                N'"Tel_mob"' + @p_separator_str +
                N'"Tel_dom"' + @p_separator_str +
                N'"Tel_vnutr"' + @p_separator_str +
                N'"Adress"' + @p_separator_str +
                N'"Serv"' + @p_separator_str +
                N'"Serv_id"' + @p_separator_str +
                N'"P_adres"' + @p_separator_str +
                N'"P_Seriya"' + @p_separator_str +
                N'"P_Nomber"' + @p_separator_str +
                N'"P_Vudan_date"' + @p_separator_str +
                N'"P_Vudan_kem"' + ' ';
            END
        ELSE IF SUBSTRING(@l_title_str, 1, 2) = 'ID'
            SET @l_title_str = 
                '"' + 
                SUBSTRING(@l_title_str, 1, PATINDEX('%,%', @l_title_str)-1) + 
                '"' + 
                SUBSTRING(@l_title_str, PATINDEX('%,%', @l_title_str), LEN(@l_title_str)); 

        -- Set up the select string
        SET @l_select_str = @p_select_str
        IF @p_select_str IS NULL
            BEGIN
            SET @l_select_str = 
                N'IsNULL(Convert(nvarchar, S_User_.[ID]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[Fio], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_User_.[Gr]), '''') + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_User_.[Dep]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[Note], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[Secur], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[Phone], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[Mob], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[Remarks], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_User_.[Iskl]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[Tel_mob], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[Tel_dom], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[Tel_vnutr], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[Adress], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[Serv], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_User_.[Serv_id]), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[P_adres], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[P_Seriya], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[P_Nomber], ''''), N''"'', N''""'') + N''"''  + ''' + @p_separator_str + ''' +' +
                N'IsNULL(Convert(nvarchar, S_User_.[P_Vudan_date], 21), '''') + ''' + @p_separator_str + ''' +' +
                N'N''"'' + REPLACE(IsNULL(S_User_.[P_Vudan_kem], ''''), N''"'', N''""'') + N''"''  + '' ''';
            END

        -- Set up the from string (with table alias) and the join string
        SET @l_from_str = '[dbo].[S_User] S_User_';

        SET @l_join_str = @p_join_str
        if @p_join_str is null
            SET @l_join_str = ' ';

        -- Set up the where string
        SET @l_where_str = ' ';
        IF @p_where_str IS NOT NULL
            SET @l_where_str = @l_where_str + 'WHERE ' + @p_where_str;

        -- Construct the query string.  Append the result set with the title.
        SET @l_query_select = 
                'SELECT '''
        SET @l_query_union = 
                ''' UNION ALL ' +
                'SELECT '
        SET @l_query_from = 
                ' FROM ' + @l_from_str + ' ' + @l_join_str + ' ' +
                @l_where_str;

        -- Run the query
        EXECUTE (@l_query_select + @l_title_str + @l_query_union + @l_select_str+ @l_query_from)

        -- Return the total number of rows of the query
        SELECT @p_num_exported = @@rowcount
    END
GO
/****** Object:  Table [dbo].[S_Dealer_email]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Dealer_email](
	[IDS] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [float] NULL,
	[ID] [float] NULL,
	[Email] [nvarchar](255) NULL,
	[Obrabotka] [int] NULL,
 CONSTRAINT [PK_S_Dealer_email] PRIMARY KEY CLUSTERED 
(
	[IDS] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Suppler]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Suppler](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Code] [int] NULL,
	[Country] [int] NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[City] [nvarchar](50) NULL,
	[PostCode] [char](10) NULL,
	[Director] [nvarchar](50) NULL,
	[Manager] [nvarchar](50) NULL,
	[Delleted] [int] NULL,
	[Isp] [nvarchar](50) NULL,
	[Numdekl] [nvarchar](20) NULL,
 CONSTRAINT [PK__S_Suppler__3B60C8C7] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Исполнитель сделавший операцию' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Suppler', @level2type=N'COLUMN',@level2name=N'Isp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер декларации' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Suppler', @level2type=N'COLUMN',@level2name=N'Numdekl'
GO
/****** Object:  Table [dbo].[S_Sost]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Sost](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Sokr] [nvarchar](10) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Note] [nvarchar](50) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Pr]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Pr](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Date] [smalldatetime] NULL,
	[Paid] [nvarchar](30) NOT NULL,
	[Inv_num] [nvarchar](30) NOT NULL,
	[Inv_date] [smalldatetime] NOT NULL,
	[Amount] [nvarchar](30) NOT NULL,
	[Department] [int] NOT NULL,
	[Rep_by] [smalldatetime] NULL,
	[Supplier] [nvarchar](30) NOT NULL,
	[Remain] [nvarchar](30) NOT NULL,
	[Budjet_with] [nvarchar](30) NOT NULL,
	[Budget_top] [nvarchar](30) NOT NULL,
	[Budget_con] [nvarchar](30) NOT NULL,
	[Director] [nvarchar](30) NOT NULL,
	[Description] [nvarchar](30) NOT NULL,
	[Reguestor] [nvarchar](30) NOT NULL,
	[Budjet_owner] [nvarchar](30) NOT NULL,
	[Model] [nvarchar](30) NULL,
	[Contracts] [nvarchar](30) NULL,
	[Sales_plan] [money] NULL,
	[Creater] [nvarchar](40) NULL,
	[Flag] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Position]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Position](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Description] [nvarchar](50) NOT NULL,
	[Col] [nvarchar](10) NOT NULL,
	[Row] [nvarchar](10) NOT NULL,
	[Priznak] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Status]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Status](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[NazOld] [nvarchar](50) NULL,
	[Notes] [nvarchar](200) NULL,
	[Usefields] [nvarchar](50) NULL,
	[Vievs] [int] NULL,
 CONSTRAINT [PK__S_Status__379037E3] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Status', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Наименование стаутусов' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Status', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Краткое описание' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Status', @level2type=N'COLUMN',@level2name=N'Notes'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Используемые поля в форме' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Status', @level2type=N'COLUMN',@level2name=N'Usefields'
GO
/****** Object:  Table [dbo].[W_Load_Rdf]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Load_Rdf](
	[IDD] [int] IDENTITY(1,1) NOT NULL,
	[Data] [smalldatetime] NULL,
	[Path] [char](200) NOT NULL,
	[Namef] [char](100) NOT NULL,
	[Rez] [char](10) NOT NULL,
	[Vin] [char](20) NULL,
 CONSTRAINT [PK_W_Load_RDF] PRIMARY KEY CLUSTERED 
(
	[IDD] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Путь принятого файла' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Load_Rdf', @level2type=N'COLUMN',@level2name=N'Path'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Имя принятого файла' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Load_Rdf', @level2type=N'COLUMN',@level2name=N'Namef'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Результат Ok, ERR' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Load_Rdf', @level2type=N'COLUMN',@level2name=N'Rez'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'VIN принятого файла' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Load_Rdf', @level2type=N'COLUMN',@level2name=N'Vin'
GO
/****** Object:  Table [dbo].[A0]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[A0](
	[IDD] [nchar](10) NULL,
	[NN] [nvarchar](50) NULL,
	[Axml] [xml] NULL
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_AggregateType', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0', @level2type=N'COLUMN',@level2name=N'IDD'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0', @level2type=N'COLUMN',@level2name=N'IDD'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0', @level2type=N'COLUMN',@level2name=N'IDD'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0', @level2type=N'COLUMN',@level2name=N'IDD'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_TextAlign', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0', @level2type=N'COLUMN',@level2name=N'IDD'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_AggregateType', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0', @level2type=N'COLUMN',@level2name=N'NN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0', @level2type=N'COLUMN',@level2name=N'NN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0', @level2type=N'COLUMN',@level2name=N'NN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=3105 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0', @level2type=N'COLUMN',@level2name=N'NN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_TextAlign', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0', @level2type=N'COLUMN',@level2name=N'NN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DefaultView', @value=0x02 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Filter', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_FilterOnLoad', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_HideNewField', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderBy', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderByOn', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderByOnLoad', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Orientation', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_TableMaxRecords', @value=10000 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_TotalsRow', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A0'
GO
/****** Object:  Table [dbo].[W_Log_Status]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Log_Status](
	[IDN] [int] IDENTITY(1,1) NOT NULL,
	[Curr_Date] [datetime] NULL,
	[Brand] [int] NULL,
	[Path_Xls] [nvarchar](255) NULL,
	[List_Xls] [nvarchar](50) NULL,
	[Diap_Xls] [nvarchar](150) NULL,
	[Status] [int] NULL,
	[Priz] [nvarchar](1) NULL,
	[Notes] [nvarchar](200) NULL,
	[Ok_No] [nvarchar](50) NULL,
	[Count_Car] [int] NULL,
 CONSTRAINT [PK__W_Log_Status__33414F69] PRIMARY KEY CLUSTERED 
(
	[IDN] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Option_2]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Option_2](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [int] NULL,
	[Model] [int] NULL,
	[Vers] [int] NULL,
	[Code] [char](10) NULL,
	[Note] [nvarchar](300) NULL,
 CONSTRAINT [PK_W_Option_2] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[W_Clame]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Clame](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Dlr] [int] NOT NULL,
	[Clame] [nvarchar](150) NOT NULL,
	[Status] [nvarchar](50) NOT NULL,
	[Approval] [nvarchar](50) NOT NULL,
	[Date_doc] [nvarchar](50) NOT NULL,
	[Path_foto] [nvarchar](250) NOT NULL,
	[Priz] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Hollyday]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Hollyday](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Dat_hollyday] [smalldatetime] NULL,
	[Remarks] [nvarchar](50) NULL,
 CONSTRAINT [PK_S_Hollyday] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[CalPerDayDlr]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		Savchenko Arthur
-- Create date: 11-01-2008
-- Description:	Calculate period pay dlr
-- =============================================
CREATE FUNCTION [dbo].[CalPerDayDlr] ( @Brands int,  
	       	                   @DatWiuArrived datetime,
                               @DatCompleted datetime )
RETURNS datetime
AS
BEGIN
DECLARE @Result datetime
IF (@Brands = 1 )            SET @Result = @DatWiuArrived + 120
IF (@Brands BETWEEN 2 AND 4) SET @Result = @DatWiuArrived + 90
IF (@Brands = 5 )            SET @Result = @DatCompleted + 5
RETURN @Result
END
GO
/****** Object:  Table [dbo].[Pr_Sub]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Pr_Sub](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Code] [nvarchar](3) NOT NULL,
	[Naz] [nvarchar](30) NOT NULL,
	[Remm] [nvarchar](50) NOT NULL,
	[Flag] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[CreTable]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[CreTable] AS
exec sp_tables
GO
/****** Object:  UserDefinedFunction [dbo].[ISOweek]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[ISOweek]  (@DATE datetime)
RETURNS int
AS
BEGIN
   DECLARE @ISOweek int
   SET @ISOweek= DATEPART(wk,@DATE)+1
      -DATEPART(wk,CAST(DATEPART(yy,@DATE) as CHAR(4))+'0104')
--Special cases: Jan 1-3 may belong to the previous year
   IF (@ISOweek=0) 
      SET @ISOweek=dbo.ISOweek(CAST(DATEPART(yy,@DATE)-1 
         AS CHAR(4))+'12'+ CAST(24+DATEPART(DAY,@DATE) AS CHAR(2)))+1
--Special case: Dec 29-31 may belong to the next year
   IF ((DATEPART(mm,@DATE)=12) AND 
      ((DATEPART(dd,@DATE)-DATEPART(dw,@DATE))>= 28))
      SET @ISOweek=1
   RETURN(@ISOweek)
END
GO
/****** Object:  UserDefinedFunction [dbo].[KolAng]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- set dateformat dmy
-- select dbo.KolAng ('02-09-2007','01-02-2007')
CREATE FUNCTION [dbo].[KolAng] (@DATE1 datetime, @DATE2 datetime)
RETURNS NVARCHAR(25)
AS
BEGIN
   DECLARE @ISO int
   DECLARE @SLOVO NVARCHAR(25)
   SET @ISO = DATEDIFF(DAY, @DATE2, @DATE1)
if (@ISO between 1 and 30)
   set @slovo='Less then 30'
if (@ISO between 31 and 60)
   set @slovo='31-60'
if (@ISO between 61 and 90)
   set @slovo='61-90'
if (@ISO between 91 and 120)
   set @slovo='91-120'
if (@ISO between 121 and 180)
   set @slovo='121-180'
if (@ISO between 181 and 200)
   set @slovo='More then 180'
if (@ISO between 201 and 300)
   set @slovo='More then 200'
   RETURN(@SLOVO)
END
GO
/****** Object:  Table [dbo].[S_Body]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Body](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Num] [int] NULL,
	[Code] [nvarchar](5) NULL,
	[Ang] [nvarchar](50) NULL,
	[Description] [nvarchar](50) NOT NULL,
	[Priz] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[CHSTAT]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
-- Возвращает номер статуса
--
CREATE FUNCTION [dbo].[CHSTAT]  (@D1 NVARCHAR(20),
                         @D2 NVARCHAR(20),
                         @D3 NVARCHAR(20),
                         @D4 NVARCHAR(20),
                         @D5 NVARCHAR(20),
                         @D6 NVARCHAR(20),
                         @D7 NVARCHAR(20),
                         @D8 NVARCHAR(20),
                         @D9 NVARCHAR(20))
RETURNS INT
AS

BEGIN
DECLARE @prstatus int
SELECT    @prstatus = 0


IF  (@D9 IS NOT NULL AND @PRStatus=0) SET @PRStatus=9
IF  (@D8 IS NOT NULL AND @PRStatus=0) SET @PRStatus=8
IF  (@D7 IS NOT NULL AND @PRStatus=0) SET @PRStatus=7
IF  (@D6 IS NOT NULL AND @PRStatus=0) SET @PRStatus=6
IF  (@D5 IS NOT NULL AND @PRStatus=0) SET @PRStatus=5
IF  (@D4 IS NOT NULL AND @PRStatus=0) SET @PRStatus=4
IF  (@D3 IS NOT NULL AND @PRStatus=0) SET @PRStatus=3
IF  (@D2 IS NOT NULL AND @PRStatus=0) SET @PRStatus=2
IF  (@D1 IS NOT NULL AND @PRStatus=0) SET @PRStatus=1


RETURN (@PRSTATUS)
END
GO
/****** Object:  Table [dbo].[PR_Dep]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PR_Dep](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Date] [smalldatetime] NULL,
	[Code] [nvarchar](3) NOT NULL,
	[Naz] [nvarchar](30) NOT NULL,
	[Allocation] [nvarchar](30) NULL,
	[Reguestor] [nvarchar](30) NULL,
	[Budget_owner] [nvarchar](30) NULL,
	[Model] [nvarchar](30) NULL,
	[Contracts] [nvarchar](30) NULL,
	[Sales_plan] [money] NULL,
	[Description] [nvarchar](30) NULL,
	[Flag] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[Cans]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Для просчета промежутков дат для форда в отчете A_status
-- select dbo.Cans ('02-09-2007','01-02-2007')
CREATE FUNCTION [dbo].[Cans] (@DATE1 datetime, @DATE2 datetime)
RETURNS NVARCHAR(25)
AS
BEGIN
   DECLARE @ISO int
   DECLARE @SLOVO NVARCHAR(25)
   SET @ISO = DATEDIFF(DAY, @DATE2, @DATE1)
IF (@ISO BETWEEN 0 AND 15)
   SET @slovo='0-15'
IF (@ISO BETWEEN 16  AND 30)
   SET @slovo='16-30'
IF (@ISO BETWEEN 31  AND 45)
   SET @slovo='31-45'
IF (@ISO BETWEEN 46 AND 60)
   SET @slovo='46-60'
IF (@ISO BETWEEN 61 AND 10000)
   set @slovo='61+'
   RETURN(@SLOVO)
END
GO
/****** Object:  UserDefinedFunction [dbo].[Canv]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Для просчета промежутков дат для форда в отчете A_status
-- select dbo.Canv ('02-09-2007','01-02-2007')
CREATE FUNCTION [dbo].[Canv] (@DATE1 datetime, @DATE2 datetime)
RETURNS NVARCHAR(25)
AS
BEGIN
   DECLARE @ISO int
   DECLARE @SLOVO NVARCHAR(25)
   SET @ISO = DATEDIFF(DAY, @DATE2, @DATE1)
IF (@ISO BETWEEN 0 AND 10)
   SET @slovo='0-10'
IF (@ISO BETWEEN 11  AND 20)
   SET @slovo='11-20'
IF (@ISO BETWEEN 21  AND 30)
   SET @slovo='21-30'
IF (@ISO BETWEEN 31 AND 40)
   SET @slovo='31-40'
IF (@ISO BETWEEN 41 AND 100)
   set @slovo='41-100'
if (@ISO BETWEEN 41 AND 10000)
   set @slovo='41+'


   RETURN(@SLOVO)
END
GO
/****** Object:  Table [dbo].[D_Deyli_Report]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[D_Deyli_Report](
	[Nomer] [int] NOT NULL,
	[Zakaz] [nvarchar](50) NULL,
	[Dlrs] [nvarchar](50) NULL,
	[Loc] [nvarchar](50) NULL,
	[Status] [nvarchar](50) NULL,
	[Model] [nvarchar](50) NULL,
	[Vin] [nvarchar](20) NULL,
	[Engine] [nvarchar](50) NULL,
	[Spec] [nvarchar](20) NULL,
	[Obladn] [nvarchar](2000) NULL,
	[Color] [nvarchar](100) NULL,
	[Dlr] [nvarchar](50) NULL,
	[Vid] [nvarchar](50) NULL,
	[Sales] [nvarchar](50) NULL,
	[Let] [datetime] NULL,
	[Zamovleno] [nvarchar](50) NULL,
	[Kod_radio] [varchar](50) NULL,
	[Number_key] [nvarchar](15) NULL,
	[Contract] [nvarchar](20) NULL,
	[Dat] [datetime] NULL,
	[Contract_brake] [smalldatetime] NULL,
	[Price] [money] NULL,
	[Fleet] [nvarchar](20) NULL,
	[Datsales] [datetime] NULL,
	[Category] [nvarchar](50) NULL,
	[Bayer_Fam] [nvarchar](50) NULL,
	[Bayer_name] [nvarchar](50) NULL,
	[Bayer_otch] [nvarchar](50) NULL,
	[Nazva] [nvarchar](50) NULL,
	[Vozarast] [int] NULL,
	[Datborn] [nvarchar](50) NULL,
	[Adress] [nvarchar](100) NULL,
	[Sity] [nvarchar](50) NULL,
	[Telf] [nvarchar](20) NULL,
	[Mob] [nvarchar](50) NULL,
	[Works] [nvarchar](50) NULL,
	[Fax] [nvarchar](50) NULL,
	[Proff] [nvarchar](50) NULL,
	[Post] [nvarchar](10) NULL,
	[Marka] [nvarchar](20) NULL,
	[Modelold] [nvarchar](20) NULL,
	[Yearvup] [nvarchar](20) NULL,
	[Salesman] [nvarchar](50) NULL,
	[Credit] [bit] NULL,
	[DatChange] [smalldatetime] NULL,
	[DatInput] [smalldatetime] NULL,
	[Changer] [nvarchar](50) NULL,
	[Service] [nvarchar](50) NULL,
	[Priznak] [nvarchar](2) NULL,
	[Email] [nvarchar](50) NULL,
	[Name] [nvarchar](50) NULL,
	[Img] [nvarchar](50) NULL,
	[Type] [nvarchar](50) NULL,
	[Length] [nvarchar](50) NULL,
	[Remarks] [nvarchar](250) NULL,
	[Sex] [nvarchar](1) NULL,
 CONSTRAINT [PK_D_deyli_report] PRIMARY KEY CLUSTERED 
(
	[Nomer] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  UserDefinedFunction [dbo].[ISO]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create  FUNCTION [dbo].[ISO]  (@DATE datetime)
RETURNS int
AS
BEGIN
   DECLARE @ISO int
   SET @ISO= DATEPART(wk,@DATE)+1-DATEPART(wk,CAST(DATEPART(yy,@DATE) as CHAR(4))+'0104')
   RETURN(@ISO)
END
GO
/****** Object:  Table [dbo].[S_Tuning]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Tuning](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Code] [nvarchar](30) NOT NULL,
	[NAZ] [nvarchar](50) NOT NULL,
	[ZNACH] [nvarchar](100) NOT NULL,
	[PRIZ] [nvarchar](10) NULL,
	[Notes] [nvarchar](50) NULL,
 CONSTRAINT [PK__S_Tuning__3F0807D0] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY],
 CONSTRAINT [I001] UNIQUE NONCLUSTERED 
(
	[Code] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Sanction]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Sanction](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Znach] [nvarchar](50) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[Analyz_Porshe]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Analyz_Porshe]
AS
SELECT     VIN, Status, Model, Brend, Vers, Sorder, ProductionMonth, MSRP, Dealer_price, Cif_cip, Sale_VIN, Sale_MARK, Sale_MODEL, Sale_IFIRMS, 
                      Sale_DATE, Sale_CURR, Sale_SUM_CURR, Sale_DEALER, Sale_ID, Sale_OPRID, Sale_CRDCODE, Sale_NUM_DOC, Sale_NOTE, Sale_PAYM_TERM, 
                      Sale_PAYM_DATE, Sale_IS_CLOSED, Sale_EUR, Sale_SUM_EUR, Pymnt_IDD, Pymnt_ID, Pymnt_DATE, Pymnt_CURR, Pymnt_SUM_CURR, 
                      Pymnt_IFIRMS, Pymnt_N_ORD, Pymnt_MARK, Pymnt_NOTE, Pymnt_EUR, Pymnt_SUM_EUR, Pymnt_NUM_DOC, Pymnt_L_NUM, Pymnt_L_DATE, 
                      Pymnt_SUM_TOTAL, DLR_Payment, PMNT_Supplier, Payment_Suppl_Date, Sold_to_DLR, Sold_to_Client, MY
FROM         Wdoc.dbo.W_ORDER_083109
WHERE     (Brend IN (3, 4, 5))
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[16] 4[60] 2[3] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_ORDER_083109 (Wdoc.dbo)"
            Begin Extent = 
               Top = 30
               Left = 40
               Bottom = 595
               Right = 302
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Analyz_Porshe'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Analyz_Porshe'
GO
/****** Object:  Table [dbo].[LgPresen]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[LgPresen](
	[INOMNUM] [nvarchar](255) NULL,
	[HNOMNUM] [nvarchar](255) NULL,
	[CTNAME2] [nvarchar](255) NULL,
	[IDERIVATION] [int] NULL,
	[HDERIVATION] [nvarchar](255) NULL,
	[CTKATALOGNUM] [nvarchar](255) NULL,
	[CTACCESSIBLE] [int] NULL,
	[CTPRICEFORDILER] [float] NULL,
	[PRICENDS] [float] NULL,
	[NDS] [float] NULL,
	[CTCOMMENT] [nvarchar](255) NULL,
	[ANALOG] [nvarchar](255) NULL,
	[DDDDD] [nchar](10) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Company_Type]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Company_Type](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Numb] [int] NULL,
	[Code] [nvarchar](5) NOT NULL,
	[Ang] [nvarchar](50) NOT NULL,
	[Description] [nvarchar](50) NOT NULL,
	[Priz] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Update_Rdf]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- select * from rdf1
-- Просмотр структуры полей таблицы
-- sp_help rdf1

CREATE procedure [dbo].[Update_Rdf]
AS
-- Обновление RDF (Retail Delivery File)
UPDATE W SET W.Rdf_Datesale     = B.[Date] ,
             W.Rdf_Datecontract = B.[Contract] ,
             W.Rdf_Fleetcode    = B.[Fleet/Retail] ,
             W.Rdf_Dlr          = B.[Dlr] ,
             W.Rdf_Numkey       = B.[Key code] ,
             W.Rdf_Codradio     = B.[Radio code], 
             W.Rdf_Category     = B.[Category] ,
             W.Rdf_Vik          = B.[Age] ,
             W.Rdf_Bornclient   = B.[Date of Birth] ,
             W.Rdf_Nameclient   = B.[Ім'я] ,
             W.Rdf_Adres        = B.[Адреса] ,
             W.Rdf_Cyti         = B.[Місто] ,
             W.Rdf_Post         = B.[Індекс] , 
             W.Rdf_Phone        = B.[Мобільний телефон] ,
             W.Rdf_Phoneh       = B.[Домашній телефон] ,
             W.Rdf_Phonew       = B.[Робочий телефон] ,
             W.Rdf_Fax          = B.[Факс] 
FROM         W_ORDER    W,
             Rdf1       B
WHERE        W.VIN    = B.[FULL VIN]
  AND        W.BREND  = 1
GO
/****** Object:  Table [dbo].[W_Srez]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Srez](
	[IDD] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [int] NULL,
	[Data] [smalldatetime] NULL,
	[Nazv] [char](50) NULL,
	[Dc] [money] NULL,
	[Cif_cip] [money] NULL,
	[Msrp] [money] NULL,
	[Suppl] [money] NULL,
	[Dlr] [money] NULL,
	[Remarks] [char](20) NULL,
	[Countcar] [int] NULL,
	[Status] [int] NULL,
 CONSTRAINT [PK__W_Srez__296DCC6C] PRIMARY KEY CLUSTERED 
(
	[IDD] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[S_Employee]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Employee](
	[ID] [float] NULL,
	[Fam] [nvarchar](255) NULL,
	[Im] [nvarchar](255) NULL,
	[Otch] [nvarchar](255) NULL,
	[Surname] [nvarchar](255) NULL,
	[Name] [nvarchar](255) NULL,
	[Posada] [nvarchar](255) NULL,
	[Vidil] [nvarchar](255) NULL,
	[E_mail] [nvarchar](255) NULL,
	[Tel_mob] [nvarchar](20) NULL,
	[Tel_vnut] [nvarchar](10) NULL,
	[Tel_home] [nvarchar](20) NULL,
	[Tel_work] [nvarchar](20) NULL,
	[Logins] [nvarchar](30) NULL,
	[Department] [int] NULL,
	[Gruppa] [int] NULL,
	[Uvolen] [datetime] NULL,
	[Priznak] [nchar](10) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Package_Group]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Package_Group](
	[IDG] [int] IDENTITY(1,1) NOT NULL,
	[IDP] [int] NOT NULL,
	[Naz] [nvarchar](100) NULL,
	[Brand] [int] NOT NULL,
	[Model] [int] NOT NULL,
	[Vers] [int] NOT NULL,
	[Engine] [int] NOT NULL,
	[Door] [int] NULL,
	[Body] [int] NULL,
	[Trans] [int] NULL,
	[Fuel] [int] NULL,
	[P_Exw] [money] NULL,
	[P_Dc] [money] NULL,
	[P_Msrp] [money] NULL,
	[Status] [int] NULL,
	[Priz] [nvarchar](1) NULL,
	[Ch_Date] [datetime] NULL,
	[Ch_user] [nvarchar](30) NULL,
	[Notes] [nvarchar](200) NULL,
	[Transportation] [money] NOT NULL,
	[Insurance] [money] NOT NULL,
 CONSTRAINT [PK__W_Package_Group__2ACC04F9] PRIMARY KEY CLUSTERED 
(
	[IDG] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[A2]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[A2](
	[aaa] [nvarchar](100) NULL,
	[IDN] [int] IDENTITY(1,1) NOT NULL,
	[ss] [int] NULL,
	[sss] [int] NULL,
	[aaa1] [nvarchar](100) NULL
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'DFFDFDF' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A2'
GO
/****** Object:  StoredProcedure [dbo].[Replace_status]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Функция замены статуса по релизу
CREATE PROCEDURE [dbo].[Replace_status] (@RELEASE AS NVARCHAR(100), @STATUS AS INT)
AS 
-- Для отдела логистики
-- Откат статуса по релизу
--SELECT ID, RLS_PLACED,RLS_LEFT_COMPOUND,STATUS FROM W_ORDER WHERE RLS='16309'
UPDATE W_ORDER SET [STATUS]=6  WHERE RLS='16309'
GO
/****** Object:  Table [dbo].[S_Remarks]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Remarks](
	[Id] [int] IDENTITY(1,2) NOT NULL,
	[Nazv] [char](250) NULL,
	[Gr] [int] NULL,
 CONSTRAINT [PK_S_Remarks] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  StoredProcedure [dbo].[Cleare_pay_dealers]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Date Changed : 12-09-2008
Очистка оплат от дилеров 

Процедура необходима что бы очистить всю информацию об оплатах от дилеров
перед новым обновлением. Если не сделать эту процедуру у некотрых заказов
останутся суммы зависшие которые не подходят под связи.
*/
CREATE PROCEDURE [dbo].[Cleare_pay_dealers]  @Brand INT
AS
UPDATE W_Order 
   SET Pymnt_SUM_EUR      =  0,
       Pymnt_SUM_CURR     =  0, 
       Pymnt_IDD          =  0, 
       Pymnt_ID           =  0, 
       Pymnt_DATE         =  NULL, 
       Pymnt_SUM_TOTAL    =  0 , 
       Pymnt_EUR          =  0 , 
       Pymnt_L_DATE       =  NULL , 
       Pymnt_NOTE         =  NULL , 
       Pymnt_NUM_DOC      =  null, 
       DLR_Payment        =  0,
       Fin_Payment_Dealer =  0
 FROM  W_Order  WITH (NOLOCK) 
 WHERE Brend = @Brand


/*
Контроль операции 

SELECT id, brend, vin, Pymnt_NOTE FROM w_order
UPDATE w_order SET Pymnt_NOTE =  null WHERE Pymnt_NOTE = 'Clear Pay' 
SELECT * FROM dlr_payment WHERE note LIKE '%8TH25742%'
*/
GO
/****** Object:  Table [dbo].[S_Ancillary_1]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Ancillary_1](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Znach] [nvarchar](50) NOT NULL,
	[Brand] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Category]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Category](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Numb] [int] NULL,
	[Code] [nvarchar](5) NOT NULL,
	[Ang] [nvarchar](50) NOT NULL,
	[Description] [nvarchar](50) NOT NULL,
	[Priz] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Senderers]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
 Отправка по почте сообщений без использования запроса к базе
 Пример использования

 EXEC SENDERERs 'asavchenko@winner.ua',
                'Информация о неоплаченных машинах',
                'Перечень неполаченных заказовSSSS'
*/

CREATE PROCEDURE [dbo].[Senderers]
                @ADRESSA nvarchar(1000), 
                @TEMA    nvarchar(200) , 
                @TELO    nvarchar(4000)
AS 

-- EXECUTE AS USER='asavchenko'
-- в базе msdb необходимо добавить тот логин от имени которого будет отправлять сообщение
-- set @ADRESSA = @ADRESSA  + ';vpetrenko@winner.ua'
EXEC msdb.dbo.sp_send_dbmail      @profile_name                = 'Robot_mail',
                                  @recipients                  = @ADRESSA    ,
                                  @subject                     = @TEMA       ,
                                  @body                        = @TELO       ,
                                  @attach_query_result_as_file = 0

/*
Добавлено еще поле рассылки копии реципиенту
EXEC msdb.dbo.sp_send_dbmail      @profile_name                ='Robot_mail'  ,
                                  @recipients                  = @ADRESSA      ,
                                  @copy_recipients             = @COPY_ADRESSA ,
                                  @subject                     = @TEMA         ,
                                  @body                        = @TELO         ,
                                  @attach_query_result_as_file = 0
*/
GO
/****** Object:  StoredProcedure [dbo].[Viev_Pays]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
  Просмотр оплат от дилеров  в связке с дилерами
*/
CREATE PROCEDURE [dbo].[Viev_Pays]
AS
Select *
 FROM  W_Order     WITH (NOLOCK), 
       Upd_paymnt  WITH (NOLOCK),
       S_Diler     WITH (NOLOCK)
WHERE  W_Order.Zakaz     =  Upd_paymnt.N_ORD 
  AND  W_Order.Dlr       =  S_Diler.Id
  AND  S_Diler.Last_Name =  Upd_paymnt.L_Dealer
GO
/****** Object:  UserDefinedFunction [dbo].[udf_JobRunTime2Sec]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[udf_JobRunTime2Sec]
 (@runtime int)
RETURNS int
AS
BEGIN
declare @runtimeinseconds int
declare @runtimeaschar char(7)
declare @hours int
declare @minutes int
declare @seconds int

SET @runtimeaschar = right('0000000' + convert(varchar(7), @runtime), 7)


SET @hours = CAST(SUBSTRING(@runtimeaschar,1,3) AS INT)
SET @minutes = CAST(SUBSTRING(@runtimeaschar,4,2) AS INT)
SET @seconds = CAST(SUBSTRING(@runtimeaschar,6,2) AS INT)

SET @runtimeinseconds = @seconds + (@minutes * 60) + ((@hours * 60)*60)

 RETURN (@runtimeinseconds)
END
GO
/****** Object:  Table [dbo].[S_Ancillary_2]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Ancillary_2](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Znach] [nvarchar](50) NOT NULL,
	[Brand] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[AngingName]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Author...........: Savchenko Arthur
Date.............: 08-10-2007 
Time.............: 09:54
Remarks......... : Функция раписывает количество дней взависимости от количества дней
Sample usege.....: select dbo.angingName([Days_in_prod]) as period   from w_order
*/


CREATE FUNCTION [dbo].[AngingName] (@Kods AS INTEGER)  
RETURNS VARCHAR (50)
AS  
BEGIN 
DECLARE @PeriodName VARCHAR(50)

SET @PeriodName =
    CASE 
        WHEN @Kods BETWEEN 0   AND 30  THEN '0-30 days'         --ROUND( (UnitPrice * .6), 2)
        WHEN @Kods BETWEEN 31  AND 60  THEN '31-60 days'        --ROUND( (UnitPrice * .7), 2)
        WHEN @Kods BETWEEN 61  AND 90  THEN '61-90 days'        --ROUND( (UnitPrice * .8), 2)
        WHEN @Kods BETWEEN 91  AND 120 THEN '91-120 days'       --ROUND( (UnitPrice * .8), 2)
        WHEN @Kods BETWEEN 121 AND 150 THEN '121-150 days'      --ROUND( (UnitPrice * .8), 2)
        WHEN @Kods BETWEEN 151 AND 180 THEN '151-180 days'      --ROUND( (UnitPrice * .8), 2)
        WHEN @Kods BETWEEN 181 AND 350 THEN '181-350 days'      --ROUND( (UnitPrice * .8), 2)
        ELSE 'More then 350 days'                               --ROUND( (UnitPrice * .9), 2)
    END 
RETURN @PeriodName
END
GO
/****** Object:  StoredProcedure [dbo].[Anging]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[Anging]
AS
SET NOCOUNT ON
SELECT wo.[Id], 
       CASE wo.status 
       WHEN 1 THEN 'Pending'
       WHEN 2 THEN 'Order'
       WHEN 3 THEN 'Completed'
       WHEN 4 THEN 'In transit to compaund'
       WHEN 5 THEN 'Compound'
       WHEN 6 THEN 'On release'
       WHEN 7 THEN 'In route to Ukraine'
       WHEN 8 THEN 'In Ukraine' 
       WHEN 9 THEN 'Sold'
       ELSE 'Unknoun status'
       END AS StatusName,
       CASE wo.Brend
       WHEN 1 THEN 'Ford'
       WHEN 2 THEN 'Volvo'
       WHEN 3 THEN 'Jaguar'
       WHEN 4 THEN 'Land Rower'
       WHEN 5 THEN 'Porsche'
       END AS BrandName,
       current_user as polz
       FROM winner.dbo.W_Order wo (NOLOCK)
--     WHERE WO.ID=4957
GO
/****** Object:  StoredProcedure [dbo].[ReindexBase]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[ReindexBase]
AS

-- Обязательно надо закрыть базу от всех только для одного
-- ALTER DATABASE WIU SET SINGLE_USER WITH ROOLBACK IMMEDIATE
-- sp_renamedb 'DBMydb', 'DBmydb_new' 
-- открыть для всех
-- ALTER DATABASE wiu SET MULTI_USER




--EXEC sp_updatestats   -- 12 cекунд
--EXEC sp_MSforeachtable 
--DBCC DBREINDEX('w_order', '', 80)
--EXEC sp_MSforeachtable @command1="print '?' DBCC DBREINDEX ('?', ' ', 80)"


-- Реиндексация базы и обновление статистики
--Use winner
--GO
EXEC sp_MSforeachtable @command1="print 'Обработана таблица ?' DBCC DBREINDEX ('?', ' ', 90)"
--Go
EXEC sp_updatestats
--GO 
-- В конце процедурі восстановить подключения
GO
/****** Object:  Table [dbo].[W_Demand]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Demand](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Department] [int] NULL,
	[Employee] [nvarchar](100) NULL,
	[DateWork] [datetime] NULL,
	[Dateinput] [datetime] NULL,
	[Approval] [int] NULL,
	[ApprovalName] [nvarchar](255) NULL,
	[Reasons] [nvarchar](255) NULL,
	[Notice] [nvarchar](255) NULL,
	[Priznak] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Srez_Avg]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Srez_Avg](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Dat] [datetime] NULL,
	[Brand] [int] NULL,
	[Status] [int] NULL,
	[Cavg] [int] NULL,
	[Csld] [int] NULL,
	[Ccal] [int] NULL,
	[Notes] [nvarchar](100) NULL,
	[Flag] [int] NULL,
 CONSTRAINT [PK__W_srez_avg__4E6A46F1] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_parts_log]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_parts_log](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Descr] [nvarchar](50) NULL,
	[Fn] [nvarchar](250) NULL,
	[Fnn] [nvarchar](400) NULL,
	[Data] [datetime] NULL,
 CONSTRAINT [PK_W_parts_log] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_User]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_User](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Fio] [nvarchar](50) NOT NULL,
	[Gr] [int] NULL,
	[Dep] [int] NULL,
	[Note] [nvarchar](50) NULL,
	[Secur] [nvarchar](255) NULL,
	[Phone] [char](10) NULL,
	[Mob] [char](10) NULL,
	[Remarks] [char](100) NULL,
	[Iskl] [int] NULL,
	[Tel_mob] [nvarchar](50) NULL,
	[Tel_dom] [nvarchar](50) NULL,
	[Tel_vnutr] [nvarchar](50) NULL,
	[Adress] [nvarchar](50) NULL,
	[Face] [image] NULL,
	[Serv] [nvarchar](100) NULL,
	[Serv_id] [int] NULL,
	[P_adres] [nvarchar](50) NULL,
	[P_Seriya] [nvarchar](20) NULL,
	[P_Nomber] [nvarchar](50) NULL,
	[P_Vudan_date] [smalldatetime] NULL,
	[P_Vudan_kem] [nvarchar](50) NULL,
	[Name_engl] [nvarchar](50) NULL,
	[Time_sheet] [int] NULL,
	[Pos_ang] [nvarchar](100) NULL,
	[Name_ang] [nvarchar](100) NULL,
	[Name_ukr] [nvarchar](30) NULL,
	[Login] [nvarchar](30) NULL,
	[ID_new] [int] NULL,
	[Description] [nvarchar](100) NULL,
	[Priznak] [int] NULL,
	[Changed] [datetime] NULL,
	[Changed_user] [nvarchar](50) NULL,
	[Pofit] [int] NULL,
	[Uvolen] [int] NULL,
	[Prikaz_uvoln] [nvarchar](50) NULL,
	[Dat_uvolen] [datetime] NULL,
	[Approval] [int] NULL,
 CONSTRAINT [PK__S_User__05F8DC4F] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Внутренний' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_User', @level2type=N'COLUMN',@level2name=N'Phone'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Мобильный' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_User', @level2type=N'COLUMN',@level2name=N'Mob'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Примечание' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_User', @level2type=N'COLUMN',@level2name=N'Remarks'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Исключить' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_User', @level2type=N'COLUMN',@level2name=N'Iskl'
GO
/****** Object:  StoredProcedure [dbo].[Create_Indiactor]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[Create_Indiactor]
as
/*
Cоздание справочника с критическими значениями промежутков
Таблица необходима для сравнения с вычисляемыыми промежутками и эталонными (индикаторами)

Описание структуры таблицы индикаторов :
    IDAging - номер промежутка
    Nazvanie - наименование промежутка
    Indikator - єталонное значение дней больше котрого не должно быть между разницой дат
    Nom1,  Data1 - номер и описание поля с первой датой
    Nom2,  Data2 - номер и описание поля со второй датой
    Notes - Примечание



UPDATE W_ORDER SET [A_Financial_Desicsion_Days]=(datediff(day,[Brd_Recived_Approved],[Brd_Recived_Approved] )),
                   [A_Sales_Desicsion_Days] =(datediff(day,[Brd_Recived_Approved],[OrderPlaced])),
                   [A_Days_Place_Orders] =(datediff(day,[Brd_Recived_Approved],[OrderPlaced])),
                   [A_FC_Desicsion_Days] = (datediff(day,[Brd_WIU_reguest_fin_approval],[Brd_WTF_approval])),
                   [A_Estimated_Production_Days] = (datediff(day,[Brd_WTF_approval],[Log_Dealer_order])),
                   [A_Actual_Prodaction_Days] = (datediff(day,[Brd_WTF_approval],[Get_Release_Date])),
                   [A_Production_Delivation_Days] = (datediff(day,[OrderPlaced],[Get_Release_Date])),
                   [A_Days_Transit_Compound] = (datediff(day,[Get_release_date],[Compound])),
                   [A_Days_Compound] = (datediff(day,[Compound],[Compound_Rls])),
                   [A_FC_Release_Confirmation_Days] = (datediff(day,[RLS_Placed], [Log_WTF_confirmation])),
                   [A_Compound_Preparation_Days] = (datediff(day,[Log_WTF_confirmation], [Compound_Rls])),
                   [A_Days_Transit_Ukraine] = (datediff(day,[Compound_Rls], [WIU_Arrived])),
                   [A_Days_Customs]  = (datediff(day,[WIU_Arrived], [Log_Vechicle_Unloaded_VIC])),
                   [A_Dayst_VIC]  = (datediff(day,[Log_Vechicle_Unloaded_VIC], [Log_VIC_departure])),
                   [A_Days_Transit_Dealer] = (datediff(day,[Log_vic_departure], [Log_actual_delivery_dlr])),
                   [A_Days_Dealer] = (datediff(day,[Log_actual_delivery_dlr], [Sold_to_Client])),
                   [A_Days_WIU_Customer_Sold] = (datediff(day,[Log_VIC_departure], [Sold_to_Client])),

                   [A_Tatal_Days] = (datediff(day,[OrderPlaced], [Sold_to_Client])) WHERE [ID]=@POISK

*/

DELETE FROM [S_Indicators]
 
INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(1, 'A_Financial_Desicsion_Days', 2, 2, 'Brd_Recived_Approved', 3, 'Brd_Recived_Approved]','Первій помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(2, 'A_Sales_Desicsion_Days', 2, 2, 'OrderPlaced', 3, 'Brd_Recived_Approved','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(3, 'A_Days_Place_Orders', 2, 2, 'OrderPlaced', 3, 'Brd_Recived_Approved','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(4, 'A_FC_Desicsion_Days', 2, 2, 'Brd_WTF_approval', 3, 'Brd_WIU_reguest_fin_approval','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(5, 'A_Estimated_Production_Days', 2, 2, 'Log_Dealer_order', 3, 'Brd_WTF_approval','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(6, 'A_Actual_Prodaction_Days', 2, 2, 'Get_Release_Date', 3, 'Brd_WTF_approval','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(7, 'A_Production_Delivation_Days', 2, 2, 'Get_Release_Date', 3, 'OrderPlaced','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(8, 'A_Days_Transit_Compound', 2, 2, 'Compound', 3, 'Get_release_date','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(9, 'A_Days_Compound', 2, 2, 'Compound', 3, 'Compound','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(10, 'A_FC_Release_Confirmation_Days', 2, 2, 'Log_WTF_confirmation', 3, 'RLS_Placed','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(11, 'A_Compound_Preparation_Days', 2, 2, 'Compound_Rls', 3, 'Log_WTF_confirmation','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(12, 'A_Days_Transit_Ukraine', 2, 2, 'WIU_Arrived]', 3, 'Compound_Rls','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(13, 'A_Days_Customs', 2, 2, 'Log_Vechicle_Unloaded_VIC', 3, 'WIU_Arrived','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES (14, 'A_Dayst_VIC', 2, 2, 'Log_VIC_departure', 3, 'Log_Vechicle_Unloaded_VIC','ddddd')

INSERT INTO [S_Indicators] ([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(15, 'A_Days_Transit_Dealer', 2, 2, 'Log_actual_delivery_dlr', 3, 'Log_vic_departure','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(16, 'A_Days_Dealer', 2, 2, 'Sold_to_Client', 3, 'Log_actual_delivery_dlr','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(17, 'A_Days_WIU_Customer_Sold', 2, 2, 'Sold_to_Client', 3, 'Log_VIC_departure','Второй помежуток')

INSERT INTO [S_Indicators]([IDAging], [Nazvanie], [Indikator], [Nom1], [Data1], [Nom2], [Data2], [Notes])
VALUES(18, 'A_Tatal_Days', 2, 2, 'Sold_to_Client]', 3, 'OrderPlaced','Второй помежуток')
GO
/****** Object:  Table [dbo].[S_Option]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Option](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Name_spr] [nvarchar](50) NULL,
	[Dat_spr] [datetime] NULL,
	[Notes] [nvarchar](50) NULL,
	[Vubor] [int] NULL,
 CONSTRAINT [PK_S_option] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Request]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Request](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Num] [nvarchar](20) NOT NULL,
	[Dat] [datetime] NULL,
	[Sum] [money] NULL,
	[Rem] [nvarchar](250) NULL,
 CONSTRAINT [PK_W_Request] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[CreateSession1]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Writes or updates session record
CREATE PROCEDURE [dbo].[CreateSession1]
@SessionID as varchar(32),
@CompiledDefinition as uniqueidentifier = NULL,
@SnapshotDataID as uniqueidentifier = NULL,
@IsPermanentSnapshot as bit = NULL,
@ReportPath as nvarchar(440) = NULL,
@Timeout as int,
@AutoRefreshSeconds as int = NULL,
@DataSourceInfo as image = NULL,
@OwnerName as nvarchar (260),
@OwnerSid as varbinary (85) = NULL,
@AuthType as int,
@EffectiveParams as ntext = NULL,
@HistoryDate as datetime = NULL,
@PageHeight as float = NULL,
@PageWidth as float = NULL,
@TopMargin as float = NULL,
@BottomMargin as float = NULL,
@LeftMargin as float = NULL,
@RightMargin as float = NULL,
@AwaitingFirstExecution as bit = NULL
AS

UPDATE PS
SET PS.RefCount = 1
FROM
    [ReportServerTempDB].dbo.PersistedStream as PS
WHERE
    PS.SessionID = @SessionID	
    
UPDATE SN
SET TransientRefcount = TransientRefcount + 1
FROM
   SnapshotData AS SN
WHERE
   SN.SnapshotDataID = @SnapshotDataID
   
UPDATE SN
SET TransientRefcount = TransientRefcount + 1
FROM
   [ReportServerTempDB].dbo.SnapshotData AS SN
WHERE
   SN.SnapshotDataID = @SnapshotDataID

DECLARE @OwnerID uniqueidentifier
EXEC GetUserID @OwnerSid, @OwnerName, @AuthType, @OwnerID OUTPUT

DECLARE @now datetime
SET @now = GETDATE()

INSERT
   INTO [ReportServerTempDB].dbo.SessionData (
      SessionID,
      CompiledDefinition,
      SnapshotDataID,
      IsPermanentSnapshot,
      ReportPath,
      Timeout,
      AutoRefreshSeconds,
      Expiration,
      DataSourceInfo,
      OwnerID,
      EffectiveParams,
      CreationTime,
      HistoryDate,
      PageHeight,
      PageWidth,
      TopMargin,
      BottomMargin,
      LeftMargin,
      RightMargin,
      AwaitingFirstExecution )
   VALUES (
      @SessionID,
      @CompiledDefinition,
      @SnapshotDataID,
      @IsPermanentSnapshot,
      @ReportPath,
      @Timeout,
      @AutoRefreshSeconds,
      DATEADD(s, @Timeout, @now),
      @DataSourceInfo,
      @OwnerID,
      @EffectiveParams,
      @now,
      @HistoryDate,
      @PageHeight,
      @PageWidth,
      @TopMargin,
      @BottomMargin,
      @LeftMargin,
      @RightMargin,
      @AwaitingFirstExecution )
GO
/****** Object:  Table [dbo].[S_Indicators]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Indicators](
	[IDAging] [int] NOT NULL,
	[Nazvanie] [nvarchar](50) NULL,
	[Indikator] [int] NULL,
	[Nom1] [nvarchar](5) NULL,
	[Data1] [nvarchar](50) NULL,
	[Nom2] [nvarchar](5) NULL,
	[Data2] [nvarchar](50) NULL,
	[Notes] [nvarchar](50) NULL,
 CONSTRAINT [PK_S_Indicators] PRIMARY KEY CLUSTERED 
(
	[IDAging] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Delivery_type]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Delivery_type](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [varchar](50) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[S_Gearbox]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Gearbox](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Brend] [int] NULL,
	[Model] [int] NULL,
	[Version] [int] NULL,
	[Code] [char](10) NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Vol] [int] NULL,
 CONSTRAINT [PK__S_Gearbox__72E607DB] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  StoredProcedure [dbo].[Rec_cound_brand]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
 Organisation :  Winner Imports Ukraine, Ltd.
 Author       :  Savchenko Arthur
 Date         :  22 september 2008 
 Time         :  11:41
 Description  :  For Report Finance Department
 
 Remarks :
 Вспомогательная процедура для расчета среднего 
 количества машин проданных за текущий месяц
 вызывается из процедуры Rec_cound_month
 Данные берутся из зараннее подготовленной таблицы 
 W_Srez данные в которую попадают ежедневно в 12.00 ночи
*/
CREATE PROCEDURE [dbo].[Rec_cound_brand]  @Brand  int, @Status int
AS

-- Initial Values
DECLARE @SOLDCAR         INT
DECLARE @CURRENTMONTH    INT
DECLARE @NAMEBRAND       NVARCHAR(50)

-- Определение текущего месяца
SET     @CURRENTMONTH = MONTH(GETDATE())

-- Количество проданных машин по бренду по статусу 9.
SELECT @SOLDCAR = COUNT(*) 
  FROM W_ORDER 
 WHERE BREND    = @Brand 
   AND MONTH(Sold_to_Client) = @CURRENTMONTH

-- Определение имени бренда
SELECT @NAMEBRAND = NAZ 
  FROM S_BREND 
 WHERE ID = @BRAND

-- Запись среднего количества срезов
INSERT W_srez_avg (Brand, Status, Cavg, Csld, Ccal, Notes, Flag)  
SELECT @Brand, @Status, AVG(Countcar), @SOLDCAR, AVG(Countcar) / @SOLDCAR * 30, @NAMEBRAND , 1  
  FROM W_Srez 
 WHERE Brand       = @Brand                             -- Brand
   AND Remarks     = CONVERT(NVARCHAR(10), @Status)     -- Status
   AND MONTH(Data) = @CURRENTMONTH                      -- Month

-- Просмотр среза в таблице
-- SELECT * FROM W_srez_avg
GO
/****** Object:  Table [dbo].[W_Docflow]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Docflow](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Init] [int] NULL,
	[Doc_type] [nvarchar](30) NULL,
	[Contr] [nvarchar](30) NULL,
	[Agr_type] [nvarchar](30) NULL,
	[Appx_to] [nvarchar](30) NULL,
	[Appx_n] [nvarchar](30) NULL,
	[Inter_n] [nvarchar](30) NULL,
	[Descr] [nvarchar](30) NULL,
	[Prep_v] [nvarchar](30) NULL,
	[Prep_s] [nvarchar](30) NULL,
	[Prep_d] [nvarchar](30) NULL,
	[Post_s] [nvarchar](30) NULL,
	[Post_d] [nvarchar](30) NULL,
	[Ext_n] [nvarchar](30) NULL,
	[Doc_date] [nvarchar](30) NULL,
	[Comm_l] [nvarchar](30) NULL,
	[Appr_l] [nvarchar](30) NULL,
	[Place] [nvarchar](30) NULL,
	[Done] [nvarchar](30) NULL,
	[Depart] [nvarchar](30) NULL,
	[Comment] [nvarchar](30) NULL,
	[Comm_dir] [nvarchar](30) NULL,
	[Sender] [nvarchar](30) NULL,
	[Comm_f] [nvarchar](30) NULL,
	[Appr_f] [nvarchar](30) NULL,
	[Send_f] [nvarchar](30) NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Parameters]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Parameters](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Dat] [datetime] NULL,
	[Code] [int] NOT NULL,
	[Cod] [nvarchar](4) NULL,
	[Brand] [int] NOT NULL,
	[Model] [int] NOT NULL,
	[Vers] [int] NOT NULL,
	[Body] [int] NOT NULL,
	[Eng] [int] NULL,
	[Freight] [money] NOT NULL,
	[Insurance] [money] NOT NULL,
	[Procedura] [money] NOT NULL,
	[Duty] [money] NOT NULL,
	[Excise] [money] NOT NULL,
	[Pdi] [money] NOT NULL,
	[Dhd] [money] NOT NULL,
	[Inukr] [money] NOT NULL,
	[Totals] [money] NOT NULL,
	[Docfee] [money] NOT NULL,
	[Extwar] [money] NOT NULL,
	[Handfee] [money] NOT NULL,
	[Countins] [money] NOT NULL,
	[Modeldisc] [money] NOT NULL,
	[Dlrmarkup] [money] NOT NULL,
	[ExcisePet] [money] NOT NULL,
	[Dutypetr] [money] NOT NULL,
	[Excdiesel] [money] NOT NULL,
	[Dutydiesel] [money] NOT NULL,
	[Impmarkup] [money] NOT NULL,
	[Remark] [nvarchar](200) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Reasons]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Reasons](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Dcn]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Dcn](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Ido] [int] NULL,
	[Brand] [int] NULL,
	[Model] [int] NULL,
	[Vers] [int] NULL,
	[Dlr] [int] NULL,
	[Acc] [int] NOT NULL,
	[Purpose] [nvarchar](200) NULL,
	[Vin_last] [nvarchar](17) NULL,
	[Vin] [nvarchar](17) NULL,
	[Num] [nvarchar](17) NULL,
	[Data] [datetime] NULL,
	[Dk] [int] NOT NULL,
	[Summ] [money] NOT NULL,
	[Setll] [int] NOT NULL,
	[Importans] [int] NULL,
	[Sal_appr] [int] NULL,
	[Sal_dat] [datetime] NULL,
	[Br_appr] [int] NULL,
	[Br_dat] [datetime] NULL,
	[Fin_appr] [int] NULL,
	[Fin_dat] [datetime] NULL,
	[Dat_create] [datetime] NULL,
	[Dat_change] [datetime] NULL,
	[User_create] [nvarchar](30) NULL,
	[User_change] [nvarchar](30) NULL,
	[Vukonav] [int] NOT NULL,
	[Curr] [int] NOT NULL,
	[Cenappr] [int] NULL,
	[Approval] [int] NULL,
	[Status] [int] NOT NULL,
	[Priz] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Score]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Score](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Year_plan] [int] NULL,
	[Total_month] [int] NULL,
	[Commercials] [int] NULL,
	[Warranty] [int] NULL,
	[Accessories] [int] NULL,
	[Forecast] [int] NULL,
	[Stock] [int] NULL,
	[Days] [int] NULL,
	[Month_13] [int] NULL,
	[Month_46] [int] NULL,
	[Month_79] [int] NULL,
	[Month_1012] [int] NULL,
	[Month_12] [int] NULL,
	[Monthtotal] [int] NULL,
	[Daily_supply] [int] NULL,
	[Stock_turn] [int] NULL,
	[First_fill] [int] NULL,
	[Count_up] [int] NULL,
	[Count_noup] [int] NULL,
	[Count_mech] [int] NULL,
	[Count_hoursnopays] [int] NULL,
	[Count_hourspay] [int] NULL,
	[Productive] [int] NULL,
	[Act_close] [int] NULL,
	[Act_close_comerce] [int] NULL,
	[Act_close_waranty] [int] NULL,
	[Pay_work] [int] NULL,
	[Profit] [int] NULL,
	[Profit_precent] [int] NULL,
	[Effective] [int] NULL,
	[Rejim] [int] NULL,
	[DlrName] [nvarchar](50) NULL,
	[DlrId] [int] NULL,
	[DateInser] [datetime] NULL,
	[Priznak] [int] NULL,
 CONSTRAINT [PK__W_Score__4F145267] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Temp]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Temp](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [nvarchar](50) NULL,
	[D_zakaza] [smalldatetime] NULL,
	[Brend] [int] NULL,
	[Model] [int] NULL,
	[Vers] [int] NULL,
	[Sorder] [nvarchar](30) NULL,
	[Wiou] [nvarchar](30) NULL,
	[ProductionMonth] [smalldatetime] NULL,
	[DLR_Order_placed] [smalldatetime] NULL,
	[Dealer_order_placed] [int] NULL,
	[Dpo] [nvarchar](30) NULL,
	[Dlr] [int] NULL,
	[Loc] [int] NULL,
	[Status] [int] NULL,
	[VIN] [nvarchar](20) NULL,
	[SVIN]  AS (left([vin],8)),
	[Engine] [int] NULL,
	[Spec1] [nvarchar](20) NULL,
	[Spec2] [nvarchar](20) NULL,
	[Spec3] [nvarchar](20) NULL,
	[Colour] [int] NULL,
	[Colours] [int] NULL,
	[Trimm] [int] NULL,
	[OrderType] [int] NULL,
	[Comments] [nvarchar](255) NULL,
	[MY] [numeric](18, 0) NULL,
	[Cif_cip_calc] [money] NULL,
	[Cif_cip] [money] NULL,
	[Dealer_price] [money] NULL,
	[MSRP] [money] NULL,
	[OrderPlaced] [smalldatetime] NULL,
	[DeadlineChange] [smalldatetime] NULL,
	[Req] [nvarchar](255) NULL,
	[Product_confirmed] [smalldatetime] NULL,
	[ProdM] [smalldatetime] NULL,
	[Start_Production] [smalldatetime] NULL,
	[Date_completed] [smalldatetime] NULL,
	[Invoice_Number] [nvarchar](20) NULL,
	[Invoice_Date] [smalldatetime] NULL,
	[Compound] [smalldatetime] NULL,
	[RLS] [nvarchar](30) NULL,
	[RLS_placed] [smalldatetime] NULL,
	[Start_transit] [smalldatetime] NULL,
	[WIU_Arrived] [smalldatetime] NULL,
	[ContractDD] [smalldatetime] NULL,
	[Dat_zak] [smalldatetime] NULL,
	[Derivate] [nvarchar](255) NULL,
	[GearBox] [int] NULL,
	[Optional] [int] NULL,
	[Options] [nvarchar](3000) NULL,
	[Client] [int] NULL,
	[Confirms] [nvarchar](50) NULL,
	[WIU] [nvarchar](255) NULL,
	[Credit_Line] [nvarchar](255) NULL,
	[Stock_Position] [nvarchar](255) NULL,
	[SalesDialer] [money] NULL,
	[Payment] [money] NULL,
	[Payment_Due] [smalldatetime] NULL,
	[Remain] [money] NULL,
	[PDI] [nvarchar](255) NULL,
	[Car_credit] [nvarchar](255) NULL,
	[Payments_Due_Aging] [nvarchar](255) NULL,
	[Fin_Recived_Approved] [smalldatetime] NULL,
	[Isp_dat] [smalldatetime] NULL,
	[Isp] [nvarchar](50) NULL,
	[Comp] [nvarchar](50) NULL,
	[Isppol] [int] NULL,
	[Priz] [int] NULL,
	[Note] [nvarchar](200) NULL,
	[Package] [int] NULL,
	[Viev] [int] NULL,
	[Vubor_pr] [int] NULL,
	[Vubor] [int] NULL,
 CONSTRAINT [PK_W_Temp] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_package_Plan]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_package_Plan](
	[Idn] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [int] NOT NULL,
	[Id_package] [int] NOT NULL,
	[Dat_package] [datetime] NULL,
	[Kol_package] [int] NULL,
	[Ispolz] [int] NULL,
	[MY] [int] NULL,
	[Wiou] [nvarchar](30) NULL,
	[ProductionMonth] [datetime] NULL,
	[Dealer_order_placed] [int] NULL,
	[Dlr] [int] NULL,
	[Colour] [int] NULL,
	[Colours] [int] NULL,
	[OrderType] [int] NULL,
	[Zakaz] [nvarchar](50) NULL,
	[Dlr_order_placed_name] [nvarchar](50) NULL,
	[Dlr_name] [nvarchar](50) NULL,
	[Colour_name] [nvarchar](50) NULL,
	[Colours_name] [nvarchar](50) NULL,
	[Ordertype_name] [nvarchar](50) NULL,
	[Package_name] [nvarchar](50) NULL,
 CONSTRAINT [PK_W_package_plan] PRIMARY KEY CLUSTERED 
(
	[Idn] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_System]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_System](
	[IDD] [int] IDENTITY(1,1) NOT NULL,
	[Dat] [datetime] NULL,
	[Note] [nvarchar](200) NULL,
	[Ntab] [nvarchar](50) NULL,
	[Crec] [int] NULL,
	[Indication] [char](10) NULL,
 CONSTRAINT [PK_W_System] PRIMARY KEY CLUSTERED 
(
	[IDD] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата и время изменений' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_System', @level2type=N'COLUMN',@level2name=N'Dat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Примечание ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_System', @level2type=N'COLUMN',@level2name=N'Note'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Имя таблицы в которой производились изменения' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_System', @level2type=N'COLUMN',@level2name=N'Ntab'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Количество записей' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_System', @level2type=N'COLUMN',@level2name=N'Crec'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Признак обработки ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_System', @level2type=N'COLUMN',@level2name=N'Indication'
GO
/****** Object:  Table [dbo].[S_Diler_Login]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Diler_Login](
	[IDS] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [float] NULL,
	[ID] [float] NULL,
	[login] [nvarchar](255) NULL,
	[Blocked] [int] NULL,
 CONSTRAINT [PK_S_diler_login] PRIMARY KEY CLUSTERED 
(
	[IDS] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Engenie]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_Engenie](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Brend] [int] NULL,
	[Model] [int] NULL,
	[Version] [int] NULL,
	[Code] [char](10) NULL,
	[Code1] [char](10) NULL,
	[Seriya] [char](10) NULL,
	[Naz] [nvarchar](50) NULL,
	[Vol] [float] NULL,
	[Tip] [int] NULL,
 CONSTRAINT [PK__S_Engenie__74CE504D] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Тип двигателя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Engenie', @level2type=N'COLUMN',@level2name=N'Tip'
GO
/****** Object:  Table [dbo].[S_Location]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Location](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Znach] [nvarchar](50) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY],
 CONSTRAINT [UNIQ_4] UNIQUE NONCLUSTERED 
(
	[Naz] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Reason_logistics]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Reason_logistics](
	[ID] [int] NOT NULL,
	[Naz] [nvarchar](50) NULL,
 CONSTRAINT [PK_S_Reason_logistics] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Ch_Price]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Ch_Price](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[D_change] [smalldatetime] NULL,
	[OrderNumber] [int] NOT NULL,
	[Notes] [nvarchar](255) NULL,
	[New_price] [money] NULL,
	[Old_price] [money] NULL,
	[Isp_name] [char](20) NULL,
	[Isp] [int] NULL,
 CONSTRAINT [PK__W_Ch_Price__4D7F7902] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  StoredProcedure [dbo].[Null_Car_Date]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Обнуление дат по двум брендам зависшим 
CREATE PROCEDURE [dbo].[Null_Car_Date]
AS
-- Форд    VIN = 24405  (ID 24405)
-- LROVER  VIN = 170795 (ID 25040)
UPDATE W_ORDER SET SALE_DATE = NULL WHERE ID IN(46983,25040)
GO
/****** Object:  View [dbo].[Other3]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Other3]
AS
SELECT     dbo.W_Optional.Zakaz, dbo.W_Optional.Conf, dbo.W_Optional.ID, dbo.S_Optional.Naz, dbo.S_Optional.Model, dbo.S_Optional.Vubor, 
                      dbo.S_Optional.Version, dbo.S_Brend.Naz AS Expr1
FROM         dbo.W_Optional INNER JOIN
                      dbo.S_Optional ON dbo.W_Optional.Conf = dbo.S_Optional.ID INNER JOIN
                      dbo.S_Brend ON dbo.S_Optional.Brend = dbo.S_Brend.ID
GO
/****** Object:  Table [dbo].[W_Update_Order_Fields]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Update_Order_Fields](
	[IDN] [nvarchar](40) NOT NULL,
	[Descript] [nvarchar](100) NULL,
PRIMARY KEY CLUSTERED 
(
	[IDN] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[Charyear]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Расшифровка года по символу в вин коде
CREATE FUNCTION [dbo].[Charyear] (@@Charsimbol VARCHAR(1))
RETURNS VARCHAR(2)
AS
BEGIN
DECLARE @@VOL VARCHAR(2)
     SET @@VOL = CASE @@Charsimbol
                 WHEN '1' THEN '01'
                 WHEN '2' THEN '02'
                 WHEN '3' THEN '03'
                 WHEN '4' THEN '04'
                 WHEN '5' THEN '05'
                 WHEN '6' THEN '06'
                 WHEN '7' THEN '07'
                 WHEN '8' THEN '08'
                 WHEN '9' THEN '09'
                 WHEN 'A' THEN '10'
                 WHEN 'B' THEN '11'
                 WHEN 'C' THEN '12'
                 WHEN 'D' THEN '13'
                 WHEN 'E' THEN '14'
                 WHEN 'F' THEN '15'
                 WHEN 'G' THEN '16'
                 WHEN 'H' THEN '17'
                 ELSE '00' 
END                 
RETURN @@VOL
END                 

--PRINT DBO.CHARYEAR('B')
GO
/****** Object:  View [dbo].[A_Roles]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Roles]
AS
SELECT     TOP (100) PERCENT f.name, f2.name AS Name_role, f.create_date, f.modify_date, f.type
FROM         sys.database_principals AS f2 INNER JOIN
                      sys.database_role_members AS r ON f2.principal_id = r.role_principal_id RIGHT OUTER JOIN
                      sys.database_principals AS f ON r.member_principal_id = f.principal_id
ORDER BY f.name
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[54] 4[5] 2[3] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "f"
            Begin Extent = 
               Top = 9
               Left = 31
               Bottom = 284
               Right = 219
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "r"
            Begin Extent = 
               Top = 20
               Left = 280
               Bottom = 260
               Right = 457
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "f2"
            Begin Extent = 
               Top = 6
               Left = 495
               Bottom = 263
               Right = 683
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 13
         Width = 284
         Width = 2370
         Width = 1935
         Width = 2385
         Width = 1875
         Width = 2160
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 2550
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Roles'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Roles'
GO
/****** Object:  StoredProcedure [dbo].[Crosstab]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[Crosstab] 
@source varchar(1000), --то, что между FROM и WHERE
@fields varchar(100)=null, --поля для отбора... по ним происходит группировка. Если не заданы, то результатом будет одна строка - итог по всем записям
@func varchar(100), -- функция вида sum(some_field), count... и так далее ... НЕДОПУСТИМО использовать в качестве аргумента * (звездочку)
@pivot varchar(1000), -- правило для формирования полей
@filtr varchar(1000)=null, -- Условия отбора (то, что в запросе следует после WHERE)
@into varchar(100)=null -- Таблица, которая будет создана и заполнена результатами выполнения процедуры (опционально)

AS

DECLARE 
@select VARCHAR(8000), 
@sql VARCHAR(8000), 
@sql1 VARCHAR(8000), 
@sql2 VARCHAR(8000), 
@sql3 VARCHAR(8000), 
@sql4 VARCHAR(8000), 
@sql5 VARCHAR(8000), 
@sql6 VARCHAR(8000), 
@sql7 VARCHAR(8000), 
@sql8 VARCHAR(8000), 
@sql9 VARCHAR(8000), 
@sqlend VARCHAR(8000), 
@delim VARCHAR(1), 
@sqllen numeric(10), 
@sqlnum numeric(10), 
@pvalue VARCHAR(100),
@filtr1 varchar(1000) 

SET NOCOUNT ON
SET ANSI_WARNINGS OFF

SET @filtr1=isnull(' AND '+@filtr, '')
EXEC ('SELECT DISTINCT ' + @pivot + ' as pivot INTO ##pivot FROM ' + @source + ' WHERE ' 
+ @pivot + ' Is Not Null '+ @filtr1)

SELECT @sql='',
@sql1='',
@sql2='',
@sql3='',
@sql4='',
@sql5='',
@sql6='',
@sql7='',
@sql8='',
@sql9='',
@select='SELECT '+isnull(@fields+',',''),  
@func=stuff(@func, len(@func), 1, ' END)')


SELECT top 1 @delim = CASE ISNUMERIC(pivot) WHEN 1 THEN '' ELSE '''' END FROM ##pivot
DECLARE cur_pivot_cursor scroll CURSOR FOR select pivot from ##pivot order by pivot  

OPEN cur_pivot_cursor

FETCH NEXT FROM cur_pivot_cursor
INTO @pvalue

SET @sqlnum = 1

WHILE @@FETCH_STATUS = 0

BEGIN

-- итерация складывания полей
SET @sql=@sql + '''' + convert(VARCHAR(100), @pvalue) + ''' = ' + 
stuff(@func,charindex( '(', @func )+1, 0, 'CASE ' + @pivot + 
' WHEN ' + @delim + convert(VARCHAR(100), @pvalue) + @delim + ' THEN ' ) + ', '

-- измеряем длину строки
SET @sqllen = len(@sql)

-- проверяем длину строки, если размер превышен, 
-- 1-й проход
IF @sqllen > 7800 and @sqlnum = 1 
BEGIN
SET @sql1 = @sql
SET @sqlnum = @sqlnum + 1
SET @sql = ''
SET @sqllen = 0
END

-- 2-й проход
IF @sqllen > 7800 and @sqlnum = 2
BEGIN
SET @sql2 = @sql
SET @sqlnum = @sqlnum + 1
SET @sql = ''
SET @sqllen = 0
END

-- 3-й проход
IF @sqllen > 7800 and @sqlnum = 3
BEGIN
SET @sql3 = @sql
SET @sqlnum = @sqlnum + 1
SET @sql = ''
SET @sqllen = 0
END

-- 4-й проход
IF @sqllen > 7800 and @sqlnum = 4
BEGIN
SET @sql4 = @sql
SET @sqlnum = @sqlnum + 1
SET @sql = ''
SET @sqllen = 0
END

-- 5-й проход
IF @sqllen > 7800 and @sqlnum = 5 
BEGIN
SET @sql5 = @sql
SET @sqlnum = @sqlnum + 1
SET @sql = ''
SET @sqllen = 0
END

-- 6-й проход
IF @sqllen > 7800 and @sqlnum = 6
BEGIN
SET @sql6 = @sql
SET @sqlnum = @sqlnum + 1
SET @sql = ''
SET @sqllen = 0
END

-- 7-й проход
IF @sqllen > 7800 and @sqlnum = 7
BEGIN
SET @sql7 = @sql
SET @sqlnum = @sqlnum + 1
SET @sql = ''
SET @sqllen = 0
END

-- 8-й проход
IF @sqllen > 7800 and @sqlnum = 8
BEGIN
SET @sql8 = @sql
SET @sqlnum = @sqlnum + 1
SET @sql = ''
SET @sqllen = 0
END 

-- 9-й проход
IF @sqllen > 7800 and @sqlnum = 9
BEGIN
SET @sql9 = @sql
SET @sqlnum = @sqlnum + 1
SET @sql = ''
SET @sqllen = 0
END 

-- получаем следующую строку
FETCH NEXT FROM cur_pivot_cursor
INTO @pvalue

END

-- курсор больше не нужен
CLOSE cur_pivot_cursor
DEALLOCATE cur_pivot_cursor

DROP TABLE ##pivot

-- убираем лишнюю запятую в конце всей серии срок
IF len(@sql) > 0
SELECT @sql=left(@sql, len(@sql)-1)
ELSE 
BEGIN
IF LEN(@sql9)>0
SELECT @sql9=left(@sql9, len(@sql9)-1)
ELSE IF LEN(@sql8)>0
SELECT @sql8=left(@sql8, len(@sql9)-1)
ELSE IF LEN(@sql7)>0
SELECT @sql7=left(@sql7, len(@sql7)-1)
ELSE IF LEN(@sql6)>0
SELECT @sql6=left(@sql6, len(@sql6)-1)
ELSE IF LEN(@sql5)>0
SELECT @sql5=left(@sql5, len(@sql5)-1)
ELSE IF LEN(@sql4)>0
SELECT @sql4=left(@sql4, len(@sql4)-1)
ELSE IF LEN(@sql3)>0
SELECT @sql3=left(@sql3, len(@sql3)-1)
ELSE IF LEN(@sql2)>0
SELECT @sql2=left(@sql2, len(@sql2)-1)
ELSE IF LEN(@sql1)>0
SELECT @sql1=left(@sql1, len(@sql1)-1)
END
SET @filtr1=isnull(' WHERE '+@filtr, '')
set @sqlend=isnull(' INTO '+@into,'')+' FROM '+@source+@filtr1+isnull(' GROUP BY '+@fields,'')

EXEC (@select+@sql1+@sql2+@sql3+@sql4+@sql5+@sql6+@sql7+@sql8+@sql9+@sql+@sqlend)
SET ANSI_WARNINGS ON
GO
/****** Object:  View [dbo].[A_Rate]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*set dateformat dmy
 Для запроса (104)
select * from s_rate where date=CONVERT(varchar(12),getdate(),104)
 Для просмотра (101)
select * from s_rate where date=CONVERT(varchar(12),getdate(),101)*/
CREATE VIEW [dbo].[A_Rate]
AS
SELECT     code, char3, size, name, rate, change
FROM         dbo.S_Rate
WHERE     (date = CONVERT(varchar(12), GETDATE(), 101))
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Rate"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 240
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 3780
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 4290
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Rate'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Rate'
GO
/****** Object:  View [dbo].[A_Bailment_Risk_Report]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Bailment_Risk_Report]
AS
SELECT     TOP (100) PERCENT Brand_name AS Brand, VIN AS VIN_Code, Last_Name AS Dealer_Name, Act AS Act_Number, Act_Date AS Bailtmrnt_Open, 
                      Price AS Bailtmrnt_Price
FROM         dbo.A_Unloadcar
WHERE     (Act_Date IS NOT NULL) AND (Closing IS NOT NULL) AND (Closing > CONVERT(DATETIME, '2009-11-01 00:00:00', 102)) AND (Act_Received IS NULL) 
                      AND (Act <> N'0')
ORDER BY Brand
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[30] 4[31] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1[44] 4[32] 3) )"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 1
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "A_Unloadcar"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 327
               Right = 346
            End
            DisplayFlags = 280
            TopColumn = 14
         End
      End
   End
   Begin SQLPane = 
      PaneHidden = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 2295
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 2475
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 3225
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Bailment_Risk_Report'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Bailment_Risk_Report'
GO
/****** Object:  Table [dbo].[W_Invoice_Sub]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Invoice_Sub](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_Invoice] [int] NOT NULL,
	[Code] [nvarchar](10) NOT NULL,
	[Naz] [nvarchar](200) NOT NULL,
	[Valute] [int] NOT NULL,
	[Sum] [money] NULL,
	[Discount] [money] NULL,
	[Total_Sum] [money] NULL,
	[Remarks] [nvarchar](250) NULL,
 CONSTRAINT [PK_W_Invoice_sub_1] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[Viev_Brands]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Author      : Savchenko Arthur
Create Date : 07-10-2008 9:14
Description : Preview Base Information
Usage       : SELECT * FROM dbo.viev_brands(4,2) 
*/

CREATE FUNCTION [dbo].[Viev_Brands] (@Brand INT, @Status INT)
RETURNS TABLE 
AS
RETURN 
(
 -- Add the SELECT statement with parameter references here
	SELECT * FROM w_order WHERE brend = @brand AND STATUS = @STATUS 
)
GO
/****** Object:  Table [dbo].[S_Partscurrancy]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Partscurrancy](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Dateinput] [datetime] NULL,
	[Dollar] [decimal](18, 2) NULL,
	[SEK] [decimal](18, 2) NULL,
	[Krona] [decimal](18, 2) NULL,
	[Euro] [decimal](18, 2) NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[Other_DB]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Other_DB]
AS
SELECT     pubs.dbo.authors.*
FROM         pubs.dbo.authors
GO
/****** Object:  Table [dbo].[W_Package_Vers]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Package_Vers](
	[ID_Vers] [int] IDENTITY(1,1) NOT NULL,
	[ID_Pack] [int] NOT NULL,
	[ID_Sub] [int] NULL,
	[D_Сhange] [smalldatetime] NOT NULL,
	[D_OG] [smalldatetime] NOT NULL,
	[D_PL] [smalldatetime] NOT NULL,
	[Nam] [nvarchar](50) NOT NULL,
	[Notes] [nvarchar](100) NULL,
	[RATE] [money] NULL,
 CONSTRAINT [PK__W_Package_Vers__491B81EF] PRIMARY KEY CLUSTERED 
(
	[ID_Vers] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Update_Order]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Update_Order](
	[IDN] [int] IDENTITY(1,1) NOT NULL,
	[Curr_Date] [datetime] NULL,
	[Brand] [int] NULL,
	[Path_Xls] [nvarchar](255) NOT NULL,
	[List_Xls] [nvarchar](50) NOT NULL,
	[Diap_Xls] [nvarchar](150) NOT NULL,
	[Status] [int] NULL,
	[Priz] [nvarchar](1) NULL,
	[Notes] [nvarchar](200) NULL,
	[Ok_No] [nvarchar](50) NULL,
	[Count_Car] [int] NULL,
	[Count_Money] [money] NULL,
	[Flds] [nchar](30) NOT NULL,
	[Statuss] [nvarchar](30) NOT NULL,
	[Vin_ord] [int] NOT NULL,
 CONSTRAINT [PK__W_Update_Order__53CE1A8C] PRIMARY KEY CLUSTERED 
(
	[IDN] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Nullid_new]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
---************************************************************
-- Обнуление счетчика в таблице заказов
-- и связанной с ней
-- вопрос возник при обнулении связных таблиц
-- когда нельзя было начать с единицы так как
-- номер начинался со сторого ид
-- Применение Set id.... только позволяет вставлять в поле ИД запись
-- но необнуляет ее
--************************************************************

CREATE PROCEDURE [dbo].[Nullid_new] 
AS

-- Обнулить счетчик со связями
-- DELETE FROM w_order
DBCC CHECKIDENT (W_ORDER, RESEED, 1)
GO
/****** Object:  Table [dbo].[S_Carrier]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Carrier](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Fio] [nvarchar](50) NULL,
	[Manager] [nvarchar](50) NULL,
	[Tel] [nvarchar](20) NULL,
	[Fax] [nvarchar](20) NULL,
	[Email] [nvarchar](30) NULL,
	[Notes] [nvarchar](200) NULL,
	[Dog_dat] [smalldatetime] NULL,
	[Dog_num] [nvarchar](20) NULL,
	[Adress] [nvarchar](100) NULL,
	[Adres_unload] [nvarchar](100) NULL,
 CONSTRAINT [PK__S_Carrier__09C96D33] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Наименвоание первозчика' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Фамилия директора' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier', @level2type=N'COLUMN',@level2name=N'Fio'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Фамилия менеджера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier', @level2type=N'COLUMN',@level2name=N'Manager'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Телефон организации' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier', @level2type=N'COLUMN',@level2name=N'Tel'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Факс' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier', @level2type=N'COLUMN',@level2name=N'Fax'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Єлектронный адрес' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier', @level2type=N'COLUMN',@level2name=N'Email'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Примечание' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier', @level2type=N'COLUMN',@level2name=N'Notes'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата логовора' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier', @level2type=N'COLUMN',@level2name=N'Dog_dat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер договора' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier', @level2type=N'COLUMN',@level2name=N'Dog_num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Почтовый адрес' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier', @level2type=N'COLUMN',@level2name=N'Adress'
GO
/****** Object:  Table [dbo].[S_Privelegiy]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Privelegiy](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Gr] [int] NULL,
	[Naz] [nvarchar](50) NOT NULL,
 CONSTRAINT [PK__S_Privelegiy__02284B6B] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[Days_L]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Days_L]
AS
SELECT     Brend, Model, Vers, DAYS_DLR, Days_Total, Days_in_prod, Days_Compound, Days_deliv
FROM         dbo.W_Order
WHERE     (DAYS_DLR > 0)
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[25] 4[36] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 245
               Right = 300
            End
            DisplayFlags = 280
            TopColumn = 3
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Days_L'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Days_L'
GO
/****** Object:  Table [dbo].[W_Log]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Log](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Tim] [datetime] NULL,
	[Usr] [nvarchar](50) NULL,
	[Usr_name] [nvarchar](30) NULL,
	[Note] [nvarchar](200) NULL,
	[Zakaz] [int] NULL,
	[Gr] [int] NULL,
	[New_val] [nvarchar](50) NULL,
	[Old_val] [nvarchar](50) NULL,
 CONSTRAINT [PK_W_LOG] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Grup]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Grup](
	[Id] [nvarchar](1) NOT NULL,
	[Naz] [nvarchar](50) NULL,
 CONSTRAINT [PK_S_Grup] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Aging]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Aging](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NULL,
	[Note] [nvarchar](250) NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[A_Viwe_old]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Viwe_old]
AS
SELECT     TOP 100 PERCENT dbo.W_Order.ID, dbo.W_Order.Status AS sTATTUS, dbo.W_Order.Zakaz, dbo.W_Order.D_zakaza, dbo.W_Order.Brend, 
                      dbo.S_Status.ID AS I_status, dbo.S_Status.Naz AS Status, dbo.W_Order.Engine, dbo.W_Order.Trimm, dbo.W_Order.Colour, 
                      dbo.W_Order.Get_release_Date, dbo.W_Order.Invoice_Date, dbo.W_Order.VIN, dbo.W_Order.Dat_zak, dbo.W_Order.MY, dbo.W_Order.Isppol
FROM         dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Status ON dbo.W_Order.Status = dbo.S_Status.ID
ORDER BY dbo.W_Order.ID, dbo.W_Order.D_zakaza
GO
/****** Object:  View [dbo].[Daly_Report]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Daly_Report]
AS
SELECT     TOP (100) PERCENT dbo.A_Status.ID AS [Номер у системі], dbo.A_Status.[Supplier Order] AS [Номер заказу], 
                      dbo.A_Status.Dlr AS [Дилер який замовив], dbo.A_Status.Loc AS [Місце знаходження], dbo.A_Status.Status AS Статутс, 
                      dbo.A_Status.Model AS Модел, dbo.A_Status.[Full VIN] AS [VIN код], dbo.A_Status.Engine AS Двигун, dbo.A_Status.Spec1 AS Спеціфікація, 
                      dbo.A_Status.[Optional Equipment] AS Обладнення, dbo.A_Status.[Colour Body] AS [Цвет кузова], dbo.W_Order.Rdf_dlr AS [Наименование дилера], 
                      dbo.W_Order.Rdf_Vid AS Вид, dbo.W_Order.Rdf_prod AS Продажа, dbo.W_Order.Rdf_rikv AS Лет, dbo.W_Order.Rdf_Zamov AS Замовлено, 
                      dbo.W_Order.Rdf_CodRadio AS [Код радио], dbo.W_Order.Rdf_numkey AS [Номер ключа], dbo.W_Order.Rdf_NumContract AS [Номер контракта], 
                      dbo.W_Order.Rdf_DateContract AS [Дата контракта], dbo.W_Order.Rdf_PriceClient AS Цена, dbo.W_Order.Rdf_FleetCode AS [Флит код], 
                      dbo.W_Order.Rdf_DateSale AS [Дата продажи], dbo.W_Order.Rdf_Category AS Категории, dbo.W_Order.Rdf_NameClient AS Фамилия, 
                      dbo.W_Order.Rdf_NameCompany AS [Наименование компании], dbo.W_Order.Rdf_Vik AS Возраст, 
                      dbo.W_Order.Rdf_BornClient AS [Дата рождения], dbo.W_Order.Rdf_Adres AS Адрес, dbo.W_Order.Rdf_Cyti AS Город, 
                      dbo.W_Order.Rdf_Phone AS [Телефон мобильный], dbo.W_Order.Rdf_Phoneh AS [Телефон домашний], 
                      dbo.W_Order.Rdf_Phonew AS [Телефон рабочий], dbo.W_Order.Rdf_Fax AS Факс, dbo.W_Order.Rdf_Prof AS Профессия, 
                      dbo.W_Order.Rdf_Post AS [Почтовый код], dbo.W_Order.Rdf_Marka AS [Марка попереднього авто], 
                      dbo.W_Order.Rdf_Model AS [Модель попереднього авто], dbo.W_Order.Rdf_Vupusk AS [Рік випуску], 
                      dbo.W_Order.Rdf_Salesman AS Продавець
FROM         dbo.A_Status INNER JOIN
                      dbo.W_Order ON dbo.A_Status.ID = dbo.W_Order.ID
WHERE     (dbo.A_Status.Id_Brand = 1) AND (dbo.A_Status.Id_Status < 9)
ORDER BY [Дилер який замовив], [Місце знаходження]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[41] 4[37] 2[17] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "A_Status"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 291
               Right = 391
            End
            DisplayFlags = 280
            TopColumn = 62
         End
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 429
               Bottom = 298
               Right = 691
            End
            DisplayFlags = 280
            TopColumn = 87
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1890
         Alias = 2925
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Daly_Report'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Daly_Report'
GO
/****** Object:  StoredProcedure [dbo].[Create_Back]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[Create_Back] (@Name_Back Nvarchar(50))
AS

-- Cоздание вак устройства
EXEC master.dbo.sp_addumpdevice 
    @devtype = N'disk', 
    @logicalname = @Name_back, 
    @physicalname = N'E:\MS SQL Backup\Back_2008_001.bak'
GO
/****** Object:  Table [dbo].[W_Tasks]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Tasks](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Depat] [int] NULL,
	[Time_start] [datetime] NULL,
	[Time_finish] [datetime] NULL,
	[Degree] [int] NULL,
	[Procent] [int] NULL,
	[Finished] [datetime] NULL,
	[Category] [int] NULL,
	[Remark] [nvarchar](200) NOT NULL,
	[Otdel] [nvarchar](30) NULL,
	[Reguester] [int] NULL,
	[Status] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Shrink_Database]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
 Author  :    Savchenko Arthur
 Date    :    10-10-2008 
 Time    :    16:30
 Remarks :    Сжатие лог файла который вырастает до очень больших размеров
              Предполагаемое время периодичности примерно - один раз в месяц 

Примечание :  Процедура не может быть сохраненна в виде процедуры для
              выполнения так как команды не позволяют в автомтаическом режиме 
              производить сжатие базы и лог файла
              Поэтому сохраненна в виде коментариев но выполнять  необходимо 
              вручную отмечая нужный фрагмент.
*/

CREATE PROCEDURE [dbo].[Shrink_Database]
AS

/*
USE Winner;
GO
ALTER DATABASE Winner SET RECOVERY SIMPLE;
GO
DBCC SHRINKFILE (Winner_Log, 10); --10MB
GO
ALTER DATABASE Winner SET RECOVERY FULL;
GO
*/



/* Сжатие базы  
   USE WINNER                                    -- Go to Winner base
   DBCC SHRINKFILE (WINNER_LOG,1)                -- Compress Winner_Log
   DBCC SHRINKFILE (WINNER_data,1)               -- Compress Winner_Data
   GO                                            
   BACKUP LOG [Winner] WITH TRUNCATE_ONLY        -- Trucate Winner 
   GO
   DBCC SHRINKFILE (WINNER_LOG,1)                
   PRINT 'Обратите на размер лог файла'
*/

/* Архивация базы данных
   Buckup Log File
   BACKUP LOG [Winner] 
   TO  DISK = N'D:\Winner\WInner_LOG.bak' 
   WITH NOFORMAT, 
   INIT,  
   NAME = N'Winner-Transaction Log  Backup', 
   SKIP, 
   NOREWIND, 
   NOUNLOAD,  
   STATS = 10

   -- сжатие после архивации
   DBCC SHRINKFILE (WINNER_LOG,1)
*/




/*
--Для SQL Server до 2008 версии я пользовался следующей процедурой:
USE ИмяБазы 
BACKUP LOG ИмяБазы WITH TRUNCATE_ONLY 
--DBCC SHRINKFILE( ИмяФайлаЛога,  ЖелаемыйРазмер )
DBCC SHRINKFILE(Winner_Log, 10)

--С SQL Server 2008 этот метод не работает, поэтому следует использоват другую процедуру:
USE ИмяБазы 
ALTER DATABASE ИмяБазы SET RECOVERY SIMPLE 
DBCC SHRINKFILE (Winner_Log, 10); 
ALTER DATABASE ИмяБазы SET RECOVERY FULL

*/
GO
/****** Object:  Table [dbo].[Dlr_Sales]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Dlr_Sales](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[VIN] [nvarchar](17) NULL,
	[FULL_VIN] [nvarchar](17) NULL,
	[MARK] [nvarchar](1) NULL,
	[MODEL] [nvarchar](15) NULL,
	[IFIRMS] [float] NULL,
	[HFIRMS] [nvarchar](60) NULL,
	[DATE] [datetime] NULL,
	[CURR] [nvarchar](3) NULL,
	[RATE] [float] NULL,
	[QTY] [float] NULL,
	[SUM_CURR] [float] NULL,
	[DEALER] [nvarchar](15) NULL,
	[ID] [nvarchar](10) NULL,
	[OPRID] [float] NULL,
	[CRDCODE] [float] NULL,
	[NUM_DOC] [nvarchar](15) NULL,
	[NOTE] [nvarchar](200) NULL,
	[PAYM_TERM] [nvarchar](20) NULL,
	[PAYM_DATE] [datetime] NULL,
	[IS_RET] [bit] NULL,
	[IS_NEW] [bit] NULL,
	[IS_CLOSED] [bit] NULL,
	[CODE] [float] NULL,
	[MOD_DATE] [datetime] NULL,
	[EUR] [float] NULL,
	[SUM_EUR] [float] NULL,
 CONSTRAINT [PK_dlr_Sales] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Import_XLS]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[Import_XLS] AS

-- Закачка во временную таблицу данных из XLS 
-- файла который находится на серврере с листом (REP)
-- Имя файла Repoert_os.xls

SELECT * INTO #t 
FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0', 'Data Source=C:\nas\it\Repoert_os.xls;Extended Properties=Excel 8.0')...[Reps$] 
--select * from #t
GO
/****** Object:  Table [dbo].[S_Buildup]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Buildup](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Code] [int] NOT NULL,
	[Gr] [int] NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Opis] [nvarchar](50) NOT NULL,
	[Znach] [money] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY],
 CONSTRAINT [S_Build_001] UNIQUE NONCLUSTERED 
(
	[Gr] ASC,
	[Code] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Employees]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Employees](
	[ID] [int] NOT NULL,
	[Fam] [nvarchar](255) NULL,
	[Im] [nvarchar](255) NULL,
	[Otch] [nvarchar](255) NULL,
	[Surname] [nvarchar](255) NULL,
	[Name] [nvarchar](255) NULL,
	[Posada] [nvarchar](255) NULL,
	[Vidil] [nvarchar](255) NULL,
	[E_mail] [nvarchar](255) NULL,
	[Tel_mob] [nvarchar](20) NULL,
	[Tel_vnut] [nvarchar](10) NULL,
	[Tel_home] [nvarchar](20) NULL,
	[Tel_work] [nvarchar](20) NULL,
	[Born] [datetime] NULL,
	[Company] [int] NULL,
	[Adress] [nvarchar](50) NULL,
	[Note] [nvarchar](200) NULL,
 CONSTRAINT [PK_S_employees] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Senderer]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
  Отправка по почте сообщений

  Пример использования
  EXEC SENDERER 'asavchenko@winner.ua;vpetrenko@winner.ua',
                'Вова сообщение о неоплаченных машинах',
                'Куча машин неполаченных',
                'SELECT left([FULL VIN],17), left(DLR,5), MODEL, VERSION FROM WINNER.DBO.A_STATUS WHERE ID_BRAND =2 AND ID_STATUS=3'

EXEC SENDERER 'asavchenko@winner.ua',
                'Информация о неоплаченных машинах',
                'Перечень неполаченных заказов',
                'SELECT left([FULL VIN],17), left(DLR,5), MODEL, VERSION FROM WINNER.DBO.A_STATUS WHERE ID_BRAND =2 AND ID_STATUS=3'
*/

CREATE PROCEDURE [dbo].[Senderer] 
                 @ADRESSA nvarchar(1000), 
                 @TEMA    nvarchar(200) , 
                 @TELO    nvarchar(4000),
                 @ZAPROS  nvarchar(MAX)
AS 

/*
EXEC msdb.dbo.sp_send_dbmail  
        @profile_name = 'Robot_mail' ,  
        @recipients   = @ADRESSA ,   
        @body         = @TELO , 
        @subject      = @TEMA
*/

/*
-- Пример использования функции
EXEC msdb.dbo.sp_send_dbmail
    @profile_name  = 'Robot_mail',
    @recipients    = @ADRESSA ,
    @query         = 'SELECT left(fio,20), note,tel_mob FROM WINNER.DBO.S_USER' ,
    @subject       = @TEMA,
    @attach_query_result_as_file = 0 ;

*/

-- EXECUTE AS USER='asavchenko'

-- в базе msdb необходимо добавить тот логин от имени которого будет отправлять сообщение
-- set @ADRESSA = @ADRESSA  + ';vpetrenko@winner.ua'


-- Чтобы отправить почтовое сообщение Database Mail, необходимо быть пользователем базы данных msdb и 
-- членом роли базы данных DatabaseMailUserRole в базе данных msdb. 
-- Чтобы добавить пользователей или группы msdb в эту роль, используйте среду SQL Server Management Studio
-- или выполните следующую инструкцию для пользователя или роли, которым требуется отправить сообщение Database Mail.
-- Даем доступ на віполнение процедуры всеми пользоваиелями домейна (или конкретному пользователю)
-- EXEC msdb.dbo.sp_addrolemember @rolename = 'DatabaseMailUserRole', @membername = 'wiu\domain users'

-- Можно поробовать
-- ALTER DATABASE [...] SET TRUSTWORTHY ON





-- Проверка работоспособности почты
-- http://msdn.microsoft.com/ru-ru/library/ms189959.aspx
-- Значение 0 указывает на то, что компонент Service Broker не активирован в базе данных msdb для доставки сообщений
-- SELECT is_broker_enabled FROM sys.databases WHERE name = 'msdb'

EXEC msdb.dbo.sp_send_dbmail
      @profile_name  = 'Robot_mail',
      @recipients    = @ADRESSA    ,
      @query         = @ZAPROS     ,
      @subject       = @TEMA       ,
      @attach_query_result_as_file = 0

/*
DECLARE @tableHTML  NVARCHAR(MAX) ;
SET @tableHTML =
    N'<H1>Work Order Report</H1>' +
    N'<table border="1">' +
    N'<tr><th>Work Order ID</th><th>Product ID</th>' +
    N'<th>Name</th><th>Order Qty</th><th>Due Date</th>' +
    N'<th>Expected Revenue</th></tr>' +
    CAST ( ( SELECT td = wo.WorkOrderID,       '',
                    td = p.ProductID, '',
                    td = p.Name, '',
                    td = wo.OrderQty, '',
                    td = wo.DueDate, '',
                    td = (p.ListPrice - p.StandardCost) * wo.OrderQty
              FROM AdventureWorks.Production.WorkOrder as wo
              JOIN AdventureWorks.Production.Product AS p
              ON wo.ProductID = p.ProductID
              WHERE DueDate > '2004-04-30'
                AND DATEDIFF(dd, '2004-04-30', DueDate) < 2 
              ORDER BY DueDate ASC,
                       (p.ListPrice - p.StandardCost) * wo.OrderQty DESC
              FOR XML PATH('tr'), TYPE 
    ) AS NVARCHAR(MAX) ) +
    N'</table>' ;

EXEC msdb.dbo.sp_send_dbmail @recipients='danw@Adventure-Works.com',
    @subject = 'Work Order List',
    @body = @tableHTML,
    @body_format = 'HTML' ;
*/
GO
/****** Object:  Table [dbo].[Base_Ford]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Base_Ford](
	[Zakaz] [nvarchar](255) NULL,
	[WIUO] [nvarchar](255) NULL,
	[Production_Month] [nvarchar](255) NULL,
	[Dealer_Order_Placed] [nvarchar](255) NULL,
	[Short_VIN] [nvarchar](255) NULL,
	[DLR] [nvarchar](255) NULL,
	[LOC] [nvarchar](255) NULL,
	[Status] [nvarchar](255) NULL,
	[MODEL] [nvarchar](255) NULL,
	[DERIVATIVE] [nvarchar](255) NULL,
	[VIN] [nvarchar](255) NULL,
	[ENGINE] [nvarchar](255) NULL,
	[Spec1] [nvarchar](255) NULL,
	[Spec2] [nvarchar](255) NULL,
	[Spec3] [nvarchar](255) NULL,
	[Optional] [nvarchar](255) NULL,
	[COLOUR] [nvarchar](255) NULL,
	[TRIM] [nvarchar](255) NULL,
	[Order_Type] [nvarchar](255) NULL,
	[COMMENTS] [nvarchar](255) NULL,
	[Model Year] [float] NULL,
	[CIF_CIP] [float] NULL,
	[Dealer Cost] [float] NULL,
	[MSRP] [float] NULL,
	[Order Placed] [datetime] NULL,
	[Dealer Cost checked] [datetime] NULL,
	[Req #] [datetime] NULL,
	[Production Confirmed] [datetime] NULL,
	[Production   REF#] [nvarchar](255) NULL,
	[OMDP / Planned ABS] [nvarchar](255) NULL,
	[Gate Release / ABS] [datetime] NULL,
	[Invoice Date] [datetime] NULL,
	[Compound Arrived] [datetime] NULL,
	[RLS] [nvarchar](255) NULL,
	[RLS placed] [datetime] NULL,
	[Compound RLS] [datetime] NULL,
	[RLS left Compound] [datetime] NULL,
	[WIU arrived] [datetime] NULL,
	[Contract Delivery Date] [datetime] NULL,
	[DLR Estimated Arrival] [datetime] NULL,
	[DLR Actual Arrival] [datetime] NULL,
	[Sold to DLR] [datetime] NULL,
	[Sold to Client] [datetime] NULL,
	[DAYS in Production] [float] NULL,
	[DAYS in Compound] [nvarchar](255) NULL,
	[DAYS in Delivery] [nvarchar](255) NULL,
	[DAYS at WIU] [nvarchar](255) NULL,
	[DAYS at DLR] [nvarchar](255) NULL,
	[DAYS   Total] [nvarchar](255) NULL,
	[Aging in Compound] [nvarchar](255) NULL,
	[Aging at DLR] [nvarchar](255) NULL,
	[Aging TOTAL] [nvarchar](255) NULL,
	[DLR PMNT] [money] NULL,
	[PMNT to Supplier] [money] NULL,
	[Plant] [nvarchar](255) NULL,
	[% WIU] [nvarchar](255) NULL,
	[DAYS in Route to Compound] [nvarchar](255) NULL,
	[Pure transport to UK days] [nvarchar](255) NULL,
	[Digression] [float] NULL,
	[Month] [nvarchar](255) NULL,
	[Stock Position] [nvarchar](255) NULL,
	[Поле62] [nvarchar](255) NULL,
	[Stock Position Fleet] [nvarchar](255) NULL,
	[Credit Line] [nvarchar](255) NULL,
	[Акційна дилерська ціна, грн] [float] NULL,
	[Current Dealer Price] [float] NULL,
	[Status 1] [nvarchar](255) NULL,
	[Note] [nvarchar](255) NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[A_Payments]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Payments]
AS
SELECT     ID, OPRID, DATE, CURR, RATE, SUM_CURR, IFIRMS, HFIRMS, DEALER, VIN, N_ORD, MARK, NOTE, IS_NEW, IS_CLOSED, EUR, SUM_EUR, NUM_DOC,
                       L_NUM, L_DATE, SUM_TOTAL
FROM         PAYMENTS..._PAYMENT AS _PAYMENT_1
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "_PAYMENT_1"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 114
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Payments'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Payments'
GO
/****** Object:  Table [dbo].[S_Config]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Config](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Sokr] [nvarchar](10) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Note] [nvarchar](50) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[U_Management]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[U_Management](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Notes] [nvarchar](50) NOT NULL,
	[Message] [nvarchar](200) NULL,
	[Variables] [nvarchar](200) NOT NULL,
 CONSTRAINT [PK_Management] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Country]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Country](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Sokr] [nvarchar](10) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Valute] [nvarchar](50) NOT NULL,
	[Note] [nvarchar](100) NULL,
	[Ang_Country] [nvarchar](100) NULL,
	[Path] [nvarchar](200) NULL,
	[Name_ang] [nvarchar](30) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Colours]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Colours](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Model] [int] NOT NULL,
	[Brend] [int] NOT NULL,
	[Version] [int] NULL,
	[Kod] [nvarchar](20) NULL,
	[Naz] [nvarchar](100) NULL,
 CONSTRAINT [PK__S_Colours__658C0CBD] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Department]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Department](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Sokr] [nvarchar](10) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Note] [nvarchar](50) NULL,
	[MailBoss] [nvarchar](100) NULL,
	[Ord] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[TotalDay]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[TotalDay] (@P1 int, @P2 int, @P3 int, @P4 int, @P5 int)
RETURNS INT
AS
BEGIN
   DECLARE @Alltotal int
   SET @Alltotal= ISNULL(@p1,0)+ISNULL(@p2,0)+ISNULL(@p3,0)+ISNULL(@p4,0)+ISNULL(@p5,0)
    --SET @Alltotal = @P1+@P2+@P3+@P4+@P5

   RETURN(@Alltotal)
END
GO
/****** Object:  Table [dbo].[S_Point]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Point](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Region] [int] NULL,
	[Brends] [int] NULL,
	[Diler] [int] NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Adres] [nvarchar](50) NULL,
	[City] [nvarchar](50) NULL,
	[Street] [nvarchar](50) NULL,
	[Post] [nvarchar](50) NULL,
	[Director] [nvarchar](50) NULL,
	[Manger] [nvarchar](50) NULL,
	[Secretar] [nvarchar](50) NULL,
	[Oblast] [int] NULL,
	[Country] [int] NULL,
	[Phone] [nvarchar](50) NULL,
	[Phone2] [nvarchar](50) NULL,
	[Phone3] [nvarchar](50) NULL,
	[Fax] [nvarchar](50) NULL,
	[Note] [nvarchar](250) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Currensy]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Currensy](
	[Code] [float] NULL,
	[Keys] [nvarchar](255) NULL,
	[Valutes] [nvarchar](255) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Colourk]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Colourk](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Brend] [int] NOT NULL,
	[Model] [int] NOT NULL,
	[Version] [int] NOT NULL,
	[Kod] [nvarchar](20) NULL,
	[Naz] [nvarchar](100) NULL,
	[Engine] [nvarchar](10) NULL,
	[Notes] [nvarchar](200) NULL,
 CONSTRAINT [PK__S_Colourk__63A3C44B] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Dr]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Dr](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [nchar](10) NULL,
	[Nazv] [nchar](10) NULL,
 CONSTRAINT [PK_DR] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Diler_Email]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Diler_Email](
	[IDS] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [float] NULL,
	[ID] [float] NULL,
	[Email] [nvarchar](255) NULL,
	[Obrabotka] [int] NULL,
 CONSTRAINT [PK_S_diler_email] PRIMARY KEY CLUSTERED 
(
	[IDS] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Up_Staus]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Проверка несовпадающих статусов которые выставил пользователь и расчитала функция
-- SELECT STATUS,STATUSS FROM W_ORDER WHERE BREND=2 and  Status != Statuss
-- EXEC Up_Status 1

CREATE PROCEDURE [dbo].[Up_Staus]  @Brand INT
AS

-- Обновление стаутса после закачки
UPDATE W_ORDER SET Status = Statuss WHERE Brend = @Brand
GO
/****** Object:  Table [dbo].[S_Country_2]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Country_2](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Code] [float] NULL,
	[Key_2] [nvarchar](255) NULL,
	[Key_3] [nvarchar](255) NULL,
	[Nazv] [nvarchar](255) NULL,
	[Procent] [int] NULL,
	[Pay] [money] NULL,
	[Priz] [int] NULL,
	[Path] [nvarchar](200) NULL,
	[Osoba] [nvarchar](50) NULL,
	[Tel] [nvarchar](20) NULL,
	[Fax] [nvarchar](20) NULL,
	[Adress] [nvarchar](200) NULL,
	[Vidpovidalyna] [nvarchar](50) NULL,
	[Srok] [nvarchar](20) NULL,
	[Zamovnuk] [nvarchar](50) NULL,
	[Pereveznik] [nvarchar](50) NULL,
	[Name_ang] [nvarchar](30) NULL,
 CONSTRAINT [PK_S_country_2] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Inet]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Inet](
	[ID] [nchar](10) NOT NULL,
	[FIO] [nchar](10) NULL,
	[NOMER] [nchar](10) NULL,
 CONSTRAINT [PK_INET] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Pakage]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Pakage](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Brend] [int] NOT NULL,
	[Model] [int] NOT NULL,
	[Vers] [int] NULL,
	[Naz] [nvarchar](400) NOT NULL,
	[Engine] [int] NULL,
	[Spec1] [nvarchar](50) NULL,
	[Spec2] [nvarchar](50) NULL,
	[Spec3] [nvarchar](50) NULL,
	[Colour] [int] NULL,
	[Colours] [int] NULL,
	[Trimm] [int] NULL,
	[GearBox] [int] NULL,
	[Cif_cip] [money] NULL,
	[Dealer_cost] [money] NULL,
	[MSRP] [money] NULL,
	[Exw] [money] NULL,
	[After] [money] NULL,
	[Before] [money] NULL,
	[Koef] [money] NULL,
	[Notes] [nvarchar](50) NULL,
	[Vubor] [int] NULL,
	[EngineTxt] [nvarchar](50) NULL,
	[Options] [nvarchar](200) NULL,
	[ModelTxt] [nvarchar](100) NULL,
	[Derevative] [nvarchar](100) NULL,
	[Codes] [nvarchar](30) NULL,
	[Versp] [int] NULL,
 CONSTRAINT [PK__W_Pakage__08012052] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Wiu_Payment]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Wiu_Payment](
	[IDS] [int] IDENTITY(1,1) NOT NULL,
	[F1] [int] NULL,
	[F2] [nvarchar](255) NULL,
	[F3] [nvarchar](255) NULL,
	[F4] [datetime] NULL,
	[F5] [money] NULL,
 CONSTRAINT [PK_W_WIU_Payment] PRIMARY KEY CLUSTERED 
(
	[IDS] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[KolDay]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[KolDay] (@DATE1 datetime, @DATE2 datetime)
RETURNS INT
AS
BEGIN
   DECLARE @ISO int
   SET @ISO= DATEDIFF(DAY,@DATE2,@DATE1)
   RETURN(@ISO)
END
GO
/****** Object:  Table [dbo].[W_Email]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Email](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Brend] [int] NULL,
	[Dlr] [int] NULL,
	[Dlr_name] [nvarchar](150) NULL,
	[Last_Name] [nvarchar](50) NULL,
	[Svvin] [nvarchar](30) NULL,
	[Loc_name] [nvarchar](50) NULL,
	[Brand] [nvarchar](255) NULL,
	[Model] [nvarchar](50) NULL,
	[WIU_Arrived] [datetime] NULL,
	[DaysAtDealer] [int] NULL,
	[Dealer_price] [money] NULL,
	[Payment] [money] NULL,
	[Debt] [money] NULL,
	[Procent] [money] NULL,
 CONSTRAINT [PK_W_Email] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[KolDay1]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[KolDay1] (@DATE1 datetime, @DATE2 datetime)
RETURNS INT
AS
BEGIN
   DECLARE @ISO int
   SET @ISO= DATEDIFF(DAY,ISNULL(@DATE2,GETDATE()),@DATE1)
   RETURN(@ISO)
END
GO
/****** Object:  StoredProcedure [dbo].[sp_helpTableField]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--exec sp_help     d_deyli_report, 'column_name'

create proc [dbo].[sp_helpTableField]
	@objname nvarchar(776) = NULL,		-- object name we're after
	@Field	nvarchar(50) = NULL			-- field name  we're after
as
	-- PRELIMINARY
	set nocount on
	declare	@dbname	sysname

	-- OBTAIN DISPLAY STRINGS FROM spt_values UP FRONT --
	declare @no varchar(35), @yes varchar(35), @none varchar(35)
	select @no = name from master.dbo.spt_values where type = 'B' and number = 0
	select @yes = name from master.dbo.spt_values where type = 'B' and number = 1
	select @none = name from master.dbo.spt_values where type = 'B' and number = 2

	-- If no @objname given, give a little info about all objects.
	if @objname is null
	begin
		-- DISPLAY ALL SYSOBJECTS --
		select
			'Name'			= o.name,
			'Owner'			= user_name(uid),
			'Object_type'	= substring(v.name,5,31)
		from sysobjects o, master.dbo.spt_values v
		where o.xtype = substring(v.name,1,2) and v.type = 'O9T'
		order by Object_type desc, Name asc

		print ' '

		-- DISPLAY ALL USER TYPES
		select
			'User_type'		= name,
			'Storage_type'	= type_name(xtype),
			'Length'		= length,
			'Prec'			= TypeProperty(name, 'precision'),
			'Scale'			= TypeProperty(name, 'scale'),
			'Nullable'		= case when TypeProperty(name, 'AllowsNull') = 1
											then @yes else @no end,
			'Default_name'	= isnull(object_name(tdefault), @none),
			'Rule_name'		= isnull(object_name(domain), @none)
		from systypes
		where xusertype > 256
		order by name

		return(0)
	end

	-- Make sure the @objname is local to the current database.
	select @dbname = parsename(@objname,3) 

	if @dbname is not null and @dbname <> db_name()
		begin
			raiserror(15250,-1,-1)
			return(1)
		end

	-- @objname must be either sysobjects or systypes: first look in sysobjects
	declare @objid int
	declare @sysobj_type char(2)
	select @objid = id, @sysobj_type = xtype from sysobjects where id = object_id(@objname)

	-- IF NOT IN SYSOBJECTS, TRY SYSTYPES --
	if @objid is null
	begin
		-- UNDONE: SHOULD CHECK FOR AND DISALLOW MULTI-PART NAME
		select @objid = xusertype from systypes where name = @objname

		-- IF NOT IN SYSTYPES, GIVE UP
		if @objid is null
		begin
			select @dbname=db_name()
			raiserror(15009,-1,-1,@objname,@dbname)
			return(1)
		end

		-- DATA TYPE HELP (prec/scale only valid for numerics)
		select
			'Type_name'		= name,
			'Storage_type'	= type_name(xtype),
			'Length'		= length,
			'Prec'			= TypeProperty(name, 'precision'),
			'Scale'			= TypeProperty(name, 'scale'),
			'Nullable'		= case when allownulls=1 then @yes else @no end,
			'Default_name'	= isnull(object_name(tdefault), @none),
			'Rule_name'		= isnull(object_name(domain), @none)
		from systypes
		where xusertype = @objid

		return(0)
	end

	-- FOUND IT IN SYSOBJECT, SO GIVE OBJECT INFO
	select
		'Name'				= o.name,
		'Owner'				= user_name(uid),
		'Type'				= substring(v.name,5,31),
		'Created_datetime'	= o.crdate
	from sysobjects o, master.dbo.spt_values v
	where o.id = @objid and o.xtype  = substring(v.name,1,2) and v.type = 'O9T'
		
	print ' '

	-- DISPLAY COLUMN IF TABLE / VIEW
	if @sysobj_type in ('S ','U ','V ')
	begin

		-- SET UP NUMERIC TYPES: THESE WILL HAVE NON-BLANK PREC/SCALE
		declare @numtypes nvarchar(80)
		select @numtypes = N'tinyint,smallint,decimal,int,real,money,float,numeric,smallmoney'

		-- INFO FOR EACH COLUMN
		print ' '
		select
			'Column_name'			= name,
			'Type'					= type_name(xusertype),
			'Computed'				= case when iscomputed = 0 then @no else @yes end,
			'Length'				= convert(int, length),
			'Prec'					= case when charindex(type_name(xtype), @numtypes) > 0
										then convert(char(5),ColumnProperty(id, name, 'precision'))
										else '     ' end,
			'Scale'					= case when charindex(type_name(xtype), @numtypes) > 0
										then convert(char(5),OdbcScale(xtype,xscale))
										else '     ' end,
			'Nullable'				= case when isnullable = 0 then @no else @yes end,
			'TrimTrailingBlanks'	= case ColumnProperty(@objid, name, 'UsesAnsiTrim')
										when 1 then @no
										when 0 then @yes
										else '(n/a)' end,
			'FixedLenNullInSource'	= case
						when type_name(xtype) not in ('varbinary','varchar','binary','char')
							Then '(n/a)'
						When status & 0x20 = 0 Then @no
						Else @yes END
		from syscolumns where id = @objid 
			and name like '%'+@Field+'%' -- Neeraj Hora
			order by colid
		-- IDENTITY COLUMN?
		print ' '
		declare @colname sysname
		select @colname = name from syscolumns where id = @objid
					and colstat & 1 = 1
		select
			'Identity'				= isnull(@colname,'No identity column defined.'),
			'Seed'					= ident_seed(@objname),
			'Increment'				= ident_incr(@objname),
			'Not For Replication'	= ColumnProperty(@objid, @colname, 'IsIDNotForRepl')

		-- ROWGUIDCOL?
		print ' '
		select @colname = null
		select @colname = name from syscolumns where id = @objid
					and ColumnProperty(@objid, name, 'IsRowGuidCol') = 1
		select 'RowGuidCol' = isnull(@colname,'No rowguidcol column defined.')

	end

	-- DISPLAY PROC PARAMS
	if @sysobj_type in ('P ') --RF too?
	begin
		-- ANY PARAMS FOR THIS PROC?
		if exists (select id from syscolumns where id = @objid)
		begin
			-- INFO ON PROC PARAMS
			print ' '
			select
				'Parameter_name'	= name,
				'Type'				= type_name(xusertype),
                'Length'			= length,
                'Prec'				= case when type_name(xtype) = 'uniqueidentifier' then xprec
										else OdbcPrec(xtype, length, xprec) end, 
                'Scale'				= OdbcScale(xtype,xscale),
                'Param_order'		= colid
			from syscolumns where id = @objid
		end
	end

	-- DISPLAY TABLE INDEXES & CONSTRAINTS
	if @sysobj_type in ('S ','U ')
	begin
		print ' '
		execute sp_objectfilegroup @objid
		print ' '
		execute sp_helpindex @objname
		print ' '
		execute sp_helpconstraint @objname,'nomsg'
	end
	else if @sysobj_type in ('V ')
	begin
		-- VIEWS DONT HAVE CONSTRAINTS, BUT PRINT THESE MESSAGES BECAUSE 6.5 DID
		print ' '
		raiserror(15469,-1,-1) -- No constraints defined
		print ' '
		raiserror(15470,-1,-1) --'No foreign keys reference this table.'
	end

	return (0) -- sp_help
GO
/****** Object:  Table [dbo].[W_Fc]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Fc](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Dat] [datetime] NULL,
	[Executor] [nvarchar](30) NULL,
	[Brand] [int] NULL,
	[Model] [int] NULL,
	[Vers] [int] NULL,
	[Num] [nvarchar](20) NOT NULL,
	[Rel_num] [nvarchar](20) NOT NULL,
	[Rel_dat] [datetime] NULL,
	[Sold_dat] [datetime] NULL,
	[Invoice_dat] [datetime] NULL,
	[Rate] [money] NULL,
	[Due_date] [datetime] NULL,
	[Day_line] [int] NULL,
	[Yes_no] [char](1) NULL,
	[Day_old] [int] NULL,
	[Day_left] [int] NULL,
	[Credit_bill] [money] NULL,
	[VIN] [nvarchar](20) NULL,
	[Model_txt] [nvarchar](50) NULL,
	[Due] [money] NULL,
	[Cost] [money] NULL,
	[Remarks] [nvarchar](100) NULL,
	[Priznak] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[W_Parts]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Parts](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Articul] [nvarchar](20) NULL,
	[Descript] [nvarchar](250) NULL,
	[Brand] [int] NULL,
	[Date] [datetime] NULL,
	[Date_update] [datetime] NULL,
	[Date_actual] [datetime] NULL,
	[Dealer] [int] NULL,
	[Change] [nvarchar](250) NULL,
	[Notes] [nvarchar](50) NULL,
	[Qty] [int] NULL,
	[Comments] [nvarchar](250) NULL,
	[Price_imp] [money] NULL,
	[Price_opt] [money] NULL,
	[Price_roz] [money] NULL,
	[Place] [int] NULL,
	[Vid] [int] NULL,
	[Flag] [int] NULL,
	[Priz] [int] NULL,
	[Zamena] [nvarchar](20) NULL,
	[Currency] [nvarchar](3) NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[St_tran]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[St_tran] ( @Br int ,
                          @Dat_start datetime,
                          @Dat_compl datetime)
RETURNS DATETIME
AS
BEGIN
DECLARE @Dvozvrat datetime

IF (@BR = 5)
    SET @Dvozvrat = @dat_start
ELSE
    SET @Dvozvrat = @dat_compl


RETURN (@Dvozvrat)
END
GO
/****** Object:  StoredProcedure [dbo].[Price_up_ford]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Увеличение цен и округление для форда
CREATE PROCEDURE [dbo].[Price_up_ford]
AS

-- Только Фиесты
UPDATE W_ORDER SET MSRP = MSRP * 1.29, 
                   DEALER_PRICE = DEALER_PRICE * 1.29
WHERE  BREND = 1 
AND    MODEL  IN (4,34,101)
AND    STATUS < 9


-- Кроме Фиест
UPDATE W_ORDER SET MSRP = MSRP * 1.25, 
                   DEALER_PRICE = DEALER_PRICE * 1.25
WHERE  BREND = 1 
AND    MODEL  NOT IN (4,34,101)
AND    STATUS < 9

-- Округление до 100
UPDATE W_ORDER SET MSRP = ROUND(MSRP+50,-2),  DEALER_PRICE = ROUND(DEALER_PRICE+50,-2)
WHERE  BREND = 1 
AND    Package IS NOT NULL
AND    Package <> 0
AND    STATUS < 9

-- Округление копеек
UPDATE W_ORDER SET MSRP         = ROUND(MSRP,0),  
                   DEALER_PRICE = ROUND(DEALER_PRICE,0)
WHERE  BREND = 1 
AND    STATUS < 9


/*

-- Увеличение цены кроме Фиесты на 15 %
SELECT ID,STATUS,Package, VERS, MSRP, MSRP * 1.15 MSRP_15, 
             DEALER_PRICE, DEALER_PRICE * 1.15 DC_11 
FROM   W_ORDER 
WHERE  BREND = 1 
AND    MODEL NOT IN (4,34,101)

-- Увеличение цены кроме Фиесты на 11 
SELECT ID,STATUS,Package, VERS, MSRP, MSRP * 1.11 MSRP_15, 
             DEALER_PRICE, DEALER_PRICE * 1.11 DC_11 
FROM   W_ORDER 
WHERE  BREND = 1 
AND    MODEL  IN (4,34,101)


-- Увеличение цены кроме Фиесты на 15 %
SELECT ID,STATUS,Package, VERS, MSRP, ROUND(((MSRP+50)),-1) MSRP_15, 
             DEALER_PRICE, ROUND(((DEALER_PRICE+50)),-1) DC_11 
FROM   W_ORDER 
WHERE  BREND = 1 
AND    MODEL NOT IN (4,34,101)
AND    Package IS NOT NULL
AND    Package <> 0


-- округление в большую сторону на 100 грн
PRINT ROUND(81321.135 + 50,-2)
PRINT ROUND(81321.55,0)

POWER

*/
GO
/****** Object:  Table [dbo].[S_Account]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Account](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Gr] [int] NULL,
	[Dk] [int] NOT NULL,
	[Acc] [nvarchar](50) NOT NULL,
	[Descr] [nvarchar](50) NOT NULL,
	[Remark] [nvarchar](100) NULL,
	[Priz] [int] NOT NULL,
	[Viev] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Day_Backup]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[Day_Backup]
AS
BACKUP DATABASE [Winner] 
TO  DISK = N'C:\data\MsSqlBackup\Dbase\Back_2008.bak' 
WITH  EXPIREDATE = N'01/10/2008 00:00:00', 
NOFORMAT, INIT,  
NAME = N'Winner-Full Database Backup', 
SKIP, NOREWIND, NOUNLOAD,  STATS = 10
GO
/****** Object:  UserDefinedFunction [dbo].[SPLIT]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
MS SQL Server Recursive T-SQL Split Function
Here you can find a t-sql split function which uses recursive CTE (common table expressions) structure in its source code.

This sample t-sql recursive split function will work with Microsoft SQL Server 2005 and MS SQL Server 2008 successfully.


Here is a sample usage of the t-sql SPLIT function in action

declare @s nvarchar(max)
select @s = N',,45 , 1, 56, 3456 456,8,5, ,d,1,1,4, 5 9 ,t,,,4,5 ,,,,, w, 3,,'
select * from dbo.split(@s,1,0)

*/


CREATE FUNCTION [dbo].[SPLIT]
(
@s nvarchar(max),
@trimPieces bit,
@returnEmptyStrings bit
)
returns @t table (val nvarchar(max))
as
begin

declare @i int, @j int
select @i = 0, @j = (LEN(@s) - LEN(replace(@s,',','')))

;with cte 
as
(
select
i = @i + 1,
s = @s, 
n = substring(@s, 0, charindex(',', @s)),
m = SUBSTRING(@s, charindex(',', @s) + 1, LEN(@s) - charindex(',', @s))

union all

select 
i = cte.i + 1,
s = cte.m, 
n = substring(cte.m, 0, charindex(',', cte.m)),
m = SUBSTRING(cte.m, charindex(',', cte.m) + 1, LEN(cte.m) - charindex(',', cte.m))
from cte
where i <= @j
)
insert into @t (val)
select pieces
from 
(
select 
case 
when @trimPieces = 1 then LTRIM(rtrim(case when i <= @j then n else m end))
else case when i <= @j then n else m end 
end
as pieces
from cte
) t
where
(@returnEmptyStrings = 0 and LEN(pieces) > 0) or (@returnEmptyStrings = 1)
option (maxrecursion 0)

return

end
GO
/****** Object:  Table [dbo].[S_DopPar]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_DopPar](
	[ID] [int] NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Znach] [nvarchar](50) NOT NULL,
	[Brend] [int] NOT NULL,
	[Models] [int] NULL,
	[Version] [int] NULL,
	[Spec] [int] NULL,
	[Notes] [nvarchar](50) NULL,
 CONSTRAINT [PK__S_DopPar__3F3159AB] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Random_password]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--exec random_password 100

CREATE PROC [dbo].[Random_password]
(
@len int = 8, --Length of the password to be generated
@password_type char(7) = 'simple' 
--Default is to generate a simple password with lowecase letters. 
--Pass anything other than 'simple' to generate a complex password. 
--The complex password includes numbers, special characters, upper case and lower case letters
)
AS
/*************************************************************************************************
		Copyright © 2001 Narayana Vyas Kondreddi. All rights reserved.
                                          
Purpose:	To generate a random password

Written by:	Narayana Vyas Kondreddi
		http://vyaskn.tripod.com

Tested on: 	SQL Server 7.0 and SQL Server 2000

Date modified:	March-29-2001 01:15 PM

Email: 		vyaskn@hotmail.com

Examples:

To generate a simple password with a length of 8 characters:
EXEC random_password

To generate a simple password with 6 characters:
EXEC random_password 6

To generate a complex password with 8 characters:
EXEC random_password @Password_type = 'complex'

To generate a comples password with 6 characters:
EXEC random_password 6, 'complex'
*************************************************************************************************/
BEGIN
DECLARE @password varchar(25), @type tinyint, @bitmap char(6)
SET @password='' 
SET @bitmap = 'uaeioy' 
--@bitmap contains all the vowels, which are a, e, i, o, u and y. These vowels are used to generate slightly readable/rememberable simple passwords

WHILE @len > 0
BEGIN
	IF @password_type = 'simple' --Generating a simple password
	BEGIN
	IF (@len%2) = 0  --Appending a random vowel to @password
		
		SET @password = @password + SUBSTRING(@bitmap,CONVERT(int,ROUND(1 + (RAND() * (5)),0)),1)
	ELSE --Appending a random alphabet
		SET @password = @password + CHAR(ROUND(97 + (RAND() * (25)),0))
		
	END
	ELSE --Generating a complex password
	BEGIN
		SET @type = ROUND(1 + (RAND() * (3)),0)

		IF @type = 1 --Appending a random lower case alphabet to @password
			SET @password = @password + CHAR(ROUND(97 + (RAND() * (25)),0))
		ELSE IF @type = 2 --Appending a random upper case alphabet to @password
			SET @password = @password + CHAR(ROUND(65 + (RAND() * (25)),0))
		ELSE IF @type = 3 --Appending a random number between 0 and 9 to @password
			SET @password = @password + CHAR(ROUND(48 + (RAND() * (9)),0))
		ELSE IF @type = 4 --Appending a random special character to @password
			SET @password = @password + CHAR(ROUND(33 + (RAND() * (13)),0))
	END

	SET @len = @len - 1
END

SELECT @password --Here's the result

END
GO
/****** Object:  UserDefinedFunction [dbo].[CntDay]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Должна быть установка даты
-- SET DATEFORMAT DMY
-- PRINT DBO.CNTDAY ('17/02/2008','10/02/2008')
-- PRINT DBO.CNTDAY ('03-02-2008',NULL)
-- PRINT DBO.CNTDAY (null,'03-02-2008')
*/

CREATE FUNCTION [dbo].[CntDay] (@DATE1 datetime, @DATE2 datetime)
RETURNS INT
AS
BEGIN
DECLARE @ISO int
----!!!!!!!!  SET     @ISO = ABS(DATEDIFF(DAY, ISNULL(@DATE2, CONVERT(VARCHAR(12),GETDATE(), 110)), @DATE1))

IF @DATE2 IS NULL
--   SET   @ISO = NULL
     SET   @ISO = 0
ELSE
   BEGIN
   IF @DATE1 IS NULL
      SET  @ISO = DATEDIFF(DAY, @DATE2, GETDATE())
   ELSE
      SET  @ISO = DATEDIFF(DAY, @DATE2 , @DATE1)
   END 
   RETURN(@ISO)
END

 --SET     @ISO = DATEDIFF(DAY, ISNULL(@DATE2, @DATE1), CONVERT(VARCHAR(12),GETDATE(), 110))
 --SET     @ISO = DATEDIFF(DAY,  @DATE2, ISNULL(@DATE1, CONVERT(VARCHAR(12),GETDATE(), 110)))
 --SET     @ISO = DATEDIFF(DAY, ISNULL(@DATE2, CONVERT(VARCHAR(12),GETDATE(), 110)), @DATE1)
 --SET     @ISO = ABS(DATEDIFF(DAY, ISNULL(@DATE2,'2008-02-04') , @DATE1))
--PRINT CONVERT(VARCHAR(12),GETDATE(), 21)
--PRINT DATEDIFF(DAY, ISNULL('04/02/2008', CONVERT(VARCHAR(12),GETDATE(), 5)), '01/02/2008')
--PRINT DATEDIFF(DAY, '01/02/2008',  '04/02/2008')
GO
/****** Object:  Table [dbo].[W_Reports_Ar]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Reports_Ar](
	[Id] [int] NOT NULL,
	[Vin] [nvarchar](17) NULL,
	[Loc] [nvarchar](50) NULL,
	[Model] [int] NULL,
	[Day_Ukraine] [int] NULL,
	[Payment_due] [int] NULL,
	[Dealer_price] [money] NULL,
	[Dealer_payment] [money] NULL,
	[Sum_currensy] [money] NULL,
	[Diff_eur] [money] NULL,
	[Procent] [money] NULL,
	[Curr] [int] NULL,
	[Brand] [int] NULL,
	[Priz] [int] NULL,
 CONSTRAINT [PK_W_reports_ar] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Timesheet_Report]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Timesheet_Report](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Year_number] [int] NOT NULL,
	[Week_number] [int] NOT NULL,
	[ID_Company] [int] NOT NULL,
	[ID_Department] [int] NOT NULL,
	[ID_Employee] [int] NOT NULL,
	[Id_Group] [int] NOT NULL,
	[Id_task] [int] NOT NULL,
	[Normal_time] [int] NOT NULL,
	[Over_time] [int] NOT NULL,
	[Total_time] [int] NOT NULL,
	[Week_closed] [int] NULL,
	[Changed] [datetime] NULL,
	[Approval] [nvarchar](1) NULL,
	[Remarks] [nvarchar](50) NOT NULL,
 CONSTRAINT [PK_W_Timesheet_Report] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Sp_lock2]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--exec sp_lock2 'winner'

CREATE PROC [dbo].[Sp_lock2]
(
@dbname sysname = NULL,
@spid int = NULL
)
AS
/*************************************************************************************************
		Copyright © 2001 Narayana Vyas Kondreddi. All rights reserved.
                                          
Purpose:	To display detailed lock information

Written by:	Narayana Vyas Kondreddi
		http://vyaskn.tripod.com

Tested on: 	SQL Server 7.0 and SQL Server 2000

Date modified:	August-13-2001 12:00 AM

Email: 		vyaskn@hotmail.com

Examples:

To see all the locks:
EXEC sp_lock2

To see all the locks in a particular database, say 'pubs':
EXEC sp_lock2 pubs

To see all the locks held by a particular spid, say 53:
EXEC sp_lock2 @spid = 53

To see all the locks held by a particular spid (23), in a particular database (pubs):
EXEC sp_lock2 pubs, 23
*************************************************************************************************/

BEGIN
SET NOCOUNT ON
CREATE TABLE #lock
(
	spid int,
	dbid int,
	ObjId int,
	IndId int,
	Type char(5),
	Resource char(20),
	Mode char(10),
	Status char(10)
)

INSERT INTO #lock EXEC sp_lock

IF @dbname IS NULL
BEGIN
	IF @spid IS NULL
	BEGIN
		SELECT a.spid AS SPID, 
		(SELECT DISTINCT program_name FROM master..sysprocesses WHERE spid = a.spid) AS [Program Name],
		db_name(dbid) AS [Database Name], ISNULL(object_name(ObjId),'') AS [Object Name],IndId, Type, Resource, Mode, Status
		FROM #lock a
	END
	ELSE
	BEGIN
		SELECT a.spid AS SPID, 
		(SELECT DISTINCT program_name FROM master..sysprocesses WHERE spid = a.spid) AS [Program Name],	
		db_name(dbid) AS [Database Name], ISNULL(object_name(ObjId),'') AS [Object Name],IndId, Type, Resource, Mode, Status
		FROM #lock a
		WHERE spid = @spid
	END
END
ELSE
BEGIN
	IF @spid IS NULL 
	BEGIN
		SELECT a.spid AS SPID,
		(SELECT DISTINCT program_name FROM master..sysprocesses WHERE spid = a.spid) AS [Program Name],		
		ISNULL(object_name(a.ObjId),'') AS [Object Name],a.IndId, 
		ISNULL((SELECT name FROM sysindexes WHERE id = a.objid and indid = a.indid ),'') AS [Index Name],
		a.Type, a.Resource, a.Mode, a.Status
		FROM #lock a
		WHERE dbid = db_id(@dbname)
	END
	ELSE
	BEGIN
		SELECT a.spid AS SPID,
		(SELECT DISTINCT program_name FROM master..sysprocesses WHERE spid = a.spid) AS [Program Name],
		ISNULL(object_name(a.ObjId),'') AS [Object Name],a.IndId, 
		ISNULL((SELECT name FROM sysindexes WHERE id = a.objid and indid = a.indid ),'') AS [Index Name],
		a.Type, a.Resource, a.Mode, a.Status
		FROM #lock a
		WHERE dbid = db_id(@dbname) AND spid = @spid			
	END
END

DROP TABLE #lock

END
GO
/****** Object:  Table [dbo].[S_Status_Pay]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Status_Pay](
	[Idd] [int] NOT NULL,
	[Naz] [nvarchar](50) NULL,
 CONSTRAINT [PK_S_status_pay] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[Sp_import_errorlog]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[Sp_import_errorlog]
(
	@log_name sysname,
	@log_number int = 0,
	@overwrite bit = 0
)
AS
/*************************************************************************************************
Purpose:	To import the SQL Server error log into a table, so that it can be queried

Written by:	Narayana Vyas Kondreddi
		http://vyaskn.tripod.com
		
Tested on: 	SQL Server 2000

Limitation: 	With error messages spanning more than one line only the first line is included in the table

Date modified:	April-16-2001 1:05 PM

Email: 		vyaskn@hotmail.com

Example 1: 	To import the current error log to table myerrorlog
		EXEC sp_import_errorlog 'myerrorlog'

Example 2: 	To import the current error log to table myerrorlog, and overwrite the table
		'myerrorlog' if it already exists
		EXEC sp_import_errorlog 'myerrorlog', @overwrite = 1

Example 3: 	To import the previous error log to table myerrorlog
		EXEC sp_import_errorlog 'myerrorlog', 1

Example 4: 	To import the second previous error log to table myerrorlog
		EXEC sp_import_errorlog 'myerrorlog', 2

*************************************************************************************************/

BEGIN
	SET NOCOUNT ON
	
	DECLARE @sql varchar(500) --Holds to SQL needed to create columns from error log

	IF (SELECT OBJECT_ID(@log_name,'U')) IS NOT NULL
		BEGIN
			IF @overwrite = 0
				BEGIN
					RAISERROR('Table already exists. Specify another name or pass 1 to @overwrite parameter',18,1)
					RETURN -1
				END
			ELSE
				BEGIN
					EXEC('DROP TABLE ' + @log_name)
				END
		END

	
	--Temp table to hold the output of sp_readerrorlog
	CREATE TABLE #errlog
	(
		err varchar(1000),
		controw tinyint
	)

	--Populating the temp table using sp_readerrorlog
	INSERT #errlog 
	EXEC sp_readerrorlog @log_number

	--This will remove the header from the errolog
	SET ROWCOUNT 4
	DELETE #errlog
	SET ROWCOUNT 0

	
	SET @sql = 	'SELECT 
				 CONVERT(DATETIME,LEFT(err,23)) [Date], 
				 SUBSTRING(err,24,10) [spid], 
				 RIGHT(err,LEN(err) - 33) [Message], 
				 controw 
			     INTO ' + QUOTENAME(@log_name) + 
			   ' FROM #errlog ' + 
			   ' WHERE controw = 0'
	
	--Creates the table with the columns Date, spid, message and controw
	EXEC (@sql)	
	
	--Dropping the temporary table
	DROP TABLE #errlog
	
	SET NOCOUNT OFF
PRINT 'Error log successfully imported to table: ' + @log_name
END
GO
/****** Object:  Table [dbo].[S_D]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[S_D](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Region] [int] NULL,
	[Code] [char](20) NULL,
	[Naz] [nvarchar](150) NULL,
	[Sokr] [nvarchar](50) NULL,
	[Last_Name] [nvarchar](50) NULL,
	[Adres] [nvarchar](100) NULL,
	[Dir] [nvarchar](50) NULL,
	[Zam] [nvarchar](50) NULL,
	[Buch] [nvarchar](50) NULL,
	[Manedger] [nvarchar](50) NULL,
	[Email] [nvarchar](50) NULL,
	[Tel] [nvarchar](50) NULL,
	[Fax] [nvarchar](50) NULL,
	[Mob] [nvarchar](50) NULL,
	[Note] [nvarchar](250) NULL,
	[Cl1] [money] NULL,
	[Cl2] [money] NULL,
	[Cl3] [money] NULL,
	[Cl4] [money] NULL,
	[Account] [nvarchar](30) NULL,
	[Bank] [nvarchar](100) NULL,
	[Edrpou] [nvarchar](50) NULL,
	[Pin] [nvarchar](50) NULL,
	[Pdv] [nvarchar](30) NULL,
	[Brand] [nvarchar](50) NULL,
	[Statut] [nvarchar](10) NULL,
	[B_Name] [nvarchar](50) NULL,
	[B_Mfo] [nvarchar](6) NULL,
	[B_Adress] [nvarchar](50) NULL,
	[B_Fhone] [nvarchar](50) NULL,
	[B_Mob] [nvarchar](10) NULL,
	[B_Fax] [nvarchar](50) NULL,
	[B_Director] [nvarchar](50) NULL,
	[B_Buch] [nvarchar](50) NULL,
	[B_Manager] [nvarchar](200) NULL,
	[B_Oper] [nvarchar](200) NULL,
	[B_Tel_oper] [nvarchar](50) NULL,
	[B_Email] [nvarchar](50) NULL,
	[Dogovor] [nvarchar](15) NULL,
	[Dogovor_data] [smalldatetime] NULL,
	[Fin_code] [int] NULL,
	[Sokr_naz] [nvarchar](300) NULL,
	[Bank_ukr] [nvarchar](300) NULL,
	[Edrpo] [nvarchar](20) NULL,
	[Svid] [nvarchar](20) NULL,
	[IndNomer] [nvarchar](20) NULL,
	[Direktor] [nvarchar](50) NULL,
	[Sokr_naz_ang] [nvarchar](300) NULL,
	[Bank_ukr_ang] [nvarchar](300) NULL,
	[Edrpo_ang] [nvarchar](20) NULL,
	[Svid_ang] [nvarchar](20) NULL,
	[IndNomer_ang] [nvarchar](20) NULL,
	[Direktor_ang] [nvarchar](50) NULL,
	[Adres_avto_ukr] [nvarchar](250) NULL,
	[Adres_avto_ang] [nvarchar](250) NULL,
	[Adres_unload] [nvarchar](100) NULL,
 CONSTRAINT [PK_S_D] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  StoredProcedure [dbo].[Price_up]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Увеличение цены на Фиесты на 11 %
--EXEC Price_up '2,3,4,5', 1.12 

CREATE PROCEDURE [dbo].[Price_up] (@Brands   NVARCHAR(30),
                           @Upprice  MONEY)
AS
               
/*
SELECT VERS, MSRP, MSRP * 1.12 MSRP_11, 
       DEALER_PRICE,DEALER_PRICE * 1.12 DC_11 
FROM   W_ORDER 
WHERE  BREND IN (2,3,4,5) 
*/

/*
-- Поднятие цен на PAG на 15 процентов с округлением до рубля
UPDATE W_order 
SET    MSRP         = ROUND((MSRP * 1.12),0), 
       DEALER_PRICE = ROUND(((DEALER_PRICE)* 1.12),0)
FROM   W_ORDER 
WHERE  BREND IN (2,3,4,5) 
*/
UPDATE W_order 
SET    MSRP         = ROUND((MSRP * @Upprice),0), 
       DEALER_PRICE = ROUND(((DEALER_PRICE)* @Upprice),0)
FROM   W_ORDER 
WHERE  BREND IN (@Brands) 

-- округление в большую сторону на 100 грн
-- PRINT ROUND(81321.135 + 100,0)
GO
/****** Object:  StoredProcedure [dbo].[Write_to_file]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--use winner

/*
  Written by: Narayana Vyas Kondreddi
  Date written: January 12th 2001
  Purpose: To log messages to text files from stored procedures/triggers/sql scripts
  Input parameters: message, file name, overwrite flag (1 to overwrite, 0 to append to file, 0 is the default)
  Example: EXEC write_to_file 'Duplicates found','C:\logfile.txt',0
  Tested on: SQL Server Version 7.0, 2000
  Remarks: You should have permissions required through access file system through xp_cmdshell
           See SQL Server Books Online for xp_cmdshell if you are having problems with this procedure
  Email: answer_me@hotmail.com
  Homepage: http://vyaskn.tripod.com
*/

CREATE PROC [dbo].[Write_to_file]
@msg VARCHAR(100),
@file VARCHAR(100),
@overwrite BIT = 0
AS
BEGIN
	SET NOCOUNT ON
	DECLARE @execstr VARCHAR(255)
	SET @execstr = RTRIM('echo ' + COALESCE(LTRIM(@msg),'-') + CASE WHEN (@overwrite = 1) THEN ' > ' ELSE ' >> ' END + RTRIM(@file))
	EXEC master..xp_cmdshell @execstr
	SET NOCOUNT OFF
END
GO
/****** Object:  Table [dbo].[S_Approval]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Approval](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Descr] [nvarchar](1000) NULL,
	[Priz] [int] NULL,
	[Viev] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[For_reporting]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[For_reporting]
AS
SELECT     dbo.S_Brend.Naz AS Brand, dbo.S_Status.Naz AS Status, dbo.W_Order.Dlrs, dbo.W_Order.ID, dbo.W_Order.Status AS Id_status
FROM         dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Status ON dbo.W_Order.Status = dbo.S_Status.ID LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID
GO
/****** Object:  StoredProcedure [dbo].[View_Brend]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[View_Brend] (@IBrand int)
AS
SET NOCOUNT ON
SELECT ID, ZAKAZ, D_ZAKAZA FROM W_ORDER WHERE BREND=@IBrand
GO
/****** Object:  Table [dbo].[W_Firms]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Firms](
	[Код] [int] IDENTITY(1,1) NOT NULL,
	[ifirms] [float] NULL,
	[hfirms] [nvarchar](255) NULL,
	[dealer] [nvarchar](255) NULL,
	[mark] [nvarchar](255) NULL,
	[is_new] [bit] NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[A_Ts_manag]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Ts_manag]
AS
SELECT     Company, Week_namber, Week_day, Employee, COUNT(Finish - Start) AS Hourses
FROM         dbo.W_Timesheet
GROUP BY Week_namber, Week_day, Company, Employee
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Timesheet"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 309
               Right = 246
            End
            DisplayFlags = 280
            TopColumn = 3
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 2865
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_manag'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_manag'
GO
/****** Object:  StoredProcedure [dbo].[Ford_cc]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[Ford_cc] @IDBRAND INT
AS

--SELECT * FROM S_ENGENIE WHERE BREND=1
CREATE TABLE #FENGINE ([Pid] [int] IDENTITY(1,1) NOT NULL,
                      naz NVARCHAR(40), 
                      vol INT)

 -- SP_HELP S_ENGENIE

INSERT #FENGINE VALUES('1.25 Duratec-16V(Sigma)75PS',1242)
INSERT #FENGINE VALUES('1.3 Duratec-8V(Rocam)70PS',1299)
INSERT #FENGINE VALUES('1.4 Duratec-16V(Sigma)80PS',1388)
INSERT #FENGINE VALUES('1.4 Duratorq-TDCi(DV)68PS',1399)
INSERT #FENGINE VALUES('1.6 Duratec-16V(Sigma)100PS',1596)
INSERT #FENGINE VALUES('1.6 Duratec-16V(Sigma)110PS',1596)
INSERT #FENGINE VALUES('1.6 Duratec-Ti-VCT(Sigma)110PS',1596)
INSERT #FENGINE VALUES('1.6 Duratec-Ti-VCT(Sigma)115PS',1596)
INSERT #FENGINE VALUES('1.6 Duratec-Ti-VCT(Sigma)125PS',1596)
INSERT #FENGINE VALUES('1.6 Duratorq-TDCi(DV)110PS',1560)
INSERT #FENGINE VALUES('1.6 Duratorq-TDCi(DV)90PS',	1560)
INSERT #FENGINE VALUES('1.8 Duratec-HE(MI4)110PS',1798)
INSERT #FENGINE VALUES('1.8 Duratec-HE(MI4)125PS',1798)
INSERT #FENGINE VALUES('1.8 Duratorq-TDCi(Lynx)100PS',1753)
INSERT #FENGINE VALUES('1.8 Duratorq-TDCi(Lynx)110PS',1753)
INSERT #FENGINE VALUES('1.8 Duratorq-TDCi(Lynx)115PS',1753)
INSERT #FENGINE VALUES('1.8 Duratorq-TDCi(Lynx)125PS',1753)
INSERT #FENGINE VALUES('1.8 Duratorq-TDCi(Lynx)75PS',1753)
INSERT #FENGINE VALUES('1.8 Duratorq-TDCi(Lynx)90PS',1753)
INSERT #FENGINE VALUES('2.0 Duratec-HE(MI4)145PS',1999)
INSERT #FENGINE VALUES('2.0 Duratec-ST(MI4)150PS',1999)
INSERT #FENGINE VALUES('2.0 Duratorq-TDCi 135PS DPF 2WD',1997)
INSERT #FENGINE VALUES('2.0 Duratorq-TDCi 135PS DPF 4WD',1997)
INSERT #FENGINE VALUES('2.0 Duratorq-TDCi(DW)130PS DPF',1997)
INSERT #FENGINE VALUES('2.0 Duratorq-TDCi(DW)135PS',1997)
INSERT #FENGINE VALUES('2.0 Duratorq-TDCi(DW)135PS DPF',1997)
INSERT #FENGINE VALUES('2.0 Duratorq-TDCi(DW)140PS',1997)
INSERT #FENGINE VALUES('2.0 Duratorq-TDCi(DW)140PS DPF',1997)
INSERT #FENGINE VALUES('2.0 Duratorq-TDCi(Puma)130PS',1997)
INSERT #FENGINE VALUES('2.2 Duratorq-TDCi(Puma)110PS',2198)
INSERT #FENGINE VALUES('2.2 Duratorq-TDCi(Puma)130PS',2198)
INSERT #FENGINE VALUES('2.2 Duratorq-TDCi(Puma)140PS',2198)
INSERT #FENGINE VALUES('2.2 Duratorq-TDCi(Puma)85PS',2198)
INSERT #FENGINE VALUES('2.3 Duratec 161PS',2261)
INSERT #FENGINE VALUES('2.3 Duratec-HE(MI4)145PS',2261)
INSERT #FENGINE VALUES('2.4 Duratorq-TDCi(Puma)100PS',2402)
INSERT #FENGINE VALUES('2.4 Duratorq-TDCi(Puma)115PS',2402)
INSERT #FENGINE VALUES('2.4 Duratorq-TDCi(Puma)140PS',2402)
INSERT #FENGINE VALUES('2.4 TCI 115 PS',2402)
INSERT #FENGINE VALUES('2.5 Duratec(RNC I5)220PS',2521)
INSERT #FENGINE VALUES('2.5 Duratec-ST(VI5)220PS',2521)
INSERT #FENGINE VALUES('2.5 Duratec-ST(VI5)225PS',2521)
INSERT #FENGINE VALUES('2.5 TDCi 143PS',2521)
INSERT #FENGINE VALUES('3.2 Duratorq-TDCi(Puma)200PS',3199)
GO
/****** Object:  Table [dbo].[S_Organ]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Organ](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Nam] [nvarchar](50) NULL,
	[Nam_ang] [nvarchar](50) NULL,
	[Nam_ukr] [nvarchar](50) NULL,
	[City] [nvarchar](50) NULL,
	[Street] [nvarchar](50) NULL,
	[Post] [nvarchar](50) NULL,
	[Director] [nvarchar](50) NULL,
	[Manger] [nvarchar](50) NULL,
	[Secretar] [nvarchar](50) NULL,
	[Region] [nvarchar](50) NULL,
	[Country] [nvarchar](50) NULL,
	[Phone] [nvarchar](50) NULL,
	[Phone2] [nvarchar](50) NULL,
	[Phone3] [nvarchar](50) NULL,
	[Fax] [nvarchar](50) NULL,
	[E_mail] [nvarchar](50) NULL,
	[Note] [nvarchar](50) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[RVIN]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[RVIN] (@Brand  AS INTEGER, @Vinn AS NVARCHAR(20))
RETURNS VARCHAR (30)
AS  
BEGIN 
DECLARE @PeriodName VARCHAR(30)

    SET @PeriodName =
    CASE 
        WHEN @Brand=1  THEN RIGHT(@VINn,11)
        WHEN @Brand=2  THEN RIGHT(@VINn,6)
        ELSE                RIGHT(@VINn,8) 
    END 
  RETURN @PeriodName
END
GO
/****** Object:  View [dbo].[Report_land_rover]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Report_land_rover]
AS
SELECT     TOP (100) PERCENT Zakaz, D_zakaza, Brend, Sorder, Wiou, VIN, PMNT_Supplier, DLR_Payment, Pymnt_SUM_CURR, Pymnt_CURR, Pymnt_EUR, 
                      Pymnt_NOTE, Pymnt_SUM_TOTAL, Status, Days_in_prod, Days_Compound, Days_deliv, Days_WIU, DAYS_DLR, Days_Total
FROM         dbo.W_Order AS W_Order
WHERE     (Brend = 4) AND (Status <> 9) AND (Status <> 12)
ORDER BY Status, VIN
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 291
               Right = 300
            End
            DisplayFlags = 280
            TopColumn = 45
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Report_land_rover'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Report_land_rover'
GO
/****** Object:  StoredProcedure [dbo].[spDBA_FixOrphanUsers]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[spDBA_FixOrphanUsers]
AS
DECLARE @username VARCHAR(25)
DECLARE GetOrphanUsers CURSOR
FOR
SELECT UserName = name
FROM sysusers
WHERE issqluser = 1
AND (sid IS NOT NULL
AND sid <> 0x0)
AND SUSER_SNAME(sid) IS NULL
ORDER BY name
OPEN GetOrphanUsers
FETCH NEXT
FROM GetOrphanUsers
INTO @username
WHILE @@FETCH_STATUS = 0
BEGIN
IF @username='dbo'
EXEC sp_changedbowner 'sa'
ELSE
EXEC sp_change_users_login 'update_one', @username, @username
FETCH NEXT
FROM GetOrphanUsers
INTO @username
END
CLOSE GetOrphanUsers
DEALLOCATE GetOrphanUsers
GO
/****** Object:  Table [dbo].[Other_Date]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Other_Date](
	[Vin] [nvarchar](50) NULL,
	[Date] [datetime] NULL,
	[Brand] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[SelBrand]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		Savchenko Arthur
-- Create date: 20-01-2009
-- Description:	Preview Count Car
-- exec selbrand 2
-- =============================================
CREATE PROCEDURE [dbo].[SelBrand] (@NumbBrand INT=1)
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
	SELECT * FROM W_ORDER WHERE Brend=@NumbBrand AND Status<9
END
GO
/****** Object:  StoredProcedure [dbo].[spDBA_FixOrphanUsersPassWord]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*Following Stored Procedure will fix all the Orphan users in database
by creating the server level user selecting same password as username.
Make sure that you change all the password once users are created*/
CREATE PROCEDURE [dbo].[spDBA_FixOrphanUsersPassWord]
AS
DECLARE @username VARCHAR(25)
DECLARE @password VARCHAR(25)
DECLARE GetOrphanUsers CURSOR
FOR
SELECT UserName = name
FROM sysusers
WHERE issqluser = 1
AND (sid IS NOT NULL
AND sid <> 0x0)
AND SUSER_SNAME(sid) IS NULL
ORDER BY name
OPEN GetOrphanUsers
FETCH NEXT
FROM GetOrphanUsers
INTO @username
SET @password = @username
WHILE @@FETCH_STATUS = 0
BEGIN
IF @username='dbo'
EXEC sp_changedbowner 'sa'
ELSE
EXEC sp_change_users_login 'Auto_Fix', @username, NULL, @password
FETCH NEXT
FROM GetOrphanUsers
INTO @username
END
CLOSE GetOrphanUsers
DEALLOCATE GetOrphanUsers
GO
/****** Object:  Table [dbo].[Exceptions]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Exceptions](
	[Vin] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[VOL_ENG_FORD]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--DECLARE @@VOL INT
--DECLARE @@ENG NVARCHAR(30)
--SET @@ENG = '1.25 Duratec-16V(Sigma)75PS'


--PRINT DBO.VOL_ENG_FORD ('1.6 Duratec-Ti-VCT(Sigma)115PS')

-- Обновление обїема двигателя
/*
 UPDATE S_ENGENIE SET VOL = DBO.VOL_ENG_FORD ([NAZ]) WHERE BREND=1
 SELECT * FROM S_ENGENIE WHERE BREND=1 ORDER BY VOL
*/
CREATE FUNCTION [dbo].[VOL_ENG_FORD] (@@ENG VARCHAR(80))
RETURNS int
AS
BEGIN
DECLARE @@VOL  INT
     SET @@VOL = CASE @@ENG 
                 WHEN '1.25 Duratec-16V(Sigma)75PS'      THEN 1242
                 WHEN '1.3 Duratec-8V(Rocam)70PS'        THEN 1299
                 WHEN '1.4 Duratec-16V(Sigma)80PS'       THEN 1388
                 WHEN '1.4 Duratorq-TDCi(DV)68PS'        THEN 1399
                 WHEN '1.6 Duratec-16V(Sigma)100PS'      THEN 1596
                 WHEN '1.6 Duratec-16V(Sigma)110PS'      THEN 1596
                 WHEN '1.6 Duratec-Ti-VCT(Sigma)110PS'   THEN 1596
                 WHEN '1.6 Duratec-Ti-VCT(Sigma)115PS'   THEN 1596
                 WHEN '1.6 Duratec-Ti-VCT(Sigma)125PS'   THEN 1596
                 WHEN '1.6 Duratorq-TDCi(DV)110PS'       THEN 1560
                 WHEN '1.6 Duratorq-TDCi(DV)90PS'        THEN 1560
                 WHEN '1.8 Duratec-HE(MI4)110PS'         THEN 1798
                 WHEN '1.8 Duratec-HE(MI4)125PS'         THEN 1798
                 WHEN '1.8 Duratorq-TDCi(Lynx)100PS'     THEN 1753
                 WHEN '1.8 Duratorq-TDCi(Lynx)110PS'     THEN 1753
                 WHEN '1.8 Duratorq-TDCi(Lynx)115PS'     THEN 1753
                 WHEN '1.8 Duratorq-TDCi(Lynx)125PS'     THEN 1753
                 WHEN '1.8 Duratorq-TDCi(Lynx)75PS'      THEN 1753
                 WHEN '1.8 Duratorq-TDCi(Lynx)90PS'      THEN 1753
                 WHEN '2.0 Duratec-HE(MI4)145PS'         THEN 1999
                 WHEN '2.0 Duratec-ST(MI4)150PS'         THEN 1999
                 WHEN '2.0 Duratorq-TDCi 135PS DPF 2WD'  THEN 1997
                 WHEN '2.0 Duratorq-TDCi 135PS DPF 4WD'  THEN 1997
                 WHEN '2.0 Duratorq-TDCi(DW)130PS DPF'   THEN 1997
                 WHEN '2.0 Duratorq-TDCi(DW)135PS'       THEN 1997
                 WHEN '2.0 Duratorq-TDCi(DW)135PS DPF'   THEN 1997
                 WHEN '2.0 Duratorq-TDCi(DW)140PS'       THEN 1997
                 WHEN '2.0 Duratorq-TDCi(DW)140PS DPF'   THEN 1997
                 WHEN '2.0 Duratorq-TDCi(Puma)130PS'     THEN 1997
                 WHEN '2.2 Duratorq-TDCi(Puma)110PS'     THEN 2198
                 WHEN '2.2 Duratorq-TDCi(Puma)130PS'     THEN 2198
                 WHEN '2.2 Duratorq-TDCi(Puma)140PS'     THEN 2198
                 WHEN '2.2 Duratorq-TDCi(Puma)85PS'      THEN 2198
                 WHEN '2.3 Duratec 161PS'                THEN 2261
                 WHEN '2.3 Duratec-HE(MI4)145PS'         THEN 2261
                 WHEN '2.4 Duratorq-TDCi(Puma)100PS'     THEN 2402
                 WHEN '2.4 Duratorq-TDCi(Puma)115PS'     THEN 2402
                 WHEN '2.4 Duratorq-TDCi(Puma)140PS'     THEN 2402
                 WHEN '2.4 TCI 115 PS'                   THEN 2402
                 WHEN '2.5 Duratec(RNC I5)220PS'         THEN 2521
                 WHEN '2.5 Duratec-ST(VI5)220PS'         THEN 2521
                 WHEN '2.5 Duratec-ST(VI5)225PS'         THEN 2521
                 WHEN '2.5 TDCi 143PS'                   THEN 2521
                 WHEN '3.2 Duratorq-TDCi(Puma)200PS'     THEN 3199
                 ELSE 0 
END
RETURN @@VOL
END
GO
/****** Object:  Table [dbo].[S_Pay]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Pay](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Dc]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Dc](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Descr] [nvarchar](1000) NOT NULL,
	[Priz] [int] NOT NULL,
	[Viev] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  StoredProcedure [dbo].[spDBA_DropOrphanUsers]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[spDBA_DropOrphanUsers]
AS
DECLARE @username VARCHAR(25)
DECLARE GetOrphanUsers CURSOR
FOR
SELECT UserName = name
FROM sysusers
WHERE issqluser = 1
AND (sid IS NOT NULL
AND sid <> 0x0)
AND SUSER_SNAME(sid) IS NULL
ORDER BY name
OPEN GetOrphanUsers
FETCH NEXT
FROM GetOrphanUsers
INTO @username
WHILE @@FETCH_STATUS = 0
BEGIN
IF @username='dbo'
EXEC sp_changedbowner 'sa'
ELSE
EXEC sp_dropuser @username
FETCH NEXT
FROM GetOrphanUsers
INTO @username
END
CLOSE GetOrphanUsers
DEALLOCATE GetOrphanUsers
GO
/****** Object:  Table [dbo].[S_Pakage_sub]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Pakage_sub](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Idd] [int] NULL,
	[Optional] [int] NOT NULL,
	[Price] [money] NOT NULL,
	[Notes] [nvarchar](250) NULL,
	[Vers] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Ttn]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Ttn](
	[Num] [int] IDENTITY(1,1) NOT NULL,
	[Avtovoz] [int] NULL,
	[Otpravnik] [int] NULL,
	[Oderjuvach] [int] NULL,
	[Perevoz] [int] NULL,
	[P_navantaj] [nvarchar](100) NULL,
	[P_razvant] [nvarchar](100) NULL,
	[Dat] [smalldatetime] NULL,
	[Remarks] [nvarchar](200) NULL,
	[Vub] [int] NULL,
	[Deleted] [int] NULL,
	[Dat_deleted] [smalldatetime] NULL,
	[Ves] [int] NULL,
	[Loc] [int] NULL,
	[Type] [int] NULL,
	[Adress_unloaded] [int] NULL,
 CONSTRAINT [PK_W_Ttn] PRIMARY KEY CLUSTERED 
(
	[Num] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=495 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер ТТН' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Otpravnik'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Otpravnik'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=885 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Otpravnik'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Отправник' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Otpravnik'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Oderjuvach'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Oderjuvach'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=1020 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Oderjuvach'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Отримувач' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Oderjuvach'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Perevoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Perevoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=765 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Perevoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Отримувач' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Perevoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'P_navantaj'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'P_navantaj'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=2055 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'P_navantaj'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Пункт навантаження' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'P_navantaj'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'P_razvant'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'P_razvant'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'P_razvant'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Пункт развантаження' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'P_razvant'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Dat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Dat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Dat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Remarks'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Remarks'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Remarks'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Vub'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Vub'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Vub'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Deleted'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Deleted'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Deleted'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Признак удаления -1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Deleted'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Dat_deleted'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Dat_deleted'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Dat_deleted'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата удаления' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn', @level2type=N'COLUMN',@level2name=N'Dat_deleted'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DefaultView', @value=0x02 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Filter', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderBy', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderByOn', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Orientation', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_TableMaxRecords', @value=10000 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn'
GO
/****** Object:  Table [dbo].[W_Vic]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Vic](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Id_Order] [int] NULL,
	[Brend] [int] NULL,
	[Model] [int] NULL,
	[Vers] [int] NULL,
	[Dlr] [int] NULL,
	[Carrier] [int] NULL,
	[Vin] [varchar](20) NULL,
	[Avtovoz] [int] NULL,
	[Act] [varchar](30) NULL,
	[Numb_acc] [varchar](30) NULL,
	[Date_acc] [datetime] NULL,
	[Sum_acc] [money] NULL,
	[Fraxt] [money] NULL,
	[Date_Act] [datetime] NULL,
	[Color_body] [int] NULL,
	[Vic_place] [int] NULL,
	[Invoice] [nvarchar](20) NULL,
	[Inspector] [int] NULL,
	[Prinial] [varchar](30) NULL,
	[Vikonav] [varchar](30) NULL,
	[Rls] [varchar](30) NULL,
	[Damage] [int] NULL,
	[Hold_inform] [varchar](30) NULL,
	[Date_rls] [datetime] NULL,
	[Date_fix] [datetime] NULL,
	[Date_change] [datetime] NULL,
	[Date_Repair] [datetime] NULL,
	[Date_Income] [datetime] NULL,
	[Date_Ready] [datetime] NULL,
	[Date_vic] [datetime] NULL,
	[Date_hold_start] [datetime] NULL,
	[Date_hold_finish] [datetime] NULL,
	[Date_expected] [datetime] NULL,
	[Date_out] [datetime] NULL,
	[Date_actual_ship] [datetime] NULL,
	[Date_actual_delivery] [datetime] NULL,
	[Days_vic] [int] NULL,
	[Days_incoming] [int] NULL,
	[Days_actual_ship] [int] NULL,
	[Days_deference] [int] NULL,
	[Qty_vechicles] [int] NULL,
	[Qty_ok] [int] NULL,
	[Flag] [int] NULL,
	[Description] [varchar](255) NULL,
	[Driver] [int] NULL,
	[Ttns] [nvarchar](100) NULL,
	[Car] [int] NULL,
	[Place] [int] NULL,
	[Pdi_order_date] [datetime] NULL,
	[Description_pdi] [varchar](255) NULL,
	[Pdi_ready] [int] NULL,
	[Qnty] [nvarchar](50) NULL,
 CONSTRAINT [PK__W_Vic__14FCBF6B] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[W_Vic_Sub]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Vic_Sub](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Ids] [int] NULL,
	[Date] [datetime] NOT NULL,
	[Date_update] [datetime] NOT NULL,
	[Location] [int] NULL,
	[Carrier] [int] NULL,
	[Place] [int] NULL,
	[Inspector] [int] NULL,
	[Notes] [nvarchar](50) NULL,
	[Flag] [int] NULL,
	[Priznak] [int] NULL,
	[Indicator] [int] NULL,
 CONSTRAINT [PK__W_Vic_sub__2AEC008A] PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Vic_Damage]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Vic_Damage](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Ids] [int] NULL,
	[Date] [datetime] NOT NULL,
	[Date_update] [datetime] NOT NULL,
	[Place] [int] NOT NULL,
	[Vid] [int] NOT NULL,
	[Sizes] [int] NOT NULL,
	[Notes] [nvarchar](50) NULL,
	[Flag] [int] NOT NULL,
	[Priznak] [int] NOT NULL,
	[Indicator] [int] NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Insurance_Sub]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Insurance_Sub](
	[PIDD] [int] IDENTITY(1,1) NOT NULL,
	[PID] [int] NULL,
	[Zakaz] [nvarchar](50) NULL,
	[VIN] [nvarchar](20) NULL,
	[Brand] [int] NULL,
	[Model] [int] NULL,
	[Vers] [int] NULL,
	[Summa_grn] [money] NOT NULL,
	[Summa_val] [money] NULL,
	[Kurs_val] [money] NOT NULL,
	[Remarks] [nvarchar](20) NULL,
	[Priznak] [nvarchar](1) NULL,
 CONSTRAINT [PK__W_Insurance_sub__6601D960] PRIMARY KEY CLUSTERED 
(
	[PIDD] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Compound]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Compound](
	[IDC] [int] IDENTITY(1,1) NOT NULL,
	[Compound] [nvarchar](50) NULL,
	[Country_id] [int] NULL,
	[Brand_id] [int] NULL,
 CONSTRAINT [PK_S_Compound] PRIMARY KEY CLUSTERED 
(
	[IDC] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Salesman]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Salesman](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [int] NULL,
	[Dlr] [int] NULL,
	[Fam] [nvarchar](30) NOT NULL,
	[Nam] [nvarchar](30) NOT NULL,
	[Tel] [nvarchar](30) NULL,
	[Isp] [nvarchar](30) NOT NULL,
	[Dat] [nvarchar](30) NOT NULL,
	[Notice] [nvarchar](100) NULL,
 CONSTRAINT [PK_S_Salesman] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Model]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Model](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Brend] [int] NOT NULL,
	[Vers] [int] NULL,
	[Kod] [nvarchar](20) NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Engine] [int] NULL,
	[Kdiler] [float] NULL,
	[Pr_Base] [float] NULL,
	[Pr_dill] [float] NULL,
	[Pr_opt] [float] NULL,
	[Pr_Grn] [float] NULL,
	[Freight] [float] NULL,
	[Insurance] [float] NULL,
	[Discount_remark] [nvarchar](50) NULL,
	[Discount_value] [money] NULL,
	[Price_midle] [numeric](18, 2) NULL,
 CONSTRAINT [PK__S_Model__7A8729A3] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Vers'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Vers'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Vers'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Kod'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Kod'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Kod'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Engine'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Engine'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Engine'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Kdiler'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Kdiler'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Kdiler'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Pr_Base'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Pr_Base'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Pr_Base'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Pr_dill'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Pr_dill'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Pr_dill'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Pr_opt'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Pr_opt'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Pr_opt'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Pr_Grn'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Pr_Grn'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Pr_Grn'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Freight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Freight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Freight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model', @level2type=N'COLUMN',@level2name=N'Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DatasheetBackColor', @value=10092543 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DefaultView', @value=0x02 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Filter', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderBy', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderByOn', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Orientation', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_TableMaxRecords', @value=10000 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Model'
GO
/****** Object:  Table [dbo].[W_Order]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Order](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [nvarchar](50) NULL,
	[D_zakaza] [smalldatetime] NULL,
	[Brend] [int] NULL,
	[Vers] [int] NULL,
	[Sorder] [nvarchar](30) NULL,
	[Wiou] [nvarchar](30) NULL,
	[ProductionMonth] [smalldatetime] NULL,
	[DLR_Order_placed] [smalldatetime] NULL,
	[Dealer_order_placed] [int] NULL,
	[Dpo] [nvarchar](30) NULL,
	[Dlr] [int] NULL,
	[Loc] [int] NULL,
	[Status] [int] NULL,
	[Model] [int] NULL,
	[VIN] [nvarchar](20) NULL,
	[Engine] [int] NULL,
	[Spec1] [nvarchar](20) NULL,
	[Spec2] [nvarchar](20) NULL,
	[Spec3] [nvarchar](20) NULL,
	[Colour] [int] NULL,
	[Colours] [int] NULL,
	[Trimm] [int] NULL,
	[OrderType] [int] NULL,
	[Comments] [nvarchar](255) NULL,
	[MY] [numeric](18, 0) NULL,
	[Cif_cip_calc] [money] NULL,
	[Cif_cip] [money] NULL,
	[Dealer_price] [money] NULL,
	[MSRP] [money] NULL,
	[OrderPlaced] [smalldatetime] NULL,
	[DeadlineChange] [smalldatetime] NULL,
	[Req] [nvarchar](255) NULL,
	[Product_confirmed] [smalldatetime] NULL,
	[ProdM] [smalldatetime] NULL,
	[Start_Production] [smalldatetime] NULL,
	[Date_completed] [smalldatetime] NULL,
	[Invoice_Number] [nvarchar](20) NULL,
	[Invoice_Date] [smalldatetime] NULL,
	[Compound] [smalldatetime] NULL,
	[RLS] [nvarchar](30) NULL,
	[RLS_placed] [smalldatetime] NULL,
	[Start_transit] [smalldatetime] NULL,
	[WIU_Arrived] [smalldatetime] NULL,
	[ContractDD] [smalldatetime] NULL,
	[DLR_Suggested_Arrival] [smalldatetime] NULL,
	[DLR_Actual_Arrival] [smalldatetime] NULL,
	[Sold_to_DLR] [smalldatetime] NULL,
	[Sold_to_Client] [smalldatetime] NULL,
	[Rls_left_compound] [smalldatetime] NULL,
	[Price_check] [smalldatetime] NULL,
	[Days_in_prod]  AS (datediff(day,[OrderPlaced],isnull([Get_release_date],getdate()))),
	[Days_Compound]  AS (datediff(day,[Compound],isnull([Compound_rls],getdate()))),
	[Days_deliv]  AS (datediff(day,[Invoice_date],isnull([WIU_Arrived],getdate()))),
	[Days_WIU]  AS (datediff(day,[WIU_Arrived],isnull([DLR_Actual_Arrival],getdate()))),
	[DAYS_DLR]  AS (datediff(day,[Wiu_Arrived],isnull([Sold_to_Client],getdate()))),
	[Days_Total]  AS (datediff(day,[Compound],isnull([Sold_to_Client],getdate()))),
	[DLR_Payment] [money] NULL,
	[PMNT_Supplier] [money] NULL,
	[Payment_Suppl_Date] [smalldatetime] NULL,
	[Dat_zak] [smalldatetime] NULL,
	[Derivate] [nvarchar](255) NULL,
	[GearBox] [int] NULL,
	[Optional] [int] NULL,
	[Options] [nvarchar](3000) NULL,
	[Client] [int] NULL,
	[Confirms] [nvarchar](50) NULL,
	[REF] [smalldatetime] NULL,
	[REF#] [nvarchar](50) NULL,
	[Compound_RLS] [smalldatetime] NULL,
	[Get_release_Date] [smalldatetime] NULL,
	[Omdp] [smalldatetime] NULL,
	[Aging_Compound] [int] NULL,
	[Aging_Dealer] [int] NULL,
	[Aging_Total] [int] NULL,
	[Aging] [nvarchar](255) NULL,
	[Dlrs] [money] NULL,
	[WIU] [nvarchar](255) NULL,
	[Credit_Line] [nvarchar](255) NULL,
	[Stock_Position] [nvarchar](255) NULL,
	[SalesDialer] [money] NULL,
	[Payment] [money] NULL,
	[Payment_Due]  AS ([dbo].[CalPerDayDlr]([brend],[wiu_arrived],[date_completed])),
	[Remain] [money] NULL,
	[PDI] [nvarchar](255) NULL,
	[Car_credit] [nvarchar](255) NULL,
	[Payments_Due_Aging] [nvarchar](255) NULL,
	[Isp_dat] [smalldatetime] NULL,
	[Isp] [nvarchar](50) NULL,
	[Comp] [nvarchar](50) NULL,
	[Isppol] [int] NULL,
	[Priz] [int] NULL,
	[Note] [nvarchar](200) NULL,
	[Package] [int] NULL,
	[Rdf_dlr] [nvarchar](50) NULL,
	[Rdf_Vid] [nvarchar](50) NULL,
	[Rdf_prod] [nvarchar](50) NULL,
	[Rdf_rikv] [smalldatetime] NULL,
	[Rdf_Zamov] [nvarchar](50) NULL,
	[Rdf_CodRadio] [nvarchar](15) NULL,
	[Rdf_numkey] [nvarchar](15) NULL,
	[Rdf_NumContract] [nvarchar](20) NULL,
	[Rdf_DateContract] [smalldatetime] NULL,
	[Rdf_PriceClient] [money] NULL,
	[Rdf_FleetCode] [nvarchar](20) NULL,
	[Rdf_DateSale] [smalldatetime] NULL,
	[Rdf_Category] [nvarchar](50) NULL,
	[Rdf_NameClient] [nvarchar](50) NULL,
	[Rdf_NameCompany] [nvarchar](50) NULL,
	[Rdf_Vik] [int] NULL,
	[Rdf_BornClient] [nvarchar](50) NULL,
	[Rdf_Adres] [nvarchar](100) NULL,
	[Rdf_Cyti] [nvarchar](20) NULL,
	[Rdf_Phone] [nvarchar](20) NULL,
	[Rdf_Phoneh] [nvarchar](50) NULL,
	[Rdf_Phonew] [nvarchar](50) NULL,
	[Rdf_Fax] [nvarchar](50) NULL,
	[Rdf_Prof] [nvarchar](50) NULL,
	[Rdf_Post] [nvarchar](10) NULL,
	[Rdf_Marka] [nvarchar](20) NULL,
	[Rdf_Model] [nvarchar](20) NULL,
	[Rdf_Vupusk] [nvarchar](20) NULL,
	[Rdf_Salesman] [int] NULL,
	[Viev] [int] NULL,
	[Vubor_pr] [int] NULL,
	[Vubor] [int] NULL,
	[Log_Ttn] [int] NULL,
	[Log_Akt] [int] NULL,
	[Log_Dat_otgruzki] [smalldatetime] NULL,
	[Log_acc] [nvarchar](20) NULL,
	[Log_sum] [money] NULL,
	[Log_noNDS] [money] NULL,
	[Log_remark] [nvarchar](300) NULL,
	[Log_mont] [int] NULL,
	[Log_kurs] [money] NULL,
	[Log_perevoz] [int] NULL,
	[Log_Dat_prib] [smalldatetime] NULL,
	[Log_Dat_razgr] [smalldatetime] NULL,
	[Log_Dat_priem] [smalldatetime] NULL,
	[Log_fio_prinyal] [nvarchar](50) NULL,
	[Log_fio_perevoz] [nvarchar](50) NULL,
	[Log_choice] [int] NULL,
	[Inv_Charges] [money] NULL,
	[Inv_Insurance] [money] NULL,
	[Inv_Country] [int] NULL,
	[Inv_Weight] [int] NULL,
	[Boc_number] [int] NULL,
	[Boc_date] [datetime] NULL,
	[Akc_Dlr_price] [money] NULL,
	[Akc_Msrp] [money] NULL,
	[Akc_valute] [int] NULL,
	[Log_Dealer_order] [datetime] NULL,
	[Fin_Recived_Approved] [datetime] NULL,
	[Brd_Recived_Approved] [datetime] NULL,
	[Brd_wiu_reguest_fin_approval] [datetime] NULL,
	[Brd_WTF_approval] [datetime] NULL,
	[Brd_WIU_Transport_invoice] [datetime] NULL,
	[Brd_configuration_check] [datetime] NULL,
	[Log_reguest_send_WTF] [datetime] NULL,
	[Log_WTF_confirmation] [datetime] NULL,
	[Log_invoice_send_to_inbound_carrier] [datetime] NULL,
	[Log_Insurance_date] [datetime] NULL,
	[Log_Vechicle_Unloaded_VIC] [datetime] NULL,
	[Log_Customs_clearance] [datetime] NULL,
	[Log_dealer_payment_check] [datetime] NULL,
	[Log_invoice_send_carrier] [datetime] NULL,
	[Log_VIC_departure] [datetime] NULL,
	[Log_estimated_delivery_dlr] [datetime] NULL,
	[Log_actual_delivery_dlr] [datetime] NULL,
	[Log_reguest_sale] [datetime] NULL,
	[Fin_accouting_doc_issued] [datetime] NULL,
	[Fin_accouting_doc_send] [datetime] NULL,
	[Fin_accouting_doc_recived] [datetime] NULL,
	[Fin_payment_supplier] [datetime] NULL,
	[Fin_payment_dealer] [datetime] NULL,
	[Fin_sale_dealer] [datetime] NULL,
	[Log_order_relocation] [datetime] NULL,
	[Log_estimated_relocation] [datetime] NULL,
	[Fin_return_dlr_deposit] [datetime] NULL,
	[Log_copy_dlr_sale] [datetime] NULL,
	[Log_original_dlr_send] [datetime] NULL,
	[Log_received_dlr] [datetime] NULL,
	[Log_inbound_carrier] [datetime] NULL,
	[Fin_invoice_pay_carrier] [datetime] NULL,
	[Log_invoice_out_carrier] [datetime] NULL,
	[Log_invoice_paid] [datetime] NULL,
	[Svin]  AS ([dbo].[Rvin]([brend],[vin])),
	[Statuss]  AS ([DBO].[CHSTAT]([OrderPlaced],[Product_confirmed],[Get_release_date],[Invoice_date],[Compound],[Rls_placed],[Rls_Left_compound],[WIU_Arrived],[Sold_to_client])),
	[A_Financial_Desicsion_Days] [int] NULL,
	[A_Sales_Desicsion_Days] [int] NULL,
	[A_Days_Place_Orders] [int] NULL,
	[A_FC_Desicsion_Days] [int] NULL,
	[A_Estimated_Production_Days] [int] NULL,
	[A_Actual_Prodaction_Days] [int] NULL,
	[A_Production_Delivation_Days] [int] NULL,
	[A_Days_Transit_Compound] [int] NULL,
	[A_Days_Compound] [int] NULL,
	[A_FC_Release_Confirmation_Days] [int] NULL,
	[A_Compound_Preparation_Days] [int] NULL,
	[A_Days_Transit_Ukraine] [int] NULL,
	[A_Days_Customs] [int] NULL,
	[A_Dayst_VIC] [int] NULL,
	[A_Days_Transit_Dealer] [int] NULL,
	[A_Days_Dealer] [int] NULL,
	[A_Days_WIU_Customer_Sold] [int] NULL,
	[A_Tatal_Days] [int] NULL,
	[Mes_zakaza]  AS (datepart(month,[d_zakaza])),
	[Blocked_f] [int] NULL,
	[Blocked_l] [int] NULL,
	[Fyon] [char](30) NULL,
	[Boq] [nvarchar](50) NULL,
	[D_in_prodaction]  AS ([dbo].[KolDay]([Invoice_date],[Product_confirmed])),
	[D_in_compound]  AS ([dbo].[KolDay]([Compound_rls],[Compound])),
	[D_in_delivery]  AS ([dbo].[KolDay]([Dlr_actual_arrival],[Wiu_arrived])),
	[D_in_wiu]  AS ([dbo].[KolDay]([Dlr_Actual_arrival],[Wiu_arrived])),
	[D_in_dlr]  AS ([dbo].[KolDay1]([Sold_to_client],[Dlr_Actual_arrival])),
	[D_in_total]  AS ([dbo].[KolDay1]([Sold_to_client],[Invoice_date])),
	[A_Compound]  AS ([dbo].[KolAng]([Compound_rls],[Compound])),
	[A_Dealer]  AS ([dbo].[KolAng]([Sold_to_client],[Dlr_actual_arrival])),
	[A_Total]  AS ([dbo].[KolAng]([Sold_to_client],[Invoice_date])),
	[Kontrakt] [smalldatetime] NULL,
	[Svvin]  AS ([dbo].[Rvin]([brend],[vin])),
	[Sale_VIN] [nvarchar](20) NULL,
	[Sale_MARK] [nvarchar](1) NULL,
	[Sale_MODEL] [nvarchar](30) NULL,
	[Sale_IFIRMS] [int] NULL,
	[Sale_DATE] [smalldatetime] NULL,
	[Sale_CURR] [nvarchar](3) NULL,
	[Sale_SUM_CURR] [money] NULL,
	[Sale_DEALER] [nvarchar](30) NULL,
	[Sale_ID] [nvarchar](20) NULL,
	[Sale_OPRID] [int] NULL,
	[Sale_CRDCODE] [int] NULL,
	[Sale_NUM_DOC] [nvarchar](20) NULL,
	[Sale_NOTE] [nvarchar](200) NULL,
	[Sale_PAYM_TERM] [nvarchar](20) NULL,
	[Sale_PAYM_DATE] [smalldatetime] NULL,
	[Sale_IS_CLOSED] [int] NULL,
	[Sale_EUR] [money] NULL,
	[Sale_SUM_EUR] [money] NULL,
	[Pymnt_IDD] [int] NULL,
	[Pymnt_ID] [nvarchar](10) NULL,
	[Pymnt_DATE] [smalldatetime] NULL,
	[Pymnt_CURR] [nvarchar](3) NULL,
	[Pymnt_SUM_CURR] [money] NULL,
	[Pymnt_IFIRMS] [int] NULL,
	[Pymnt_N_ORD] [nvarchar](20) NULL,
	[Pymnt_MARK] [nvarchar](1) NULL,
	[Pymnt_NOTE] [nvarchar](200) NULL,
	[Pymnt_EUR] [money] NULL,
	[Pymnt_SUM_EUR] [money] NULL,
	[Pymnt_NUM_DOC] [nvarchar](20) NULL,
	[Pymnt_L_NUM] [nvarchar](10) NULL,
	[Pymnt_L_DATE] [smalldatetime] NULL,
	[Pymnt_SUM_TOTAL] [money] NULL,
	[Dc1] [money] NULL,
	[Msrp1] [money] NULL,
 CONSTRAINT [PK__W_Order__0D99FE17] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Уникальный номер' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Zakaz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Zakaz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Zakaz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер заказа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Zakaz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'D_zakaza'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'D_zakaza'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'D_zakaza'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата заказа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'D_zakaza'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код бренда' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brend'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Vers'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Vers'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Vers'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код версии' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Vers'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Sorder'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Sorder'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Sorder'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Второй номер (используется у некотріх производителей например LR)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Sorder'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Wiou'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Wiou'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Wiou'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код в Виннере' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Wiou'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ProductionMonth'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ProductionMonth'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ProductionMonth'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Месяц віпуска автомобіля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ProductionMonth'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Order_placed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Order_placed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Order_placed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата размещения заказа дилером в WIU (DLR Ordered)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Order_placed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код дилера размистившего заказ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dealer_order_placed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dpo'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dpo'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dpo'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Dealer placed order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dpo'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Loc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Loc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Loc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Место прибытия' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Loc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Status'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Status'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Status'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Статус' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Status'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код модели' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'VIN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'VIN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'VIN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Длинный вин' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'VIN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Engine'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Engine'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Engine'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Двигатель' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Engine'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Spec1'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Spec1'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Spec1'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дополнительные параметры 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Spec1'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Spec2'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Spec2'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Spec2'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дополнительные параметры 2' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Spec2'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Spec3'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Spec3'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Spec3'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дополнительные параметры 3' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Spec3'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Colour'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Colour'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Colour'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цвет кузова' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Colour'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Colours'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Colours'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Colours'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цвет салона' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Colours'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Trimm'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Trimm'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Trimm'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код кузова' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Trimm'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'OrderType'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'OrderType'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'OrderType'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Тип заказа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'OrderType'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Comments'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Comments'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Comments'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Для ввода старых клиентов' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Comments'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'MY'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'MY'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'MY'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Год модели' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'MY'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Cif_cip_calc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Cif_cip_calc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Cif_cip_calc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Пересчитанная  цена по новому (актуальному)  справочнику' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Cif_cip_calc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Cif_cip'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Cif_cip'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Cif_cip'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цена от производителя нам' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Cif_cip'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dealer_price'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dealer_price'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dealer_price'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цена для дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dealer_price'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'MSRP'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'MSRP'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'MSRP'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цена для клиента' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'MSRP'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'OrderPlaced'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'OrderPlaced'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'OrderPlaced'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата размещения заказа у производителя нами' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'OrderPlaced'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DeadlineChange'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DeadlineChange'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DeadlineChange'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Последний срок изготовления машины' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DeadlineChange'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Req'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Req'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Req'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер подтверждения заказа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Req'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Product_confirmed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Product_confirmed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Product_confirmed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата подтверждения заказа на изготовление машины производителем' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Product_confirmed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ProdM'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ProdM'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ProdM'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата действительного начала  производства автомобиля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ProdM'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Start_Production'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Start_Production'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Start_Production'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Начало производства автомобиля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Start_Production'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Date_completed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Date_completed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Date_completed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата изготовления автомобиля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Date_completed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Invoice_Number'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Invoice_Number'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Invoice_Number'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер инвойса' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Invoice_Number'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Invoice_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Invoice_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Invoice_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата оформления инвойса от производителя            (4. In Transit to Compound)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Invoice_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата доставки в компаунд                                           (5. In Compound)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'RLS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'RLS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'RLS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер релиза (трака) отправки в Украину' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'RLS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'RLS_placed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'RLS_placed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'RLS_placed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата релиза                                                                    (6. On Release)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'RLS_placed'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Start_transit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Start_transit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Start_transit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата начала транспортировки в Укрину' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Start_transit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'WIU_Arrived'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'WIU_Arrived'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'WIU_Arrived'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата прибытия в Winner imports Ukraine                      (8.Ukraine)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'WIU_Arrived'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ContractDD'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ContractDD'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ContractDD'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата доставки  автомбиля клиенту по контракту                                     ( Contract dileverey date)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'ContractDD'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Suggested_Arrival'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Suggested_Arrival'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Suggested_Arrival'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Предпологаемая дата доставка дилеру' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Suggested_Arrival'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Actual_Arrival'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Actual_Arrival'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Actual_Arrival'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Действительная дата продажи дилеру' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Actual_Arrival'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Sold_to_DLR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Sold_to_DLR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Sold_to_DLR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата продажи дилеру' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Sold_to_DLR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Sold_to_Client'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Sold_to_Client'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Sold_to_Client'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата продажи клиенту                                                 (9.Sold)  машина продана' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Sold_to_Client'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rls_left_compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rls_left_compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rls_left_compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата продажи дилеру' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rls_left_compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Price_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Price_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Price_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата окончательной проверки  и корректирвки цены (корректировка машины после проврки цены- запрещена!!!) Dealer Cost Check' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Price_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_in_prod'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_in_prod'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_in_prod'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Количество дней в производстве' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_in_prod'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Количество дней в компаунде' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_deliv'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_deliv'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_deliv'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Количество дней  в производстве' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_deliv'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_WIU'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_WIU'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_WIU'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Количество дней на  Виннере' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_WIU'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DAYS_DLR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DAYS_DLR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DAYS_DLR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Количество дней  у дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DAYS_DLR'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_Total'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_Total'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_Total'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Общее количество дней' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Days_Total'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Payment'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Payment'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Payment'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Заплатил нам диллер' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'DLR_Payment'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'PMNT_Supplier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'PMNT_Supplier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'PMNT_Supplier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Заплатили мы производителю' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'PMNT_Supplier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payment_Suppl_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payment_Suppl_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payment_Suppl_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата оплаты производителю' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payment_Suppl_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dat_zak'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dat_zak'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dat_zak'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата заказа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dat_zak'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Derivate'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Derivate'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Derivate'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Оборудование (компановка-осталась для совмещения со старой версией)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Derivate'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'GearBox'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'GearBox'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'GearBox'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Коробка передач (Трансимиссия)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'GearBox'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Optional'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Optional'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Optional'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Опции (для прегонки из старой версии)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Optional'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Options'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Options'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Options'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Перечень для опций (для переноса данных со старого дс)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Options'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Client'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Client'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Client'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код клиента (согласно справочника)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Client'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Confirms'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Confirms'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Confirms'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер подтверждения заказа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Confirms'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'REF'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'REF'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'REF'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата подтверждения заказа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'REF'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Compound_RLS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Compound_RLS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Compound_RLS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата выхода из компаунда                                         (7.In route to Ukraine)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Compound_RLS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Get_release_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Get_release_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Get_release_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата выхода с производства                                      (3. Сompleted)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Get_release_Date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Omdp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Omdp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Omdp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата выхода с производства' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Omdp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Период в компаунде' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging_Dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging_Dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging_Dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Период у дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging_Dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging_Total'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging_Total'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging_Total'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Период общее количество' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging_Total'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Период' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Aging'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dlrs'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dlrs'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dlrs'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Диллер (Справочник дилеров)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Dlrs'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'WIU'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'WIU'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'WIU'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер в WIU' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'WIU'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Credit_Line'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Credit_Line'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Credit_Line'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Кредитная линия' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Credit_Line'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Stock_Position'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Stock_Position'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Stock_Position'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'?????????????' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Stock_Position'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'SalesDialer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'SalesDialer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'SalesDialer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цена для дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'SalesDialer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payment'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payment'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payment'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Оплата' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payment'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payment_Due'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payment_Due'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payment_Due'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Время до которого необходимо оплатить машину поставщику' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payment_Due'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Remain'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Remain'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Remain'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Переброска денег                                 ?????????????' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Remain'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'PDI'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'PDI'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'PDI'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Предпродажная подготовка' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'PDI'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Car_credit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Car_credit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Car_credit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Кредитная линия' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Car_credit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payments_Due_Aging'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payments_Due_Aging'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payments_Due_Aging'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'?????????????' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Payments_Due_Aging'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Isp_dat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Isp_dat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Isp_dat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата вставки документа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Isp_dat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Isp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Isp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Isp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Имя исполнителя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Isp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Comp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Comp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Comp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Копьютер с которого оформлен документ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Comp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Isppol'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Isppol'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Isppol'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Исполнитель (вносится с программы на локальном компьютере)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Isppol'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Priz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Priz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Priz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Признак документа системный' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Priz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Note'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Note'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Note'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Примечание (Фамилия по русски )' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Note'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Package'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Package'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Package'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер пакета по справочнику если есть' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Package'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Наименование дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Vid'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Vid'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Vid'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Вид ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Vid'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_prod'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_prod'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_prod'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Продавец' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_prod'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_rikv'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_rikv'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_rikv'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Рік  випуску' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_rikv'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Zamov'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Zamov'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Zamov'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер замовлення' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Zamov'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_CodRadio'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_CodRadio'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_CodRadio'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код блокировки радио' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_CodRadio'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_numkey'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_numkey'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_numkey'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер ключа от машины' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_numkey'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_NumContract'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_NumContract'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_NumContract'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер контракта клиента' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_NumContract'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_DateContract'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_DateContract'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_DateContract'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата подписания контракта с клиентом' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_DateContract'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_PriceClient'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_PriceClient'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_PriceClient'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цена для клиента' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_PriceClient'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_FleetCode'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_FleetCode'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_FleetCode'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Флит код' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_FleetCode'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_DateSale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_DateSale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_DateSale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата продажи клиенту машины' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_DateSale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Category'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Category'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Category'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Кактегория клиента' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Category'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_NameClient'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_NameClient'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_NameClient'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Имя клиента' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_NameClient'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_NameCompany'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_NameCompany'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_NameCompany'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Ноименование компании' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_NameCompany'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Vik'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Vik'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Vik'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Возраст клиента' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Vik'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_BornClient'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_BornClient'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_BornClient'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата рождения' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_BornClient'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Adres'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Adres'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Adres'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Адрес проживания клиента' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Adres'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Cyti'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Cyti'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Cyti'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Город' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Cyti'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Phone'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Phone'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Phone'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Телефон' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Phone'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Phoneh'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Phoneh'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Phoneh'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Телефон домашний' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Phoneh'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Phonew'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Phonew'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Phonew'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Телефон рабочий' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Phonew'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Fax'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Fax'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Fax'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Факс' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Fax'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Prof'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Prof'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Prof'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Профессия' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Prof'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Post'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Post'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Post'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Почтовый код' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Post'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Marka'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Marka'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Marka'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Марка предыдущего автомобиля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Marka'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Модель  предыдущего автомобиля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Vupusk'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Vupusk'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Vupusk'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Год выпуска' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Rdf_Vupusk'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Viev'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Viev'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Viev'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Показывать или нет на экране' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Viev'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Vubor_pr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Vubor_pr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Vubor_pr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Поле выбора для расчета цен' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Vubor_pr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Vubor'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Vubor'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Vubor'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Поле выбора' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Vubor'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Ttn'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Ttn'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Ttn'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'ТТн' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Ttn'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Akt'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Akt'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Akt'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер акта' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Akt'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_otgruzki'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_otgruzki'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_otgruzki'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата отгрузки' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_otgruzki'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_acc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_acc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_acc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер счета' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_acc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_sum'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_sum'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_sum'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Сумма за машину' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_sum'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_noNDS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_noNDS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_noNDS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Сумма за машину без НДС' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_noNDS'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_remark'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_remark'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_remark'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Примечание' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_remark'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_mont'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_mont'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_mont'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Месяц перевозки' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_mont'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_kurs'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_kurs'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_kurs'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'курс евро' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_kurs'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_perevoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_perevoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_perevoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Перевозчик' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_perevoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_prib'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_prib'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_prib'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата прибытия автомобиля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_prib'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_razgr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_razgr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_razgr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата разгрузки автомбиля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_razgr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_priem'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_priem'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_priem'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Время приема автомбиля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dat_priem'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_fio_prinyal'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_fio_prinyal'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_fio_prinyal'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'ФИО принявшего автомобиль' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_fio_prinyal'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_fio_perevoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_fio_perevoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_fio_perevoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'ФИО представителя перевозчика' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_fio_perevoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_choice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_choice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_choice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Поле для обработки вібранніх документов заказов' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_choice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Charges'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Charges'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Charges'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Freight charges' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Charges'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Insurance (Страховка)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Country'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Country'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Country'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Страна в котрой изготовили автомобиль' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Country'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Weight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Weight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Weight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Вес автомобиля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Inv_Weight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Boc_number'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Boc_number'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Boc_number'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер BOC' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Boc_number'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Boc_date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Boc_date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Boc_date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата ВОС' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Boc_date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Akc_Dlr_price'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Akc_Dlr_price'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Akc_Dlr_price'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цена акции Dlr_price' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Akc_Dlr_price'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Akc_Msrp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Akc_Msrp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Akc_Msrp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Цена акции MSRP' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Akc_Msrp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Akc_valute'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Akc_valute'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Akc_valute'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код валюты при акции' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Akc_valute'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dealer_order'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dealer_order'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dealer_order'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата отримання замовлення від дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Dealer_order'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_Recived_Approved'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_Recived_Approved'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_Recived_Approved'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата подтверждения финансами заказа от дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_Recived_Approved'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_Recived_Approved'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_Recived_Approved'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_Recived_Approved'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата подтверждения брендом заказа от дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_Recived_Approved'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_wiu_reguest_fin_approval'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_wiu_reguest_fin_approval'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_wiu_reguest_fin_approval'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата запиту на фінансове затвердження авто до WTF' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_wiu_reguest_fin_approval'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_WTF_approval'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_WTF_approval'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_WTF_approval'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата отримання фінансового підтверження на авто від WTF' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_WTF_approval'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_WIU_Transport_invoice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_WIU_Transport_invoice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_WIU_Transport_invoice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата складання транспортного инвойса WIU' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_WIU_Transport_invoice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_configuration_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_configuration_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_configuration_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата перевірки комплектності опцій на відповідність до замовлення' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Brd_configuration_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_send_WTF'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_send_WTF'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_send_WTF'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата запиту на фінансове затвердження релізу від WTF' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_send_WTF'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_send_WTF'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_send_WTF'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_send_WTF'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_WTF_confirmation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_WTF_confirmation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_WTF_confirmation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата отримання фінансове затвердження релізу від WTF' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_WTF_confirmation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_WTF_confirmation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_WTF_confirmation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_WTF_confirmation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_to_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_to_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_to_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата замовлення до перевізника' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_to_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_to_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_to_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_to_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Insurance_date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Insurance_date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Insurance_date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата завершення процедури розмитнення автомобілю' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Insurance_date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Insurance_date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Insurance_date'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Vechicle_Unloaded_VIC'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Vechicle_Unloaded_VIC'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Vechicle_Unloaded_VIC'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата прібуття на склад VIC' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Vechicle_Unloaded_VIC'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Customs_clearance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Customs_clearance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Customs_clearance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата завершення процедури розмитнення автомобілю' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Customs_clearance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Customs_clearance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Customs_clearance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_Customs_clearance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_dealer_payment_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_dealer_payment_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_dealer_payment_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата перевірки проплати від дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_dealer_payment_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_dealer_payment_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_dealer_payment_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_dealer_payment_check'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата замовлення до перевізника' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_send_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_VIC_departure'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_VIC_departure'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_VIC_departure'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата вибуття зі складу' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_VIC_departure'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_VIC_departure'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_VIC_departure'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_VIC_departure'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата запланована доставки до дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_actual_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_actual_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_actual_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата прибуття до дилера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_actual_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_actual_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_actual_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_actual_delivery_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата отримання замовлення на продаж автомобиля(виписка документов)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_reguest_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_issued'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_issued'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_issued'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата готовності бухгалтерських документів на продаж автомобіля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_issued'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_issued'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_issued'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_issued'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата відправки дилеру бухгалтерських документів на продаж автомобіля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_recived'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_recived'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_recived'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата отримання дилером бухгалтерських документів на продаж автомобіля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_recived'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_recived'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_recived'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_accouting_doc_recived'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_supplier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_supplier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_supplier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата (останньои) так как заносится в таблицу Payment to supplier черговой оплати постачальнику автомобіля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_supplier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_supplier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_supplier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_supplier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата (останньои) так как заносится в таблицу Payment to dlr черговой оплати дилером нам за автомобіль' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_payment_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_sale_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_sale_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_sale_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата продажи дилеру' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_sale_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_sale_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_sale_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_sale_dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_order_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_order_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_order_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата замовлення автомобіля в дилера-продавця' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_order_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_order_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_order_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_order_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата заплановоного перевезення' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_estimated_relocation'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_return_dlr_deposit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_return_dlr_deposit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_return_dlr_deposit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата повернення дилеру предплати' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_return_dlr_deposit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_return_dlr_deposit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_return_dlr_deposit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_return_dlr_deposit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_copy_dlr_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_copy_dlr_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_copy_dlr_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата відсилки факсової копії акту дилеру-продавцю' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_copy_dlr_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_copy_dlr_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_copy_dlr_sale'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_original_dlr_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_original_dlr_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_original_dlr_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата відсилки орігіналу  акту дилеру-продавцю' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_original_dlr_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_original_dlr_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_original_dlr_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_original_dlr_send'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_received_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_received_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_received_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата отримання завіренного акту від дилера-продавця' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_received_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_received_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_received_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_received_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата отримання рахунку від перевізника "до Україні"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_inbound_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_invoice_pay_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_invoice_pay_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_invoice_pay_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата оплати рахунку перевізнику' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_invoice_pay_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_invoice_pay_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_invoice_pay_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fin_invoice_pay_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_out_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_out_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_out_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата отримання рахунку від перевезника "по Україні"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_out_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_out_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_out_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_out_carrier'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_paid'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_paid'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_paid'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата оплати рахунку перевізнику' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_paid'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_paid'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_paid'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Log_invoice_paid'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Svin'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Svin'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Svin'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Короткий код VIN (7 знаков от длинного VIN)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Svin'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Statuss'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Statuss'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Statuss'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Вычисление статуса' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Statuss'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Financial_Desicsion_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Financial_Desicsion_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Financial_Desicsion_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Sales_Desicsion_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Sales_Desicsion_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Sales_Desicsion_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Place_Orders'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Place_Orders'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Place_Orders'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_FC_Desicsion_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_FC_Desicsion_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_FC_Desicsion_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Estimated_Production_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Estimated_Production_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Estimated_Production_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Actual_Prodaction_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Actual_Prodaction_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Actual_Prodaction_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Production_Delivation_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Production_Delivation_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Production_Delivation_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Transit_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Transit_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Transit_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Compound'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_FC_Release_Confirmation_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_FC_Release_Confirmation_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_FC_Release_Confirmation_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Compound_Preparation_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Compound_Preparation_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Compound_Preparation_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Transit_Ukraine'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Transit_Ukraine'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Transit_Ukraine'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Customs'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Customs'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Customs'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Dayst_VIC'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Dayst_VIC'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Dayst_VIC'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Transit_Dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Transit_Dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Transit_Dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_Dealer'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_WIU_Customer_Sold'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_WIU_Customer_Sold'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Days_WIU_Customer_Sold'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Tatal_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Tatal_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Tatal_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Общее количество дней' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'A_Tatal_Days'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Месяц заказа' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Mes_zakaza'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Блокировка оплат' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Blocked_f'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Блокировка отгрузки ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Blocked_l'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер заказа у производителя вольво' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fyon'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DisplayControl', @value=N'109' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fyon'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Format', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fyon'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_IMEMode', @value=N'0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Fyon'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата под контрактом' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order', @level2type=N'COLUMN',@level2name=N'Kontrakt'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DefaultView', @value=0x02 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Filter', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_LinkChildFields', @value=N'Zakaz' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_LinkMasterFields', @value=N'ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderBy', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderByOn', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Orientation', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_SubdatasheetName', @value=N'dbo.W_Optional' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_TableMaxRecords', @value=10000 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Order'
GO
/****** Object:  Table [dbo].[W_Optional]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Optional](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NULL,
	[Brand] [int] NULL,
	[Model] [int] NULL,
	[Vers] [int] NULL,
	[Conf] [int] NULL,
	[Note] [nvarchar](250) NULL,
	[Sokr] [nvarchar](10) NULL,
	[Naz] [nvarchar](500) NULL,
	[Pr_exw] [money] NULL,
	[Pr_dlr] [money] NULL,
	[Pr_msrp] [money] NULL,
	[Pr_raznica] [money] NULL,
	[Note1] [nvarchar](250) NULL,
	[Cods] [int] NULL,
	[Discount] [money] NULL,
 CONSTRAINT [PK__W_Optional__125EB334] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Zakaz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Zakaz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Zakaz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=600 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Conf'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Conf'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=630 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Conf'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Note'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Note'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=525 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Note'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Sokr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Sokr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=495 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Sokr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=3555 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Pr_exw'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Pr_exw'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=1950 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Pr_exw'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Pr_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Pr_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Pr_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Pr_msrp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Pr_msrp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional', @level2type=N'COLUMN',@level2name=N'Pr_msrp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DefaultView', @value=0x02 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Filter', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderBy', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderByOn', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Orientation', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_TableMaxRecords', @value=10000 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Optional'
GO
/****** Object:  Table [dbo].[W_Pay_suppl_2]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Pay_suppl_2](
	[IDD] [int] IDENTITY(1,1) NOT NULL,
	[IDN] [int] NOT NULL,
	[IDZ] [int] NULL,
	[Dat_pay] [datetime] NULL,
	[Vin] [nvarchar](30) NULL,
	[Zakaz] [nvarchar](30) NULL,
	[Ammount] [money] NULL,
	[Status] [int] NULL,
	[Notise] [nvarchar](100) NULL
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Поле связное' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_suppl_2', @level2type=N'COLUMN',@level2name=N'IDN'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Код заказа с W_Order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_suppl_2', @level2type=N'COLUMN',@level2name=N'IDZ'
GO
/****** Object:  Table [dbo].[W_Pay_Err]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Pay_Err](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NOT NULL,
	[DatDoc] [smalldatetime] NULL,
	[Polz] [nvarchar](50) NULL,
	[ErrName] [nvarchar](50) NULL,
	[Invoice] [nvarchar](20) NULL,
	[Compens_sum] [money] NULL,
	[Compens_doc] [nvarchar](20) NULL,
	[Notes] [nvarchar](200) NULL,
 CONSTRAINT [PK_W_Pay_err] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Уникальное имя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_Err', @level2type=N'COLUMN',@level2name=N'Idd'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Связное поле заказа W_order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_Err', @level2type=N'COLUMN',@level2name=N'Zakaz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата сделанніх изменений' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_Err', @level2type=N'COLUMN',@level2name=N'DatDoc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Пользователь' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_Err', @level2type=N'COLUMN',@level2name=N'Polz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Описание расхождения сумм' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_Err', @level2type=N'COLUMN',@level2name=N'ErrName'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер инвойса' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_Err', @level2type=N'COLUMN',@level2name=N'Invoice'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Сумма компенсации' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_Err', @level2type=N'COLUMN',@level2name=N'Compens_sum'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Документ компенсации' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_Err', @level2type=N'COLUMN',@level2name=N'Compens_doc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Примечание' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Pay_Err', @level2type=N'COLUMN',@level2name=N'Notes'
GO
/****** Object:  Table [dbo].[W_Ttn_Sub]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Ttn_Sub](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Ttn] [int] NULL,
	[Zakaz] [int] NULL,
	[Vin] [nvarchar](20) NULL,
	[Dlr] [int] NULL,
	[Price] [money] NULL,
	[Act] [nvarchar](20) NULL,
	[Act_Date] [datetime] NULL,
	[Acc_Number] [nvarchar](50) NULL,
	[Acc_Date] [datetime] NULL,
	[Acc_Sum] [money] NULL,
	[Remark] [nvarchar](100) NULL,
	[Priz] [nvarchar](50) NULL,
	[Avtovoz] [int] NULL,
	[Carrier] [int] NULL,
	[Closing] [datetime] NULL,
	[Dlr_unload] [int] NULL,
	[Dlr_load] [int] NULL,
	[Act_Received] [datetime] NULL,
	[Act_Printed] [datetime] NULL,
	[Vubor] [int] NULL,
	[Kurs] [money] NULL,
	[Type] [int] NULL,
	[Printonly] [int] NULL,
 CONSTRAINT [PK_W_Ttn_sub] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата закриття відповідального зберегання' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Ttn_Sub', @level2type=N'COLUMN',@level2name=N'Closing'
GO
/****** Object:  Table [dbo].[W_Hi_Pay]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Hi_Pay](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[D_change] [smalldatetime] NULL,
	[Zakaz] [int] NOT NULL,
	[Old_price] [money] NULL,
	[New_price] [money] NULL,
	[Isp] [int] NULL,
	[Isp_name] [nvarchar](30) NULL,
	[Notes] [nvarchar](255) NULL,
	[Remarks] [nchar](255) NULL,
 CONSTRAINT [PK__W_Hi_Pay__20ACD28B] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Move_Dealer]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Move_Dealer](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NOT NULL,
	[Dealer] [int] NULL,
	[Dat] [smalldatetime] NULL,
	[Remarks] [nvarchar](200) NULL,
 CONSTRAINT [PK_W_Move_dealer] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Rdf]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Rdf](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NOT NULL,
	[D_change] [smalldatetime] NULL,
	[Dlr] [int] NOT NULL,
	[Packs] [int] NOT NULL,
	[Body] [int] NOT NULL,
	[Clrk] [int] NOT NULL,
	[Clrs] [int] NOT NULL,
	[Order] [int] NOT NULL,
	[Isp_name] [char](20) NULL,
	[Isp] [int] NULL,
 CONSTRAINT [PK__W_RDF__65570293] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[W_Pay]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Pay](
	[IDpay] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NOT NULL,
	[Date_pay] [datetime] NULL,
	[Id_dealer] [int] NULL,
	[Price] [money] NULL,
	[Kurs] [money] NULL,
	[Pr_grn]  AS ([Price] * [Kurs]),
	[Isp] [int] NULL,
	[Isp_name] [nvarchar](30) NULL,
	[Notes] [nvarchar](255) NULL,
PRIMARY KEY CLUSTERED 
(
	[IDpay] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Packs_Pay]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Packs_Pay](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NOT NULL,
	[D_change] [smalldatetime] NULL,
	[Dlr] [int] NOT NULL,
	[Packs] [int] NOT NULL,
	[Body] [int] NOT NULL,
	[Clrk] [int] NOT NULL,
	[Clrs] [int] NOT NULL,
	[Orders] [int] NOT NULL,
	[Isp_name] [char](20) NULL,
	[Isp] [int] NULL,
 CONSTRAINT [PK__W_Packs_Pay__6A1BB7B0] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[W_Hi_Dislocation]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Hi_Dislocation](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NULL,
	[Whence] [int] NULL,
	[Whither] [int] NULL,
	[D_Exit] [smalldatetime] NULL,
	[D_Arrived] [smalldatetime] NULL,
	[Carrier] [int] NULL,
	[Notes] [nvarchar](255) NULL,
 CONSTRAINT [PK__W_Hi_Dislocation__1AF3F935] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_History]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_History](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NULL,
	[Dstatus] [smalldatetime] NULL,
	[Status] [int] NULL,
	[Isp_name] [char](20) NULL,
	[Isp] [int] NULL,
 CONSTRAINT [PK__W_History__162F4418] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[W_Pays]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Pays](
	[IDpay] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NOT NULL,
	[Date_pay] [datetime] NULL,
	[Id_dealer] [int] NULL,
	[Id_Country] [int] NULL,
	[Id_City] [int] NULL,
	[Price] [money] NULL,
	[Kurs] [money] NULL,
	[Pr_grn]  AS ([Price] * [Kurs]),
	[Isp] [int] NULL,
	[Isp_name] [nvarchar](30) NULL,
	[Notes] [nvarchar](255) NULL,
 CONSTRAINT [PK__W_Pays__6F556E19] PRIMARY KEY CLUSTERED 
(
	[IDpay] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Hi_Order]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Hi_Order](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[D_change] [smalldatetime] NULL,
	[Zakaz] [int] NOT NULL,
	[Notes] [nvarchar](255) NULL,
	[Isp_name] [char](20) NULL,
	[Isp] [int] NULL,
 CONSTRAINT [PK__W_Hi_Order__48BAC3E5] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[W_Option]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Option](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NULL,
	[DatCh] [datetime] NULL,
	[Changer] [nvarchar](30) NULL,
	[Brand] [int] NULL,
	[Model] [int] NULL,
	[Vers] [int] NULL,
	[Cods] [int] NULL,
	[Conf] [int] NULL,
	[Note] [nvarchar](250) NULL,
	[Sokr] [nvarchar](10) NULL,
	[Naz] [nvarchar](500) NULL,
	[Exw] [money] NULL,
	[Dc] [money] NULL,
	[Msrp] [money] NULL,
	[Recalc] [money] NULL,
	[Raznica] [money] NULL,
	[Discount] [money] NULL,
	[Notes] [nvarchar](200) NULL,
	[Remark] [money] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Config]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Config](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NULL,
	[Model] [int] NULL,
	[Conf] [int] NULL,
	[Znach] [nvarchar](50) NULL,
	[Note] [nvarchar](50) NOT NULL,
 CONSTRAINT [PK__W_Config__1446FBA6] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Diler_Sub]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Diler_Sub](
	[Id] [int] IDENTITY(1,1) NOT NULL,
	[Idn] [int] NOT NULL,
	[Position] [nvarchar](50) NOT NULL,
	[Fist_Name] [nvarchar](50) NOT NULL,
	[Last_name] [nvarchar](50) NOT NULL,
	[Short_Name] [nvarchar](50) NOT NULL,
	[Mob_tel] [nvarchar](20) NOT NULL,
	[Work_tel] [nvarchar](20) NOT NULL,
	[Home_tel] [nvarchar](20) NOT NULL,
	[E_mail] [nvarchar](50) NOT NULL,
	[Post_code] [nvarchar](10) NOT NULL,
	[Area] [nvarchar](40) NOT NULL,
	[City] [nvarchar](40) NOT NULL,
	[Street] [nvarchar](40) NOT NULL,
	[Build] [nvarchar](40) NOT NULL,
PRIMARY KEY CLUSTERED 
(
	[Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Diler_Unload]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Diler_Unload](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_Dlr] [int] NULL,
	[Region] [int] NULL,
	[Adress] [nvarchar](255) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_option_3]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_option_3](
	[Idd] [int] IDENTITY(1,1) NOT NULL,
	[Ids] [int] NULL,
	[Kod] [char](10) NULL,
	[Akt] [int] NULL,
	[Otbor] [int] NULL,
	[Groups] [nvarchar](1) NULL,
	[Notice] [nvarchar](300) NULL,
 CONSTRAINT [PK_W_option_3] PRIMARY KEY CLUSTERED 
(
	[Idd] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  Table [dbo].[W_Release]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Release](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_Request] [int] NOT NULL,
	[Num] [nvarchar](20) NOT NULL,
	[Dat] [datetime] NULL,
	[Sum] [money] NULL,
	[Rem] [nvarchar](250) NULL,
 CONSTRAINT [PK_W_Release] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Invoice]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Invoice](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_Release] [int] NULL,
	[ID_Wiu] [int] NOT NULL,
	[Zakaz] [nvarchar](20) NULL,
	[Wiu_Invoice] [nvarchar](20) NULL,
	[Vin] [nvarchar](20) NULL,
	[Ex_Works] [money] NULL,
	[Fac_Cost] [money] NULL,
	[Fc_Rel] [money] NULL,
	[Distr_Fee] [money] NULL,
	[Fac_Inv] [nvarchar](20) NULL,
	[Wi_Rel] [money] NULL,
	[Del_Cost] [money] NULL,
	[Credit_Bill] [nvarchar](50) NULL,
	[Cost_Eur] [money] NULL,
	[Due_Date] [datetime] NULL,
	[Country] [int] NULL,
	[Weicht] [int] NULL,
	[Remarks] [nvarchar](250) NULL,
	[Insurance] [money] NULL,
	[Freight] [money] NULL,
	[ID_Delivery] [int] NULL,
	[Date_Change] [datetime] NULL,
	[Changer] [nvarchar](50) NULL,
 CONSTRAINT [PK_W_Invoice] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[W_Temp_Optional]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Temp_Optional](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NULL,
	[Brand] [int] NULL,
	[Model] [int] NULL,
	[Vers] [int] NULL,
	[Conf] [int] NULL,
	[Note] [nvarchar](250) NULL,
	[Sokr] [nvarchar](10) NULL,
	[Naz] [nvarchar](500) NULL,
	[Pr_exw] [money] NULL,
	[Pr_dlr] [money] NULL,
	[Pr_msrp] [money] NULL,
	[Pr_raznica] [money] NULL,
	[Note1] [nvarchar](250) NULL,
 CONSTRAINT [PK_W_Temp_Optional] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Version]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Version](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Brand] [int] NOT NULL,
	[Model] [int] NOT NULL,
	[Sokr] [nvarchar](20) NOT NULL,
	[Naz] [nvarchar](50) NOT NULL,
	[Exw] [money] NULL,
	[Dlr_cost] [money] NULL,
	[Msrp] [money] NULL,
	[Inv_City] [nvarchar](50) NULL,
	[Inv_Freight] [money] NULL,
	[Inv_Insurance] [money] NULL,
	[Inv_Weight] [numeric](18, 3) NULL,
 CONSTRAINT [PK__S_Version__4301EA8F] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'ID'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Brand'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Brand'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Brand'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Sokr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Sokr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Sokr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Exw'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Exw'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Exw'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Dlr_cost'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Dlr_cost'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Dlr_cost'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Msrp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Msrp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Msrp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_City'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_City'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_City'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Город для производителя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_City'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_Freight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_Freight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_Freight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Freight charges' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_Freight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Insurance - страховка' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnHidden', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_Weight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnOrder', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_Weight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_ColumnWidth', @value=-1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version', @level2type=N'COLUMN',@level2name=N'Inv_Weight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DatasheetBackColor', @value=16777164 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DefaultView', @value=0x02 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Filter', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderBy', @value=NULL , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_OrderByOn', @value=0 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Orientation', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_TableMaxRecords', @value=10000 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Version'
GO
/****** Object:  Table [dbo].[W_Pakage_Sub]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Pakage_Sub](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Zakaz] [int] NOT NULL,
	[Model] [int] NOT NULL,
	[Conf] [int] NULL,
	[Price] [money] NULL,
	[Note] [nvarchar](50) NULL,
	[Cod] [nvarchar](15) NULL,
	[Naz] [nvarchar](250) NULL,
	[Exw] [money] NULL,
	[Dlr] [money] NULL,
	[Msrp] [money] NULL,
	[Vers] [int] NOT NULL,
 CONSTRAINT [PK__W_Pakage_sub__09E968C4] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[S_Carrier_Driver]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Carrier_Driver](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Carr] [int] NOT NULL,
	[Fam] [nvarchar](30) NOT NULL,
	[Nam] [nvarchar](30) NOT NULL,
	[Otc] [nvarchar](30) NULL,
	[Born] [smalldatetime] NULL,
	[Adress] [nvarchar](50) NULL,
	[PostCode] [nvarchar](10) NULL,
	[Сity] [nvarchar](50) NULL,
	[T_hom] [nvarchar](20) NULL,
	[T_wrk] [nvarchar](20) NULL,
	[T_mob] [nvarchar](20) NULL,
	[P_ser] [nvarchar](10) NULL,
	[P_num] [nvarchar](10) NULL,
	[P_dat] [smalldatetime] NULL,
	[P_kem] [nvarchar](200) NULL,
	[P_adr] [nvarchar](200) NULL,
	[Notes] [nvarchar](200) NULL,
 CONSTRAINT [PK_S_Carrier_driver] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Связное поле' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'Carr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Фамилия водителя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'Fam'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Имя водителя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'Nam'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Отчество' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'Otc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата рождения' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'Born'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Адрес' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'Adress'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Почтовій код' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'PostCode'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Город проживания' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'Сity'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Телефон домашний' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'T_hom'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Телефон рабочий' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'T_wrk'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Телефон мобитльный' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'T_mob'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Пасопрт серия' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'P_ser'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Пасопрт номер' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'P_num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Дата выдачи паспорта' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'P_dat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Кем выдан паспорт' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'P_kem'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Адрес проживания' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'P_adr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Прмечание' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Driver', @level2type=N'COLUMN',@level2name=N'Notes'
GO
/****** Object:  Table [dbo].[S_Carrier_Traller]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Carrier_Traller](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Carr] [int] NOT NULL,
	[Naz] [nvarchar](50) NULL,
	[Nom] [nvarchar](50) NOT NULL,
	[Gruz] [int] NULL,
	[Place] [int] NULL,
	[Notes] [nvarchar](200) NULL,
 CONSTRAINT [PK_S_Carrier_traller] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY],
 CONSTRAINT [IX_S_Carrier_traller] UNIQUE NONCLUSTERED 
(
	[Carr] ASC,
	[Naz] ASC,
	[Nom] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Связное поле' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Traller', @level2type=N'COLUMN',@level2name=N'Carr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Наименование треллера' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Traller', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Государтсвенный номер' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Traller', @level2type=N'COLUMN',@level2name=N'Nom'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Грузопдьемность' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Traller', @level2type=N'COLUMN',@level2name=N'Gruz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Количество мест' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Traller', @level2type=N'COLUMN',@level2name=N'Place'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Примечание' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Traller', @level2type=N'COLUMN',@level2name=N'Notes'
GO
/****** Object:  Table [dbo].[S_Carrier_Avto]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[S_Carrier_Avto](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Carr] [int] NULL,
	[Naz] [nvarchar](50) NULL,
	[Nom] [nvarchar](50) NOT NULL,
	[Fio] [nvarchar](50) NULL,
	[Tel] [nvarchar](20) NULL,
	[Notes] [nvarchar](200) NULL,
 CONSTRAINT [PK__S_Carrier_avto__0BB1B5A5] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY],
 CONSTRAINT [IX_S_Carrier_avto] UNIQUE NONCLUSTERED 
(
	[Carr] ASC,
	[Naz] ASC,
	[Nom] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Связное поле' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Avto', @level2type=N'COLUMN',@level2name=N'Carr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Марка автомобиля' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Avto', @level2type=N'COLUMN',@level2name=N'Naz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Государтсвенный номер' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Avto', @level2type=N'COLUMN',@level2name=N'Nom'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'ФИО водителя' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Avto', @level2type=N'COLUMN',@level2name=N'Fio'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Телефон' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Avto', @level2type=N'COLUMN',@level2name=N'Tel'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Примечание' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'S_Carrier_Avto', @level2type=N'COLUMN',@level2name=N'Notes'
GO
/****** Object:  Table [dbo].[W_Pakage_History]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Pakage_History](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[IDRel] [int] NOT NULL,
	[Dat_Input] [datetime] NULL,
	[D_exw] [datetime] NULL,
	[D_dc] [datetime] NULL,
	[D_msrp] [datetime] NULL,
	[P_exw] [money] NULL,
	[P_dc] [money] NULL,
	[P_msrp] [money] NULL,
	[Rate] [money] NULL,
	[Remarks] [nvarchar](200) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[A_Insurance_oderjuvach]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Insurance_oderjuvach]
AS
SELECT     TOP (100) PERCENT dbo.W_Insurance.PID, dbo.W_Insurance_Sub.VIN, dbo.S_Diler.Sokr AS Oderjuvach, S_Diler_1.Sokr AS Otpravnuk
FROM         dbo.S_Diler INNER JOIN
                      dbo.W_Ttn ON dbo.S_Diler.ID = dbo.W_Ttn.Oderjuvach INNER JOIN
                      dbo.S_Diler AS S_Diler_1 ON dbo.W_Ttn.Otpravnik = S_Diler_1.ID RIGHT OUTER JOIN
                      dbo.W_Ttn_Sub ON dbo.W_Ttn.Num = dbo.W_Ttn_Sub.Ttn RIGHT OUTER JOIN
                      dbo.W_Insurance INNER JOIN
                      dbo.W_Insurance_Sub ON dbo.W_Insurance.PID = dbo.W_Insurance_Sub.PID ON dbo.W_Ttn_Sub.Vin = dbo.W_Insurance_Sub.VIN
WHERE     (NOT (dbo.S_Diler.Sokr IS NULL)) AND (NOT (S_Diler_1.Sokr IS NULL))
ORDER BY dbo.W_Insurance.PID
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[41] 4[20] 2[6] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Insurance"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 327
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Insurance_Sub"
            Begin Extent = 
               Top = 23
               Left = 249
               Bottom = 266
               Right = 400
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Ttn"
            Begin Extent = 
               Top = 21
               Left = 703
               Bottom = 253
               Right = 839
            End
            DisplayFlags = 280
            TopColumn = 1
         End
         Begin Table = "W_Ttn_Sub"
            Begin Extent = 
               Top = 20
               Left = 451
               Bottom = 261
               Right = 602
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 165
               Left = 922
               Bottom = 402
               Right = 1082
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler_1"
            Begin Extent = 
               Top = 17
               Left = 875
               Bottom = 125
               Right = 1035
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Insurance_oderjuvach'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N' = 2520
         Width = 4455
         Width = 4710
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Insurance_oderjuvach'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Insurance_oderjuvach'
GO
/****** Object:  View [dbo].[A_Insurance]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Insurance]
AS
SELECT     dbo.W_Insurance_Sub.PIDD, dbo.W_Insurance_Sub.PID, dbo.W_Insurance_Sub.Zakaz, dbo.W_Insurance_Sub.VIN, dbo.W_Insurance_Sub.Brand, 
                      dbo.W_Insurance_Sub.Model, dbo.W_Insurance_Sub.Vers, dbo.W_Insurance_Sub.Summa_grn, dbo.W_Insurance_Sub.Summa_val, 
                      dbo.W_Insurance_Sub.Kurs_val, dbo.W_Insurance_Sub.Remarks, dbo.W_Insurance_Sub.Priznak, dbo.S_Brend.Naz AS Brand_Name, 
                      dbo.S_Model.Naz AS Model_Name, dbo.S_Version.Naz AS Version_Name
FROM         dbo.W_Insurance_Sub INNER JOIN
                      dbo.S_Brend ON dbo.W_Insurance_Sub.Brand = dbo.S_Brend.ID INNER JOIN
                      dbo.S_Model ON dbo.W_Insurance_Sub.Model = dbo.S_Model.ID INNER JOIN
                      dbo.S_Version ON dbo.W_Insurance_Sub.Vers = dbo.S_Version.ID
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Insurance_Sub"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 230
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 6
               Left = 227
               Bottom = 114
               Right = 387
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 114
               Left = 249
               Bottom = 222
               Right = 409
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 244
               Left = 256
               Bottom = 352
               Right = 407
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Insurance'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Insurance'
GO
/****** Object:  StoredProcedure [dbo].[Upd_Dlr_sales]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
----------------------------------------------------------------
-- Winner Imports Ukraine, LTD
-- Savchenko Arthur
-- Обновление продаж дилерам машинам (машина меняет собственность)
-- (связанная процедура - обновление поступлений оплат от дилеров по проданнім машинам)
-- 2007-12-13 19:46 
-- Время выполнения ориентировчное около 5.43 мин
----------------------------------------------------------------
CREATE PROCEDURE [dbo].[Upd_Dlr_sales]
AS
SET NOCOUNT ON
DECLARE @CountZap integer

/*
-- DELETE FROM 
-- UPDATE W_ORDER SET REMAIN = (SELECT SUM(SUM_CURR) FROM DBF_PAYMENT..._PAYMENT PMNT WHERE W_ORDER.DLR=PMNT.ID)
   UPDATE W_ORDER SET REMAIN = (SELECT SUM(SUM_CURR) FROM A_SALES PMNT WHERE W_ORDER.DLR=PMNT.ID AND W_ORDER.VIN LIKE '%' + PMNT.VIN + '%')
*/


 -- Обновление оплат сгруппированные (просуммированные) по дилерам 
 UPDATE W_ORDER  SET SalesDialer =  (SELECT SUM(Sum_curr) 
                                     FROM   A_sales Pmnt 
                                     WHERE  W_order.Dlr = Pmnt.ID 
                                     AND    W_ORDER.VIN LIKE '%' + PMNT.VIN + '%' 
                                     AND    PMNT.VIN <> '')

/*
 -- Обновление оплат сгруппированные (просуммированные) по дилерам 
 UPDATE W_ORDER  SET Payment     =  (SELECT SUM(Sum_curr) 
                                     FROM   A_sales Pmnt 
                                     WHERE  W_order.Dlr = Pmnt.ID 
                                     AND    W_ORDER.VIN LIKE '%' + PMNT.VIN + '%' 
                                     AND    PMNT.VIN <> '')
*/
SELECT @CountZap=@@ROWCOUNT 

/*
Запись в лог таблицу  
Можно сравнивать количество записей в таблице закачек
с нінешней таблицей оплат и после єтого если количество 
записей в таблице совпадает с значением количества записей
последней закачки то обновление не производить 
*/


-- Описание признаков в системном поле Indication
-- FIN  Финансовые операции
-- WRK  Рабочие опреации внутри системы
-- SLS  Продажи нами дилерам машин (меняется собственник машин)
-- OPL  Оплаты дилерами нам за машины которые он и купили у нас
-- SPL  Оплата нами производителю за купленные машины
-- USR  Действия связанные с операциями произведенными пользователями
-- TMP  Временніе опеарции для промежуточных расчетов
-- OTR  Другие операции которые не попадают в вішеупомянутые категории


-- Запись сообщения в системную таблицу о зколичестве обработанных записях
IF @CountZap>0
   BEGIN 
   INSERT INTO W_system (Note, Ntab, Crec, Indication) 
   VALUES ('Записи обновлены', 'W_ORDER',@CountZap,'SLS')
   END
ELSE
   BEGIN 
   INSERT INTO W_system (Note, Ntab, Crec, Indication) 
   VALUES ('Обновлений не произошло', 'W_ORDER', @CountZap,'SLS')
   END

-- SELECT * FROM A_SALES  

/*
SELECT * 
FROM  DBF_PAYMENT..._PAYMENT PMNT, A_SALES SLS
WHERE PMNT.dealer = SLS.dealer

SELECT REMAIN FROM W_ORDER where remain>0
*/
GO
/****** Object:  View [dbo].[F_1]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[F_1]
AS
SELECT     dbo.Base_ford.Zakaz, dbo.Base_ford.WIUO, dbo.S_Model.Naz AS Mod2, dbo.Base_ford.MODEL AS Mod1, dbo.S_Version.Brand AS Brend2, 
                      dbo.S_Version.Naz AS Vers_naz, dbo.Base_ford.VIN, dbo.Base_ford.Spec1, dbo.Base_ford.Spec2, dbo.Base_ford.Spec3, dbo.Base_ford.Optional, 
                      dbo.Base_ford.[TRIM], dbo.Base_ford.Order_Type, dbo.Base_ford.ENGINE, dbo.S_Model.ID AS Model, dbo.S_Version.ID AS Version, 1 AS Brand, 
                      dbo.S_Type.ID AS oRDtYPE, dbo.Base_ford.COMMENTS, dbo.Base_ford.CIF_CIP, dbo.Base_ford.[Dealer Cost], dbo.Base_ford.MSRP, 
                      dbo.Base_ford.[Order Placed], dbo.Base_ford.[Dealer Cost checked], dbo.Base_ford.[Req #], dbo.Base_ford.[Production Confirmed], 
                      dbo.Base_ford.[Production   REF#], dbo.Base_ford.[OMDP / Planned ABS], dbo.Base_ford.[Gate Release / ABS], dbo.Base_ford.[Invoice Date], 
                      dbo.Base_ford.[Compound Arrived]
FROM         dbo.Base_ford INNER JOIN
                      dbo.S_Model ON dbo.Base_ford.MODEL = dbo.S_Model.Naz INNER JOIN
                      dbo.S_Version ON dbo.S_Model.ID = dbo.S_Version.Model AND dbo.Base_ford.DERIVATIVE = dbo.S_Version.Naz INNER JOIN
                      dbo.S_Type ON dbo.Base_ford.Order_Type = dbo.S_Type.Naz
WHERE     (dbo.S_Version.Brand = 1)
GO
/****** Object:  View [dbo].[A_OrderType]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_OrderType]
AS
SELECT     TOP 100 PERCENT dbo.W_Order.Brend, dbo.W_Order.Status AS Id_status, dbo.S_Status.Naz AS Status, dbo.W_Order.Model, 
                      dbo.S_Model.Naz AS Name_model, dbo.W_Order.OrderType AS Id_Type, dbo.S_Type.Naz AS Order_type, dbo.W_Order.Vers, 
                      dbo.S_Version.Naz AS Name_version
FROM         dbo.S_Status RIGHT OUTER JOIN
                      dbo.S_Type RIGHT OUTER JOIN
                      dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID ON dbo.S_Type.ID = dbo.W_Order.OrderType LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID ON dbo.S_Status.ID = dbo.W_Order.Status
ORDER BY dbo.W_Order.Brend, dbo.W_Order.Status, dbo.W_Order.Model
GO
/****** Object:  View [dbo].[A_View]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_View]
AS
SELECT     TOP (100) PERCENT dbo.W_Order.Zakaz, dbo.W_Order.ID, dbo.W_Order.D_zakaza, dbo.S_Model.Naz AS Model, dbo.S_Version.Naz AS Version, 
                      dbo.S_Status.ID AS I_status, dbo.S_Status.Naz AS Status, dbo.W_Order.Engine, dbo.S_Engenie.Naz AS Engenie, dbo.W_Order.Trimm, 
                      dbo.S_Colours.Naz AS Col_S, dbo.W_Order.Colour, dbo.S_Colourk.Naz AS Col_K, dbo.W_Order.Get_release_Date, dbo.W_Order.Invoice_Date, 
                      dbo.W_Order.VIN, dbo.W_Order.Dat_zak, dbo.S_Gearbox.Naz AS GearBox, dbo.W_Order.Isppol, dbo.W_Order.Model AS I_Model, 
                      dbo.W_Order.Vers AS I_Vers, dbo.W_Order.Viev, dbo.W_Order.MY, dbo.W_Order.Dlr AS I_Dealer, dbo.W_Order.Spec1 AS I_Spec1, 
                      dbo.W_Order.Spec2 AS I_Spec2, dbo.W_Order.Spec3 AS I_Spec3, dbo.W_Order.Colours AS I_Colours, dbo.W_Order.GearBox AS I_Gearbox, 
                      dbo.S_Brend.Naz AS Brand_name, S_Diler_1.Naz AS Dlr_name, dbo.S_Trim_S.Nazv AS Trimmm, dbo.S_Colourk.Naz AS Expr1, 
                      dbo.W_Order.OrderPlaced, dbo.W_Order.Invoice_Number, S_Diler_1.Last_Name, S_Diler_1.Sokr, dbo.W_Order.RLS, dbo.W_Order.RLS_placed, 
                      dbo.W_Order.Sorder, dbo.W_Order.Cif_cip_calc, dbo.W_Order.Cif_cip, dbo.W_Order.Dealer_price, dbo.W_Order.MSRP, dbo.W_Order.DeadlineChange, 
                      dbo.W_Order.Product_confirmed, dbo.W_Order.ProdM, dbo.W_Order.Start_Production, dbo.W_Order.Date_completed, dbo.W_Order.ContractDD, 
                      dbo.W_Order.DLR_Suggested_Arrival, dbo.W_Order.DLR_Actual_Arrival, dbo.W_Order.Sold_to_DLR, dbo.W_Order.Sold_to_Client, 
                      dbo.W_Order.Days_in_prod, dbo.W_Order.Days_Compound, dbo.W_Order.Days_deliv, dbo.W_Order.Days_WIU, dbo.W_Order.DAYS_DLR, 
                      dbo.W_Order.Days_Total, dbo.W_Order.DLR_Payment, dbo.W_Order.PMNT_Supplier, dbo.W_Order.Payment_Suppl_Date, dbo.W_Order.Omdp, 
                      dbo.W_Order.Compound_RLS, dbo.W_Order.REF, dbo.W_Order.Aging_Compound, dbo.W_Order.Aging_Dealer, dbo.W_Order.Aging_Total, 
                      dbo.W_Order.Aging, dbo.W_Order.SalesDialer, dbo.W_Order.Payment, dbo.W_Order.Akc_Dlr_price, dbo.W_Order.Akc_Msrp, dbo.W_Order.Akc_valute, 
                      dbo.W_Order.OrderType, dbo.W_Order.Loc, dbo.W_Order.Price_check, dbo.W_Order.Rdf_DateSale, dbo.W_Order.Fin_accouting_doc_issued, 
                      dbo.W_Order.Fin_accouting_doc_send, dbo.W_Order.Fin_accouting_doc_recived, dbo.W_Order.Fin_payment_supplier, 
                      dbo.W_Order.Fin_payment_dealer, dbo.W_Order.Fin_sale_dealer, dbo.W_Order.Fin_return_dlr_deposit, dbo.W_Order.Fin_invoice_pay_carrier, 
                      dbo.S_Mounth.Naz AS Mes_zakaza, dbo.W_Order.Wiou, dbo.W_Order.Dealer_order_placed, dbo.S_Diler.Last_Name AS Dlr_order, 
                      dbo.W_Order.Brend, dbo.S_Trim_S.ID AS Expr2, dbo.W_Order.Boq, dbo.S_Location.ID AS Expr3, dbo.S_Location.Naz AS Loc_name, 
                      dbo.W_Order.Comments AS Coments, dbo.W_Order.WIU_Arrived, dbo.W_Order.Rls_left_compound, dbo.S_Type.ID AS Expr4, 
                      dbo.S_Type.Naz AS OrdType, dbo.W_Order.Compound AS Compoun_arrived, dbo.W_Order.ProductionMonth, dbo.W_Order.Log_Akt, 
                      dbo.W_Order.Log_Ttn, dbo.W_Order.Svvin, dbo.W_Order.Start_transit, dbo.S_Program.NameProgram, dbo.W_Order.Derivate, dbo.S_Colourk.Kod, 
                      dbo.W_Order.Vubor, dbo.W_Order.Dc1, dbo.W_Order.Msrp1, dbo.W_Order.Note, dbo.W_Pakage.Naz AS Name_pak, dbo.W_Order.Package AS Id_pak, 
                      dbo.W_Order.Stock_Position AS Compounds, dbo.W_Order.PDI AS Plant, dbo.W_Order.Log_Dat_razgr AS Pdi_Yes, 
                      dbo.W_Order.Log_Dat_priem AS Ready_PDI, dbo.W_Order.Log_fio_perevoz AS Qty, dbo.W_Order.Log_Dat_prib AS Additional_work, 
                      dbo.W_Order.Log_inbound_carrier AS PDI_OK
FROM         dbo.S_Diler AS S_Diler_1 RIGHT OUTER JOIN
                      dbo.W_Order LEFT OUTER JOIN
                      dbo.W_Pakage ON dbo.W_Order.Package = dbo.W_Pakage.ID LEFT OUTER JOIN
                      dbo.S_Program ON dbo.W_Order.Optional = dbo.S_Program.IDN LEFT OUTER JOIN
                      dbo.S_Type ON dbo.W_Order.OrderType = dbo.S_Type.ID LEFT OUTER JOIN
                      dbo.S_Location ON dbo.W_Order.Loc = dbo.S_Location.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dealer_order_placed = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Trim_S ON dbo.W_Order.Trimm = dbo.S_Trim_S.ID LEFT OUTER JOIN
                      dbo.S_Mounth ON dbo.W_Order.Mes_zakaza = dbo.S_Mounth.ID LEFT OUTER JOIN
                      dbo.S_Colours ON dbo.W_Order.Colour = dbo.S_Colours.ID LEFT OUTER JOIN
                      dbo.S_Colourk ON dbo.W_Order.Colours = dbo.S_Colourk.ID ON S_Diler_1.ID = dbo.W_Order.Dlr LEFT OUTER JOIN
                      dbo.S_Engenie ON dbo.W_Order.Engine = dbo.S_Engenie.ID LEFT OUTER JOIN
                      dbo.S_Status ON dbo.W_Order.Status = dbo.S_Status.ID LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Gearbox ON dbo.W_Order.GearBox = dbo.S_Gearbox.ID LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID
WHERE     (dbo.W_Order.Viev = 0)
ORDER BY dbo.W_Order.Brend
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1[20] 4[56] 3) )"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1[50] 2[25] 3) )"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[76] 4[15] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1[96] 4) )"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2) )"
      End
      ActivePaneConfig = 1
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Diler_1"
            Begin Extent = 
               Top = 336
               Left = 39
               Bottom = 430
               Right = 199
            End
            DisplayFlags = 280
            TopColumn = 4
         End
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 354
               Bottom = 1042
               Right = 515
            End
            DisplayFlags = 280
            TopColumn = 116
         End
         Begin Table = "W_Pakage"
            Begin Extent = 
               Top = 724
               Left = 37
               Bottom = 832
               Right = 188
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Program"
            Begin Extent = 
               Top = 722
               Left = 620
               Bottom = 865
               Right = 780
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Type"
            Begin Extent = 
               Top = 502
               Left = 619
               Bottom = 610
               Right = 776
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Location"
            Begin Extent = 
               Top = 436
               Left = 38
               Bottom = 529
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 223
               Left = 39
               Bottom = 331
               Right = 199
            End
            DisplayFl' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_View'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'ags = 280
            TopColumn = 6
         End
         Begin Table = "S_Trim_S"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 84
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Mounth"
            Begin Extent = 
               Top = 841
               Left = 36
               Bottom = 949
               Right = 187
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Colours"
            Begin Extent = 
               Top = 151
               Left = 614
               Bottom = 290
               Right = 774
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Colourk"
            Begin Extent = 
               Top = 296
               Left = 615
               Bottom = 417
               Right = 775
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Engenie"
            Begin Extent = 
               Top = 611
               Left = 38
               Bottom = 710
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Status"
            Begin Extent = 
               Top = 22
               Left = 615
               Bottom = 148
               Right = 775
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 123
               Left = 39
               Bottom = 217
               Right = 199
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 532
               Left = 38
               Bottom = 609
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 5
         End
         Begin Table = "S_Gearbox"
            Begin Extent = 
               Top = 615
               Left = 620
               Bottom = 716
               Right = 777
            End
            DisplayFlags = 280
            TopColumn = 4
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 10
               Left = 40
               Bottom = 118
               Right = 200
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
      PaneHidden = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 4575
         Alias = 1305
         Table = 1755
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_View'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_View'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Orientation', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_View'
GO
/****** Object:  View [dbo].[A_View_reporting]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_View_reporting]
AS
SELECT     TOP 100 PERCENT dbo.W_Order.Zakaz AS [Supplier order], dbo.W_Order.ID, dbo.S_Mounth.Naz AS [Production Month], 
                      dbo.W_Order.DLR_Order_placed AS [Dealer placed order], dbo.W_Order.Svin AS [Short VIN], dbo.S_Diler.Last_Name AS Dealer, 
                      dbo.S_Location.Naz AS Location, dbo.S_Status.Naz AS Status, dbo.S_Model.Naz AS Model, dbo.W_Order.VIN AS [Full VIN], 
                      dbo.S_Engenie.Naz AS Engine, dbo.W_Order.Spec1 AS [Spec 1], dbo.W_Order.Spec2 AS [Spec 2], dbo.W_Order.Spec3 AS [Spec 3], 
                      dbo.S_Colourk.Naz AS [Colour body], dbo.S_Type.Naz AS [Order type], dbo.W_Order.Comments AS Coments, dbo.W_Order.MY AS [Model year], 
                      dbo.W_Order.Cif_cip AS [CIF-CIP], dbo.W_Order.Dealer_price AS [Dealer cost], dbo.W_Order.MSRP, dbo.W_Order.OrderPlaced AS [Order placed], 
                      dbo.W_Order.DeadlineChange AS Deadline, dbo.W_Order.Req, dbo.W_Order.Product_confirmed AS [Production confirm], 
                      dbo.W_Order.ProdM AS [Production ref], dbo.W_Order.Start_Production AS [Start production], dbo.W_Order.Date_completed AS [Date comleted], 
                      dbo.W_Order.Invoice_Date AS [Invoice date], dbo.W_Order.Compound, dbo.W_Order.RLS AS [RLS number], 
                      dbo.W_Order.RLS_placed AS [RLS date placed], dbo.W_Order.Start_transit AS [Start transit], dbo.W_Order.WIU_Arrived AS [WIU arrived], 
                      dbo.W_Order.ContractDD AS [Contract delivery  date], dbo.W_Order.DLR_Suggested_Arrival AS [Dealer suggested], 
                      dbo.W_Order.DLR_Actual_Arrival AS [Dealer actual arrival], dbo.W_Order.Sold_to_DLR AS [Sold to dealer], 
                      dbo.W_Order.Sold_to_Client AS [Sold to client], dbo.W_Order.Days_in_prod AS [Days in production], 
                      dbo.W_Order.Days_Compound AS [Days at compound], dbo.W_Order.Days_deliv AS [Days to deliveri], dbo.W_Order.Days_WIU AS [Days in WIU], 
                      dbo.W_Order.DAYS_DLR AS [Days to dealer], dbo.W_Order.Days_Total AS [Days total], dbo.W_Order.Payment_Suppl_Date AS [Payment supplier date],
                       dbo.W_Order.PMNT_Supplier AS [Payment supplier], dbo.W_Order.DLR_Payment AS [Dealer payment], dbo.W_Order.Status AS Status_ID, 
                      dbo.W_Order.Brend AS Brand_ID, S_Aging_1.Naz AS [Anging compound], S_Aging_1.Naz AS [Anging dealer], S_Aging_2.Naz AS [Aging total], 
                      dbo.S_Colours.Naz AS [Trim]
FROM         dbo.S_Trim_s INNER JOIN
                      dbo.S_Trim ON dbo.S_Trim_s.ID = dbo.S_Trim.Body RIGHT OUTER JOIN
                      dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dlr = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Aging S_Aging_1 ON dbo.W_Order.Aging_Dealer = S_Aging_1.Id LEFT OUTER JOIN
                      dbo.S_Aging S_Aging_2 ON dbo.W_Order.Aging_Total = S_Aging_2.Id LEFT OUTER JOIN
                      dbo.S_Aging S_Aging_3 ON dbo.W_Order.Aging_Compound = S_Aging_3.Id LEFT OUTER JOIN
                      dbo.S_Status ON dbo.W_Order.Status = dbo.S_Status.ID LEFT OUTER JOIN
                      dbo.S_Type ON dbo.W_Order.OrderType = dbo.S_Type.ID LEFT OUTER JOIN
                      dbo.S_Location ON dbo.W_Order.Loc = dbo.S_Location.ID LEFT OUTER JOIN
                      dbo.S_Mounth ON dbo.W_Order.ProductionMonth = dbo.S_Mounth.ID LEFT OUTER JOIN
                      dbo.S_Engenie ON dbo.W_Order.Engine = dbo.S_Engenie.ID LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID ON dbo.S_Trim.ID = dbo.W_Order.Trimm LEFT OUTER JOIN
                      dbo.S_Colourk ON dbo.W_Order.Colour = dbo.S_Colourk.ID LEFT OUTER JOIN
                      dbo.S_Gearbox ON dbo.W_Order.GearBox = dbo.S_Gearbox.ID LEFT OUTER JOIN
                      dbo.S_Colours ON dbo.W_Order.Colours = dbo.S_Colours.ID
ORDER BY dbo.W_Order.Status, dbo.W_Order.ID
GO
/****** Object:  View [dbo].[A_Statatus_Nohide]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Statatus_Nohide]
AS
SELECT     TOP (100) PERCENT dbo.W_Order.Zakaz AS [Supplier Order], dbo.W_Order.Sorder AS [Common Order], 
                      dbo.W_Order.ProductionMonth AS [Production Month], dbo.S_Diler.Last_Name AS [Dealer Order Placed], dbo.W_Order.Svin AS [Short VIN], 
                      S_Diler_1.Last_Name AS Dlr, dbo.S_Location.Naz AS Loc, dbo.S_Status.Naz AS Status, dbo.S_Model.Naz AS Model, dbo.S_Version.Naz AS Version, 
                      dbo.W_Order.Derivate AS Derivative, dbo.W_Order.VIN AS [Full VIN], dbo.S_Engenie.Naz AS Engine, dbo.W_Order.Spec1, dbo.W_Order.Spec2, 
                      dbo.W_Order.Spec3, LEFT(dbo.W_Order.Options, 2000) AS [Optional Equipment], dbo.S_Colours.Naz AS [Colour Body], dbo.S_Colourk.Naz AS Trim, 
                      dbo.S_Type.Naz AS [Order Type], dbo.W_Order.Comments, dbo.W_Order.MY AS [Model Year], dbo.W_Order.Cif_cip AS [CIF/CIP], 
                      dbo.W_Order.Dealer_price AS [Dealer price], dbo.W_Order.MSRP, dbo.W_Order.OrderPlaced AS [Order Placed], 
                      dbo.W_Order.DeadlineChange AS [Deadline Change], dbo.W_Order.Req AS Reg, dbo.W_Order.Product_confirmed AS [Production Confirmed], 
                      dbo.W_Order.Omdp, dbo.W_Order.Get_release_Date AS [Gate Release], dbo.W_Order.Invoice_Date AS [Invoice Date], 
                      dbo.W_Order.Compound AS [Compound Arrived], dbo.W_Order.RLS AS [RLS #], dbo.W_Order.RLS_placed AS [RLS Placed], 
                      dbo.W_Order.Compound_RLS AS [Compound RLS], dbo.W_Order.Rls_left_compound AS [RLS Left Compound], 
                      dbo.W_Order.WIU_Arrived AS [WIU Arrived], dbo.W_Order.ContractDD AS [Contract Delivery Date], 
                      dbo.W_Order.DLR_Suggested_Arrival AS [DLR Estimated Arrival], dbo.W_Order.DLR_Actual_Arrival AS [DLR Actual Arrival], 
                      dbo.W_Order.Sold_to_DLR AS [Sold to DLR], dbo.W_Order.Sold_to_Client AS [Sold to Client], dbo.CntDay(dbo.W_Order.Invoice_Date, 
                      dbo.W_Order.Product_confirmed) AS [Day in Prodaction], dbo.CntDay(dbo.W_Order.Compound_RLS, dbo.W_Order.Compound) AS [Day in Compound], 
                      dbo.CntDay(dbo.W_Order.WIU_Arrived, dbo.W_Order.Compound_RLS) AS [Day in Delivery], dbo.CntDay(dbo.W_Order.DLR_Actual_Arrival, 
                      dbo.W_Order.WIU_Arrived) AS [Day at WIU], dbo.CntDay(dbo.W_Order.Sold_to_Client, dbo.W_Order.DLR_Actual_Arrival) AS [Day at Dlr], 
                      dbo.CntDay(dbo.W_Order.Sold_to_Client, dbo.W_Order.Invoice_Date) AS [Day at Total], dbo.AGING(dbo.W_Order.Compound_RLS, 
                      dbo.W_Order.Compound, dbo.W_Order.Brend) AS [Aging in Compound], dbo.AGING(dbo.W_Order.Sold_to_Client, dbo.W_Order.WIU_Arrived, 
                      dbo.W_Order.Brend) AS [Aging at Dealer], dbo.AGING(dbo.W_Order.Sold_to_Client, dbo.W_Order.Invoice_Date, dbo.W_Order.Brend) AS [Aging Total], 
                      dbo.W_Order.DLR_Payment AS [Dealer Payment], dbo.W_Order.PMNT_Supplier AS [Payment to Supplier], dbo.W_Order.Brend AS Id_Brand, 
                      dbo.W_Order.Model AS Id_Model, dbo.W_Order.Vers AS Id_Vers, dbo.W_Order.Status AS Id_Status, dbo.W_Order.Payment_Due AS [Payment Due], 
                      dbo.W_Order.Wiou, dbo.W_Order.Kontrakt AS [Date Contract], dbo.W_Order.Date_completed AS [Date Completed], 
                      dbo.W_Order.Start_Production AS [Start Production], dbo.W_Order.Viev, dbo.W_Order.Loc AS Id_Loc, 
                      dbo.W_Order.Payment_Suppl_Date AS Pay_Suppl_Date, dbo.W_Order.Pymnt_DATE AS Pay_Dlr_Date, dbo.W_Order.ID
FROM         dbo.S_Status RIGHT OUTER JOIN
                      dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Location ON dbo.W_Order.Loc = dbo.S_Location.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dealer_order_placed = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Type ON dbo.W_Order.OrderType = dbo.S_Type.ID LEFT OUTER JOIN
                      dbo.S_Trim_s ON dbo.W_Order.Trimm = dbo.S_Trim_s.ID LEFT OUTER JOIN
                      dbo.S_Mounth ON dbo.W_Order.Mes_zakaza = dbo.S_Mounth.ID LEFT OUTER JOIN
                      dbo.S_Colours ON dbo.W_Order.Colour = dbo.S_Colours.ID LEFT OUTER JOIN
                      dbo.S_Colourk ON dbo.W_Order.Colours = dbo.S_Colourk.ID LEFT OUTER JOIN
                      dbo.S_Diler AS S_Diler_1 ON dbo.W_Order.Dlr = S_Diler_1.ID LEFT OUTER JOIN
                      dbo.S_Engenie ON dbo.W_Order.Engine = dbo.S_Engenie.ID ON dbo.S_Status.ID = dbo.W_Order.Status LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Gearbox ON dbo.W_Order.GearBox = dbo.S_Gearbox.ID LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID
WHERE     (dbo.W_Order.Viev = 0)
ORDER BY Id_Brand, [Production Month], [Dealer Order Placed], Loc
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Status"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 114
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 227
               Bottom = 114
               Right = 489
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Location"
            Begin Extent = 
               Top = 6
               Left = 527
               Bottom = 99
               Right = 678
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 102
               Left = 527
               Bottom = 210
               Right = 687
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Type"
            Begin Extent = 
               Top = 114
               Left = 38
               Bottom = 222
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Trim_s"
            Begin Extent = 
               Top = 114
               Left = 227
               Bottom = 192
               Right = 378
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Mounth"
            Begin Extent = 
               Top = 192
               Left = 227
               Bottom = 300
               Right = 378
            End
            DisplayFlags = 2' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Statatus_Nohide'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'80
            TopColumn = 0
         End
         Begin Table = "S_Colours"
            Begin Extent = 
               Top = 210
               Left = 416
               Bottom = 318
               Right = 567
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Colourk"
            Begin Extent = 
               Top = 222
               Left = 38
               Bottom = 330
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler_1"
            Begin Extent = 
               Top = 300
               Left = 227
               Bottom = 408
               Right = 387
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Engenie"
            Begin Extent = 
               Top = 318
               Left = 425
               Bottom = 426
               Right = 576
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 330
               Left = 38
               Bottom = 438
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 408
               Left = 227
               Bottom = 516
               Right = 378
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Gearbox"
            Begin Extent = 
               Top = 426
               Left = 416
               Bottom = 534
               Right = 567
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 438
               Left = 38
               Bottom = 546
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 2760
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Statatus_Nohide'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Statatus_Nohide'
GO
/****** Object:  View [dbo].[A_Status_old_1]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*

Notice  :  Основной просмотр для формирования отчетности
Date    :  02-04-2007


*/
 
CREATE VIEW [dbo].[A_Status_old_1]
AS
SELECT   TOP (100) PERCENT   
         dbo.W_Order.Zakaz                 AS [Supplier Order]      , 
         dbo.W_Order.Sorder                AS [Common Order]        , 
         dbo.W_Order.ProductionMonth       AS [Production Month]    , 
         dbo.S_Diler.Last_Name             AS [Dealer Order Placed] , 
         dbo.W_Order.Svin                  AS [Short VIN]           , 
         S_Diler_1.Last_Name               AS [Dlr]                 , 
         dbo.S_Location.Naz                AS [Loc]                 , 
         dbo.S_Status.Naz                  AS [Status]              , 
         dbo.S_Model.Naz                   AS [Model]               , 
         dbo.S_Version.Naz                 AS [Version]             , 
         dbo.W_Order.Derivate              AS [Derivative]          , 
         dbo.W_Order.VIN                   AS [Full VIN]            , 
         dbo.S_Engenie.Naz                 AS [Engine]              , 
         dbo.W_Order.Spec1                 AS [Spec1]               , 
         dbo.W_Order.Spec2                 AS [Spec2]               , 
         dbo.W_Order.Spec3                 AS [Spec3]               , 
         LEFT(dbo.W_Order.Options, 2000)   AS [Optional Equipment]  , 
         dbo.S_Colours.Naz                 AS [Colour Body]         ,    
         dbo.S_Colourk.Naz                 AS [Trim]                , 
         dbo.S_Type.Naz                    AS [Order Type]          , 
         dbo.W_Order.Comments              AS [Comments]            , 
         dbo.W_Order.MY                    AS [Model Year]          ,    
         dbo.W_Order.Cif_cip               AS [CIF/CIP]             , 
         dbo.W_Order.Dealer_price          AS [Dealer price]        , 
         dbo.W_Order.MSRP                  AS [MSRP]                ,                 
         dbo.W_Order.OrderPlaced           AS [Order Placed]        , 
         dbo.W_Order.DeadlineChange        AS [Deadline Change]     , 
         dbo.W_Order.Req                   AS [Reg]                 , 
         dbo.W_Order.Product_confirmed     AS [Production Confirmed], 
         dbo.W_Order.Omdp                  AS [OMDP]                ,  
         dbo.W_Order.Get_release_Date      AS [Gate Release]        , 
         dbo.W_Order.Invoice_Date          AS [Invoice Date]        , 
         dbo.W_Order.Compound              AS [Compound Arrived]    , 
         dbo.W_Order.RLS                   AS [RLS #]               , 
         dbo.W_Order.RLS_placed            AS [RLS placed]          , 
         dbo.W_Order.Compound_RLS          AS [Compound RLS]        , 
         dbo.W_Order.Rls_left_compound     AS [RLS left Compound]   , 
         dbo.W_Order.WIU_Arrived           AS [WIU arrived]         , 
         dbo.W_Order.ContractDD            AS [Contract Delivery Date], 
         dbo.W_Order.DLR_Suggested_Arrival AS [DLR Estimated Arrival], 
         dbo.W_Order.DLR_Actual_Arrival    AS [DLR Actual Arrival]  , 
         dbo.W_Order.Sold_to_DLR           AS [Sold to DLR]         , 
         dbo.W_Order.Sold_to_Client        AS [Sold to Client]      , 
         dbo.CntDay (dbo.W_Order.Invoice_Date,       dbo.W_Order.Product_Confirmed)  AS [Day in Prodaction], 
         dbo.CntDay (dbo.W_Order.Compound_RLS,       dbo.W_Order.Compound)           AS [Day in Compound], 
         dbo.CntDay (dbo.W_Order.WIU_Arrived,        dbo.W_Order.Compound_RLS)       AS [Day in Delivery], 
         dbo.CntDay (dbo.W_Order.DLR_Actual_Arrival, dbo.W_Order.WIU_Arrived)        AS [Day at WIU], 
         dbo.CntDay (dbo.W_Order.Sold_to_Client,     dbo.W_Order.DLR_Actual_Arrival) AS [Day at Dlr], 
         dbo.CntDay (dbo.W_Order.Sold_to_Client,     dbo.W_Order.Invoice_Date)       AS [Day at Total], 
         dbo.W_Order.A_Compound            AS [Aging in Compound]   , 
         dbo.W_Order.A_Dealer              AS [Aging at Dealer]     , 
         dbo.W_Order.A_Total               AS [Aging Total]         , 
         dbo.W_Order.DLR_Payment           AS [Dealer Payment]      , 
         dbo.W_Order.PMNT_Supplier         AS [Payment to Supplier] , 
         dbo.W_Order.Brend                 AS [Id_Brand]            , 
         dbo.W_Order.Model                 AS [Id_Model]            , 
         dbo.W_Order.Vers                  AS [Id_Vers]             , 
         dbo.W_Order.Status                AS [Id_Status]           , 
         dbo.W_Order.Payment_Due           AS [Payment Due]         , 
         dbo.W_Order.Wiou                  AS [WIOU]               ,  
         dbo.W_Order.Kontrakt              AS [Date Contract]       ,
         dbo.W_Order.Date_completed        AS [Date Completed]      , 
         dbo.W_Order.Start_Production      AS [Start Production]
   FROM  dbo.S_Status                                                            RIGHT OUTER JOIN
         dbo.W_Order                                                             LEFT OUTER JOIN
         dbo.S_Location  ON dbo.W_Order.Loc                 = dbo.S_Location.ID  LEFT OUTER JOIN
         dbo.S_Diler     ON dbo.W_Order.Dealer_order_placed = dbo.S_Diler.ID     LEFT OUTER JOIN
         dbo.S_Type      ON dbo.W_Order.OrderType           = dbo.S_Type.ID      LEFT OUTER JOIN
         dbo.S_Trim_s    ON dbo.W_Order.Trimm               = dbo.S_Trim_s.ID    LEFT OUTER JOIN
         dbo.S_Mounth    ON dbo.W_Order.Mes_zakaza          = dbo.S_Mounth.ID    LEFT OUTER JOIN
         dbo.S_Colours   ON dbo.W_Order.Colour              = dbo.S_Colours.ID   LEFT OUTER JOIN
         dbo.S_Colourk   ON dbo.W_Order.Colours             = dbo.S_Colourk.ID   LEFT OUTER JOIN
         dbo.S_Diler     AS S_Diler_1  ON dbo.W_Order.Dlr   = S_Diler_1.ID       LEFT OUTER JOIN
         dbo.S_Engenie   ON dbo.W_Order.Engine              = dbo.S_Engenie.ID 
                         ON dbo.S_Status.ID                 = dbo.W_Order.Status LEFT OUTER JOIN
         dbo.S_Version   ON dbo.W_Order.Vers                = dbo.S_Version.ID   LEFT OUTER JOIN
         dbo.S_Model     ON dbo.W_Order.Model               = dbo.S_Model.ID     LEFT OUTER JOIN
         dbo.S_Gearbox   ON dbo.W_Order.GearBox             = dbo.S_Gearbox.ID   LEFT OUTER JOIN
         dbo.S_Brend     ON dbo.W_Order.Brend               = dbo.S_Brend.ID
ORDER BY [Id_Brand],
         [Production Month], 
         [Dealer Order Placed],
         [Loc]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[25] 4[54] 2[6] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = -672
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Status"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 114
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 104
               Left = 151
               Bottom = 414
               Right = 413
            End
            DisplayFlags = 280
            TopColumn = 63
         End
         Begin Table = "S_Location"
            Begin Extent = 
               Top = 6
               Left = 227
               Bottom = 99
               Right = 378
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 222
               Left = 38
               Bottom = 330
               Right = 198
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Type"
            Begin Extent = 
               Top = 222
               Left = 236
               Bottom = 330
               Right = 387
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Trim_s"
            Begin Extent = 
               Top = 330
               Left = 38
               Bottom = 408
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Mounth"
            Begin Extent = 
               Top = 330
               Left = 227
               Bottom = 438
               Right = 378
            End
            DisplayFlags' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Status_old_1'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N' = 280
            TopColumn = 0
         End
         Begin Table = "S_Colours"
            Begin Extent = 
               Top = 408
               Left = 38
               Bottom = 516
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Colourk"
            Begin Extent = 
               Top = 438
               Left = 227
               Bottom = 546
               Right = 378
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler_1"
            Begin Extent = 
               Top = 516
               Left = 38
               Bottom = 624
               Right = 198
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Engenie"
            Begin Extent = 
               Top = 545
               Left = 292
               Bottom = 653
               Right = 443
            End
            DisplayFlags = 280
            TopColumn = 2
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 624
               Left = 38
               Bottom = 732
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 1
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 654
               Left = 227
               Bottom = 762
               Right = 378
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Gearbox"
            Begin Extent = 
               Top = 732
               Left = 38
               Bottom = 840
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 762
               Left = 227
               Bottom = 870
               Right = 378
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 3405
         Alias = 2940
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Status_old_1'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Status_old_1'
GO
/****** Object:  View [dbo].[A_Planig_Package]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Planig_Package]
AS
SELECT     dbo.W_package_plan.Idn AS ID, dbo.S_Type.Naz AS OrderType, dbo.W_package_plan.Dealer_order_placed, dbo.S_Diler.Last_Name, 
                      dbo.W_package_plan.Dlr, S_Diler_1.Last_Name AS Dealer, dbo.S_Colours.Naz AS Colour, dbo.S_Colourk.Naz AS Trim, dbo.W_package_plan.MY, 
                      dbo.W_package_plan.Dat_package, dbo.W_package_plan.Zakaz
FROM         dbo.S_Diler AS S_Diler_1 RIGHT OUTER JOIN
                      dbo.W_package_plan LEFT OUTER JOIN
                      dbo.S_Colourk ON dbo.W_package_plan.Colours = dbo.S_Colourk.ID LEFT OUTER JOIN
                      dbo.S_Colours ON dbo.W_package_plan.Colour = dbo.S_Colours.ID LEFT OUTER JOIN
                      dbo.S_Type ON dbo.W_package_plan.OrderType = dbo.S_Type.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_package_plan.Dealer_order_placed = dbo.S_Diler.ID ON S_Diler_1.ID = dbo.W_package_plan.Dlr
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[45] 4[34] 2[6] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Diler_1"
            Begin Extent = 
               Top = 114
               Left = 292
               Bottom = 222
               Right = 452
            End
            DisplayFlags = 280
            TopColumn = 3
         End
         Begin Table = "W_package_plan"
            Begin Extent = 
               Top = 3
               Left = 37
               Bottom = 392
               Right = 238
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Colourk"
            Begin Extent = 
               Top = 340
               Left = 298
               Bottom = 448
               Right = 449
            End
            DisplayFlags = 280
            TopColumn = 4
         End
         Begin Table = "S_Colours"
            Begin Extent = 
               Top = 229
               Left = 295
               Bottom = 337
               Right = 446
            End
            DisplayFlags = 280
            TopColumn = 2
         End
         Begin Table = "S_Type"
            Begin Extent = 
               Top = 453
               Left = 299
               Bottom = 561
               Right = 450
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 0
               Left = 293
               Bottom = 108
               Right = 453
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 2205
  ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Planig_Package'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'       Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Planig_Package'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Planig_Package'
GO
/****** Object:  StoredProcedure [dbo].[Web_prepaire]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Процедура подготовки данніх для дейли репорта
CREATE PROCEDURE [dbo].[Web_prepaire]
AS


-- Предварительная очитска отчета 
DELETE FROM D_DEYLI_REP 

-- Заполнение первого поля в отчете для связи
INSERT D_DEYLI_REP (DLR) 
SELECT lAST_NAME FROM S_DILER

-- Просмотр отчета
--SELECT * FROM D_DEYLI_REPort where nomer=38380
GO
/****** Object:  StoredProcedure [dbo].[Ins_Option_Ford]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[Ins_Option_Ford] (@Model nvarchar(50), 
                                         @Vers  nvarchar(50))
AS
SET NOCOUNT ON

DECLARE @S_Model int
DECLARE @S_Vers  int

SELECT @S_Model=ID FROM S_Model   WHERE Brend = 1 AND Naz   = @Model
SELECT @S_Vers =ID FROM S_Version WHERE Brand = 1 AND Model = @S_Model AND Naz = @Vers

DELETE FROM S_Optional WHERE  Brend = 1 AND Model = @S_Model AND Version = @S_Vers

-- Вставка опций из подготовленной таблицы
INSERT  S_Optional (Brend, Model,   Version,   Sokr,      Naz, Pr_exw, Pr_dlr, pr_msrp, Vers, Grup, Naz_ukr)
SELECT                1,  @S_Model, @S_Vers, left(F3,10),  Left(F4,250),   F5,      F6,     F7,     3,    10,  @Model + ' - ' + @Vers
FROM    S_opt 
WHERE   F1=@Model AND F2=@Vers

-- DELETE FROM S_Optional WHERE brend=1
-- SELECT * FROM S_OPTIONAL where brend=1
GO
/****** Object:  StoredProcedure [dbo].[App_ClientAdd]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Creates a new record in the [dbo].[S_Client] table.
CREATE PROCEDURE [dbo].[App_ClientAdd]
    @p_Postav smalldatetime,
    @p_Fio nvarchar(100),
    @p_Fleet nvarchar(30),
    @p_Company nvarchar(30),
    @p_Age nvarchar(30),
    @p_Born smalldatetime,
    @p_Adress nvarchar(50),
    @p_PostCode nvarchar(10),
    @p_Сity nvarchar(50),
    @p_T_hom nvarchar(20),
    @p_T_wrk nvarchar(20),
    @p_T_mob nvarchar(20),
    @p_T_Fax nvarchar(20),
    @p_Proff nvarchar(50),
    @p_Oldavto nvarchar(20),
    @p_Oldmodel nvarchar(20),
    @p_Oldyear nvarchar(4),
    @p_Remarks nvarchar(50),
    @p_Brand int,
    @p_Data_start smalldatetime,
    @p_Data_finish smalldatetime,
    @p_Model nvarchar(50),
    @p_Version nvarchar(50),
    @p_Engine nvarchar(50),
    @p_Vid_engine nvarchar(50),
    @p_VIN nvarchar(20),
    @p_Territoriya nvarchar(50),
    @p_Data_finish_ex smalldatetime,
    @p_Notes nvarchar(200),
    @p_Priznak nvarchar(10),
    @p_Ispol nvarchar(50),
    @p_Comp nvarchar(50),
    @p_Data_input datetime,
    @p_God int,
    @p_Mes nvarchar(20),
    @p_Dlr nvarchar(50),
    @p_Fam nvarchar(50),
    @p_Im nvarchar(50),
    @p_Otch nvarchar(50),
    @p_Pol nvarchar(1),
    @p_Street nvarchar(50),
    @p_E_mail nvarchar(50),
    @p_Data_sale datetime,
    @p_Id_out int output
AS
BEGIN
    INSERT
    INTO [dbo].[S_Client]
        (
            [Fio],
            [Fleet],
            [Company],
            [Age],
            [Born],
            [Adress],
            [PostCode],
            [Сity],
            [T_hom],
            [T_wrk],
            [T_mob],
            [T_Fax],
            [Proff],
            [Oldavto],
            [Oldmodel],
            [Oldyear],
            [Remarks],
            [Brand],
            [Data_start],
            [Data_finish],
            [Model],
            [Version],
            [Engine],
            [Vid_engine],
            [VIN],
            [Territoriya],
            [Data_finish_ex],
            [Notes],
            [Data_input],
            [God],
            [Mes],
            [Dlr],
            [Fam],
            [Im],
            [Otch],
            [Pol],
            [Street],
            [E_mail],
            [Data_sale]
        )
    VALUES
        (
             @p_Fio,
             @p_Fleet,
             @p_Company,
             @p_Age,
             @p_Born,
             @p_Adress,
             @p_PostCode,
             @p_Сity,
             @p_T_hom,
             @p_T_wrk,
             @p_T_mob,
             @p_T_Fax,
             @p_Proff,
             @p_Oldavto,
             @p_Oldmodel,
             @p_Oldyear,
             @p_Remarks,
             @p_Brand,
             @p_Data_start,
             @p_Data_finish,
             @p_Model,
             @p_Version,
             @p_Engine,
             @p_Vid_engine,
             @p_VIN,
             @p_Territoriya,
             @p_Data_finish_ex,
             @p_Notes,
             @p_Data_input,
             @p_God,
             @p_Mes,
             @p_Dlr,
             @p_Fam,
             @p_Im,
             @p_Otch,
             @p_Pol,
             @p_Street,
             @p_E_mail,
             @p_Data_sale
        )

    SET @p_Id_out = SCOPE_IDENTITY()

    -- Call UPDATE for fields that have database defaults
    IF @p_Postav IS NOT NULL
        UPDATE [dbo].[S_Client] SET [Postav] = @p_Postav WHERE [Id] = @p_Id_out

    IF @p_Priznak IS NOT NULL
        UPDATE [dbo].[S_Client] SET [Priznak] = @p_Priznak WHERE [Id] = @p_Id_out

    IF @p_Ispol IS NOT NULL
        UPDATE [dbo].[S_Client] SET [Ispol] = @p_Ispol WHERE [Id] = @p_Id_out

    IF @p_Comp IS NOT NULL
        UPDATE [dbo].[S_Client] SET [Comp] = @p_Comp WHERE [Id] = @p_Id_out

END
GO
/****** Object:  StoredProcedure [dbo].[App_ClientUpdate]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Updates a record in the [dbo].[S_Client] table.
-- Concurreny is supported by using checksum method.
CREATE PROCEDURE [dbo].[App_ClientUpdate]
    @pk_Id int,
    @p_Postav smalldatetime,
    @p_Fio nvarchar(100),
    @p_Fleet nvarchar(30),
    @p_Company nvarchar(30),
    @p_Age nvarchar(30),
    @p_Born smalldatetime,
    @p_Adress nvarchar(50),
    @p_PostCode nvarchar(10),
    @p_Сity nvarchar(50),
    @p_T_hom nvarchar(20),
    @p_T_wrk nvarchar(20),
    @p_T_mob nvarchar(20),
    @p_T_Fax nvarchar(20),
    @p_Proff nvarchar(50),
    @p_Oldavto nvarchar(20),
    @p_Oldmodel nvarchar(20),
    @p_Oldyear nvarchar(4),
    @p_Remarks nvarchar(50),
    @p_Brand int,
    @p_Data_start smalldatetime,
    @p_Data_finish smalldatetime,
    @p_Model nvarchar(50),
    @p_Version nvarchar(50),
    @p_Engine nvarchar(50),
    @p_Vid_engine nvarchar(50),
    @p_VIN nvarchar(20),
    @p_Territoriya nvarchar(50),
    @p_Data_finish_ex smalldatetime,
    @p_Notes nvarchar(200),
    @p_Priznak nvarchar(10),
    @p_Ispol nvarchar(50),
    @p_Comp nvarchar(50),
    @p_Data_input datetime,
    @p_God int,
    @p_Mes nvarchar(20),
    @p_Dlr nvarchar(50),
    @p_Fam nvarchar(50),
    @p_Im nvarchar(50),
    @p_Otch nvarchar(50),
    @p_Pol nvarchar(1),
    @p_Street nvarchar(50),
    @p_E_mail nvarchar(50),
    @p_Data_sale datetime,
    @p_prevConValue nvarchar(4000),
    @p_force_update  char(1)
AS
DECLARE
    @l_newValue nvarchar(4000),
    @return_status int,
    @l_rowcount int
BEGIN
-- Check whether the record still exists before doing update
    IF NOT EXISTS (SELECT * FROM [dbo].[S_Client] WHERE [Id] = @pk_Id)
        RAISERROR ('Concurrency Error: The record has been deleted by another user. Table [dbo].[S_Client]', 16, 1)

    -- If user wants to force update to happen even if 
    -- the record has been modified by a concurrent user,
    -- then we do this.
    IF (@p_force_update = 'Y')
        BEGIN

            -- Update the record with the passed parameters
            UPDATE [dbo].[S_Client]
            SET 
            [Postav] = @p_Postav,
            [Fio] = @p_Fio,
            [Fleet] = @p_Fleet,
            [Company] = @p_Company,
            [Age] = @p_Age,
            [Born] = @p_Born,
            [Adress] = @p_Adress,
            [PostCode] = @p_PostCode,
            [Сity] = @p_Сity,
            [T_hom] = @p_T_hom,
            [T_wrk] = @p_T_wrk,
            [T_mob] = @p_T_mob,
            [T_Fax] = @p_T_Fax,
            [Proff] = @p_Proff,
            [Oldavto] = @p_Oldavto,
            [Oldmodel] = @p_Oldmodel,
            [Oldyear] = @p_Oldyear,
            [Remarks] = @p_Remarks,
            [Brand] = @p_Brand,
            [Data_start] = @p_Data_start,
            [Data_finish] = @p_Data_finish,
            [Model] = @p_Model,
            [Version] = @p_Version,
            [Engine] = @p_Engine,
            [Vid_engine] = @p_Vid_engine,
            [VIN] = @p_VIN,
            [Territoriya] = @p_Territoriya,
            [Data_finish_ex] = @p_Data_finish_ex,
            [Notes] = @p_Notes,
            [Priznak] = @p_Priznak,
            [Ispol] = @p_Ispol,
            [Comp] = @p_Comp,
            [Data_input] = @p_Data_input,
            [God] = @p_God,
            [Mes] = @p_Mes,
            [Dlr] = @p_Dlr,
            [Fam] = @p_Fam,
            [Im] = @p_Im,
            [Otch] = @p_Otch,
            [Pol] = @p_Pol,
            [Street] = @p_Street,
            [E_mail] = @p_E_mail,
            [Data_sale] = @p_Data_sale
            WHERE [Id] = @pk_Id

            -- Make sure only one record is affected
            SET @l_rowcount = @@ROWCOUNT
            IF @l_rowcount = 0
                RAISERROR ('The record cannot be updated.', 16, 1)
            IF @l_rowcount > 1
                RAISERROR ('duplicate object instances.', 16, 1)

        END
    ELSE
        BEGIN
            -- Get the checksum value for the record 
            -- and put an update lock on the record to 
            -- ensure transactional integrity.  The lock
            -- will be release when the transaction is 
            -- later committed or rolled back.
            Select @l_newValue = CAST(BINARY_CHECKSUM([Id],[Postav],[Fio],[Fleet],[Company],[Age],[Born],[Adress],[PostCode],[Сity],[T_hom],[T_wrk],[T_mob],[T_Fax],[Proff],[Oldavto],[Oldmodel],[Oldyear],[Remarks],[Brand],[Data_start],[Data_finish],[Model],[Version],[Engine],[Vid_engine],[VIN],[Territoriya],[Data_finish_ex],[Notes],[Priznak],[Ispol],[Comp],[Data_input],[God],[Mes],[Dlr],[Fam],[Im],[Otch],[Pol],[Street],[E_mail],[Data_sale]) AS nvarchar(4000)) 
            FROM [dbo].[S_Client] with (rowlock, holdlock)
            WHERE [Id] = @pk_Id


            -- Check concurrency by comparing the checksum values
            IF (@p_prevConValue = @l_newValue)
                SET @return_status = 0     -- pass
            ElSE
                SET @return_status = 1     -- fail

            -- Concurrency check passed.  Go ahead and 
            -- update the record
            IF (@return_status = 0)
                BEGIN

                    UPDATE [dbo].[S_Client]
                    SET 
                    [Postav] = @p_Postav,
                    [Fio] = @p_Fio,
                    [Fleet] = @p_Fleet,
                    [Company] = @p_Company,
                    [Age] = @p_Age,
                    [Born] = @p_Born,
                    [Adress] = @p_Adress,
                    [PostCode] = @p_PostCode,
                    [Сity] = @p_Сity,
                    [T_hom] = @p_T_hom,
                    [T_wrk] = @p_T_wrk,
                    [T_mob] = @p_T_mob,
                    [T_Fax] = @p_T_Fax,
                    [Proff] = @p_Proff,
                    [Oldavto] = @p_Oldavto,
                    [Oldmodel] = @p_Oldmodel,
                    [Oldyear] = @p_Oldyear,
                    [Remarks] = @p_Remarks,
                    [Brand] = @p_Brand,
                    [Data_start] = @p_Data_start,
                    [Data_finish] = @p_Data_finish,
                    [Model] = @p_Model,
                    [Version] = @p_Version,
                    [Engine] = @p_Engine,
                    [Vid_engine] = @p_Vid_engine,
                    [VIN] = @p_VIN,
                    [Territoriya] = @p_Territoriya,
                    [Data_finish_ex] = @p_Data_finish_ex,
                    [Notes] = @p_Notes,
                    [Priznak] = @p_Priznak,
                    [Ispol] = @p_Ispol,
                    [Comp] = @p_Comp,
                    [Data_input] = @p_Data_input,
                    [God] = @p_God,
                    [Mes] = @p_Mes,
                    [Dlr] = @p_Dlr,
                    [Fam] = @p_Fam,
                    [Im] = @p_Im,
                    [Otch] = @p_Otch,
                    [Pol] = @p_Pol,
                    [Street] = @p_Street,
                    [E_mail] = @p_E_mail,
                    [Data_sale] = @p_Data_sale
                    WHERE [Id] = @pk_Id

                    SET @l_rowcount = @@ROWCOUNT
                    IF @l_rowcount = 0
                        RAISERROR ('The record cannot be updated.', 16, 1)
                    IF @l_rowcount > 1
                        RAISERROR ('duplicate object instances.', 16, 1)

                END
            ELSE
            -- Concurrency check failed.  Inform the user by raising the error
                RAISERROR ('Concurrency Error: The record has been updated by another user. Table [dbo].[S_Client]', 16, 1)

        END
END
GO
/****** Object:  StoredProcedure [dbo].[App_ClientGet]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns a specific record from the [dbo].[S_Client] table.
CREATE PROCEDURE [dbo].[App_ClientGet]
        @pk_Id int
AS
DECLARE
    @l_count int
BEGIN

    -- Get the rowcount first and make sure 
    -- only one row is returned
    SELECT @l_count = count(*) 
    FROM [dbo].[S_Client]
    WHERE [Id] =@pk_Id

    IF @l_count = 0
        RAISERROR ('The record no longer exists.', 16, 1)
    IF @l_count > 1
        RAISERROR ('duplicate object instances.', 16, 1)

    -- Get the row from the query.  Checksum value will be
    -- returned along the row data to support concurrency.
    SELECT 
        [Id],
        [Postav],
        [Fio],
        [Fleet],
        [Company],
        [Age],
        [Born],
        [Adress],
        [PostCode],
        [Сity],
        [T_hom],
        [T_wrk],
        [T_mob],
        [T_Fax],
        [Proff],
        [Oldavto],
        [Oldmodel],
        [Oldyear],
        [Remarks],
        [Brand],
        [Data_start],
        [Data_finish],
        [Model],
        [Version],
        [Engine],
        [Vid_engine],
        [VIN],
        [Territoriya],
        [Data_finish_ex],
        [Notes],
        [Priznak],
        [Ispol],
        [Comp],
        [Data_input],
        [God],
        [Mes],
        [Dlr],
        [Fam],
        [Im],
        [Otch],
        [Pol],
        [Street],
        [E_mail],
        [Data_sale],
        CAST(BINARY_CHECKSUM([Id],[Postav],[Fio],[Fleet],[Company],[Age],[Born],[Adress],[PostCode],[Сity],[T_hom],[T_wrk],[T_mob],[T_Fax],[Proff],[Oldavto],[Oldmodel],[Oldyear],[Remarks],[Brand],[Data_start],[Data_finish],[Model],[Version],[Engine],[Vid_engine],[VIN],[Territoriya],[Data_finish_ex],[Notes],[Priznak],[Ispol],[Comp],[Data_input],[God],[Mes],[Dlr],[Fam],[Im],[Otch],[Pol],[Street],[E_mail],[Data_sale]) AS nvarchar(4000)) AS IS_CHECKSUM_COLUMN_12345
    FROM [dbo].[S_Client]
    WHERE [Id] =@pk_Id
END
GO
/****** Object:  StoredProcedure [dbo].[Upd_spr_payments]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Изменение структуры платежей оплат
/*
ALTER TABLE W_Sales_Payments ALTER COLUMN Start  DATETIME
ALTER TABLE W_Sales_Payments ALTER COLUMN Finish DATETIME

-- Добавление новой недели
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (1,2008,12,53,'NEW WEEK')
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (2,2008,12,53,'NEW WEEK')
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (3,2008,12,53,'NEW WEEK')
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (4,2008,12,53,'NEW WEEK')
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (5,2008,12,53,'NEW WEEK')
*/

/*
  Заполнение справочника для отчета по всем брендам на текущий год
  EXEC Upd_spr_payments 1,2009
  EXEC Upd_spr_payments 2,2009
  EXEC Upd_spr_payments 3,2009
  EXEC Upd_spr_payments 4,2009
  EXEC Upd_spr_payments 5,2009
  
Аuthor : Savchenko Arthur
  Date   : 01-07-2008 12:36
  SELECT * FROM W_Sales_Payments WHERE GOD=2008 and brand=1
*/

-- Заполнение календаря оплат на новый год промежутки задаются вручную по указанию аналитического отдела
-- 
-- Работает после процедуры Create_Sales_Payments которая подгатавливает данные на будющий год
-- потом обновляем данные текущей процедрой
-- Внимание 2008 год был высокостным поэтому во вторм месяце присутствует дата 2008-02-29 !!!
-- Последня корректировка базы произошла 2009-01-13 20:35
-- 


CREATE PROCEDURE [dbo].[Upd_spr_payments] (@Brand INT, @God INT)
AS
---- Jan
--UPDATE  W_Sales_Payments SET Mont=1, Start='2009-01-01', Finish='2009-01-06'  WHERE God=@God AND Weeks=1 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=1, Start='2009-01-07', Finish='2009-01-13'  WHERE God=@God AND Weeks=2 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=1, Start='2009-01-14', Finish='2009-01-20'  WHERE God=@God AND Weeks=3 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=1, Start='2009-01-21', Finish='2009-01-27'  WHERE God=@God AND Weeks=4 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=1, Start='2009-01-28', Finish='2009-01-31'  WHERE God=@God AND Weeks=5 AND Brand = @Brand
---- Feb
--UPDATE  W_Sales_Payments SET Mont=2, Start='2009-02-01', Finish='2009-02-10'  WHERE God=@God AND Weeks=6 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=2, Start='2009-02-11', Finish='2009-02-17'  WHERE God=@God AND Weeks=7 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=2, Start='2009-02-18', Finish='2009-02-24'  WHERE God=@God AND Weeks=8 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=2, Start='2009-02-25', Finish='2009-02-28'  WHERE God=@God AND Weeks=9 AND Brand = @Brand
---- Mar
--UPDATE  W_Sales_Payments SET Mont=3, Start='2009-03-01', Finish='2009-03-09'  WHERE God=@God AND Weeks=10 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=3, Start='2009-03-10', Finish='2009-03-16'  WHERE God=@God AND Weeks=11 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=3, Start='2009-03-17', Finish='2009-03-23'  WHERE God=@God AND Weeks=12 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=3, Start='2009-03-24', Finish='2009-03-31'  WHERE God=@God AND Weeks=13 AND Brand = @Brand
---- Apr
--UPDATE  W_Sales_Payments SET Mont=4, Start='2009-04-01', Finish='2009-04-06'  WHERE God=@God AND Weeks=14 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=4, Start='2009-04-07', Finish='2009-04-13'  WHERE God=@God AND Weeks=15 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=4, Start='2009-04-14', Finish='2009-04-20'  WHERE God=@God AND Weeks=16 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=4, Start='2009-04-21', Finish='2009-04-27'  WHERE God=@God AND Weeks=17 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=4, Start='2009-04-28', Finish='2009-04-30'  WHERE God=@God AND Weeks=18 AND Brand = @Brand
---- May
--UPDATE  W_Sales_Payments SET Mont=5, Start='2009-05-01', Finish='2009-05-04'  WHERE God=@God AND Weeks=19 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=5, Start='2009-05-05', Finish='2009-05-11'  WHERE God=@God AND Weeks=20 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=5, Start='2009-05-12', Finish='2009-05-18'  WHERE God=@God AND Weeks=21 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=5, Start='2009-05-19', Finish='2009-05-25'  WHERE God=@God AND Weeks=22 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=5, Start='2009-05-26', Finish='2009-05-31'  WHERE God=@God AND Weeks=23 AND Brand = @Brand
---- Jun
--UPDATE  W_Sales_Payments SET Mont=6, Start='2009-06-01', Finish='2009-06-08'  WHERE God=@God AND Weeks=24 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=6, Start='2009-06-09', Finish='2009-06-15'  WHERE God=@God AND Weeks=25 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=6, Start='2009-06-16', Finish='2009-06-22'  WHERE God=@God AND Weeks=26 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=6, Start='2009-06-23', Finish='2009-06-30'  WHERE God=@God AND Weeks=27 AND Brand = @Brand
---- Jul
--UPDATE  W_Sales_Payments SET Mont=7, Start='2009-07-01', Finish='2009-07-06'  WHERE God=@God AND Weeks=28 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=7, Start='2009-07-07', Finish='2009-07-13'  WHERE God=@God AND Weeks=29 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=7, Start='2009-07-14', Finish='2009-07-20'  WHERE God=@God AND Weeks=30 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=7, Start='2009-07-21', Finish='2009-07-27'  WHERE God=@God AND Weeks=31 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=7, Start='2009-07-28', Finish='2009-07-31'  WHERE God=@God AND Weeks=32 AND Brand = @Brand
---- Aug
--UPDATE  W_Sales_Payments SET Mont=8, Start='2009-08-01', Finish='2009-08-10'  WHERE God=@God AND Weeks=33 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=8, Start='2009-08-11', Finish='2009-08-17'  WHERE God=@God AND Weeks=34 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=8, Start='2009-08-18', Finish='2009-08-24'  WHERE God=@God AND Weeks=35 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=8, Start='2009-08-25', Finish='2009-08-31'  WHERE God=@God AND Weeks=36 AND Brand = @Brand
---- Sep
--UPDATE  W_Sales_Payments SET Mont=9, Start='2009-09-01', Finish='2009-09-07'  WHERE God=@God AND Weeks=37 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=9, Start='2009-09-08', Finish='2009-09-14'  WHERE God=@God AND Weeks=38 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=9, Start='2009-09-15', Finish='2009-09-21'  WHERE God=@God AND Weeks=39 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=9, Start='2009-09-22', Finish='2009-09-30'  WHERE God=@God AND Weeks=40 AND Brand = @Brand
---- Oct
--UPDATE  W_Sales_Payments SET Mont=10, Start='2009-10-01', Finish='2009-10-05'  WHERE God=@God AND Weeks=41 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=10, Start='2009-10-06', Finish='2009-10-12'  WHERE God=@God AND Weeks=42 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=10, Start='2009-10-13', Finish='2009-10-19'  WHERE God=@God AND Weeks=43 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=10, Start='2009-10-20', Finish='2009-10-26'  WHERE God=@God AND Weeks=44 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=10, Start='2009-10-27', Finish='2009-10-31'  WHERE God=@God AND Weeks=45 AND Brand = @Brand
---- Nov
--UPDATE  W_Sales_Payments SET Mont=11, Start='2009-11-01', Finish='2009-11-09'  WHERE God=@God AND Weeks=46 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=11, Start='2009-11-10', Finish='2009-11-16'  WHERE God=@God AND Weeks=47 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=11, Start='2009-11-17', Finish='2009-11-23'  WHERE God=@God AND Weeks=48 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=11, Start='2009-11-24', Finish='2009-11-30'  WHERE God=@God AND Weeks=49 AND Brand = @Brand
---- Dec
--UPDATE  W_Sales_Payments SET Mont=12, Start='2009-12-01', Finish='2009-12-07'  WHERE God=@God AND Weeks=50 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=12, Start='2009-12-08', Finish='2009-12-14'  WHERE God=@God AND Weeks=51 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=12, Start='2009-12-15', Finish='2009-12-21'  WHERE God=@God AND Weeks=52 AND Brand = @Brand
--UPDATE  W_Sales_Payments SET Mont=12, Start='2009-12-22', Finish='2009-12-31'  WHERE God=@God AND Weeks=53 AND Brand = @Brand



-- 2011
-- Jan
UPDATE  W_Sales_Payments SET Mont=1, Start='2011-01-01', Finish='2011-01-06'  WHERE God=@God AND Weeks=1 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=1, Start='2011-01-07', Finish='2011-01-13'  WHERE God=@God AND Weeks=2 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=1, Start='2011-01-14', Finish='2011-01-20'  WHERE God=@God AND Weeks=3 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=1, Start='2011-01-21', Finish='2011-01-27'  WHERE God=@God AND Weeks=4 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=1, Start='2011-01-28', Finish='2011-01-31'  WHERE God=@God AND Weeks=5 AND Brand = @Brand
-- Feb
UPDATE  W_Sales_Payments SET Mont=2, Start='2011-02-01', Finish='2011-02-10'  WHERE God=@God AND Weeks=6 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=2, Start='2011-02-11', Finish='2011-02-17'  WHERE God=@God AND Weeks=7 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=2, Start='2011-02-18', Finish='2011-02-24'  WHERE God=@God AND Weeks=8 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=2, Start='2011-02-25', Finish='2011-02-28'  WHERE God=@God AND Weeks=9 AND Brand = @Brand
-- Mar
UPDATE  W_Sales_Payments SET Mont=3, Start='2011-03-01', Finish='2011-03-09'  WHERE God=@God AND Weeks=10 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=3, Start='2011-03-10', Finish='2011-03-16'  WHERE God=@God AND Weeks=11 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=3, Start='2011-03-17', Finish='2011-03-23'  WHERE God=@God AND Weeks=12 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=3, Start='2011-03-24', Finish='2011-03-31'  WHERE God=@God AND Weeks=13 AND Brand = @Brand
-- Apr
UPDATE  W_Sales_Payments SET Mont=4, Start='2011-04-01', Finish='2011-04-06'  WHERE God=@God AND Weeks=14 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=4, Start='2011-04-07', Finish='2011-04-13'  WHERE God=@God AND Weeks=15 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=4, Start='2011-04-14', Finish='2011-04-20'  WHERE God=@God AND Weeks=16 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=4, Start='2011-04-21', Finish='2011-04-27'  WHERE God=@God AND Weeks=17 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=4, Start='2011-04-28', Finish='2011-04-30'  WHERE God=@God AND Weeks=18 AND Brand = @Brand
-- May
UPDATE  W_Sales_Payments SET Mont=5, Start='2011-05-01', Finish='2011-05-04'  WHERE God=@God AND Weeks=19 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=5, Start='2011-05-05', Finish='2011-05-11'  WHERE God=@God AND Weeks=20 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=5, Start='2011-05-12', Finish='2011-05-18'  WHERE God=@God AND Weeks=21 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=5, Start='2011-05-19', Finish='2011-05-25'  WHERE God=@God AND Weeks=22 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=5, Start='2011-05-26', Finish='2011-05-31'  WHERE God=@God AND Weeks=23 AND Brand = @Brand
-- Jun
UPDATE  W_Sales_Payments SET Mont=6, Start='2011-06-01', Finish='2011-06-08'  WHERE God=@God AND Weeks=24 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=6, Start='2011-06-09', Finish='2011-06-15'  WHERE God=@God AND Weeks=25 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=6, Start='2011-06-16', Finish='2011-06-22'  WHERE God=@God AND Weeks=26 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=6, Start='2011-06-23', Finish='2011-06-30'  WHERE God=@God AND Weeks=27 AND Brand = @Brand
-- Jul
UPDATE  W_Sales_Payments SET Mont=7, Start='2011-07-01', Finish='2011-07-06'  WHERE God=@God AND Weeks=28 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=7, Start='2011-07-07', Finish='2011-07-13'  WHERE God=@God AND Weeks=29 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=7, Start='2011-07-14', Finish='2011-07-20'  WHERE God=@God AND Weeks=30 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=7, Start='2011-07-21', Finish='2011-07-27'  WHERE God=@God AND Weeks=31 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=7, Start='2011-07-28', Finish='2011-07-31'  WHERE God=@God AND Weeks=32 AND Brand = @Brand
-- Aug
UPDATE  W_Sales_Payments SET Mont=8, Start='2011-08-01', Finish='2011-08-10'  WHERE God=@God AND Weeks=33 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=8, Start='2011-08-11', Finish='2011-08-17'  WHERE God=@God AND Weeks=34 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=8, Start='2011-08-18', Finish='2011-08-24'  WHERE God=@God AND Weeks=35 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=8, Start='2011-08-25', Finish='2011-08-31'  WHERE God=@God AND Weeks=36 AND Brand = @Brand
-- Sep
UPDATE  W_Sales_Payments SET Mont=9, Start='2011-09-01', Finish='2011-09-07'  WHERE God=@God AND Weeks=37 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=9, Start='2011-09-08', Finish='2011-09-14'  WHERE God=@God AND Weeks=38 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=9, Start='2011-09-15', Finish='2011-09-21'  WHERE God=@God AND Weeks=39 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=9, Start='2011-09-22', Finish='2011-09-30'  WHERE God=@God AND Weeks=40 AND Brand = @Brand
-- Oct
UPDATE  W_Sales_Payments SET Mont=10, Start='2011-10-01', Finish='2011-10-05'  WHERE God=@God AND Weeks=41 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=10, Start='2011-10-06', Finish='2011-10-12'  WHERE God=@God AND Weeks=42 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=10, Start='2011-10-13', Finish='2011-10-19'  WHERE God=@God AND Weeks=43 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=10, Start='2011-10-20', Finish='2011-10-26'  WHERE God=@God AND Weeks=44 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=10, Start='2011-10-27', Finish='2011-10-31'  WHERE God=@God AND Weeks=45 AND Brand = @Brand
-- Nov
UPDATE  W_Sales_Payments SET Mont=11, Start='2011-11-01', Finish='2011-11-09'  WHERE God=@God AND Weeks=46 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=11, Start='2011-11-10', Finish='2011-11-16'  WHERE God=@God AND Weeks=47 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=11, Start='2011-11-17', Finish='2011-11-23'  WHERE God=@God AND Weeks=48 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=11, Start='2011-11-24', Finish='2011-11-30'  WHERE God=@God AND Weeks=49 AND Brand = @Brand
-- Dec
UPDATE  W_Sales_Payments SET Mont=12, Start='2011-12-01', Finish='2011-12-07'  WHERE God=@God AND Weeks=50 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=12, Start='2011-12-08', Finish='2011-12-14'  WHERE God=@God AND Weeks=51 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=12, Start='2011-12-15', Finish='2011-12-21'  WHERE God=@God AND Weeks=52 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=12, Start='2011-12-22', Finish='2011-12-31'  WHERE God=@God AND Weeks=53 AND Brand = @Brand
GO
/****** Object:  StoredProcedure [dbo].[Create_Sales_Payments]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Подготовка отчета для финансов на год
-- Делается процедура только один раз в начале года


/*
DELETE FROM  W_Sales_payments
exec Create_Sales_Payments 1, 2007
exec Create_Sales_Payments 2, 2007
exec Create_Sales_Payments 3, 2007
exec Create_Sales_Payments 4, 2007
exec Create_Sales_Payments 5, 2007
SELECT * FROM W_Sales_payments
Аргументы
Бренд, Год, Месяц, Неделя, День с, День по
*/

/*  2009 год

exec Create_Sales_Payments 1, 2009
exec Create_Sales_Payments 2, 2009
exec Create_Sales_Payments 3, 2009
exec Create_Sales_Payments 4, 2009
exec Create_Sales_Payments 5, 2009

SELECT * FROM W_Sales_payments
*/


CREATE PROCEDURE [dbo].[Create_Sales_Payments]  (@Brand int, @God int)
AS
-- January
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,1,1,1,7)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,1,2,8,14)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,1,3,15,21)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,1,4,22,28)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,1,5,29,31)
-- February
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,2,6,1,11)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,2,7,12,18)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,2,8,19,25)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,2,9,26,28)
-- March
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,3,10,1,11)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,3,11,12,18)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,3,12,19,25)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,3,13,26,35)
-- April
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,4,14,1,6)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,4,15,7,13)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,4,16,14,20)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,4,17,22,30)
-- May
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,5,18,1,6)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,5,19,7,13)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,5,20,14,20)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,5,21,21,27)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,5,22,28,31)
-- June
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,6,23,1,10)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,6,24,11,17)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,6,25,18,24)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,6,26,25,30)
-- Jule
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,7,27,1,8)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,7,28,9,15)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,7,29,16,22)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,7,30,23,31)
-- August
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,8,31,1,5)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,8,32,6,12)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,8,33,13,19)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,8,34,20,26)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,8,35,27,31)
-- September
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,9,36,1,9)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,9,37,10,16)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,9,38,17,23)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,9,39,24,30)
-- October
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,10,40,1,7)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,10,41,8,14)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,10,42,15,21)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,10,43,22,28)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,10,44,29,31)
-- November
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,11,45,1,11)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,11,46,12,18)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,11,47,19,25)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,11,48,26,30)
-- Desember
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,12,49,1,11)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,12,50,12,18)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,12,51,19,25)
INSERT INTO [Winner].[dbo].[W_Sales_payments]([Brand], [God], [Mont], [Weeks], [Start], [Finish]) VALUES (@Brand, @God,12,52,26,30)
GO
/****** Object:  StoredProcedure [dbo].[Create_wsalespayments]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Формирование нового года для отчета 
/*

EXEC  Create_wsalespayments  1, 2010
EXEC  Create_wsalespayments  2, 2010
EXEC  Create_wsalespayments  3, 2010
EXEC  Create_wsalespayments  4, 2010
EXEC  Create_wsalespayments  5, 2010

EXEC  Create_wsalespayments  1, 2011
EXEC  Create_wsalespayments  2, 2011
EXEC  Create_wsalespayments  3, 2011
EXEC  Create_wsalespayments  4, 2011
EXEC  Create_wsalespayments  5, 2011

EXEC  Create_wsalespayments  1, 2012
EXEC  Create_wsalespayments  2, 2012
EXEC  Create_wsalespayments  3, 2012
EXEC  Create_wsalespayments  4, 2012
EXEC  Create_wsalespayments  5, 2012

*/
CREATE PROCEDURE [dbo].[Create_wsalespayments] (@Brend Int, @God INT)
AS

-- Удаление предыдущих данных
DELETE FROM W_Sales_Payments WHERE Brand=@Brend and God=@God

DECLARE @SGOD varchar(4)
SET @SGOD=CONVERT(varchar(4),@God)


INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 1, 1, @SGOD + '-01-01' ,@SGOD + '-01-06' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 1, 2, @SGOD + '-01-07' ,@SGOD + '-01-13' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 1, 3, @SGOD + '-01-14' ,@SGOD + '-01-20' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 1, 4, @SGOD + '-01-21' ,@SGOD + '-01-27' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 1, 5, @SGOD + '-01-28' ,@SGOD + '-01-31' ,0,0,0,' ', @God)

INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 2, 6, @SGOD + '-02-01' ,@SGOD + '-02-10' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 2, 7, @SGOD + '-02-11' ,@SGOD + '-02-17' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 2, 8, @SGOD + '-02-18' ,@SGOD + '-02-24' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 2, 9, @SGOD + '-02-27' ,@SGOD + '-02-29' ,0,0,0,' ', @God)

INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 3,10, @SGOD + '-03-01' ,@SGOD + '-03-09' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 3,11, @SGOD + '-03-10' ,@SGOD + '-03-16' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 3,12, @SGOD + '-03-17' ,@SGOD + '-03-23' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 3,13, @SGOD + '-03-24' ,@SGOD + '-03-31' ,0,0,0,' ', @God)

INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 4,14, @SGOD + '-04-01' ,@SGOD + '-04-06' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 4,15, @SGOD + '-04-07' ,@SGOD + '-04-13' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 4,16, @SGOD + '-04-14' ,@SGOD + '-04-20' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 4,17, @SGOD + '-04-21' ,@SGOD + '-04-27' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 4,18, @SGOD + '-04-28' ,@SGOD + '-04-30' ,0,0,0,' ', @God)

INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 5,19, @SGOD + '-05-01' ,@SGOD + '-05-04' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 5,20, @SGOD + '-05-05' ,@SGOD + '-05-11' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 5,21, @SGOD + '-05-12' ,@SGOD + '-05-18' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 5,22, @SGOD + '-05-19' ,@SGOD + '-05-25' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 5,23, @SGOD + '-05-26' ,@SGOD + '-05-31' ,0,0,0,' ', @God)

INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 6,24, @SGOD + '-06-01' ,@SGOD + '-06-08' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 6,25, @SGOD + '-06-09' ,@SGOD + '-06-15' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 6,26, @SGOD + '-06-16' ,@SGOD + '-06-22' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 6,27, @SGOD + '-06-23' ,@SGOD + '-06-30' ,0,0,0,' ', @God)

INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 7,28, @SGOD + '-07-01' ,@SGOD + '-07-06' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 7,29, @SGOD + '-07-07' ,@SGOD + '-07-13' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 7,30, @SGOD + '-07-14' ,@SGOD + '-07-20' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 7,31, @SGOD + '-07-21' ,@SGOD + '-07-27' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 7,32, @SGOD + '-07-28' ,@SGOD + '-07-31' ,0,0,0,' ', @God)

INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 8,33, @SGOD + '-08-01' ,@SGOD + '-08-10' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 8,34, @SGOD + '-08-11' ,@SGOD + '-08-17' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 8,35, @SGOD + '-08-18' ,@SGOD + '-08-24' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 8,36, @SGOD + '-08-25' ,@SGOD + '-08-31' ,0,0,0,' ', @God)

INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 9,37, @SGOD + '-09-01' ,@SGOD + '-09-07' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 9,38, @SGOD + '-09-08' ,@SGOD + '-09-14' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 9,39, @SGOD + '-09-15' ,@SGOD + '-09-21' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 9,40, @SGOD + '-09-22' ,@SGOD + '-09-30' ,0,0,0,' ', @God)

INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 10,41, @SGOD + '-10-01' ,@SGOD + '-10-05' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 10,42, @SGOD + '-10-06' ,@SGOD + '-10-12' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 10,43, @SGOD + '-10-13' ,@SGOD + '-10-19' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 10,44, @SGOD + '-10-20' ,@SGOD + '-10-26' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 10,45, @SGOD + '-10-27' ,@SGOD + '-10-31' ,0,0,0,' ', @God)

INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 11,46, @SGOD + '-11-01' ,@SGOD + '-11-09' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 11,47, @SGOD + '-11-10' ,@SGOD + '-11-16' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 11,48, @SGOD + '-11-17' ,@SGOD + '-11-23' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 11,49, @SGOD + '-11-24' ,@SGOD + '-11-30' ,0,0,0,' ', @God)

INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 12,50, @SGOD + '-12-01' ,@SGOD + '-12-07' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 12,51, @SGOD + '-12-08' ,@SGOD + '-12-14' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 12,52, @SGOD + '-12-15' ,@SGOD + '-12-25' ,0,0,0,' ', @God)
INSERT W_Sales_Payments(Brand,God,Mont,Weeks,Start,Finish,Units,Sales,Paid,Notes,Priznak) VALUES (@brend, @GOD, 12,53, @SGOD + '-12-26' ,@SGOD + '-12-31' ,0,0,0,' ', @God)
GO
/****** Object:  StoredProcedure [dbo].[Upd_spr_payments_2010]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Изменение структуры платежей оплат
/*
ALTER TABLE W_Sales_Payments ALTER COLUMN Start  DATETIME
ALTER TABLE W_Sales_Payments ALTER COLUMN Finish DATETIME

-- Добавление новой недели
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (1,2010,12,53,'NEW WEEK')
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (2,2010,12,53,'NEW WEEK')
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (3,2010,12,53,'NEW WEEK')
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (4,2010,12,53,'NEW WEEK')
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (5,2010,12,53,'NEW WEEK')
*/

/*
  Заполнение справочника для отчета по всем брендам на текущий год
  EXEC Upd_spr_payments_2010 1,2010
  EXEC Upd_spr_payments_2010 2,2010
  EXEC Upd_spr_payments_2010 3,2010
  EXEC Upd_spr_payments_2010 4,2010
  EXEC Upd_spr_payments_2010 5,2010
  
Аuthor : Savchenko Arthur
  Date   : 01-07-2010 12:36
  SELECT * FROM W_Sales_Payments WHERE GOD=2010 and brand=1
  SELECT * FROM W_Sales_Payments WHERE GOD=2010 and brand=2
  SELECT * FROM W_Sales_Payments WHERE GOD=2010 and brand=3
  SELECT * FROM W_Sales_Payments WHERE GOD=2010 and brand=4
  SELECT * FROM W_Sales_Payments WHERE GOD=2010 and brand=5


*/
CREATE PROCEDURE [dbo].[Upd_spr_payments_2010] (@Brand INT, @God INT)
AS
-- Jan
UPDATE  W_Sales_Payments SET Mont=1, Start='2010-01-01', Finish='2010-01-06'  WHERE God=@God AND Weeks=1 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=1, Start='2010-01-07', Finish='2010-01-13'  WHERE God=@God AND Weeks=2 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=1, Start='2010-01-14', Finish='2010-01-20'  WHERE God=@God AND Weeks=3 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=1, Start='2010-01-21', Finish='2010-01-27'  WHERE God=@God AND Weeks=4 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=1, Start='2010-01-28', Finish='2010-01-31'  WHERE God=@God AND Weeks=5 AND Brand = @Brand
-- Feb
UPDATE  W_Sales_Payments SET Mont=2, Start='2010-02-01', Finish='2010-02-10'  WHERE God=@God AND Weeks=6 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=2, Start='2010-02-11', Finish='2010-02-17'  WHERE God=@God AND Weeks=7 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=2, Start='2010-02-18', Finish='2010-02-24'  WHERE God=@God AND Weeks=8 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=2, Start='2010-02-25', Finish='2010-02-29'  WHERE God=@God AND Weeks=9 AND Brand = @Brand
-- Mar
UPDATE  W_Sales_Payments SET Mont=3, Start='2010-03-01', Finish='2010-03-09'  WHERE God=@God AND Weeks=10 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=3, Start='2010-03-10', Finish='2010-03-16'  WHERE God=@God AND Weeks=11 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=3, Start='2010-03-17', Finish='2010-03-23'  WHERE God=@God AND Weeks=12 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=3, Start='2010-03-24', Finish='2010-03-31'  WHERE God=@God AND Weeks=13 AND Brand = @Brand
-- Apr
UPDATE  W_Sales_Payments SET Mont=4, Start='2010-04-01', Finish='2010-04-06'  WHERE God=@God AND Weeks=14 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=4, Start='2010-04-07', Finish='2010-04-13'  WHERE God=@God AND Weeks=15 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=4, Start='2010-04-14', Finish='2010-04-20'  WHERE God=@God AND Weeks=16 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=4, Start='2010-04-21', Finish='2010-04-27'  WHERE God=@God AND Weeks=17 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=4, Start='2010-04-28', Finish='2010-04-30'  WHERE God=@God AND Weeks=18 AND Brand = @Brand
-- May
UPDATE  W_Sales_Payments SET Mont=5, Start='2010-05-01', Finish='2010-05-04'  WHERE God=@God AND Weeks=19 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=5, Start='2010-05-05', Finish='2010-05-11'  WHERE God=@God AND Weeks=20 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=5, Start='2010-05-12', Finish='2010-05-18'  WHERE God=@God AND Weeks=21 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=5, Start='2010-05-19', Finish='2010-05-25'  WHERE God=@God AND Weeks=22 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=5, Start='2010-05-26', Finish='2010-05-31'  WHERE God=@God AND Weeks=23 AND Brand = @Brand
-- Jun
UPDATE  W_Sales_Payments SET Mont=6, Start='2010-06-01', Finish='2010-06-08'  WHERE God=@God AND Weeks=24 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=6, Start='2010-06-09', Finish='2010-06-15'  WHERE God=@God AND Weeks=25 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=6, Start='2010-06-16', Finish='2010-06-22'  WHERE God=@God AND Weeks=26 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=6, Start='2010-06-23', Finish='2010-06-30'  WHERE God=@God AND Weeks=27 AND Brand = @Brand
-- Jul
UPDATE  W_Sales_Payments SET Mont=7, Start='2010-07-01', Finish='2010-07-06'  WHERE God=@God AND Weeks=28 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=7, Start='2010-07-07', Finish='2010-07-13'  WHERE God=@God AND Weeks=29 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=7, Start='2010-07-14', Finish='2010-07-20'  WHERE God=@God AND Weeks=30 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=7, Start='2010-07-21', Finish='2010-07-27'  WHERE God=@God AND Weeks=31 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=7, Start='2010-07-28', Finish='2010-07-31'  WHERE God=@God AND Weeks=32 AND Brand = @Brand
-- Aug
UPDATE  W_Sales_Payments SET Mont=8, Start='2010-08-01', Finish='2010-08-10'  WHERE God=@God AND Weeks=33 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=8, Start='2010-08-11', Finish='2010-08-17'  WHERE God=@God AND Weeks=34 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=8, Start='2010-08-18', Finish='2010-08-24'  WHERE God=@God AND Weeks=35 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=8, Start='2010-08-25', Finish='2010-08-31'  WHERE God=@God AND Weeks=36 AND Brand = @Brand
-- Sep
UPDATE  W_Sales_Payments SET Mont=9, Start='2010-09-01', Finish='2010-09-07'  WHERE God=@God AND Weeks=37 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=9, Start='2010-09-08', Finish='2010-09-14'  WHERE God=@God AND Weeks=38 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=9, Start='2010-09-15', Finish='2010-09-21'  WHERE God=@God AND Weeks=39 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=9, Start='2010-09-22', Finish='2010-09-30'  WHERE God=@God AND Weeks=40 AND Brand = @Brand
-- Oct
UPDATE  W_Sales_Payments SET Mont=10, Start='2010-10-01', Finish='2010-10-05'  WHERE God=@God AND Weeks=41 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=10, Start='2010-10-06', Finish='2010-10-12'  WHERE God=@God AND Weeks=42 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=10, Start='2010-10-13', Finish='2010-10-19'  WHERE God=@God AND Weeks=43 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=10, Start='2010-10-20', Finish='2010-10-26'  WHERE God=@God AND Weeks=44 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=10, Start='2010-10-27', Finish='2010-10-31'  WHERE God=@God AND Weeks=45 AND Brand = @Brand
-- Nov
UPDATE  W_Sales_Payments SET Mont=11, Start='2010-11-01', Finish='2010-11-09'  WHERE God=@God AND Weeks=46 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=11, Start='2010-11-10', Finish='2010-11-16'  WHERE God=@God AND Weeks=47 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=11, Start='2010-11-17', Finish='2010-11-23'  WHERE God=@God AND Weeks=48 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=11, Start='2010-11-24', Finish='2010-11-30'  WHERE God=@God AND Weeks=49 AND Brand = @Brand
-- Dec
UPDATE  W_Sales_Payments SET Mont=12, Start='2010-12-01', Finish='2010-12-07'  WHERE God=@God AND Weeks=50 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=12, Start='2010-12-08', Finish='2010-12-14'  WHERE God=@God AND Weeks=51 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=12, Start='2010-12-15', Finish='2010-12-21'  WHERE God=@God AND Weeks=52 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=12, Start='2010-12-22', Finish='2010-12-31'  WHERE God=@God AND Weeks=53 AND Brand = @Brand
GO
/****** Object:  StoredProcedure [dbo].[Upd_spr_payments_new]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Изменение структуры платежей оплат
/*
ALTER TABLE W_Sales_Payments ALTER COLUMN Start  DATETIME
ALTER TABLE W_Sales_Payments ALTER COLUMN Finish DATETIME

-- Добавление новой недели
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (1,2008,12,53,'NEW WEEK')
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (2,2008,12,53,'NEW WEEK')
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (3,2008,12,53,'NEW WEEK')
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (4,2008,12,53,'NEW WEEK')
INSERT W_Sales_Payments(Brand, god, Mont, Weeks, Notes) VALUES (5,2008,12,53,'NEW WEEK')
*/

/*
  Заполнение справочника для отчета по всем брендам на текущий год
  EXEC Upd_spr_payments 1,2008
  EXEC Upd_spr_payments 2,2008
  EXEC Upd_spr_payments 3,2008
  EXEC Upd_spr_payments 4,2008
  EXEC Upd_spr_payments 5,2008
  
Аuthor : Savchenko Arthur
  Date   : 01-07-2008 12:36
  SELECT * FROM W_Sales_Payments WHERE GOD=2008 and brand=1
*/

CREATE PROCEDURE [dbo].[Upd_spr_payments_new] (@Brand INT, @God INT)
AS
-- Jan
UPDATE  W_Sales_Payments SET Mont=1, Start='2008-01-01', Finish='2008-01-06'  WHERE God=@God AND Weeks=1 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=1, Start='2008-01-07', Finish='2008-01-13'  WHERE God=@God AND Weeks=2 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=1, Start='2008-01-14', Finish='2008-01-20'  WHERE God=@God AND Weeks=3 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=1, Start='2008-01-21', Finish='2008-01-27'  WHERE God=@God AND Weeks=4 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=1, Start='2008-01-28', Finish='2008-01-31'  WHERE God=@God AND Weeks=5 AND Brand = @Brand
-- Feb
UPDATE  W_Sales_Payments SET Mont=2, Start='2008-02-01', Finish='2008-02-10'  WHERE God=@God AND Weeks=6 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=2, Start='2008-02-11', Finish='2008-02-17'  WHERE God=@God AND Weeks=7 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=2, Start='2008-02-18', Finish='2008-02-24'  WHERE God=@God AND Weeks=8 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=2, Start='2008-02-25', Finish='2008-02-29'  WHERE God=@God AND Weeks=9 AND Brand = @Brand
-- Mar
UPDATE  W_Sales_Payments SET Mont=3, Start='2008-03-01', Finish='2008-03-09'  WHERE God=@God AND Weeks=10 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=3, Start='2008-03-10', Finish='2008-03-16'  WHERE God=@God AND Weeks=11 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=3, Start='2008-03-17', Finish='2008-03-23'  WHERE God=@God AND Weeks=12 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=3, Start='2008-03-24', Finish='2008-03-31'  WHERE God=@God AND Weeks=13 AND Brand = @Brand
-- Apr
UPDATE  W_Sales_Payments SET Mont=4, Start='2008-04-01', Finish='2008-04-06'  WHERE God=@God AND Weeks=14 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=4, Start='2008-04-07', Finish='2008-04-13'  WHERE God=@God AND Weeks=15 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=4, Start='2008-04-14', Finish='2008-04-20'  WHERE God=@God AND Weeks=16 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=4, Start='2008-04-21', Finish='2008-04-27'  WHERE God=@God AND Weeks=17 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=4, Start='2008-04-28', Finish='2008-04-30'  WHERE God=@God AND Weeks=18 AND Brand = @Brand
-- May
UPDATE  W_Sales_Payments SET Mont=5, Start='2008-05-01', Finish='2008-05-04'  WHERE God=@God AND Weeks=19 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=5, Start='2008-05-05', Finish='2008-05-11'  WHERE God=@God AND Weeks=20 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=5, Start='2008-05-12', Finish='2008-05-18'  WHERE God=@God AND Weeks=21 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=5, Start='2008-05-19', Finish='2008-05-25'  WHERE God=@God AND Weeks=22 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=5, Start='2008-05-26', Finish='2008-05-31'  WHERE God=@God AND Weeks=23 AND Brand = @Brand
-- Jun
UPDATE  W_Sales_Payments SET Mont=6, Start='2008-06-01', Finish='2008-06-08'  WHERE God=@God AND Weeks=24 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=6, Start='2008-06-09', Finish='2008-06-15'  WHERE God=@God AND Weeks=25 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=6, Start='2008-06-16', Finish='2008-06-22'  WHERE God=@God AND Weeks=26 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=6, Start='2008-06-23', Finish='2008-06-30'  WHERE God=@God AND Weeks=27 AND Brand = @Brand
-- Jul
UPDATE  W_Sales_Payments SET Mont=7, Start='2008-07-01', Finish='2008-07-06'  WHERE God=@God AND Weeks=28 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=7, Start='2008-07-07', Finish='2008-07-13'  WHERE God=@God AND Weeks=29 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=7, Start='2008-07-14', Finish='2008-07-20'  WHERE God=@God AND Weeks=30 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=7, Start='2008-07-21', Finish='2008-07-27'  WHERE God=@God AND Weeks=31 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=7, Start='2008-07-28', Finish='2008-07-31'  WHERE God=@God AND Weeks=32 AND Brand = @Brand
-- Aug
UPDATE  W_Sales_Payments SET Mont=8, Start='2008-08-01', Finish='2008-08-10'  WHERE God=@God AND Weeks=33 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=8, Start='2008-08-11', Finish='2008-08-17'  WHERE God=@God AND Weeks=34 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=8, Start='2008-08-18', Finish='2008-08-24'  WHERE God=@God AND Weeks=35 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=8, Start='2008-08-25', Finish='2008-08-31'  WHERE God=@God AND Weeks=36 AND Brand = @Brand
-- Sep
UPDATE  W_Sales_Payments SET Mont=9, Start='2008-09-01', Finish='2008-09-07'  WHERE God=@God AND Weeks=37 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=9, Start='2008-09-08', Finish='2008-09-14'  WHERE God=@God AND Weeks=38 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=9, Start='2008-09-15', Finish='2008-09-21'  WHERE God=@God AND Weeks=39 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=9, Start='2008-09-22', Finish='2008-09-30'  WHERE God=@God AND Weeks=40 AND Brand = @Brand
-- Oct
UPDATE  W_Sales_Payments SET Mont=10, Start='2008-10-01', Finish='2008-10-05'  WHERE God=@God AND Weeks=41 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=10, Start='2008-10-06', Finish='2008-10-12'  WHERE God=@God AND Weeks=42 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=10, Start='2008-10-13', Finish='2008-10-19'  WHERE God=@God AND Weeks=43 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=10, Start='2008-10-20', Finish='2008-10-26'  WHERE God=@God AND Weeks=44 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=10, Start='2008-10-27', Finish='2008-10-31'  WHERE God=@God AND Weeks=45 AND Brand = @Brand
-- Nov
UPDATE  W_Sales_Payments SET Mont=11, Start='2008-11-01', Finish='2008-11-09'  WHERE God=@God AND Weeks=46 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=11, Start='2008-11-10', Finish='2008-11-16'  WHERE God=@God AND Weeks=47 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=11, Start='2008-11-17', Finish='2008-11-23'  WHERE God=@God AND Weeks=48 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=11, Start='2008-11-24', Finish='2008-11-30'  WHERE God=@God AND Weeks=49 AND Brand = @Brand
-- Dec
UPDATE  W_Sales_Payments SET Mont=12, Start='2008-12-01', Finish='2008-12-07'  WHERE God=@God AND Weeks=50 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=12, Start='2008-12-08', Finish='2008-12-14'  WHERE God=@God AND Weeks=51 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=12, Start='2008-12-15', Finish='2008-12-21'  WHERE God=@God AND Weeks=52 AND Brand = @Brand
UPDATE  W_Sales_Payments SET Mont=12, Start='2008-12-22', Finish='2008-12-31'  WHERE God=@God AND Weeks=53 AND Brand = @Brand
GO
/****** Object:  Table [dbo].[W_Timesheet]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[W_Timesheet](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Company] [int] NOT NULL,
	[Department] [int] NOT NULL,
	[Employee] [int] NOT NULL,
	[Category] [int] NOT NULL,
	[Task_id] [int] NOT NULL,
	[Task] [nvarchar](50) NULL,
	[Start] [datetime] NOT NULL,
	[Finish] [datetime] NOT NULL,
	[Remark] [nvarchar](50) NULL,
	[Overtime] [int] NULL,
	[Priz] [int] NULL,
	[Polz] [nvarchar](50) NULL,
	[DataInsert] [datetime] NULL,
	[Week_namber] [int] NULL,
	[Week_day] [int] NULL,
	[Changed] [datetime] NULL,
	[Approve_director] [int] NULL,
	[Approve_gd] [int] NULL,
	[Flag] [int] NULL,
	[Totalmin]  AS (datediff(minute,[Start],[Finish])),
	[Totalhrs]  AS ([DBO].[Min_hoursmin](datediff(minute,[start],[finish]))),
 CONSTRAINT [PK__W_Timesheet__249408B6] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
/****** Object:  View [dbo].[A_Avtovoz]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Avtovoz]
AS
SELECT     TOP (100) PERCENT dbo.W_Avtovoz.IDN, dbo.W_Avtovoz.Carrier AS Id_perevoz, dbo.S_Carrier.Naz AS Nm_Perev, dbo.S_Carrier.Tel AS Tel_perev, 
                      dbo.W_Avtovoz.Date_transfer, dbo.S_Carrier_Driver.Fam, dbo.S_Carrier_Driver.Nam, dbo.S_Carrier_Driver.Otc, dbo.S_Carrier_Driver.T_mob, 
                      dbo.W_Avtovoz.Car_num, dbo.W_Avtovoz.Trailer_num, dbo.S_Carrier_Avto.Nom AS Car, dbo.S_Carrier_Traller.Nom AS Track, dbo.S_Carrier_Avto.Naz, 
                      dbo.W_Avtovoz.Acc_Number, dbo.W_Avtovoz.Acc_Date, dbo.W_Avtovoz.Remarks, dbo.W_Avtovoz.Acc_Sum, dbo.W_Avtovoz.Blocked, 
                      dbo.W_Avtovoz.Priznak, dbo.W_Avtovoz.Date_Planing, dbo.W_Avtovoz.Dlr_Actual_Arrival, dbo.W_Avtovoz.Commentary
FROM         dbo.S_Carrier_Driver RIGHT OUTER JOIN
                      dbo.S_Carrier_Traller RIGHT OUTER JOIN
                      dbo.W_Avtovoz LEFT OUTER JOIN
                      dbo.S_Carrier ON dbo.W_Avtovoz.Carrier = dbo.S_Carrier.ID ON dbo.S_Carrier_Traller.ID = dbo.W_Avtovoz.Trailer_num ON 
                      dbo.S_Carrier_Driver.ID = dbo.W_Avtovoz.Driver LEFT OUTER JOIN
                      dbo.S_Carrier_Avto ON dbo.W_Avtovoz.Car_num = dbo.S_Carrier_Avto.ID
WHERE     (dbo.W_Avtovoz.Priznak IS NULL) AND (dbo.W_Avtovoz.Date_transfer > CONVERT(DATETIME, '2009-01-01 00:00:00', 102))
ORDER BY dbo.W_Avtovoz.IDN, dbo.W_Avtovoz.Date_transfer, Nm_Perev, dbo.S_Carrier_Driver.Fam
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1[75] 4) )"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Carrier_Driver"
            Begin Extent = 
               Top = 412
               Left = 280
               Bottom = 520
               Right = 431
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Carrier_Traller"
            Begin Extent = 
               Top = 275
               Left = 296
               Bottom = 383
               Right = 447
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Avtovoz"
            Begin Extent = 
               Top = 28
               Left = 27
               Bottom = 448
               Right = 184
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Carrier"
            Begin Extent = 
               Top = 1
               Left = 288
               Bottom = 130
               Right = 439
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Carrier_Avto"
            Begin Extent = 
               Top = 135
               Left = 297
               Bottom = 243
               Right = 448
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 11
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Avtovoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Avtovoz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Avtovoz'
GO
/****** Object:  View [dbo].[A_Weight]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Weight]
AS
SELECT     TOP (100) PERCENT dbo.S_Weight.Brand, dbo.S_Weight.Model, dbo.S_Weight.Vers, dbo.S_Weight.Body, dbo.S_Version.Naz AS Vers_name, 
                      dbo.S_Country_2.Name_ang AS Country, dbo.S_Compound.Compound, ISNULL(dbo.S_Weight.Insurance, 0) AS Insurance, ISNULL(dbo.S_Weight.Freight, 0) AS Freight, 
                      dbo.S_Weight.Ves, dbo.S_Trim_S.Nazv AS Bodytype, dbo.S_Model.Naz
FROM         dbo.S_Compound INNER JOIN
                      dbo.S_Country_2 INNER JOIN
                      dbo.S_Weight ON dbo.S_Country_2.Idd = dbo.S_Weight.Contry INNER JOIN
                      dbo.S_Version ON dbo.S_Weight.Vers = dbo.S_Version.ID ON dbo.S_Compound.IDC = dbo.S_Weight.Compound INNER JOIN
                      dbo.S_Trim_S ON dbo.S_Weight.Body = dbo.S_Trim_S.ID INNER JOIN
                      dbo.S_Model ON dbo.S_Weight.Model = dbo.S_Model.ID
ORDER BY dbo.S_Weight.Vers
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[53] 4[21] 2[2] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Compound"
            Begin Extent = 
               Top = 199
               Left = 887
               Bottom = 339
               Right = 1057
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Country_2"
            Begin Extent = 
               Top = 233
               Left = 246
               Bottom = 443
               Right = 412
            End
            DisplayFlags = 280
            TopColumn = 14
         End
         Begin Table = "S_Weight"
            Begin Extent = 
               Top = 31
               Left = 545
               Bottom = 292
               Right = 726
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 62
               Left = 893
               Bottom = 178
               Right = 1053
            End
            DisplayFlags = 280
            TopColumn = 3
         End
         Begin Table = "S_Trim_S"
            Begin Extent = 
               Top = 21
               Left = 252
               Bottom = 207
               Right = 412
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 242
               Left = 1250
               Bottom = 468
               Right = 1419
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 12
         Width = 284
         Width = 855
         W' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Weight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'idth = 885
         Width = 975
         Width = 1050
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 3270
         Alias = 2880
         Table = 2880
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Weight'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Weight'
GO
/****** Object:  StoredProcedure [dbo].[Remembers_mail]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Оповещение об оплате основным людям отвечающие за оплату
-- EXEC REMEMBERS_MAIL 'Remind Payment Dealer Status','Payments in Dealer Status Update !!!'
CREATE PROCEDURE [dbo].[Remembers_mail] (@Remarks NVARCHAR(50), @Telo NVARCHAR(200))
AS

--Finance
--EXEC mail_send 'yprysich@winner.ua',      @Telo, @Remarks 
--EXEC mail_send 'sberezovskiy@winner.ua',  @Telo, @Remarks    -- Березовский
  EXEC mail_send 'pavlish@winner.ua',     @Telo, @Remarks    -- Хряпыч   

--Логистика
--EXEC mail_send 'tosadcha@winner.ua',     @Telo, @Remarks  
  EXEC mail_send 'isoldatenko@winner.ua',  'Оплаты закачаны !! Можешь отгружать', 'Инна,  оплаты закачаны .'
--EXEC mail_send 'nyeltsina@winner.ua',    @Telo, @Remarks  

-- 1. Форд 
--EXEC mail_send 'npylypchuk@winner.ua',   @Telo, @Remarks   -- Пилипчук

-- 2. Volvo
  EXEC mail_send 'vartemenko@winner.ua',   @Telo, @Remarks   -- Артеменко
  EXEC mail_send 'huschapovska@winner.ua', @Telo, @Remarks   -- Ганна ущаповська
 
-- 3. Jaguar
  EXEC mail_send 'svoytovych@winner.ua',   'Обновление оплат !!!', 'Оплаты от дилеров в базе данных обновлены !!!'

-- 4. Land Rover
EXEC mail_send 'sberezovska@winner.ua',  @Telo, @Remarks  -- Гардецкий

-- 5. Porsche
EXEC mail_send 'ibolhovska@winner.ua',    @Telo, @Remarks    -- Болховская

--EXEC mail_send 'igulyayev@winner.ua',     @Telo, @Remarks    -- Гуляев
--Bussiness Process лично мне оповещения о прохождении оповещений другим отделам
EXEC mail_send 'asavchenko@winner.ua',    @Telo, @Remarks
--EXEC mail_send 'asavchenko@winner.ua',    'Оповещатель', 'Оповещения об оплате отосланы исполнителям'
--EXEC Write_Log 'Savchenko', 'Update Payment !!!!', 23456, Default,'New','Old'
GO
/****** Object:  StoredProcedure [dbo].[Insert_rate]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--UPDATE s_Rate SET Rate_ed = Rate/size,
--Date_curr=REPLACE(CONVERT(VARCHAR(10), DATE, 102),'.','') + char3

--REPLACE(CONVERT(VARCHAR(10), DATE, 101), '/', '')
--select * from S_Rate

-- Добавление шаблона за дату
CREATE PROCEDURE [dbo].[Insert_rate](@Idate DATETIME)
AS
DELETE FROM  S_Rate WHERE DATE=@IDATE
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'036','AUD',100, 'австралійських доларів')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'031','AZM',100, 'азербайджанських манатів')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'826','GBP',100, 'англійських фунтів стерлінгів')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'974','BYR',10,  'білоруських рублів')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'208','DKK',100, 'датських крон')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'840','USD',100, 'доларів США')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'233','EEK',100, 'естонських крон')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'978','EUR',100, 'ЄВРО')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'352','ISK',100, 'ісландських крон')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'398','KZT',100, 'казахстанських тенге')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'124','CAD',100, 'канадських доларів')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'428','LVL',100, 'латвійських латів')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'440','LTL',100, 'литовських літів')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'498','MDL',100, 'молдовських леїв')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'578','NOK',100, 'норвезьких крон')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'985','PLN',100, 'польських злотих')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'643','RUB',10,  'російських рублів')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'702','SGD',100, 'сінгапурських доларів')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'960','XDR',100, 'СПЗ')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'792','TRL',100, 'турецьких лір')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'795','TMM',100, 'туркменських манатів')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'348','HUF',1000,'угорських форинтів')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'860','UZS',100, 'узбецьких сумів')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'203','CZK',100, 'чеських крон')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'752','SEK',100, 'шведських крон')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'756','CHF',100, 'швейцарських франків')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'156','CNY',100, 'юанів женьміньбі (Китай)')
INSERT S_Rate(date,code,char3,size,name) VALUES (@Idate,'392','JPY',1000,'японських єн')

-- Контроль введенных данных
--SELECT  DISTINCT DATE FROM S_RATE WHERE YEAR(DATE) = 2009 ORDER BY DATE
--SELECT  DISTINCT DATE FROM S_RATE WHERE YEAR(DATE) = 2010 ORDER BY DATE



-- Добавленные курсы по просьбе Степаненко Васи
-- JAN 2000 (17) 
--exec Insert_rate '2000-01-01'
--exec Insert_rate '2000-01-02'
--exec Insert_rate '2000-01-03'
--exec Insert_rate '2000-01-04'
--exec Insert_rate '2000-01-05'
--exec Insert_rate '2000-01-06'
--exec Insert_rate '2000-01-07'
--exec Insert_rate '2000-01-08'
--exec Insert_rate '2000-01-09'
--exec Insert_rate '2000-01-10'
--exec Insert_rate '2000-01-11'
--exec Insert_rate '2000-01-12'
--exec Insert_rate '2000-01-13'
--exec Insert_rate '2000-01-14'
--exec Insert_rate '2000-01-15'
--exec Insert_rate '2000-01-16'
--exec Insert_rate '2000-01-17'

-- JAN 2009 (31)
--exec Insert_rate '2009-01-01'
--exec Insert_rate '2009-01-02'
--exec Insert_rate '2009-01-03'
--exec Insert_rate '2009-01-04'
--exec Insert_rate '2009-01-05'
--exec Insert_rate '2009-01-06'
--exec Insert_rate '2009-01-07'
--exec Insert_rate '2009-01-08'
--exec Insert_rate '2009-01-09'
--exec Insert_rate '2009-01-10'
--exec Insert_rate '2009-01-11'
--exec Insert_rate '2009-01-12'
--exec Insert_rate '2009-01-13'
--exec Insert_rate '2009-01-14'
--exec Insert_rate '2009-01-15'
--exec Insert_rate '2009-01-16'
--exec Insert_rate '2009-01-17'
--exec Insert_rate '2009-01-18'
--exec Insert_rate '2009-01-19'
--exec Insert_rate '2009-01-20'
--exec Insert_rate '2009-01-21'
--exec Insert_rate '2009-01-22'
--exec Insert_rate '2009-01-23'
--exec Insert_rate '2009-01-24'
--exec Insert_rate '2009-01-25'
--exec Insert_rate '2009-01-26'
--exec Insert_rate '2009-01-27'
--exec Insert_rate '2009-01-28'
--exec Insert_rate '2009-01-29'
--exec Insert_rate '2009-01-30'
--exec Insert_rate '2009-01-31'
--
---- FEB 2009 (28)
--exec Insert_rate '2009-02-01'
--exec Insert_rate '2009-02-02'
--exec Insert_rate '2009-02-03'
--exec Insert_rate '2009-02-04'
--exec Insert_rate '2009-02-05'
--exec Insert_rate '2009-02-06'
--exec Insert_rate '2009-02-07'
--exec Insert_rate '2009-02-08'
--exec Insert_rate '2009-02-09'
--exec Insert_rate '2009-02-10'
--exec Insert_rate '2009-02-11'
--exec Insert_rate '2009-02-12'
--exec Insert_rate '2009-02-13'
--exec Insert_rate '2009-02-14'
--exec Insert_rate '2009-02-15'
--exec Insert_rate '2009-02-16'
--exec Insert_rate '2009-02-17'
--exec Insert_rate '2009-02-18'
--exec Insert_rate '2009-02-19'
--exec Insert_rate '2009-02-20'
--exec Insert_rate '2009-02-21'
--exec Insert_rate '2009-02-22'
--exec Insert_rate '2009-02-23'
--exec Insert_rate '2009-02-24'
--exec Insert_rate '2009-02-25'
--exec Insert_rate '2009-02-26'
--exec Insert_rate '2009-02-27'
--exec Insert_rate '2009-02-28'
--
---- MART 2009 (31)
--exec Insert_rate '2009-03-01'
--exec Insert_rate '2009-03-02'
--exec Insert_rate '2009-03-03'
--exec Insert_rate '2009-03-04'
--exec Insert_rate '2009-03-05'
--exec Insert_rate '2009-03-06'
--exec Insert_rate '2009-03-07'
--exec Insert_rate '2009-03-08'
--exec Insert_rate '2009-03-09'
--exec Insert_rate '2009-03-10'
--exec Insert_rate '2009-03-11'
--exec Insert_rate '2009-03-12'
--exec Insert_rate '2009-03-13'
--exec Insert_rate '2009-03-14'
--exec Insert_rate '2009-03-15'
--exec Insert_rate '2009-03-16'
--exec Insert_rate '2009-03-17'
--exec Insert_rate '2009-03-18'
--exec Insert_rate '2009-03-19'
--exec Insert_rate '2009-03-20'
--exec Insert_rate '2009-03-21'
--exec Insert_rate '2009-03-22'
--exec Insert_rate '2009-03-23'
--exec Insert_rate '2009-03-24'
--exec Insert_rate '2009-03-25'
--exec Insert_rate '2009-03-26'
--exec Insert_rate '2009-03-27'
--exec Insert_rate '2009-03-28'
--exec Insert_rate '2009-03-29'
--exec Insert_rate '2009-03-30'
--exec Insert_rate '2009-03-31'
--
--
---- APRIL 2009 (30)
--exec Insert_rate '2009-04-01'
--exec Insert_rate '2009-04-02'
--exec Insert_rate '2009-04-03'
--exec Insert_rate '2009-04-04'
--exec Insert_rate '2009-04-05'
--exec Insert_rate '2009-04-06'
--exec Insert_rate '2009-04-07'
--exec Insert_rate '2009-04-08'
--exec Insert_rate '2009-04-09'
--exec Insert_rate '2009-04-10'
--exec Insert_rate '2009-04-11'
--exec Insert_rate '2009-04-12'
--exec Insert_rate '2009-04-13'
--exec Insert_rate '2009-04-14'
--exec Insert_rate '2009-04-15'
--exec Insert_rate '2009-04-16'
--exec Insert_rate '2009-04-17'
--exec Insert_rate '2009-04-18'
--exec Insert_rate '2009-04-19'
--exec Insert_rate '2009-04-20'
--exec Insert_rate '2009-04-21'
--exec Insert_rate '2009-04-22'
--exec Insert_rate '2009-04-23'
--exec Insert_rate '2009-04-24'
--exec Insert_rate '2009-04-25'
--exec Insert_rate '2009-04-26'
--exec Insert_rate '2009-04-27'
--exec Insert_rate '2009-04-28'
--exec Insert_rate '2009-04-29'
--exec Insert_rate '2009-04-30'
--
---- MAY 2009 (31)
--exec Insert_rate '2009-05-01'
--exec Insert_rate '2009-05-02'
--exec Insert_rate '2009-05-03'
--exec Insert_rate '2009-05-04'
--exec Insert_rate '2009-05-05'
--exec Insert_rate '2009-05-06'
--exec Insert_rate '2009-05-07'
--exec Insert_rate '2009-05-08'
--exec Insert_rate '2009-05-09'
--exec Insert_rate '2009-05-10'
--exec Insert_rate '2009-05-11'
--exec Insert_rate '2009-05-12'
--exec Insert_rate '2009-05-13'
--exec Insert_rate '2009-05-14'
--exec Insert_rate '2009-05-15'
--exec Insert_rate '2009-05-16'
--exec Insert_rate '2009-05-17'
--exec Insert_rate '2009-05-18'
--exec Insert_rate '2009-05-19'
--exec Insert_rate '2009-05-20'
--exec Insert_rate '2009-05-21'
--exec Insert_rate '2009-05-22'
--exec Insert_rate '2009-05-23'
--exec Insert_rate '2009-05-24'
--exec Insert_rate '2009-05-25'
--exec Insert_rate '2009-05-26'
--exec Insert_rate '2009-05-27'
--exec Insert_rate '2009-05-28'
--exec Insert_rate '2009-05-29'
--exec Insert_rate '2009-05-30'
--exec Insert_rate '2009-05-31'
--
---- JULY 2009 (2)
--exec Insert_rate '2009-06-01'
--exec Insert_rate '2009-06-02'
--
--
---- JANUARY 2010 (1)
--exec Insert_rate '2010-01-30'
--
---- FEBRURY 2010 (16)
--exec Insert_rate '2010-02-01'
--exec Insert_rate '2010-02-02'
--exec Insert_rate '2010-02-03'
--exec Insert_rate '2010-02-04'
--exec Insert_rate '2010-02-05'
--exec Insert_rate '2010-02-06'
--exec Insert_rate '2010-02-07'
--exec Insert_rate '2010-02-08'
--exec Insert_rate '2010-02-09'
--exec Insert_rate '2010-02-10'
--exec Insert_rate '2010-02-11'
--exec Insert_rate '2010-02-12'
--exec Insert_rate '2010-02-13'
--exec Insert_rate '2010-02-14'
--exec Insert_rate '2010-02-15'
--exec Insert_rate '2010-02-20'
--
----
GO
/****** Object:  StoredProcedure [dbo].[Insert_rate_last_period]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*

--select  date from s_rate group by date

-- Копирование предыдущих курсов в новый день 
 EXEC Insert_rate_last_period '2010/03/17','2010/03/20'
 EXEC Insert_rate_last_period '2010/03/17','2010/03/21'
 EXEC Insert_rate_last_period '2010/03/21','2010/03/22'
 EXEC Insert_rate_last_period '2010/03/26','2010/03/27'
 EXEC Insert_rate_last_period '2010/03/26','2010/03/28'
 
При закачке если нет данных за предыдущие дни то необходимо закачивать за сегодняшний день
*/

CREATE PROCEDURE [dbo].[Insert_rate_last_period](@Old_Date DATETIME, @New_Date DATETIME)
AS

-- Удаление предыдущей версии за этот день
DELETE FROM  S_Rate WHERE Date = @New_Date

-- Вставка данных
INSERT S_Rate([date], code, char3, size, name, rate, change) 
SELECT @New_Date, code, char3, size, name, rate, change
FROM   s_rate 
WHERE  date = @Old_Date
GO
/****** Object:  View [dbo].[A_Vic_sub]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Vic_sub]
AS
SELECT     Ids, MAX(Date) AS Date, MAX(Location) AS Location, MAX(Indicator) AS Indicator
FROM         dbo.W_Vic_Sub
GROUP BY Ids
HAVING      (MAX(Location) IS NOT NULL)
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[34] 4[27] 2[3] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Vic_Sub"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 283
               Right = 253
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 13
         Width = 284
         Width = 2070
         Width = 3255
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 2655
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Vic_sub'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Vic_sub'
GO
/****** Object:  View [dbo].[A_Ts_gd]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Ts_gd]
AS
SELECT     TOP (100) PERCENT dbo.S_Company.Naz AS Компанія, dbo.S_User.Fio AS Працівник, dbo.S_Task.Naz AS Задача, dbo.S_Group_Task.Naz AS Група,
                       dbo.W_Timesheet_Task.Start AS Початок, dbo.W_Timesheet_Task.Finish AS Кінець, dbo.W_Timesheet_Task.Norm_0 AS [Всього норм], 
                      dbo.W_Timesheet_Task.Over_0 AS [Всього сверх], dbo.W_Timesheet_Task.Norm_1 AS [Норм пн], dbo.W_Timesheet_Task.Over_1 AS [Сверх пн], 
                      dbo.W_Timesheet_Task.Norm_2 AS [Норм вт], dbo.W_Timesheet_Task.Over_2 AS [Сверх вт], dbo.W_Timesheet_Task.Norm_3 AS [Норм ср], 
                      dbo.W_Timesheet_Task.Over_3 AS [Сверх ср], dbo.W_Timesheet_Task.Norm_4 AS [Норм чт], dbo.W_Timesheet_Task.Over_4 AS [Сверх чт], 
                      dbo.W_Timesheet_Task.Norm_5 AS [Норм пт], dbo.W_Timesheet_Task.Over_5 AS [Сверх пт], dbo.W_Timesheet_Task.Over_6 AS [Сверх сб], 
                      dbo.W_Timesheet_Task.Over_7 AS [Сверх вс], dbo.W_Timesheet_Task.Remark AS Примітки, dbo.W_Timesheet_Task.Aproval AS Затверджено, 
                      dbo.W_Timesheet_Task.Week_number AS [Номер неділі], dbo.W_Timesheet_Task.Year_number AS Рік, 
                      dbo.W_Timesheet_Task.ID_employee AS Empl, dbo.W_Timesheet_Task.Employee
FROM         dbo.W_Timesheet_Task LEFT OUTER JOIN
                      dbo.S_Task ON dbo.W_Timesheet_Task.Id_task = dbo.S_Task.Id LEFT OUTER JOIN
                      dbo.S_Group_Task ON dbo.W_Timesheet_Task.Id_group = dbo.S_Group_Task.Id LEFT OUTER JOIN
                      dbo.S_User ON dbo.W_Timesheet_Task.ID_employee = dbo.S_User.ID LEFT OUTER JOIN
                      dbo.S_Company ON dbo.W_Timesheet_Task.ID_company = dbo.S_Company.Id
ORDER BY Працівник
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[48] 4[27] 2[9] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Timesheet_Task"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 357
               Right = 273
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Task"
            Begin Extent = 
               Top = 257
               Left = 411
               Bottom = 365
               Right = 562
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Group_Task"
            Begin Extent = 
               Top = 180
               Left = 643
               Bottom = 288
               Right = 796
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_User"
            Begin Extent = 
               Top = 0
               Left = 444
               Bottom = 108
               Right = 595
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Company"
            Begin Extent = 
               Top = 58
               Left = 636
               Bottom = 151
               Right = 787
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 26
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
 ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_gd'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'        Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 3180
         Table = 2670
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_gd'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_gd'
GO
/****** Object:  View [dbo].[A_Parameters]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Parameters]
AS
SELECT     dbo.S_Parameters.ID AS NumID, dbo.S_Brend.Naz AS Brand_Name, dbo.S_Model.Naz AS Model_Name, dbo.S_Version.Naz AS Vers_Name, 
                      dbo.S_Trim_s.Nazv AS Body_Name, dbo.S_Engenie.Naz AS Engine_Name, dbo.S_Parameters.Dat AS Date_changed, dbo.S_Parameters.Code, 
                      dbo.S_Parameters.Cod AS ID_Cod, dbo.S_Parameters.Brand AS ID_Brand, dbo.S_Parameters.Model AS ID_Model, dbo.S_Parameters.Vers AS ID_Vers, 
                      dbo.S_Parameters.Body AS ID_Body, dbo.S_Parameters.Eng AS ID_Eng, dbo.S_Parameters.Remark AS Remarks
FROM         dbo.S_Version RIGHT OUTER JOIN
                      dbo.S_Trim_s RIGHT OUTER JOIN
                      dbo.S_Parameters LEFT OUTER JOIN
                      dbo.S_Engenie ON dbo.S_Parameters.Eng = dbo.S_Engenie.ID ON dbo.S_Trim_s.ID = dbo.S_Parameters.Body ON 
                      dbo.S_Version.ID = dbo.S_Parameters.Vers LEFT OUTER JOIN
                      dbo.S_Model ON dbo.S_Parameters.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.S_Parameters.Brand = dbo.S_Brend.ID
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[39] 4[40] 2[3] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 176
               Left = 374
               Bottom = 272
               Right = 525
            End
            DisplayFlags = 280
            TopColumn = 2
         End
         Begin Table = "S_Trim_s"
            Begin Extent = 
               Top = 277
               Left = 376
               Bottom = 355
               Right = 527
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Parameters"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 314
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Engenie"
            Begin Extent = 
               Top = 358
               Left = 377
               Bottom = 466
               Right = 528
            End
            DisplayFlags = 280
            TopColumn = 5
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 90
               Left = 373
               Bottom = 173
               Right = 524
            End
            DisplayFlags = 280
            TopColumn = 4
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 7
               Left = 373
               Bottom = 88
               Right = 524
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
      ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Parameters'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'   Alias = 1995
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Parameters'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Parameters'
GO
/****** Object:  View [dbo].[A_View_old]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_View_old]
AS
SELECT     dbo.W_Order.Zakaz, dbo.W_Order.ID, dbo.W_Order.D_zakaza, dbo.S_Model.Naz AS Model, dbo.W_Order.Brend, dbo.S_Version.Naz AS Version, 
                      dbo.S_Status.ID AS I_status, dbo.S_Status.Naz AS Status, dbo.W_Order.Engine, dbo.S_Engenie.Naz AS Engenie, dbo.W_Order.Trimm, 
                      dbo.S_Colours.Naz AS Col_S, dbo.W_Order.Colour, dbo.S_Colourk.Naz AS Col_K, dbo.W_Order.Get_release_Date, dbo.W_Order.Invoice_Date, 
                      dbo.W_Order.VIN, dbo.W_Order.Dat_zak, dbo.S_Gearbox.Naz AS GearBox, dbo.W_Order.Isppol, dbo.W_Order.Model AS I_Model, 
                      dbo.W_Order.Vers AS I_Vers, dbo.W_Order.Viev, dbo.W_Order.MY, dbo.W_Order.Dlr AS I_Dealer, dbo.W_Order.Spec1 AS I_Spec1, 
                      dbo.W_Order.Spec2 AS I_Spec2, dbo.W_Order.Spec3 AS I_Spec3, dbo.W_Order.Colours AS I_Colours, dbo.W_Order.GearBox AS I_Gearbox, 
                      dbo.S_Trim.Body, dbo.S_Brend.Naz AS Brand_name, dbo.S_Diler.Naz AS Dlr_name, dbo.S_Trim_s.Nazv AS Trimmm, dbo.S_Colourk.ID AS Expr1, 
                      dbo.W_Order.OrderPlaced, dbo.W_Order.Invoice_Number, dbo.S_Diler.Last_Name, dbo.S_Diler.Sokr, dbo.W_Order.RLS, dbo.W_Order.RLS_placed, 
                      dbo.W_Order.Sorder, dbo.W_Order.Cif_cip_calc, dbo.W_Order.Cif_cip, dbo.W_Order.Dealer_price, dbo.W_Order.MSRP, dbo.W_Order.DeadlineChange, 
                      dbo.W_Order.Product_confirmed, dbo.W_Order.ProdM, dbo.W_Order.Start_Production, dbo.W_Order.Date_completed, dbo.W_Order.ContractDD, 
                      dbo.W_Order.DLR_Suggested_Arrival, dbo.W_Order.DLR_Actual_Arrival, dbo.W_Order.Sold_to_DLR, dbo.W_Order.Sold_to_Client, 
                      dbo.W_Order.Days_in_prod, dbo.W_Order.Days_Compound, dbo.W_Order.Days_deliv, dbo.W_Order.Days_WIU, dbo.W_Order.DAYS_DLR, 
                      dbo.W_Order.Days_Total, dbo.W_Order.DLR_Payment, dbo.W_Order.PMNT_Supplier, dbo.W_Order.Payment_Suppl_Date, dbo.W_Order.Omdp, 
                      dbo.W_Order.Compound_RLS, dbo.W_Order.REF, dbo.W_Order.Aging_Compound, dbo.W_Order.Aging_Dealer, dbo.W_Order.Aging_Total, 
                      dbo.W_Order.Aging, dbo.W_Order.SalesDialer, dbo.W_Order.Payment, dbo.W_Order.Akc_Dlr_price, dbo.W_Order.Akc_Msrp, dbo.W_Order.Akc_valute, 
                      dbo.W_Order.OrderType, dbo.W_Order.Loc, dbo.W_Order.Price_check, dbo.W_Order.Rdf_DateSale, dbo.W_Order.Fin_accouting_doc_issued, 
                      dbo.W_Order.Fin_accouting_doc_send, dbo.W_Order.Fin_accouting_doc_recived, dbo.W_Order.Fin_payment_supplier, 
                      dbo.W_Order.Fin_payment_dealer, dbo.W_Order.Fin_sale_dealer, dbo.W_Order.Fin_return_dlr_deposit, dbo.W_Order.Fin_invoice_pay_carrier, 
                      dbo.S_Mounth.Naz AS Mes_zakaza
FROM         dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Mounth ON dbo.W_Order.Mes_zakaza = dbo.S_Mounth.ID LEFT OUTER JOIN
                      dbo.S_Colours ON dbo.W_Order.Colour = dbo.S_Colours.ID LEFT OUTER JOIN
                      dbo.S_Colourk ON dbo.W_Order.Colours = dbo.S_Colourk.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dlr = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Engenie ON dbo.W_Order.Engine = dbo.S_Engenie.ID LEFT OUTER JOIN
                      dbo.S_Status ON dbo.W_Order.Status = dbo.S_Status.ID LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Trim ON dbo.W_Order.Trimm = dbo.S_Trim.ID LEFT OUTER JOIN
                      dbo.S_Gearbox ON dbo.W_Order.GearBox = dbo.S_Gearbox.ID LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID LEFT OUTER JOIN
                      dbo.S_Trim_s ON dbo.S_Trim.Body = dbo.S_Trim_s.ID
WHERE     (dbo.W_Order.Viev = 0)
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1[50] 4[25] 3) )"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1[50] 2[25] 3) )"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1 [56] 4 [18] 2))"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1[75] 4) )"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 9
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 474
               Right = 300
            End
            DisplayFlags = 280
            TopColumn = 6
         End
         Begin Table = "S_Mounth"
            Begin Extent = 
               Top = 168
               Left = 856
               Bottom = 276
               Right = 1016
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Colours"
            Begin Extent = 
               Top = 42
               Left = 490
               Bottom = 150
               Right = 650
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Colourk"
            Begin Extent = 
               Top = 45
               Left = 822
               Bottom = 153
               Right = 982
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 178
               Left = 539
               Bottom = 286
               Right = 699
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Engenie"
            Begin Extent = 
               Top = 55
               Left = 1015
               Bottom = 163
               Right = 1175
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Status"
            Begin Extent = 
               Top = 306
               Left = 581
               Bottom = 414
               Right = 741
            End
            DisplayF' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_View_old'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'lags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 269
               Left = 1004
               Bottom = 377
               Right = 1164
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 420
               Left = 594
               Bottom = 528
               Right = 754
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Trim"
            Begin Extent = 
               Top = 466
               Left = 1030
               Bottom = 574
               Right = 1190
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Gearbox"
            Begin Extent = 
               Top = 386
               Left = 840
               Bottom = 494
               Right = 1000
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 655
               Left = 661
               Bottom = 763
               Right = 821
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Trim_s"
            Begin Extent = 
               Top = 626
               Left = 1074
               Bottom = 704
               Right = 1234
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
      PaneHidden = 
   End
   Begin DataPane = 
      PaneHidden = 
      Begin ParameterDefaults = ""
      End
      RowHeights = 220
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_View_old'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_View_old'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Orientation', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_View_old'
GO
/****** Object:  View [dbo].[L_View]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[L_View]
AS
SELECT     dbo.W_Order.Zakaz, dbo.W_Order.ID, dbo.W_Order.D_zakaza, dbo.S_Model.Naz AS Model, dbo.W_Order.Brend, dbo.S_Version.Naz AS Version, 
                      dbo.S_Status.ID AS I_status, dbo.S_Status.Naz AS Status, dbo.W_Order.Engine, dbo.S_Engenie.Naz AS Engenie, dbo.W_Order.Trimm, 
                      dbo.S_Colours.Naz AS Col_S, dbo.W_Order.Colour, dbo.S_Colourk.Naz AS Col_K, dbo.W_Order.Get_release_Date, dbo.W_Order.Invoice_Date, 
                      dbo.W_Order.VIN, dbo.W_Order.Dat_zak, dbo.S_Gearbox.Naz AS GearBox, dbo.W_Order.Isppol, dbo.W_Order.Model AS I_Model, 
                      dbo.W_Order.Vers AS I_Vers, dbo.W_Order.Viev, dbo.W_Order.MY, dbo.W_Order.Dlr AS I_Dealer, dbo.W_Order.Spec1 AS I_Spec1, 
                      dbo.W_Order.Spec2 AS I_Spec2, dbo.W_Order.Spec3 AS I_Spec3, dbo.W_Order.Colours AS I_Colours, dbo.W_Order.GearBox AS I_Gearbox, 
                      dbo.S_Trim.Body, dbo.S_Brend.Naz AS Brand_name, dbo.S_Diler.Naz AS Dlr_name, dbo.S_Trim_s.Nazv AS Trimmm, dbo.S_Colourk.ID AS Expr1, 
                      dbo.W_Order.OrderPlaced, dbo.W_Order.Invoice_Number, dbo.S_Diler.Last_Name, dbo.S_Diler.Sokr, dbo.W_Order.RLS, dbo.W_Order.RLS_placed, 
                      dbo.W_Order.Sorder, dbo.W_Order.Cif_cip_calc, dbo.W_Order.Cif_cip, dbo.W_Order.Dealer_price, dbo.W_Order.MSRP, dbo.W_Order.DeadlineChange, 
                      dbo.W_Order.Product_confirmed, dbo.W_Order.ProdM, dbo.W_Order.Start_Production, dbo.W_Order.Date_completed, dbo.W_Order.ContractDD, 
                      dbo.W_Order.DLR_Suggested_Arrival, dbo.W_Order.DLR_Actual_Arrival, dbo.W_Order.Sold_to_DLR, dbo.W_Order.Sold_to_Client, 
                      dbo.W_Order.Days_in_prod, dbo.W_Order.Days_Compound, dbo.W_Order.Days_deliv, dbo.W_Order.Days_WIU, dbo.W_Order.DAYS_DLR, 
                      dbo.W_Order.Days_Total, dbo.W_Order.DLR_Payment, dbo.W_Order.PMNT_Supplier, dbo.W_Order.Payment_Suppl_Date, dbo.W_Order.Omdp, 
                      dbo.W_Order.Compound_RLS, dbo.W_Order.REF, dbo.W_Order.Aging_Compound, dbo.W_Order.Aging_Dealer, dbo.W_Order.Aging_Total, 
                      dbo.W_Order.Aging, dbo.W_Order.SalesDialer, dbo.W_Order.Payment, dbo.W_Order.Akc_Dlr_price, dbo.W_Order.Akc_Msrp, dbo.W_Order.Akc_valute, 
                      dbo.W_Order.OrderType, dbo.W_Order.Loc, dbo.W_Order.Price_check, dbo.W_Order.Rdf_DateSale, dbo.W_Order.Fin_accouting_doc_issued, 
                      dbo.W_Order.Fin_accouting_doc_send, dbo.W_Order.Fin_accouting_doc_recived, dbo.W_Order.Fin_payment_supplier, 
                      dbo.W_Order.Fin_payment_dealer, dbo.W_Order.Fin_sale_dealer, dbo.W_Order.Fin_return_dlr_deposit, dbo.W_Order.Fin_invoice_pay_carrier
FROM         dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Colours ON dbo.W_Order.Colour = dbo.S_Colours.ID LEFT OUTER JOIN
                      dbo.S_Colourk ON dbo.W_Order.Colours = dbo.S_Colourk.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dlr = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Engenie ON dbo.W_Order.Engine = dbo.S_Engenie.ID LEFT OUTER JOIN
                      dbo.S_Status ON dbo.W_Order.Status = dbo.S_Status.ID LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Trim ON dbo.W_Order.Trimm = dbo.S_Trim.ID LEFT OUTER JOIN
                      dbo.S_Gearbox ON dbo.W_Order.GearBox = dbo.S_Gearbox.ID LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID LEFT OUTER JOIN
                      dbo.S_Trim_s ON dbo.S_Trim.Body = dbo.S_Trim_s.ID
WHERE     (dbo.W_Order.Viev = 0)
GO
/****** Object:  StoredProcedure [dbo].[Add_option]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
  ADD OPTIONS TO ORDER
  Дата      : 18-07-2008
  Время     : 14:28
  Ввод новых опций для выбранного автомобиля 
  Описание : Вставка призводится выбранных опций принадлежащих только выбранным 
             вариантам Бренд Модель Версия
             Остальные данные разделяются на две части Оглавление и подножье инвойса
             которые формируются во всех инвойсах автоматически и заполняются
             из необходимых для этого сочетания справочников.

             Структура тела инвойса :
               * Оглавление (автоматическое заполнение )             CODS = 1,2,3,4,5
               * Опции      (выбор вручную из справочника S_Opttion) CODS = 10
               * Подножье   (автоматическое заполнение )             CODS = 11,12,13,14

  Пример использования процедуры :
  EXEC ADD_OPTION 36919, 1, 23, 789

-- Очистка для работы опций в заказах
   DELETE FROM   W_OPTION

-- Просомтр опций
   SELECT * FROM W_OPTION

-- Добавление записи о новой версии базы
   EXEC Insert_version_programm_database 'Version 12.01','17-09-2008'

  Оглавление (Header)
   1 BASE BASE
   2 MDL  MODEL 
   3 MY   MODEL YEAR
   4 ENG  ENGINE

  Опции (Body)
   10 COD NAME OPTIONS
   10 COD NAME OPTIONS
   10 COD ............
   10 COD NAME OPTIONS 

  Подножье (Futter)
   11 CLB COLOR BODY
   12 TRM TRIM
   13 EXW EXWORKS
   14 FRC FREIGHT CHARGES 
   15 INS INSURANCE
   16 COR COUNTRY OF ORIGINAL
   17 WGT WEIGHT
   20 TSM TOTAL SUM

*/
CREATE PROCEDURE [dbo].[Add_option]  @IDORDER INT, 
                                    @IDBRAND INT , 
                                    @IDMODEL INT, 
                                    @IDVERS  INT
AS
-- Подготовка к ошибкам
DECLARE @ERR0       INT             -- Ошибка на первом этапе
DECLARE @ERR1       INT             -- Ошибка на втором этапе
DECLARE @ERR2       INT             -- Ошибка на третьем этапе  
DECLARE @ERR3       INT             -- Ошибка на четвертом этапе
DECLARE @BAZANAME   NVARCHAR(100)   -- Наименование базы
DECLARE @BAZACOST   MONEY           -- Стоимость базы автомобиля
DECLARE @OPTCOST    MONEY           -- Стоимость опций
DECLARE @ENGINENAME NVARCHAR(100)   -- Наименование двигателя в куб. см.
DECLARE @BRANDNAME  NVARCHAR(50)    -- Наименование бренда
DECLARE @MODELNAME  NVARCHAR(50)    -- Наименование модели 
DECLARE @VERSNAME   NVARCHAR(50)    -- Наименование версии
DECLARE @MODELYEAR  NVARCHAR(4)     -- Модельный год
DECLARE @COLORBODY  NVARCHAR(50)    -- Цвет кузова
DECLARE @COLORTRIM  NVARCHAR(50)    -- Цвет салонна и материал
DECLARE @BODYTYPE   NVARCHAR(50)    -- Тип кузова
DECLARE @IDBODYTYPE NVARCHAR(50)    -- ID кузова 
DECLARE @EXWORKS    MONEY           -- Заводская стоимость автомобиля
DECLARE @FCHARGES   MONEY           -- Стоимсоть доставки автомобиля
DECLARE @INSURANCE  MONEY           -- Стоимсоть страховки автомобиля
DECLARE @INSURPROC  MONEY           -- Процент скидки
DECLARE @TOTALSUM   MONEY           -- Итоговая стоимость автомобиля
DECLARE @COUNTRY    NVARCHAR(50)    -- Страна доставки автомобиля
DECLARE @DISCOUNT   MONEY           -- Cкидка производителя на базу автомобиля
DECLARE @WEIGHT     NVARCHAR(4)     -- Вес автомобиля
DECLARE @DIS_BRANDN NVARCHAR(50)    -- Наименование скидка для бренда
DECLARE @DIS_BRANDV MONEY           -- Значение скидки для бренда
DECLARE @DIS_MODELN NVARCHAR(50)    -- Наименование скидка для модели
DECLARE @DIS_MODELV MONEY           -- Значение скидки для модели

-- Проверка выбранных количества баз
BEGIN TRANSACTION P1

-- Проверка на правильное количество выбранных баз 
-- Не должно быть совсем не выбрано
-- и не должно быть выбрано больше 1
-- Оповещение если не была выбрана база и откат
IF (SELECT COUNT(*) FROM S_OPTIONAL WITH (NOLOCK)
                    WHERE BREND = @IDBRAND 
                      AND MODEL = @IDMODEL 
                      AND VERS  = @IDVERS  
                      AND CODE = 'BASE' 
                      AND VUBR = -1) = 0 
    BEGIN 
     -- RAISERROR 
        ROLLBACK TRANSACTION P1
    END

-- Оповещение если была выбрана два раза база и откат
IF (SELECT COUNT(*) FROM S_OPTIONAL  WITH (NOLOCK) WHERE BREND = @IDBRAND AND MODEL = @IDMODEL AND VERS = @IDVERS  AND CODE = 'BASE' AND VUBR = -1) > 1 
    BEGIN 
      --RAISERROR 
        ROLLBACK TRANSACTION P1
    END

-- 0. Скидка 8 процентов (договоренность с производителем Форд) для других нет
--    Определяется из глобального справочника настроек   
IF @IDBRAND = 1
   BEGIN
       SELECT  @DISCOUNT = Znach 
         FROM  S_Tuning 
         WITH (NOLOCK)
        WHERE  ID = 23        
   END
ELSE
       SELECT @DISCOUNT = 1

-- База
SELECT @BAZACOST = Pr_exw,
       @BAZANAME = Naz          
 FROM  S_OPTIONAL 
 WITH (NOLOCK)
WHERE  BREND     = @IDBRAND 
  AND  MODEL     = @IDMODEL
  AND  VERSION   = @IDVERS
  AND  SOKR      = 'BASE'
  AND  VUBR      = -1

-- Опции
SELECT  @OPTCOST  = SUM  (Pr_exw) 
  FROM  S_OPTIONAL  
  WITH (NOLOCK)
 WHERE  BREND    = @IDBRAND 
   AND  MODEL    = @IDMODEL
   AND  VERSION  = @IDVERS
   AND  SOKR   ! = 'BASE'
   AND  VUBR     = -1
  
-- База со скидки от производителя
SET @BAZACOST = @BAZACOST - ((@BAZACOST + @OPTCOST) * @DISCOUNT)

-- EX WORKS - расчетная сумма стоимоcти автомобиля
SET @EXWORKS = ISNULL(@BAZACOST, 0) + ISNULL(@OPTCOST, 0)

-- Стоимсоть доставки и страховки
SELECT  @FCHARGES  = FREIGHT ,
        @INSURANCE = INSURANCE 
  FROM  S_DELIVERY   
  WITH (NOLOCK)
 WHERE  BRAND      = @IDBRAND 
   AND  MODEL      = @IDMODEL

-- Итоговая сумма в конце отчета
SET @TOTALSUM = ISNULL(@BAZACOST,0) + ISNULL(@OPTCOST,0) + ISNULL(@EXWORKS,0) + ISNULL(@INSURANCE,0)

-- Модельный год (Model Year)
SELECT  @MODELYEAR = MY 
  FROM  W_ORDER 
  WITH (NOLOCK) 
 WHERE  ID = @IDORDER 

-- Наименование модели
SELECT  @MODELNAME = NAZ 
  FROM  S_MODEL 
  WITH (NOLOCK) 
 WHERE  ID = @IDMODEL

-- Наименование версии
SELECT  @VERSNAME  = NAZ 
  FROM  S_VERSION 
  WITH (NOLOCK) 
 WHERE  ID = @IDVERS

-- Тип кузова
SELECT @BODYTYPE = T.NAZV
  FROM W_ORDER     W  WITH (NOLOCK),
       S_TRIM_S    T  WITH (NOLOCK)
 WHERE W.TRIMM  =  T.ID 
   AND W.ID     =  @IDORDER

-- Двигатель Engenie
SELECT @ENGINENAME  = D.NAZ
  FROM W_ORDER        W  WITH (NOLOCK),
       S_ENGENIE      D  WITH (NOLOCK)
 WHERE W.ENGINE     = D.ID  
   AND W.ID         = @IDORDER

-- Цвет кузова и цвет салона
SELECT @COLORBODY  = C.NAZ,
       @COLORTRIM  = K.NAZ
  FROM W_ORDER       W  WITH (NOLOCK),
       S_COLOURS     C  WITH (NOLOCK),
       S_COLOURK     K  WITH (NOLOCK)
 WHERE W.COLOUR    = C.ID   
   AND W.COLOURS   = K.ID  
   AND W.ID        = @IDORDER

-- Страна производителя 
SELECT  @COUNTRY = NAZ 
  FROM  S_DELIVERY 
  WITH (NOLOCK)
 WHERE  BRAND    = @IDBRAND 
   AND  MODEL    = @IDMODEL

-- Доставка и страховка
SELECT @COUNTRY   = C.NAZV,                   -- наименование страны 
       @FCHARGES  = D.FREIGHT,                -- стоимость доставки
       @INSURPROC = D.INSURANCE               -- страховка  
FROM   S_COUNTRY_2  C  WITH (NOLOCK),
       S_DELIVERY   D  WITH (NOLOCK)
WHERE  C.IDD      = D.COUNTRY
  AND  D.BRAND    = @IDBRAND
  AND  D.MODEL    = @IDMODEL
  AND  D.VERSION  = @IDVERS

-- Начало транзакции
BEGIN TRANSACTION

-- Удаление предыдущих данных только расчетных  не трогая данные которые были внесены брендом
DELETE FROM W_OPTION WHERE Zakaz = @IDORDER  
-- AND (CODS IN (1,2,3,4) OR CODS IN (11,12,13,14,15,16,17,18,19,20,30))

-- Обнуление признака пакета так как это не пакетная машина 
-- (но єто приведет к работе триггера)
-- UPDATE W_ORDER SET PACKAGE = 0 WHERE ID = @IDORDER

-- Обработка на нулевом этапе
SET @ERR0 = @@ERROR

-- ЗAГОЛОВОК ИНВОЙСА
-- Модель 
INSERT  W_OPTION (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Exw, Note) 
VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'MDL', 'MODEL : ' +  UPPER(@MODELNAME), 2, 0, UPPER(@MODELNAME))

-- Модельный год MODEL YEAR
INSERT  W_OPTION (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Exw, Note) 
VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'MY', 'MODEL YEAR : ' + UPPER(@MODELYEAR), 3, 0, @MODELYEAR)

-- Двигатель и кубические сантиметры (ENGINE NAME & CC)
INSERT  W_OPTION (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Exw, Note)
VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'ENG', 'ENGINE : (' + CONVERT(NVARCHAR(4),DBO.VOL_ENG_FORD(@ENGINENAME)) + ' CC)  ' + UPPER(@ENGINENAME)   , 4, 0, DBO.VOL_ENG_FORD(@ENGINENAME))

-- Ошибки на первом этапе
SET @ERR1 = @@ERROR

-- Внесение опций в заказ c признаком cods = 10 выбранные пользователем
INSERT  W_OPTION (Zakaz, Brand, Model, Vers, Conf, Sokr, Naz, Exw, Dc, Msrp, Cods, Note)
SELECT  @IDORDER, @IDBRAND, @IDMODEL, @IDVERS, Id, Sokr , UPPER(Naz), Pr_Exw, Pr_Dlr, Pr_msrp, 10, 'Options' 
  FROM  S_OPTIONAL
  WITH (NOLOCK)
 WHERE  BREND = @IDBRAND     
   AND  Vubr  = -1

-- Discount Brand ( Добавление скидок по базе автомобиля если они есть )
SELECT  @DIS_BRANDN = Discount_remark,
        @DIS_BRANDV = Discount_value          
  FROM  S_BREND
  WITH (NOLOCK)
 WHERE  ID  = @IDBRAND 

-- Если есть скидка по бренду
   IF @DIS_BRANDV ! = 0
      BEGIN
           SET     @DIS_BRANDV = @DIS_BRANDV * -1 
           INSERT  W_OPTION (Zakaz, Brand, Model, Vers, Sokr, Naz, Exw,  Cods, Note)
           VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'DBRD',  @DIS_BRANDN,  @DIS_BRANDV, 10, 'Discount Brand' )
      END

-- Discount model ( Добавление скидок по модели автомобиля если они есть )
SELECT @DIS_MODELN = Discount_remark,
       @DIS_MODELV = Discount_value          
 FROM  S_MODEL
 WITH (NOLOCK)
WHERE  BREND       = @IDBRAND 
  AND  ID          = @IDMODEL

-- Если есть скидка по модели
   IF @DIS_MODELV ! = 0
      BEGIN
      SET     @DIS_MODELV = @DIS_MODELV * -1 
      INSERT  W_OPTION (Zakaz, Brand, Model, Vers, Sokr, Naz, Exw,  Cods, Note)
      VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'DMDL',  @DIS_MODELN,  @DIS_MODELV, 10, 'Discount Model' )
      END

-- Назначение порядка сортировки для опции базы (перевод на первую позицию)
UPDATE W_OPTION 
   SET CODS  = 1, 
       EXW   = @BAZACOST, 
       NOTE  = 'Base'
WHERE  SOKR  = 'BASE' 
  AND  ZAKAZ = @IDORDER

-- Ошибки на втором этапе
SET @ERR2 = @@ERROR

-- Подножье
-- COLOR BODY
INSERT  W_OPTION (Zakaz,     Brand,    Model,    Vers,    Sokr, Naz, Cods, Exw, Note)
VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'CLB', 'COLOR BODY : ' +  @COLORBODY , 11, 0, 'Color Body')

-- TRIM
INSERT  W_OPTION (Zakaz,     Brand,    Model,    Vers,    Sokr, Naz, Cods, Exw, Note)
VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'TRM', 'TRIM : '  +  @COLORTRIM , 12, 0, 'Trim')

-- Подсчет  общей суммы по опциям в текущем заказе
SELECT  @TOTALSUM = ISNULL(SUM(Exw),0) 
  FROM  W_OPTION  
  WITH (NOLOCK)
 WHERE  ZAKAZ  = @IDORDER 
   AND  CODS   = 10

-- EXW
SET @EXWORKS = @EXWORKS + @DIS_MODELV + @DIS_BRANDV

INSERT  W_OPTION (Zakaz,     Brand,    Model,    Vers,    Sokr, Naz,  Cods, Exw, Note)
VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'EXW', 'EX WORKS : ' , 13, @EXWORKS, 'Ex Works')

-- Доставка и страховка
SELECT  @FCHARGES   = ISNULL(FREIGHT,  0),
        @INSURPROC  = ISNULL(INSURANCE,0) 
  FROM  S_DELIVERY  
  WITH (NOLOCK)
 WHERE  BRAND       = @IDBRAND 
   AND  MODEL       = @IDMODEL

-- Доставка
INSERT  W_OPTION (Zakaz,     Brand,    Model,    Vers,   Sokr, Naz,  Cods, Exw, Note)
VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'FRC', 'FREIGHT CHARGES  : ' , 14, ISNULL(@FCHARGES,0),'Delivery Cost')

-- Cтраховка
SELECT @BAZACOST = SUM(Pr_exw)
 FROM  S_OPTIONAL 
 WITH (NOLOCK)
WHERE  BREND     = @IDBRAND 
  AND  MODEL     = @IDMODEL
  AND  VERSION   = @IDVERS
  AND  VUBR      = -1

-- Расчет страховки 
SET @INSURANCE = (@BAZACOST + @FCHARGES) /100 * @INSURPROC

-- Запись страховки
INSERT  W_OPTION (Zakaz,     Brand,    Model,    Vers,    Sokr, Naz, Cods, Exw, Discount, Note )
VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'INS', 'INSURANCE  :  ' + CONVERT(NVARCHAR(10), @INSURPROC) + '%' , 15, @INSURANCE, @INSURPROC, @BAZACOST)

-- COUNTRY OF ORIGINAL
INSERT  W_OPTION (Zakaz,     Brand,    Model,    Vers,    Sokr, Naz, Cods, Exw, Note)
SELECT  @IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'COR', 'COUNTRY OF ORIGIN  : ' + C.NAME_ANG, 16, 0,UPPER(@COUNTRY)
  FROM  S_DELIVERY   D WITH (NOLOCK),
        S_COUNTRY_2  C WITH (NOLOCK)
 WHERE  D.COUNTRY_ORIGIN = C.IDD      
   AND  D.BRAND          = @IDBRAND 
   AND  D.MODEL          = @IDMODEL
   
-- Id weight 
SELECT  @IDBODYTYPE = TRIMM 
  FROM  W_ORDER 
  WITH (NOLOCK)
 WHERE  BREND       = @IDBRAND 
   AND  ID          = @IDORDER

-- Weight
INSERT  W_OPTION (Zakaz,    Brand,    Model,    Vers,    Sokr,  Naz,  Cods, Exw, Note)
SELECT            @IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'WGT', 'WEIGHT  : ' + CONVERT(NVARCHAR(4), VES) + ' (KG.)', 17, 0, CONVERT(NVARCHAR(4), VES)
  FROM  S_TRIM  
  WITH (NOLOCK)
WHERE   BRAND   = @IDBRAND 
  AND   MODEL   = @IDMODEL 
  AND   VERSION = @IDVERS
  AND   BODY    = @IDBODYTYPE

-- TOTAL SUM
   SET  @TOTALSUM = @EXWORKS + @FCHARGES + @INSURANCE 
INSERT  W_OPTION (Zakaz,     Brand,    Model,    Vers,    Sokr, Naz, Cods, Exw, Note)
VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, 'FCA', UPPER(@COUNTRY), 30, @TOTALSUM, 'FCA Sum')

-- Ошибки на третьем этапе
SET  @ERR3 = @@ERROR

-- Снятие отметок пока по всему бренду
UPDATE S_OPTIONAL 
   SET VUBR  = 0 
 WHERE BREND = @IDBRAND 
--AND  Model = @IDMODEL 
--AND  Vers  = @IDVERS

-- Откат при ошибке хотябы в одном шагов
IF @ERR1 > 0  AND @ERR2 > 0 AND @ERR3 > 0
   BEGIN
        ROLLBACK TRANSACTION
        RAISERROR ('Error Created Invoice !!!', 16, 1 )
        INSERT INTO W_LOG (Zakaz, Tim, Usr_name, Note, Old_val, New_val) 
        VALUES (@IDORDER, GETDATE(), USER_NAME() , 'Rollback Transaction ', @ERR1, @ERR2)
       
   END
ELSE
   BEGIN
        INSERT INTO W_LOG (Zakaz, Tim, Usr_name, Note, Old_val, New_val) 
        VALUES (@IDORDER, GETDATE(), USER_NAME() , 'Add Options Into Order', @TOTALSUM, '')
        COMMIT TRANSACTION
   END
GO
/****** Object:  View [dbo].[A_Risk_Report]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Risk_Report]
AS
SELECT     dbo.W_Ttn_Sub.Vin AS Vin_Code, MAX(dbo.S_Diler.Last_Name) AS Dealer_Name, MAX(dbo.W_Ttn_Sub.Price) AS Bailtment_Price, 
                      MAX(dbo.W_Ttn_Sub.Act_Date) AS Bailtment_Open, dbo.A_Status.Name_brand AS Brand, dbo.A_Status.Model AS Model_Name, 
                      dbo.A_Status.Version AS Version_Name, dbo.W_Ttn_Sub.Closing AS Bailment_Closing, dbo.W_Ttn_Sub.Act AS Act_Number
FROM         dbo.W_Ttn_Sub LEFT OUTER JOIN
                      dbo.A_Status ON dbo.W_Ttn_Sub.Vin = dbo.A_Status.[Full VIN] LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Ttn_Sub.Dlr = dbo.S_Diler.ID
GROUP BY dbo.W_Ttn_Sub.Vin, dbo.A_Status.Model, dbo.A_Status.Version, dbo.A_Status.Name_brand, dbo.W_Ttn_Sub.Act_Received, dbo.W_Ttn_Sub.Closing, 
                      dbo.W_Ttn_Sub.Act
HAVING      (dbo.W_Ttn_Sub.Act_Received IS NULL) AND (dbo.W_Ttn_Sub.Closing IS NOT NULL) AND (dbo.W_Ttn_Sub.Closing > CONVERT(DATETIME, 
                      '2009-11-01 00:00:00', 102)) AND (dbo.W_Ttn_Sub.Act <> N'0') AND (dbo.W_Ttn_Sub.Act IS NOT NULL) AND (NOT (MAX(dbo.W_Ttn_Sub.Act_Date) 
                      IS NULL))
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[12] 4[49] 2[7] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Ttn_Sub"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 379
               Right = 276
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "A_Status"
            Begin Extent = 
               Top = 17
               Left = 554
               Bottom = 295
               Right = 768
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 201
               Left = 335
               Bottom = 304
               Right = 463
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 11
         Width = 284
         Width = 3555
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 2310
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 2115
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 2610
         Filter = 3525
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Risk_Report'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Risk_Report'
GO
/****** Object:  View [dbo].[A_Logistics_Type]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Logistics_Type]
AS
SELECT     dbo.A_Status.ID, dbo.W_Ttn_Sub.Act, dbo.W_Ttn.Num, dbo.W_Ttn_Sub.Ttn, dbo.W_Ttn_Sub.Avtovoz, dbo.W_Ttn.Type AS Type_ttn, 
                      dbo.W_Ttn_Sub.Type AS Type_vin, dbo.A_Status.Name_brand, dbo.A_Status.Model, dbo.A_Status.Version, dbo.S_Diler.Last_Name AS From_dlr, 
                      S_Diler_1.Last_Name AS To_Dlr, dbo.W_Ttn_Sub.Vin, { fn WEEK(dbo.W_Ttn.Dat) } AS Id_week, dbo.S_Diler.ID AS Id_dlr
FROM         dbo.W_Ttn_Sub INNER JOIN
                      dbo.W_Ttn ON dbo.W_Ttn_Sub.Avtovoz = dbo.W_Ttn.Avtovoz INNER JOIN
                      dbo.S_Diler ON dbo.W_Ttn.Otpravnik = dbo.S_Diler.ID INNER JOIN
                      dbo.S_Diler AS S_Diler_1 ON dbo.W_Ttn.Oderjuvach = S_Diler_1.ID INNER JOIN
                      dbo.A_Status ON dbo.W_Ttn_Sub.Zakaz = dbo.A_Status.ID
WHERE     (dbo.W_Ttn.Type IS NOT NULL) AND (dbo.W_Ttn_Sub.Type IS NOT NULL) AND ({ fn WEEK(dbo.W_Ttn.Dat) } = { fn WEEK(GETDATE()) })
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[43] 4[24] 2[2] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1[35] 4[41] 3) )"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Ttn_Sub"
            Begin Extent = 
               Top = 32
               Left = 295
               Bottom = 147
               Right = 446
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Ttn"
            Begin Extent = 
               Top = 5
               Left = 48
               Bottom = 402
               Right = 199
            End
            DisplayFlags = 280
            TopColumn = 1
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 169
               Left = 278
               Bottom = 263
               Right = 438
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler_1"
            Begin Extent = 
               Top = 283
               Left = 280
               Bottom = 391
               Right = 440
            End
            DisplayFlags = 280
            TopColumn = 3
         End
         Begin Table = "A_Status"
            Begin Extent = 
               Top = 15
               Left = 563
               Bottom = 364
               Right = 777
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 26
         Width = 284
         Width = 1500
         Width = 3480
         Width = 765
         Width = 1695
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 900
         Width = 1500
         Width' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Logistics_Type'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N' = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 3330
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 2940
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Logistics_Type'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Logistics_Type'
GO
/****** Object:  StoredProcedure [dbo].[Vic_update_avtovoz]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/* 
   Author               :  Savchenko A
   Date Last Correction :  15-07-2009
   Organzation          :  Winner Imports Ukraine
   Description          :
   Обновление данных для VIC по автовозу, перевозчиков и ттн
   EXEC Vic_update_avtovoz
   Происходит каждый раз при открытии окна PDI
*/

CREATE PROCEDURE [dbo].[Vic_update_avtovoz]
AS

BEGIN TRANSACTION
-- Обновление c основной таблицы VIN, Rls, DLR
UPDATE W_Vic  
SET    W_Vic.Vin     = T.VIN,
       W_Vic.Rls     = T.Rls,
       W_Vic.Dlr     = T.Dlr,
       W_Vic.Invoice = T.Invoice_Number,
       W_Vic.Flag    = T.Status
FROM   W_Order  AS T
WHERE  W_Vic.Id_Order = T.ID

/*
 Важное замечание !!!    
 Данные от логистики Солдатенко
 Так как машина перевозиться несколькими автовозами
 в базе необходимо выбирать максимальный номер автовоза и обновлять
 его в базе PDI
*/
UPDATE W_Vic  
SET    W_Vic.Numb_acc = T.ttn , 
       W_Vic.Avtovoz  = T.Avtovoz , 
       W_Vic.Carrier  = T.Carrier
FROM   W_Ttn_sub AS T  WITH (NOLOCK)
WHERE  W_Vic.Id_Order = T.Zakaz 
AND    T.Avtovoz = (SELECT MAX(Avtovoz) FROM W_ttn_sub WHERE VIN = W_Vic.VIN )
COMMIT TRANSACTION


/*
Проверка
select * from W_Vic  where id_order=47178 -- avtovoz=2480

select * from W_ttn_sub  where avtovoz=2480
select max(avtovoz) from W_ttn_sub where vin='WF0SXXGBWS8C48071'
select avtovoz from W_ttn_sub where vin='WF0SXXGBWS8C48071'

FROM   W_Ttn_sub  T,
WHERE  W_Vic.Id_Order = T.Zakaz

*/
GO
/****** Object:  View [dbo].[A_Avtovoz_1]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Avtovoz_1]
AS
SELECT     dbo.A_View.Brend, dbo.A_View.Version, dbo.A_View.Model, dbo.W_Order.Log_choice, dbo.W_Order.Zakaz, dbo.A_View.Brand_name, 
                      dbo.W_Order.Log_Akt, dbo.W_Order.Log_Dat_otgruzki, dbo.W_Order.Log_acc, dbo.W_Order.Log_sum, dbo.W_Order.Log_noNDS, 
                      dbo.W_Order.Log_remark, dbo.W_Order.Log_mont, dbo.A_View.Brend AS Expr1, dbo.W_Order.DLR_Payment, dbo.W_Order.Dealer_price, 
                      dbo.W_Order.WIU_Arrived, dbo.W_Order.ID, dbo.W_Order.Loc, dbo.W_Order.Svin, dbo.A_View.Dlr_name, dbo.W_Order.DLR_Actual_Arrival, 
                      LEFT(dbo.A_View.Brand_name, 1) AS Brend_bukva, dbo.W_Order.Dealer_order_placed, dbo.W_Order.Dlr, dbo.W_Order.VIN, dbo.W_Ttn_sub.Ttn, 
                      dbo.W_Ttn.Avtovoz, dbo.S_Carrier.Naz
FROM         dbo.W_Order INNER JOIN
                      dbo.W_Ttn_sub INNER JOIN
                      dbo.W_Ttn ON dbo.W_Ttn_sub.Ttn = dbo.W_Ttn.Num INNER JOIN
                      dbo.S_Carrier ON dbo.W_Ttn.Perevoz = dbo.S_Carrier.ID ON dbo.W_Order.ID = dbo.W_Ttn_sub.Zakaz LEFT OUTER JOIN
                      dbo.A_View ON dbo.W_Order.ID = dbo.A_View.ID
WHERE     (dbo.W_Order.Log_Akt IS NOT NULL)
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 114
               Right = 300
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "A_View"
            Begin Extent = 
               Top = 9
               Left = 436
               Bottom = 117
               Right = 646
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Ttn_sub"
            Begin Extent = 
               Top = 166
               Left = 361
               Bottom = 259
               Right = 512
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Ttn"
            Begin Extent = 
               Top = 171
               Left = 559
               Bottom = 279
               Right = 710
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Carrier"
            Begin Extent = 
               Top = 268
               Left = 635
               Bottom = 376
               Right = 786
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Avtovoz_1'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Avtovoz_1'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Avtovoz_1'
GO
/****** Object:  View [dbo].[A_Bailment_risk_old]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Bailment_risk_old]
AS
SELECT     TOP (100) PERCENT dbo.W_Ttn_Sub.Vin AS Vin_Code, dbo.S_Diler.Last_Name AS Dealer_Name, dbo.W_Ttn_Sub.Price AS Bailtment_Price2, 
                      dbo.W_Ttn_Sub.Act_Date AS Bailtment_Open, dbo.A_Status.Name_brand AS Brand, dbo.A_Status.Model AS Model_Name, 
                      dbo.A_Status.Version AS Version_Name, dbo.W_Ttn_Sub.Closing AS Bailment_Closing, dbo.W_Ttn_Sub.Act AS Act_Number, dbo.W_Ttn_Sub.Idd, 
                      dbo.W_Ttn_Sub.Closing, dbo.CntDay(GETDATE(), dbo.W_Ttn_Sub.Act_Date) AS Days_Doc, 
                      CASE WHEN id_brand = 1 THEN Price ELSE Kurs * Price END AS Bailtment_Price, dbo.A_Status.Id_Brand
FROM         dbo.W_Ttn_Sub LEFT OUTER JOIN
                      dbo.A_Status ON dbo.W_Ttn_Sub.Vin = dbo.A_Status.[Full VIN] LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Ttn_Sub.Dlr = dbo.S_Diler.ID
WHERE     (dbo.W_Ttn_Sub.Act_Received IS NULL) AND (dbo.W_Ttn_Sub.Closing IS NULL) AND (dbo.W_Ttn_Sub.Act <> N'0') AND 
                      (dbo.W_Ttn_Sub.Act_Date > CONVERT(DATETIME, '2009-10-01 00:00:00', 102)) AND (dbo.W_Ttn_Sub.Idd IN
                          (SELECT     MAX(Idd) AS Idmax
                            FROM          dbo.W_Ttn_Sub AS W_Ttn_Sub_1
                            GROUP BY Vin))
ORDER BY Brand
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Ttn_Sub"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 114
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "A_Status"
            Begin Extent = 
               Top = 6
               Left = 227
               Bottom = 114
               Right = 441
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 6
               Left = 479
               Bottom = 114
               Right = 639
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Bailment_risk_old'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Bailment_risk_old'
GO
/****** Object:  View [dbo].[A_Ts]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Ts]
AS
SELECT     TOP (100) PERCENT dbo.S_Company.Naz AS Компанія, dbo.S_Department.Naz AS Відділ, dbo.S_User.Fio AS Працівник, 
                      dbo.W_Timesheet.Start AS Початок, dbo.W_Timesheet.Finish AS Закінчення, dbo.Dmm(dbo.W_Timesheet.Start, dbo.W_Timesheet.Finish) 
                      AS Тривалість, dbo.S_Group_task.Naz AS Категорії, dbo.S_Task.Naz AS Задача, dbo.W_Timesheet.Week_namber AS Неділя, 
                      dbo.W_Timesheet.Task AS Примітки, CASE dbo.W_Timesheet.Overtime WHEN 0 THEN 'N' ELSE 'Y' END AS Overtime, 
                      dbo.W_Timesheet.Company AS Id_comp, dbo.W_Timesheet.Department AS Id_dep, dbo.W_Timesheet.Approve_director, 
                      dbo.S_User.ID AS Id_Emp
FROM         dbo.S_Task RIGHT OUTER JOIN
                      dbo.W_Timesheet LEFT OUTER JOIN
                      dbo.S_Group_task ON dbo.W_Timesheet.Category = dbo.S_Group_task.Id ON dbo.S_Task.Id = dbo.W_Timesheet.Task_id LEFT OUTER JOIN
                      dbo.S_Department INNER JOIN
                      dbo.S_User ON dbo.S_Department.ID = dbo.S_User.Dep ON dbo.W_Timesheet.Employee = dbo.S_User.ID LEFT OUTER JOIN
                      dbo.S_Company ON dbo.W_Timesheet.Company = dbo.S_Company.Id
ORDER BY dbo.S_Company.Id, Відділ, Працівник
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[46] 4[32] 2[12] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Task"
            Begin Extent = 
               Top = 245
               Left = 317
               Bottom = 353
               Right = 468
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Timesheet"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 520
               Right = 198
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Group_task"
            Begin Extent = 
               Top = 124
               Left = 330
               Bottom = 232
               Right = 483
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Department"
            Begin Extent = 
               Top = 109
               Left = 809
               Bottom = 217
               Right = 960
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_User"
            Begin Extent = 
               Top = 78
               Left = 501
               Bottom = 311
               Right = 652
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Company"
            Begin Extent = 
               Top = 0
               Left = 870
               Bottom = 93
               Right = 1021
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 5445
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'         Alias = 3390
         Table = 2295
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts'
GO
/****** Object:  StoredProcedure [dbo].[Delete_Car_In_Back]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
 Описание процедуры:
 Перенос заказов в архив помеченных на удаление
 Заказы удаляются не сразу а сначала помечаются на удаление
 и если необходимо то потом могут быть восстановлены из архивной таблицы
 
 Применение :
 EXEC DELETE_CAR_IN_BACK

*/
CREATE PROCEDURE [dbo].[Delete_Car_In_Back]
AS
-- Отключение счетчика
-- SET IDENTITY_INSERT w_order_back ON
-- GO

-- Подсчет количества до вставки
-- SELECT COUNT(*) FROM w_order_back
INSERT INTO  w_order_back SELECT * FROM w_order WHERE viev=-1

-- Подсчет количества после вставки
-- SELECT COUNT(*) FROM w_order_back

-- Удаление из рабочей таблицы заказы помеченные на удаление
DELETE FROM w_order WHERE viev=-1
GO
/****** Object:  StoredProcedure [dbo].[Vosstanovlenie_udal_car]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Восстоновление ошибочно удаленных машин
-- Использование exec Vosstanovlenie_udal_car 53913
-- Процедуру можно использовать в виде шаблона повторов машин
-- @IDvstavka - номер ИД в таблице удаленных машин
-- 
CREATE PROCEDURE [dbo].[Vosstanovlenie_udal_car] @IDvstavka   INT
                                              --@idudalenie  INT
AS
-- Удаление если необходимо
-- DELETE  w_order WHERE id = 53918

INSERT W_ORDER 
      (brend, model, sorder, wiou, vers, zakaz, d_zakaza, [Spec1], [Spec2], [Spec3], [Colour], [Colours], [Trimm], [OrderType], [Comments], [MY], [Cif_cip_calc], [Cif_cip], [Dealer_price], [MSRP], [OrderPlaced], [DeadlineChange], [Req], [Product_confirmed], [ProdM], [Start_Production], [Date_completed], [Invoice_Number], [Invoice_Date], [Compound], [RLS],[RLS_placed],	[Start_transit],[WIU_Arrived],	[ContractDD],	[DLR_Suggested_Arrival],[DLR_Actual_Arrival],[Sold_to_DLR],	[Sold_to_Client], [Rls_left_compound], [Price_check], options)
SELECT brend, model, sorder, wiou, vers, zakaz, d_zakaza, [Spec1], [Spec2], [Spec3], [Colour], [Colours], [Trimm], [OrderType], [Comments], [MY], [Cif_cip_calc], [Cif_cip], [Dealer_price], [MSRP], [OrderPlaced], [DeadlineChange], [Req], [Product_confirmed], [ProdM], [Start_Production], [Date_completed], [Invoice_Number], [Invoice_Date], [Compound], [RLS],[RLS_placed],	[Start_transit],[WIU_Arrived],	[ContractDD],	[DLR_Suggested_Arrival],[DLR_Actual_Arrival],[Sold_to_DLR],	[Sold_to_Client], [Rls_left_compound], [Price_check], options
FROM   W_order_back 
WHERE  Id = @idvstavka

-- Просмотр результатов
-- select max(id) from w_order
GO
/****** Object:  View [dbo].[A_Parts]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Parts]
AS
SELECT     dbo.W_Parts.Id, dbo.W_Parts.Articul, dbo.W_Parts.Descript, dbo.W_Parts.Brand, dbo.W_Parts.Date, dbo.W_Parts.Date_update, dbo.W_Parts.Date_actual, 
                      dbo.W_Parts.Dealer, dbo.W_Parts.Change, dbo.W_Parts.Notes, dbo.W_Parts.Qty, dbo.W_Parts.Comments, dbo.W_Parts.Price_imp, dbo.W_Parts.Price_opt, 
                      dbo.W_Parts.Price_roz, dbo.W_Parts.Place, dbo.W_Parts.Vid, dbo.W_Parts.Flag, dbo.W_Parts.Priz, dbo.W_Parts.Zamena, dbo.S_Diler.Last_Name, 
                      dbo.S_Diler.Naz AS Dealername, dbo.S_Brend.Naz AS Brand_name, dbo.W_Parts.Currency
FROM         dbo.W_Parts LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Parts.Brand = dbo.S_Brend.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Parts.Dealer = dbo.S_Diler.ID
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[37] 4[35] 2[4] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Parts"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 384
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 36
               Left = 336
               Bottom = 144
               Right = 496
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 149
               Left = 328
               Bottom = 289
               Right = 493
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 23
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 4155
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Parts'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N' = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Parts'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Parts'
GO
/****** Object:  View [dbo].[A_Brand_model]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Brand_model]
AS
SELECT     dbo.S_Model.ID AS Id_model, dbo.S_Model.Naz AS Name_model, dbo.S_Brend.ID AS id_Brand, dbo.S_Brend.Naz AS Name_Brand, dbo.S_Model.Price_midle
FROM         dbo.S_Model INNER JOIN
                      dbo.S_Brend ON dbo.S_Model.Brend = dbo.S_Brend.ID
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[12] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 367
               Right = 233
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 57
               Left = 513
               Bottom = 358
               Right = 931
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 1995
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Brand_model'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Brand_model'
GO
/****** Object:  View [dbo].[A_Deference]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Deference]
AS
SELECT     TOP (100) PERCENT dbo.W_Optional.Zakaz AS [Order #], dbo.S_Brend.Naz AS [Name Brand], dbo.A_Status.Model, dbo.A_Status.Version, 
                      dbo.A_Status.[Full VIN] AS VIN, dbo.W_Optional.Pr_raznica AS Deference, dbo.W_Optional.Note AS Remark, dbo.W_Optional.Sokr AS [Code Option], 
                      dbo.W_Optional.Naz AS [Name Option], dbo.A_Status.[Invoice Date], dbo.A_Status.[Sold to DLR], dbo.A_Status.[Sold to Client], 
                      dbo.W_Optional.Brand
FROM         dbo.W_Optional INNER JOIN
                      dbo.A_Status ON dbo.W_Optional.Zakaz = dbo.A_Status.ID INNER JOIN
                      dbo.S_Brend ON dbo.A_Status.Id_Brand = dbo.S_Brend.ID
WHERE     (dbo.W_Optional.Note IS NOT NULL)
ORDER BY dbo.W_Optional.Brand
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[29] 4[32] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Optional"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 247
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "A_Status"
            Begin Extent = 
               Top = 6
               Left = 227
               Bottom = 230
               Right = 420
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 5
               Left = 493
               Bottom = 113
               Right = 644
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 1590
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Deference'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Deference'
GO
/****** Object:  StoredProcedure [dbo].[Pr_vstavka]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[Pr_vstavka] (@inn varchar(100), @mmm varchar(100) )
AS
SET NOCOUNT ON
INSERT INTO W_version(Notes,descr) VALUES ( @inn + convert(Varchar(30), GETDATE()), @mmm )
GO
/****** Object:  StoredProcedure [dbo].[Insert_version_programm_database]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Change script
-- Insert_version_programm_database 'Изменения в логистике и инвойсах','Ver 001.037'
CREATE PROCEDURE [dbo].[Insert_version_programm_database]
                      (@Description_txt NVARCHAR(40),
                       @Vers_txt        NVARCHAR(20))
AS

INSERT  W_Version([D_change] ,[Descr]  ,[Notes], [USS])
VALUES (GETDATE(),'V001.'+ @Vers_txt,@Description_txt,'Савченко А.А.')
GO
/****** Object:  StoredProcedure [dbo].[PovtorOptions]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[PovtorOptions] (@IDBRAND INT,
                           @OLDMODEL INT,
                           @OLDVERS INT, 
                           @NEWMODEL INT,
                           @NEWVERS INT)
AS
--SET NOCOUNT ON

INSERT INTO S_OPTIONAL(  Grup, Brend,      Model,    Version,  Sokr, Naz, Pr_exw, Pr_dlr, Pr_msrp)
SELECT                   Grup, @IDBRAND , @NEWMODEL, @NEWVERS, Sokr, Naz, Pr_exw, Pr_dlr, Pr_msrp
  FROM S_OPTIONAL 
WHERE  BREND = @IDBRAND 
  AND  MODEL = @OLDMODEL 
  AND  VERS=@OLDVERS

PRINT @OLDMODEL
PRINT @OLDVERS
PRINT @NEWMODEL
PRINT @NEWVERS

--PRINT @@ERROR
PRINT 'ROW = ' + CONVERT(VARCHAR(5),@@ROWCOUNT)
GO
/****** Object:  StoredProcedure [dbo].[Insert_New_Order]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
  Вставка новых заказов
*/
CREATE PROCEDURE [dbo].[Insert_New_Order] (@BRAND INT)
AS

DECLARE @Old INT         -- до вставки
DECLARE @New INT         -- после вставки
DECLARE @Raz INT         -- Разница


-- Обновление модель версии
UPDATE W 
SET    W.MODEL    = P.MODEL, 
       W.VERS     = P.VERS,
       W.ENGINE   = P.ENGINE,
       W.TRIMM    = P.TRIMM,
       W.GEARBOX  = P.GEARBOX,
       W.SPEC1    = P.SPEC1,
       W.SPEC2    = P.SPEC2,
       W.SPEC3    = P.SPEC3,
       W.OPTIONS  = P.NAZ
FROM   W_CO     W, 
       W_PAKAGE P
WHERE  W.PACKAGE = P.ID
 AND   W.BREND   = 1 --@BRAND

-- Цвет оббивки
UPDATE W 
SET    W.COLOUR_ID = S.ID
FROM   W_CO  W, 
       S_COLOURS S
WHERE  W.COLOUR = S.NAZ
 AND   W.BREND  = S.BREND    --  @BRAND
 AND   W.MODEL  = S.MODEL
 AND   W.VERS   = S.VERSION

-- Цвет кузова 
UPDATE W 
SET    W.COLOURS_ID = S.ID
FROM   W_CO      W, 
       S_COLOURK S
WHERE  W.COLOURS = S.NAZ
 AND   W.BREND   = S.BREND   --  @BRAND
 AND   W.MODEL   = S.MODEL
 AND   W.VERS    = S.VERSION

--/*

-- Отключить триггер перед вставкой

-- Подсчет количества до вставки
SELECT @Old = COUNT(ID) FROM W_ORDER WHERE BREND = @BRAND

-- Вставка в основную таблицу
INSERT W_ORDER (Zakaz ,
                Dat_zak , 
                D_zakaza , 
                Status ,   
                Brend , 
                Model , 
                Vers ,  
                Package , 
                Colour , 
                Colours , 
                Spec1 , 
                Spec2 ,
                Spec3 ,
                Trimm , 
                Options ,
                Engine ,
                Gearbox , 
                Dlr , 
                Dealer_order_placed , 
                Orderplaced ,
                Ordertype , 
                ProductionMonth , 
                ProdM , 
                Cif_Cip ,
                Dealer_price ,
                Msrp ,  
                My ,  
                Optional , 
                Viev ,   
                Isp_dat , 
                Isp ,
                Priz ,
                Note , 
                Comments)
SELECT          Zakaz ,                           -- Номер заказа
                Getdate() ,                       -- Дата вставки  
                Dat ,                             -- Дата создания заказа
                1 ,                               -- Статус
               @BRAND ,                           -- Бренд
                Model ,                           -- Модель 
                Vers ,                            -- Версия  
                Package ,                         -- Номер пакет  
                Colour_id ,                       -- Цвет кузова 
                Colours_id ,                      -- Цвет  
                Spec1 ,                           -- Cпецификация 1
                Spec2 ,                           -- Cпецификация 2  
                Spec3 ,                           -- Cпецификация 3
                Trimm,                            -- Кузов 
                Options ,                         -- Опции 
                Engine ,                          -- Двигатель
                Gearbox ,                         -- Коробка передач
                Dlr ,                             -- Дилер заказавший  
                Dlr as Dlrp ,                     -- Дилер собственник   
                Orderplaced ,                     -- Дата размещения заказа у производителя
                OrderType ,                       -- Тип заказа
                Productionmonth ,                 -- Месяц производства  
                Productionmonth as prodm,         -- Месяц производства  
                0 ,                               -- Цена производителя
                0 ,                               -- Цена дилера
                0 ,                               -- Цена клиента
                2008 ,                            -- Модельный год
                100 ,                             -- Признак закачки = 100 
                0 ,                               -- Просмотр 
                Getdate(),                        -- Дата вставки
                'Automat',                        -- Автоматический перенос
                1,                                -- Признака
                'LOAD FORD',                      -- Примечание
                'NEW ORDER'                       -- Коментарии
FROM             W_CO                      
WHERE            BREND = @BRAND                   -- Фильтрация    
  AND            PRIZ = 1                         -- Ограничение повторной закачки
 
-- Подсчет количества после вставки
SELECT @New = COUNT(ID) FROM W_ORDER WHERE BREND = @BRAND
SET @Raz = @New - @Old

-- Запись о вставленной информации в лог файл
INSERT INTO W_LOG (Zakaz, Tim, Usr_name, Note, Old_val, New_val) 
VALUES (@Raz, GETDATE(), USER_NAME() , 'Add Order in Database on Ford', @Old, @New)

--*/

-- Замена признака c 1 на 2 = (данные перекачаны в таблицу W_order)
UPDATE W_CO SET PRIZ = 2 WHERE  BREND = @BRAND   -- Фильтрация    

/*
Контроль вставки
SELECT comments  FROM W_ORDER WHERE BREND=1
SELECT max(id)   FROM W_ORDER WHERE BREND=1
SELECT count(id) FROM W_ORDER WHERE BREND=1
*/
GO
/****** Object:  UserDefinedFunction [dbo].[UsdPhrase]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*************************************************************************/
/*                  UsdPhrase function for MSSQL2000                     */
/*                   Gleb Oufimtsev (dnkvpb@nm.ru)                       */
/*                       http://www.gvu.newmail.ru                       */
/*                          Moscow  Russia  2001                         */
/*************************************************************************/
CREATE function [dbo].[UsdPhrase] (@Value money)
returns varchar(255)
as
begin
  declare @dpart bigint, @dattr tinyint, @cpart tinyint, @cattr tinyint
  set @dpart=floor(@Value)     set @dattr=@dpart%100
  if @dattr>19 set @dattr=@dattr%10
  set @cpart=(@Value-@dpart)*100
  if @cpart>19 set @cattr=@cpart%10 else set @cattr=@cpart
  return dbo.NumPhrase(floor(@Value),1)+' доллар'
           +case when @dattr=1 then '' when @dattr in (2,3,4) then 'а' else
'ов' end
           +' США '+right('0'+cast(@cpart as varchar(2)),2)+' цент'
           +case when @cattr=1 then '' when @cattr in (2,3,4) then 'а' else
'ов' end
end
GO
/****** Object:  UserDefinedFunction [dbo].[RubPhrase]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*************************************************************************/
/*                  RubPhrase function for MSSQL2000                     */
/*                   Gleb Oufimtsev (dnkvpb@nm.ru)                       */
/*                       http://www.gvu.newmail.ru                       */
/*                          Moscow  Russia  2001                         */
/*************************************************************************/
CREATE function [dbo].[RubPhrase] (@Value money)
returns varchar(255)
as
begin
  declare @rpart bigint, @rattr tinyint,  @cpart tinyint, @cattr tinyint
  set @rpart=floor(@Value)     set @rattr=@rpart%100
  if @rattr>19 set @rattr=@rattr%10
  set @cpart=(@Value-@rpart)*100
  if @cpart>19 set @cattr=@cpart%10 else set @cattr=@cpart
  return dbo.NumPhrase(@rpart,1)+' рубл'
           +case when @rattr=1 then 'ь' when @rattr in (2,3,4) then 'я' else
'ей' end+' '
           +right('0'+cast(@cpart as varchar(2)),2)+' копе'
           +case when @cattr=1 then 'йка' when @cattr in (2,3,4) then 'йки'
else 'ек' end
end
GO
/****** Object:  View [dbo].[A_Pays]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Pays]
AS
SELECT     N_ORD, SUM(SUM_EUR) AS S_Eur, MAX([DATE]) AS Expr1, MIN(SUM_TOTAL) AS Expr2
FROM         dbo.dlr_Payment
GROUP BY N_ORD
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1[50] 4[25] 3) )"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1[50] 2[25] 3) )"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1[75] 4) )"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 9
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "dlr_Payment"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 360
               Right = 288
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
      PaneHidden = 
   End
   Begin DataPane = 
      PaneHidden = 
      Begin ParameterDefaults = ""
      End
      RowHeights = 220
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Pays'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Pays'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Orientation', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Pays'
GO
/****** Object:  View [dbo].[D_Payment]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[D_Payment]
AS
SELECT     dbo.S_Diler.ID AS Dlr_id, dbo.W_Order.Brend, dbo.W_Order.ID, dbo.dlr_Payment.N_ORD, SUM(dbo.dlr_Payment.SUM_EUR) AS Paym_euro, 
                      SUM(dbo.dlr_Payment.SUM_CURR) AS Paym_hrn
FROM         dbo.S_Diler RIGHT OUTER JOIN
                      dbo.dlr_Payment ON dbo.S_Diler.Last_Name = dbo.dlr_Payment.DEALER LEFT OUTER JOIN
                      dbo.W_Order ON dbo.dlr_Payment.N_ORD = dbo.W_Order.Zakaz
GROUP BY dbo.S_Diler.ID, dbo.W_Order.Brend, dbo.W_Order.ID, dbo.dlr_Payment.N_ORD
GO
/****** Object:  StoredProcedure [dbo].[Upd_sales_payment]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--INSERT INTO Dlr_Sales   SELECT [_Sales].*   FROM _Sales
--INSERT INTO Dlr_Payment SELECT [_Payment].* FROM _Payment
CREATE PROC [dbo].[Upd_sales_payment]
AS
DECLARE @DELSAL INT
DECLARE @DELPAY INT
PRINT 'Удалено продаж = ' + CONVERT(NVARCHAR(20),@DELSAL)

BEGIN TRANSACTION 
TRUNCATE TABLE Dlr_Sales 
TRUNCATE TABLE Dlr_Payment

SELECT @DELSAL = COUNT(*) FROM DLR_SALES
SELECT @DELPAY = COUNT(*) FROM Dlr_Payment

PRINT 'Удалено продаж = ' + CONVERT(NVARCHAR(20),@DELSAL)
PRINT 'Удалено продаж = ' + CONVERT(NVARCHAR(20),@DELPAY)

-- DELETE  Dlr_Sales 
-- DELETE  Dlr_Payment

INSERT INTO Dlr_Sales   SELECT * FROM PAYMENTS..._Sales
INSERT INTO Dlr_Payment SELECT * FROM PAYMENTS..._Payment


--SELECT *   FROM PAYMENTS..._Sales
--SELECT *  FROM PAYMENTS..._Payment

SELECT @DELSAL = COUNT(*) FROM DLR_SALES
SELECT @DELPAY = COUNT(*) FROM Dlr_Payment

PRINT 'Добавлено продаж = ' + CONVERT(NVARCHAR(20),@DELSAL)
PRINT 'Добавлено продаж = ' + CONVERT(NVARCHAR(20),@DELPAY)
COMMIT TRANSACTION

-- SELECT * FROM DLR_SALES
-- SELECT * FROM DLR_PAYMENT
GO
/****** Object:  View [dbo].[Rep_dlr_ar]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Rep_dlr_ar]
AS
SELECT     TOP (100) PERCENT VIN, N_ORD, SUM(SUM_EUR) AS S_eur, SUM(SUM_CURR) AS S_uah, SUM(SUM_TOTAL) AS S_total
FROM         dbo.Dlr_Payment
WHERE     (YEAR(DATE) > 2007) AND (MARK = N'F')
GROUP BY VIN, N_ORD
HAVING      (NOT (VIN IS NULL))
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[56] 4[22] 2[3] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "Dlr_Payment"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 269
               Right = 306
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 2775
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Rep_dlr_ar'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Rep_dlr_ar'
GO
/****** Object:  View [dbo].[Upd_paymnt]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Upd_paymnt]
AS
SELECT     DEALER AS L_DEALER, N_ORD, SUM(SUM_CURR) AS S_SUM_CURR, SUM(SUM_EUR) AS S_SUM_EUR, MIN(IDD) AS L_IDD, MIN(ID) AS L_ID, MIN(OPRID) 
                      AS L_OPRID, MAX(ISNULL(L_DATE, GETDATE())) AS L_L_DATE, SUM(SUM_TOTAL) AS L_SUM_TOTAL, MIN(NOTE) AS L_NOTE, MIN(EUR) AS L_EUR, MAX(DATE) 
                      AS L_DATE, MIN(NUM_DOC) AS L_NUM_DOC, MY
FROM         dbo.Dlr_Payment
GROUP BY N_ORD, DEALER, MY
HAVING      (NOT (DEALER IS NULL))
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[7] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "Dlr_Payment"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 464
               Right = 390
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 14
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 3105
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 4890
         Alias = 2370
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Upd_paymnt'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Upd_paymnt'
GO
/****** Object:  StoredProcedure [dbo].[get_dir_file_list]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- *************************************************************************
-- TEST SCRIPT
-- exec get_dir_file_list 'C:\temp', 1
-- exec get_dir_file_list 'C:\nas\it\_out\base',1
-- get_dir_file_list 'C:\nas\it\_out\base',0
-- select * from w_files
-- *************************************************************************
-- *************************************************************************
-- Зпись в таблицу файлов из определенной дирректории
-- *************************************************************************
CREATE PROCEDURE [dbo].[get_dir_file_list]
   @folder   varchar(6000),
   @Subfolders   BIT = 0 --Lists the folders too
AS

declare @error         INT,
        @script        varchar(8000),
        @file_name     varchar(8000)

SET @script = 'cd ' + @folder
EXEC @error = master..xp_CMDSHELL @script, NO_OUTPUT

IF @error = 0
BEGIN
   SET @script = 'DIR ' + @folder + ' /b /o:g /o:n /a:-d '
   If @Subfolders = 1
      BEGIN
       SET @script = @script + '/s '
      END

       SET @script = @script
   
       --CREATE TABLE W_files(Path VARCHAR(8000)) 
       DELETE FROM W_files
       INSERT W_files(Path) EXEC @error = master.dbo.xp_cmdshell @script
       UPDATE W_files SET Processed=Processed+1
      
       -- перенос скопированных файлов в директорию
       -- master.dbo.xp_cmdshell 'copy C:\nas\it\_out\base\*.xls C:\nas\it\_out\base\ddl'
       
       -- удаление
       -- master.dbo.xp_cmdshell 'вуд C:\nas\it\_out\base\*.xls'

       --SELECT * FROM #path
       --DROP TABLE #path
END
GO
/****** Object:  View [dbo].[Units]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Units]
AS
SELECT     TOP (100) PERCENT dbo.KolAnging(DAYS_DLR) AS ang, Status, DAYS_DLR
FROM         dbo.W_Order
WHERE     (Brend = 3)
ORDER BY ang
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[42] 4[25] 2[16] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 294
               Right = 408
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 2640
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 780
         GroupBy = 1125
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Units'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Units'
GO
/****** Object:  StoredProcedure [dbo].[Parts_Insert_dealer_xls]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- ***************************************************************************************************************
-- Сбор данных из xls файло поступивших от дилеров в определенную директоррию
-- Запись в дирректорию W:\\temp\parts\*.xls
-- EXEC Insert_dealer_parts_xls 1
-- ***************************************************************************************************************
CREATE PROCEDURE [dbo].[Parts_Insert_dealer_xls] (@BRANDID INT)
AS

-- Инициализация переменных
DECLARE @DLRID    INT                   -- Ид дилера
DECLARE @DLIDSTR  NVARCHAR(10)          -- Ид дилера строковая переменная
DECLARE @DLRNAME  NVARCHAR(50)          -- Имя дилера
DECLARE @PATHDIR  NVARCHAR(250)         -- Формирование пути к файлу 
DECLARE @ENDPATH  NVARCHAR(50)          -- Окончание формирования
DECLARE @FULLPATH NVARCHAR(250)         -- Окончание формирования
DECLARE @EXPLOIT  NVARCHAR(3000)        -- Формирование строки запроса
DECLARE @PATHH    NVARCHAR(500)         -- Формирование строки запроса
DECLARE @PATHCOM  NVARCHAR(500)         -- команда для проверки существования файла на диске
DECLARE @RESULT   INT                   -- Результат поиска файла в дирректории  0 - файл есть 1-нет файла
DECLARE @BRANDSTR NVARCHAR(1)           -- Буква бренда F, V, J, L
--DECLARE @BRANDID  INT                 -- Номер бренда (для ручного контроля)
--SET @BRANDID = 5

-- Определение буквы бренда
IF  (@BRANDID=1) SET @BRANDSTR = 'F'
IF  (@BRANDID=2) SET @BRANDSTR = 'V'
IF  (@BRANDID=3) SET @BRANDSTR = 'L'
IF  (@BRANDID=4) SET @BRANDSTR = 'J'
IF  (@BRANDID=5) SET @BRANDSTR = 'P'
 
-- EXEC @result1 = master..xp_cmdshell 'TYPE C:\nas\temp\parts\P400.xLS',no_output
-- PRINT @result1

-- Пути и настройки
SET @PATHDIR  = 'Data Source=C:\parts\db\xls'         -- Определние пути к папке файлов
SET @ENDPATH = ';Extended Properties=Excel 8.0'       -- Окончание формирования

-- Определение курсора
DECLARE DLRCURSOR CURSOR FOR SELECT ID, LAST_NAME FROM  WINNER.DBO.S_DILER  ORDER BY ID 
FOR READ ONLY
OPEN DLRCURSOR
FETCH FROM DLRCURSOR INTO @DLRID,  @DLRNAME
   	  WHILE @@FETCH_STATUS = 0
	  	    BEGIN
                 SET @DLIDSTR = CONVERT(NVARCHAR(10),@DLRID) 
                 SET @PATHH   = 'C:\nas\parts\db\xls\' + @BRANDSTR + CONVERT(NVARCHAR(10),@DLRID) + '.XLS'         -- формирование пути к файлу
                 SET @PATHCOM = 'TYPE ' + @PATHH
                 
                 
              -- 0 - файл есть 1-нет файла
                 EXEC  @RESULT = master..xp_cmdshell @PATHCOM ,no_output

                 IF @RESULT = 0
                     BEGIN
                  --    PRINT 'Файл есть = ' + @PATHH 
                  --    PRINT @RESULT
                  --                        
                      --SET @DLIDSTR =  '375'
                      --PRINT @PATHDIR + 'F' + @DLIDSTR + '.XLS'
                      --PRINT @PATHDIR + 'V' + @DLIDSTR + '.XLS'
                      --PRINT @PATHDIR + 'L' + @DLIDSTR + '.XLS'
                      --PRINT @PATHDIR + 'J' + @DLIDSTR + '.XLS'
                      --SET @FULLPATH = @PATHDIR  + 'P' + @DLIDSTR + '.XLS' + @Endpath 
                      --SELECT @FULLPATH = 'Data Source=C:\nas\temp\parts\P' + @DLIDSTR + '.xls;Extended Properties=Excel 8.0'
                      --SELECT @FULLPATH = 'Data Source=C:\nas\temp\parts\P375.xls;Extended Properties=Excel 8.0'
                      --PRINT @FULLPATH
                 
                      --Удаление предыдущих данных поступивших раннее от этого дилера по бренду
                        DELETE FROM W_PARTS WHERE Dealer = CONVERT(INT, @DLIDSTR) AND Brand = @BRANDID
                        
                      --SELECT * FROM W_PARTS
                      --Динамическая строка подключения к xls и выборка данных в таблицу 
                      --SELECT * FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0','Data Source=C:\NAS\PARTS\DB\XLS\P381.xls;Extended Properties=Excel 8.0')...[Parts$] WHERE ARTICUL IS NOT NULL
                      --SELECT @EXPLOIT = N'SELECT * FROM OPENDATASOURCE(''Microsoft.Jet.OLEDB.4.0'',''Data Source="C:\NAS\PARTS\DB\XLS\' + @BRANDSTR + @DLIDSTR + '.xls";Extended Properties=Excel 8.0'')...[Parts$] WHERE articul IS NOT NULL '
                      --SELECT @EXPLOIT = N'INSERT W_PARTS (Articul, Qty, Comments, Dealer, Brand) SELECT CONVERT(NVARCHAR(20), Articul + '' ''), CONVERT(Money, Qty), Comments,' + @DLIDSTR + ',' + CONVERT(NVARCHAR(3),@BRANDID) + ' FROM OPENDATASOURCE(''Microsoft.Jet.OLEDB.4.0'',''Data Source="C:\NAS\PARTS\DB\XLS\' + @BRANDSTR + @DLIDSTR + '.xls";Extended Properties=Excel 8.0'')...[Parts$] WHERE articul IS NOT NULL '
                        
                        
                      --SELECT @EXPLOIT = 'INSERT W_PARTS (Articul, Qty, Comments, Dealer, Brand) SELECT CONVERT(NCHAR(20),[ARTICUL]), CONVERT(Money, Qty), Comments,' + @DLIDSTR + ',' + CONVERT(NVARCHAR(3),@BRANDID) + ' FROM OPENDATASOURCE(''Microsoft.Jet.OLEDB.4.0'',''Data Source="C:\NAS\PARTS\DB\XLS\' + @BRANDSTR + @DLIDSTR + '.xls";Extended Properties=Excel 8.0'')...[Parts$] WHERE articul IS NOT NULL '
                     -- Выбор только тех которые имеют номер артикула
                        SELECT @EXPLOIT = 'INSERT W_PARTS (Articul, Qty, Comments, Dealer, Brand) SELECT CONVERT(NVARCHAR(20),ARTICUL) AS Artic, CONVERT(Money, Qty), Comments, ' + @DLIDSTR + ', ' + CONVERT(NVARCHAR(3),@BRANDID) + ' FROM OPENDATASOURCE(''Microsoft.Jet.OLEDB.4.0'',''Data Source="C:\NAS\PARTS\DB\XLS\' + @BRANDSTR + @DLIDSTR + '.xls";Extended Properties=Excel 8.0'')...[Parts$] WHERE ARTICUL IS NOT NULL '
                      --SELECT @EXPLOIT = 'INSERT W_PARTS (Articul, Qty, Comments, Dealer, Brand) SELECT ARTICUL, CONVERT(Money, Qty), Comments, ' + @DLIDSTR + ', ' + CONVERT(NVARCHAR(3),@BRANDID) + ' FROM OPENDATASOURCE(''Microsoft.Jet.OLEDB.4.0'',''Data Source="C:\NAS\PARTS\DB\XLS\' + @BRANDSTR + @DLIDSTR + '.xls";Extended Properties=Excel 8.0'')...[Parts$] WHERE ARTICUL IS NOT NULL '
                      
                      EXEC  (@EXPLOIT)
                      
                      
                      --INSERT W_PARTS (Articul, Qty, Comments, Dealer, Brand) 
                      --SELECT CONVERT(NVARCHAR(20),[ARTICUL]), CONVERT(Money, Qty), Comments, @DLIDSTR , CONVERT(NVARCHAR(3),@BRANDID) FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0','Data Source="C:\NAS\PARTS\DB\XLS\' + @BRANDSTR + @DLIDSTR + '.xls";Extended Properties=Excel 8.0'')...[Parts$] WHERE articul IS NOT NULL 
                        

                      --Запись в лог файл
                      --INSERT Usr_name, Note,Zakaz, Gr, New_val, Old_val VALUES 'Parts','Load file : ' + @BRANDSTR + @DLIDSTR, @pathh, CONVERT(NVARCHAR(10),@DLRID) 
                      --print @EXPLOIT
                      --PRINT '--------------------------------------------------' + @PATHH
                        
                      --SELECT * FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0', 'Data Source=C:\nas\temp\parts\P400.xls;Extended Properties=Excel 8.0')...[Parts$] WHERE articul <> ''
                      --SELECT * INTO #t FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0','Data Source=' + @PATH + ';Extended Properties=Excel 8.0')...[Parts$]
                      --SELECT * INTO #t FROM OPENDATASOURCE(@PATHDIR)...[Parts$]
                      --SELECT * INTO #t FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0', ''' + @FULLPATH + ''')...[Parts$]
                      --SELECT * INTO #t FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0','Data Source=C:\nas\temp\parts\P400.xls;Extended Properties=Excel 8.0')...[Parts$]
                      --SELECT * FROM W_PARTS
                        --IF @@ERROR>0 
                         --  BEGIN
                          --    PRINT 'ERROR' + @EXPLOIT
                          -- END 
                          
                         INSERT W_Parts_log (Descr, Fnn) VALUES  (@@rowcount,  @PATHCOM)
                  END  
                
               -- Если файла нет    
               --ELSE
                  -- BEGIN
                  -- PRINT 'ФАЙЛА НЕТ'
                  -- CONTINUE
              -- END   

             FETCH FROM DLRCURSOR INTO @DLRID, @DLRNAME
         --  Можно использование и такого синтаксиса но при этом будет выводиться весь запрос в табличном виде
         --  FETCH FROM DLRCURSOR  
         set @EXPLOIT=''
	  END 

-- Освобождение курсора
CLOSE DLRCURSOR
DEALLOCATE DLRCURSOR

--PRINT CONVERT(money, '222.22')
GO
/****** Object:  StoredProcedure [dbo].[Insert_dealer_parts_xls]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- ***************************************************************************************************************
-- Сбор данных из xls файло поступивших от дилеров в определенную директоррию
-- Запись в дирректорию W:\\temp\parts\*.xls
-- 
-- ***************************************************************************************************************
CREATE PROCEDURE [dbo].[Insert_dealer_parts_xls]
AS

-- Инициализация переменных
DECLARE @DLRID    INT                   -- Ид дилера
DECLARE @DLIDSTR  NVARCHAR(10)          -- Ид дилера строковая переменная
DECLARE @DLRNAME  NVARCHAR(50)          -- Имя дилера
DECLARE @PATHDIR  NVARCHAR(250)         -- Формирование пути к файлу 
DECLARE @ENDPATH  NVARCHAR(50)          -- Окончание формирования
DECLARE @FULLPATH NVARCHAR(250)         -- Окончание формирования
DECLARE @EXPLOIT  NVARCHAR(3000)        -- Формирование строки запроса
DECLARE @PATHH    NVARCHAR(500)         -- Формирование строки запроса
DECLARE @PATHCOM  NVARCHAR(500)         -- команда для проверки существования файла на диске
DECLARE @RESULT   INT                   -- Результат поиска файла в дирректории  0 - файл есть 1-нет файла

 
-- EXEC @result1 = master..xp_cmdshell 'TYPE C:\nas\temp\parts\P400.xLS',no_output
-- PRINT @result1

-- Пути и настройки
SET @PATHDIR  = 'Data Source=C:\nas\temp\parts\'      -- Определние пути к папке файлов
SET @ENDPATH = ';Extended Properties=Excel 8.0'       -- Окончание формирования

-- Определение курсора
DECLARE DLRCURSOR CURSOR FOR SELECT ID, LAST_NAME FROM  WINNER.DBO.S_DILER ORDER BY ID 
FOR READ ONLY
OPEN DLRCURSOR
FETCH FROM DLRCURSOR INTO @DLRID,  @DLRNAME
   	  WHILE @@FETCH_STATUS = 0
	  	    BEGIN
                 SET @DLIDSTR =  CONVERT(NVARCHAR(10),@DLRID) 
                 SET @PATHH = 'C:\nas\temp\parts\P' + CONVERT(NVARCHAR(10),@DLRID) + '.XLS'         -- формирование пути к файлу
                 SET @PATHCOM = 'TYPE ' + @PATHH
                 
                 
                 -- 0 - файл есть 1-нет файла
                 EXEC  @RESULT = master..xp_cmdshell @PATHCOM ,no_output
                 PRINT @RESULT

                 IF @RESULT = 0
                    BEGIN
                 
                      --SET @DLIDSTR =  '375'
                      --PRINT @PATHDIR + 'F' + @DLIDSTR + '.XLS'
                      --PRINT @PATHDIR + 'V' + @DLIDSTR + '.XLS'
                      --PRINT @PATHDIR + 'L' + @DLIDSTR + '.XLS'
                      --PRINT @PATHDIR + 'J' + @DLIDSTR + '.XLS'
                      --SET @FULLPATH = @PATHDIR  + 'P' + @DLIDSTR + '.XLS' + @Endpath 
                      --SELECT @FULLPATH = 'Data Source=C:\nas\temp\parts\P' + @DLIDSTR + '.xls;Extended Properties=Excel 8.0'
                      --SELECT @FULLPATH = 'Data Source=C:\nas\temp\parts\P375.xls;Extended Properties=Excel 8.0'
                      --PRINT @FULLPATH
                 
                      --Динамическая строка подключения
                        SELECT @EXPLOIT = N'SELECT * FROM OPENDATASOURCE(''Microsoft.Jet.OLEDB.4.0'',''Data Source="C:\nas\temp\parts\P' + @DLIDSTR + '.xls";Extended Properties=Excel 8.0'')...[Parts$]'
                      --EXEC (@EXPLOIT)

                 
                        print @EXPLOIT
                        PRINT '--------------------------------------------------' + @PATHH
                      --SELECT * FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0', 'Data Source=C:\nas\temp\parts\P400.xls;Extended Properties=Excel 8.0')...[Parts$] WHERE articul <> ''
                      --SELECT * INTO #t FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0','Data Source=' + @PATH + ';Extended Properties=Excel 8.0')...[Parts$]
                      --SELECT * INTO #t FROM OPENDATASOURCE(@PATHDIR)...[Parts$]
                      --SELECT * INTO #t FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0', ''' + @FULLPATH + ''')...[Parts$]
                     -- SELECT * INTO #t FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0','Data Source=C:\nas\temp\parts\P400.xls;Extended Properties=Excel 8.0')...[Parts$]
                        FETCH FROM DLRCURSOR INTO @DLRID, @DLRNAME
                    --  Можно использование и такого синтаксиса но при этом будет выводиться весь запрос в табличном виде
                    --  FETCH FROM DLRCURSOR  
                  END  
	  END 

-- Освобождение курсора
CLOSE DLRCURSOR
DEALLOCATE DLRCURSOR
GO
/****** Object:  StoredProcedure [dbo].[App_Diler_subDelete]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Deletes a record from the [dbo].[S_Diler_sub] table.
CREATE PROCEDURE [dbo].[App_Diler_subDelete]
        @pk_Id int
AS
BEGIN
    DELETE [dbo].[S_Diler_sub]
    WHERE [Id] = @pk_Id
END
GO
/****** Object:  StoredProcedure [dbo].[App_Diler_subGet]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns a specific record from the [dbo].[S_Diler_sub] table.
CREATE PROCEDURE [dbo].[App_Diler_subGet]
        @pk_Id int
AS
DECLARE
    @l_count int
BEGIN

    -- Get the rowcount first and make sure 
    -- only one row is returned
    SELECT @l_count = count(*) 
    FROM [dbo].[S_Diler_sub]
    WHERE [Id] =@pk_Id

    IF @l_count = 0
        RAISERROR ('The record no longer exists.', 16, 1)
    IF @l_count > 1
        RAISERROR ('duplicate object instances.', 16, 1)

    -- Get the row from the query.  Checksum value will be
    -- returned along the row data to support concurrency.
    SELECT 
        [Id],
        [Idn],
        [Position],
        [Fist_Name],
        [Last_name],
        [Short_Name],
        [Mob_tel],
        [Work_tel],
        [Home_tel],
        [E_mail],
        [Post_code],
        [Area],
        [City],
        [Street],
        [Build],
        CAST(BINARY_CHECKSUM([Id],[Idn],[Position],[Fist_Name],[Last_name],[Short_Name],[Mob_tel],[Work_tel],[Home_tel],[E_mail],[Post_code],[Area],[City],[Street],[Build]) AS nvarchar(4000)) AS IS_CHECKSUM_COLUMN_12345
    FROM [dbo].[S_Diler_sub]
    WHERE [Id] =@pk_Id
END
GO
/****** Object:  StoredProcedure [dbo].[App_Diler_subAdd]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Creates a new record in the [dbo].[S_Diler_sub] table.
CREATE PROCEDURE [dbo].[App_Diler_subAdd]
    @p_Idn int,
    @p_Position nvarchar(50),
    @p_Fist_Name nvarchar(50),
    @p_Last_name nvarchar(50),
    @p_Short_Name nvarchar(50),
    @p_Mob_tel nvarchar(20),
    @p_Work_tel nvarchar(20),
    @p_Home_tel nvarchar(20),
    @p_E_mail nvarchar(50),
    @p_Post_code nvarchar(10),
    @p_Area nvarchar(40),
    @p_City nvarchar(40),
    @p_Street nvarchar(40),
    @p_Build nvarchar(40),
    @p_Id_out int output
AS
BEGIN
    INSERT
    INTO [dbo].[S_Diler_sub]
        (
            [Idn],
            [Position],
            [Fist_Name],
            [Last_name],
            [Short_Name],
            [Mob_tel],
            [Work_tel],
            [Home_tel],
            [E_mail],
            [Post_code],
            [Area],
            [City],
            [Street],
            [Build]
        )
    VALUES
        (
             @p_Idn,
             @p_Position,
             @p_Fist_Name,
             @p_Last_name,
             @p_Short_Name,
             @p_Mob_tel,
             @p_Work_tel,
             @p_Home_tel,
             @p_E_mail,
             @p_Post_code,
             @p_Area,
             @p_City,
             @p_Street,
             @p_Build
        )

    SET @p_Id_out = SCOPE_IDENTITY()

END
GO
/****** Object:  View [dbo].[Dr_dlr]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Dr_dlr]
AS
SELECT     TOP (100) PERCENT W.ID AS [ID WIU], W.Zakaz AS [Supplier Order], D.Naz AS [Dealer Name], W.Brend AS [ID Brand], W.Model AS [ID Model], 
                      W.Vers AS [ID Version], W.Dlr AS [ID Dealer], W.Loc AS [ID Location], W.VIN AS [VIN Code], W.Engine AS [ID Engine], E.Naz AS [Name Engine], 
                      W.Spec1 AS [Special 1], W.Options AS [Optional Equipment], W.Colour AS [ID Color Body], M.Naz AS [Model Name], B.Naz AS Brand, 
                      V.Naz AS [Version Name], W.Status AS [Id Status], dbo.S_Status.Naz AS [Status Name]
FROM         dbo.W_Order AS W LEFT OUTER JOIN
                      dbo.S_Status ON W.Status = dbo.S_Status.ID LEFT OUTER JOIN
                      dbo.S_Model AS M ON W.Model = M.ID LEFT OUTER JOIN
                      dbo.S_Version AS V ON W.Vers = V.ID LEFT OUTER JOIN
                      dbo.S_Brend AS B ON W.Brend = B.ID LEFT OUTER JOIN
                      dbo.S_Engenie AS E ON W.Engine = E.ID LEFT OUTER JOIN
                      dbo.S_Location AS L ON W.Loc = L.ID LEFT OUTER JOIN
                      dbo.S_Diler AS D ON W.Dlr = D.ID
WHERE     (W.Brend = 1) AND (W.Status < 9)
ORDER BY [Id Status]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[48] 4[30] 2[8] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = -109
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 453
               Right = 300
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "M"
            Begin Extent = 
               Top = 339
               Left = 526
               Bottom = 447
               Right = 686
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "V"
            Begin Extent = 
               Top = 106
               Left = 387
               Bottom = 214
               Right = 538
            End
            DisplayFlags = 280
            TopColumn = 2
         End
         Begin Table = "B"
            Begin Extent = 
               Top = 6
               Left = 383
               Bottom = 101
               Right = 543
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "E"
            Begin Extent = 
               Top = 541
               Left = 392
               Bottom = 649
               Right = 543
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "L"
            Begin Extent = 
               Top = 451
               Left = 394
               Bottom = 544
               Right = 545
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "D"
            Begin Extent = 
               Top = 203
               Left = 650
               Bottom = 311
               Right = 810
            End
            DisplayFlags = 280
            TopColumn = 0
         E' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Dr_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'nd
         Begin Table = "S_Status"
            Begin Extent = 
               Top = 226
               Left = 400
               Bottom = 334
               Right = 551
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1590
         Alias = 1440
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Dr_dlr'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Dr_dlr'
GO
/****** Object:  View [dbo].[A_ownedUnits]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_ownedUnits]
AS
SELECT     TOP (100) PERCENT dbo.W_Order.Statuss, dbo.W_Order.Date_completed, dbo.W_Order.Sold_to_DLR, dbo.W_Order.Sale_DATE, GETDATE() 
                      - dbo.W_Order.Date_completed AS Days_old, dbo.W_Order.Cif_cip, dbo.W_Order.Dealer_price, dbo.W_Order.MSRP, dbo.S_Status.Naz, 
                      dbo.S_Model.Naz AS Model_naz, dbo.W_Order.Status, dbo.W_Order.Brend, dbo.W_Order.Dlr, dbo.S_Version.Naz AS Versia, 
                      dbo.W_Order.Invoice_Date, dbo.W_Order.DLR_Payment, dbo.W_Order.Dealer_price AS Expr1, 
                      dbo.W_Order.DLR_Payment / dbo.W_Order.Dealer_price AS Raznica, dbo.W_Order.PMNT_Supplier, dbo.W_Order.Svvin, 
                      dbo.S_Diler.Last_Name AS DEALER, dbo.W_Order.VIN, dbo.W_Order.Pymnt_DATE AS Datte, dbo.W_Order.Pymnt_ID AS oprid, dbo.W_Order.Viev, 
                      dbo.W_Order.Payment_Due, dbo.W_Order.WIU_Arrived, GETDATE() - dbo.W_Order.WIU_Arrived AS Days_old1
FROM         dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Status ON dbo.W_Order.Status = dbo.S_Status.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dlr = dbo.S_Diler.ID
WHERE     (dbo.W_Order.PMNT_Supplier <> 0) AND (dbo.W_Order.Viev = 0)
ORDER BY Days_old
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 114
               Right = 300
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Status"
            Begin Extent = 
               Top = 6
               Left = 338
               Bottom = 114
               Right = 489
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 6
               Left = 527
               Bottom = 114
               Right = 687
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 6
               Left = 725
               Bottom = 114
               Right = 876
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 225
               Left = 354
               Bottom = 333
               Right = 514
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 3930
         Alias = 900
        ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_ownedUnits'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N' Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_ownedUnits'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_ownedUnits'
GO
/****** Object:  StoredProcedure [dbo].[Preview_porsche_orders]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--Просмотр заказов по Порше
--EXEC Preview_porsche_orders 
CREATE PROCEDURE [dbo].[Preview_porsche_orders] 
AS

-- Просмотр машин
SELECT   W.Status                                 AS [ID Status]    ,  -- Статус
         w.zakaz								  AS [Order],  
         w.vin                                    AS [VIN Code], 
         w.Pymnt_DATE                             as [Payment Date Dealer], 
         w.Sale_date                              AS [Date Sold to Dealer], 
         W.RLS_placed                             AS [Release Placed], 
         d.last_name                              AS [Dealer] ,   
         w.date_completed                         AS [Date completed],
         S.Naz                                    AS [Status]     ,  -- Наименование стаутса
         B.Id                                     AS [ID Brand]   ,  -- Ид бренд
         B.Naz                                    AS [Brand Name] ,  -- Наименование бренда
         M.Id                                     AS [ID Model]   ,  -- Ид модели 
         M.Naz                                    AS [Model Name] ,  -- Имя модели
         V.Id                                     AS [Id Version] ,  -- Ид версии
         V.Naz                                    AS [Version Name]          
FROM     W_order   W , 
         S_Brend   B , 
         S_Model   M , 
         S_Version V ,
         S_Status  S ,
         s_diler   D
WHERE    W.Brend  = 5
  AND    W.Brend  = B.Id
  AND    W.Model  = M.Id
  AND    W.Vers   = V.Id
  AND    W.Status = S.Id
  and    W.Dlr    = d.id 
  and    W.dlr    = 392                 --PCDP
  and    w.DLR_Actual_Arrival between '2008.07.01' and getdate()
  and    w.status = 9
ORDER BY STATUS
GO
/****** Object:  StoredProcedure [dbo].[Base_Report_Brand]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
  Количество машин в разрезе бренд - модель - версия
*/
-- Просмотр в разрезе Бренд Модель Версия
-- EXEC Base_Report_Brand 2

CREATE PROCEDURE [dbo].[Base_Report_Brand] (@Brand int) 
AS
SELECT   W.Status                                 AS ID_Status    ,  -- Статус
         S.Naz                                    AS Status       ,  -- Наименование стаутса
         B.Id                                     AS ID_Brand     ,  -- Ид бренд
         B.Naz                                    AS Brand        ,  -- Наименование бренда
         M.Id                                     AS ID_Model     ,  -- Ид модели 
         M.Naz                                    AS Model        ,  -- Имя модели
         V.Id                                     AS Id_Version   ,  -- Ид версии
         V.Naz                                    AS Version      ,  -- Название версии 
         COUNT (V.Naz)                            AS Qunty        ,  -- Количество машин
         SUM   (W.DLR_Payment)                    AS Dlr_Payment  ,  -- Дилер оплатил
         SUM   (W.PMNT_Supplier)                  AS Sup_Payment  ,  -- Мы опалтили производителю
         SUM   (W.PMNT_Supplier - W.DLR_Payment)  AS Raz_Payment     -- Разница между оплатами
FROM     W_order   W , 
         S_Brend   B , 
         S_Model   M , 
         S_Version V ,
         S_Status  S
(NOLOCK)
WHERE    W.Brend  = @Brand
  AND    W.Brend  = B.Id
  AND    W.Model  = M.Id
  AND    W.Vers   = V.Id
  AND    W.Status = S.Id
GROUP BY S.Naz, W.Status, B.Naz, B.Id,  M.Naz, M.ID,  V.Naz, V.Id
ORDER BY W.Status, B.Naz, M.Naz, V.Naz

--PRINT @@ROWCOUNT
GO
/****** Object:  StoredProcedure [dbo].[In12]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Вставка в таблицу значения
CREATE PROCEDURE [dbo].[In12] (@Naz Nvarchar(20))
AS
  SET NOCOUNT ON
--SELECT ID, ZAKAZ, D_ZAKAZA FROM W_ORDER WHERE BREND=@IBrand
  INSERT A0(Nn) VALUES (@naz)
GO
/****** Object:  StoredProcedure [dbo].[App_SalesmanGet]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Returns a specific record from the [dbo].[S_Salesman] table.
CREATE PROCEDURE [dbo].[App_SalesmanGet]
        @pk_ID int
AS
DECLARE
    @l_count int
BEGIN

    -- Get the rowcount first and make sure 
    -- only one row is returned
    SELECT @l_count = count(*) 
    FROM [dbo].[S_Salesman]
    WHERE [ID] =@pk_ID

    IF @l_count = 0
        RAISERROR ('The record no longer exists.', 16, 1)
    IF @l_count > 1
        RAISERROR ('duplicate object instances.', 16, 1)

    -- Get the row from the query.  Checksum value will be
    -- returned along the row data to support concurrency.
    SELECT 
        [ID],
        [Brand],
        [Dlr],
        [Fam],
        [Nam],
        [Tel],
        [Isp],
        [Dat],
        [Notice],
        CAST(BINARY_CHECKSUM([ID],[Brand],[Dlr],[Fam],[Nam],[Tel],[Isp],[Dat],[Notice]) AS nvarchar(4000)) AS IS_CHECKSUM_COLUMN_12345
    FROM [dbo].[S_Salesman]
    WHERE [ID] =@pk_ID
END
GO
/****** Object:  Table [dbo].[A1]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[A1](
	[Pid] [int] IDENTITY(1,1) NOT NULL,
	[ppp] [char](10) NULL,
	[Mnogo] [nvarchar](500) NULL,
	[Uss] [nvarchar](50) NULL,
	[Polz] [nvarchar](50) NULL,
	[datas] [datetime] NULL,
	[datam] [datetime] NULL,
	[datan]  AS (datediff(day,[DATAM],[DATAS])),
	[A1] [datetime] NULL,
	[A2] [datetime] NULL,
	[A3] [datetime] NULL,
	[A4] [datetime] NULL,
	[A5] [datetime] NULL,
	[A6] [datetime] NULL,
	[A7] [datetime] NULL,
	[A8] [datetime] NULL,
	[A9] [datetime] NULL,
	[A10]  AS ([DBO].[CHSTAT]([A1], [A2], [A3], [A4], [A5], [A6], [A7], [A8], [A9])),
	[a222]  AS (datediff(day,[DATAM],[DATAS])),
 CONSTRAINT [PK_A1] PRIMARY KEY CLUSTERED 
(
	[Pid] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'A1', @level2type=N'COLUMN',@level2name=N'Uss'
GO
/****** Object:  StoredProcedure [dbo].[Send_kopuch]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- ************************************************************************
-- Отправка сообщения для примера Копычу без запроса
-- ************************************************************************
create procedure [dbo].[Send_kopuch] 
as


DECLARE @TBODY NVARCHAR(400)
SET @TBODY ='Dear  Vitaliy Kopych, ' + 
            'a new purchase request requiring your approval has been created by ' +   CHAR(10) + CHAR(13) + 
            'Arthur Savchenko ' +   CHAR(10) + CHAR(13) + 
            'in DAX Purchasing module. Click for details: '   + CHAR(10) + CHAR(13) +           
            ' http://ax/sites/DynamicsAx/Enterprise%20Portal/RoleCenterCFO.aspx?WCMP=wfl'
 
--EXEC SENDERERs  'vkopych@winner.ua', 'Please Approved', @TBODY
EXEC SENDERERs  'asavchenko@winner.ua', 'Please Approved', @TBODY
GO
/****** Object:  StoredProcedure [dbo].[Remainder_dealers_logistics]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- 
-- Рассыылка почты с напоминание дилерам по логистике о возврате документов по доставленным машинам
-- заявка принята от Осадчей
-- Напоминание должно рассылаться автоматически раз в сутки с указанием срока возврата документов + 3 дня от выписки документов
-- 
-- Можно использовать процедуру наподобие этой : EXEC Remeinder_dealers_pay 410, 'asavchenko@winner.ua'
-- в которой формируется отчет в HTML коде

CREATE PROCEDURE [dbo].[Remainder_dealers_logistics]
AS 

SET NOCOUNT ON

-- Описание перемсенных 
DECLARE @vendor_id     int, 
        @vendor_name   nvarchar(100), 
        @vendor_email  nvarchar(100), 
        @title         nvarchar(50) ,
        @message       nvarchar(Max),
        @brand         nvarchar(20) ,   
        @model         nvarchar(20) , 
        @version       nvarchar(20) ,     
        @act           nvarchar(10) ,   
        @daysdoc       nvarchar(20) ,
        @vin           nvarchar(20) ,
        @bailprice     money
        

DECLARE dealers CURSOR FOR SELECT top 1 Idd, sokr, e_logistics, vin_code, brand, model_name, version_name, act_number, days_doc  FROM a_bailment_risk
OPEN    dealers
FETCH NEXT FROM dealers INTO @vendor_id, @vendor_name, @vendor_email, @vin, @brand, @model, @version, @act, @daysdoc

WHILE @@FETCH_STATUS = 0 
BEGIN
 


 SET @message = 'Шановні колеги, '  + CHAR(10) + CHAR(13) +
                'Доводимо до Вашого відома, що на ' + CONVERT (nvarchar(20),GETDATE()) + 'відділ логістики не отримав оригінали актів прийому-передачі на відповідальне зберігання на  автомобілі, які були відвантажені, згідно списку зазначеного нижче:' + CHAR(10) + CHAR(13) +
                'Просимо  у найкоротший термін надіслати акти на адресу:' + CHAR(10) + CHAR(13) + 
                'Віннер Імпортс Україна, ЛТД.'        + CHAR(10) + CHAR(13) + 
                'Вул. Дачна 5а, с. Капітанівка'       + CHAR(10) + CHAR(13) + 
                'Київська обл., 08112'                + CHAR(10) + CHAR(13) +
                'Україна'                             + CHAR(10) + CHAR(13) +
                'На ім‘я Ірини Риботецької '          + CHAR(10) + CHAR(13) +
                'Тел. + 44 585 63 00 вн.номер №374 '  + CHAR(10) + CHAR(13) +
                'Просимо звяти до уваги, що у разі неотримання актів, вам буде призупинено відвантаження та продаж автомобілів. '  + CHAR(10) + CHAR(13) +
                'З повагою, '  + CHAR(10) + CHAR(13) +
                'у разі неотримання актів, вам буде призупинено відвантаження та продаж автомобілів.'  


-- EXEC SENDERERs 'asavchenko@winner.ua;tosadcha@winner.ua',
--                'Информация о неоплаченных машинах',
--                 @message

 EXEC SENDERERs 'asavchenko@winner.ua',
                'Информация о неоплаченных машинах',
                 @message

FETCH NEXT FROM dealers
END 


CLOSE dealers
DEALLOCATE dealers


--
--USE AdventureWorks
--GO
---- Declare the variables to store the values returned by FETCH.
--DECLARE @LastName varchar(50), @FirstName varchar(50)
--
--DECLARE contact_cursor CURSOR FOR
--SELECT LastName, FirstName FROM Person.Contact
--WHERE LastName LIKE 'B%'
--ORDER BY LastName, FirstName
--
--OPEN contact_cursor
--
---- Perform the first fetch and store the values in variables.
---- Note: The variables are in the same order as the columns
---- in the SELECT statement. 
--
--FETCH NEXT FROM contact_cursor
--INTO @LastName, @FirstName
--
---- Check @@FETCH_STATUS to see if there are any more rows to fetch.
--WHILE @@FETCH_STATUS = 0
--BEGIN
--
--   
--
--   -- This is executed as long as the previous fetch succeeds.
--   FETCH NEXT FROM contact_cursor
--   INTO @LastName, @FirstName
--END
--
--CLOSE contact_cursor
--DEALLOCATE contact_cursor
--GO
GO
/****** Object:  UserDefinedFunction [dbo].[Out_pass]    Script Date: 10/29/2010 14:30:37 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Если 0 то неправильный пароль
Если 1 все ОК

Контроль
PRINT DBO.OUT_PASS ('PRIMER',9)
SELECT ID, SECUR FROM S_USER
PRINT DBO.OUT_PASS ('PRIMER',9)
*/
CREATE FUNCTION [dbo].[Out_pass] (@UsPass nvarchar(255), @IDuser int)
RETURNS INT
AS
BEGIN
DECLARE   @status int
SELECT    @status = PWDCOMPARE(@UsPass, Secur) FROM S_USER WHERE ID = @IDuser
RETURN   (@STATUS)
END
GO
/****** Object:  StoredProcedure [dbo].[In_Passsvord]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Шифрование пароля
CREATE PROCEDURE [dbo].[In_Passsvord] (@UsPass nvarchar(255), @IDuser int)
AS
SET NOCOUNT ON
DECLARE @KOLZAP INT
UPDATE S_user SET Secur = PWDENCRYPT(@UsPass) WHERE ID = @IDuser
PRINT PWDENCRYPT(@UsPass)
SELECT @KOLZAP=@@ROWCOUNT
GO
/****** Object:  View [dbo].[A_Users]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Users]
AS
SELECT     TOP (100) PERCENT dbo.S_User.Fio, dbo.S_Department.Naz AS Department, dbo.S_User.Note, dbo.S_User.Login + N'@winner.ua' AS [Mai Namel], 
                      dbo.S_User.Tel_mob, dbo.S_User.Tel_dom, dbo.S_User.Tel_vnutr
FROM         dbo.S_User INNER JOIN
                      dbo.S_Department ON dbo.S_User.Dep = dbo.S_Department.ID
WHERE     (dbo.S_User.Prikaz_uvoln = N'0') AND (dbo.S_User.Login IS NOT NULL)
ORDER BY dbo.S_User.Fio
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_User"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 327
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Department"
            Begin Extent = 
               Top = 6
               Left = 227
               Bottom = 114
               Right = 378
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 1500
         Width = 1500
         Width = 3390
         Width = 4875
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 3615
         Alias = 2745
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Users'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Users'
GO
/****** Object:  StoredProcedure [dbo].[TM_Calc_timesheet]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Winner Imports Ukraine
-- 06 jule 2009
-- TM - Time Management
-- Вставка нового значения в сводную таблицу по работнику
-- и пересчет значений по часам
/*

-- Пример использования процедуры
EXEC TM_Calc_timesheet 2,           -- company
                       2010,        -- year
                       12,          -- week 
                       2,           -- day week
                       9,           -- employee
                       1,           -- group task 
                       1,           -- task 
                       10,          -- hours    
                       0,           -- 0-norma
                       '+'          -- remark

*/
CREATE PROCEDURE [dbo].[TM_Calc_timesheet] (
                 @Company    int,             -- Id Company     
                 @Year       int,             -- Year  
                 @Week       int,             -- Week 
                 @DayWeek    int,             -- День недели
                 @Empl       int,             -- ID Employee
                 @Grp        int,             -- ID Groups task 
                 @Task       int,             -- ID Task
                 @Hours      int,             -- Вводимые часы (
                 @Overtime   int,             -- Признак овертайма (0-обыч,1-сверх)
                 @Remark     nvarchar(30))    -- Remark 
AS

-- Описание переменных
DECLARE @Total_sum int            -- Cумма нормы + сверхнормы часов
DECLARE @Norm_sum  int            -- Cумма всех нормы часов по работнику за неделю
DECLARE @Over_sum  int            -- Cумма всех сверх номы часов по работнику за неделю
DECLARE @Norm      int            -- Часы по работнику за нормы текущий день
DECLARE @Over      int            -- Часы по работнику за сверх нормы текущий день
DECLARE @Cntrec    int            -- Количество строк
DECLARE @Depart    int            -- Отдел 
DECLARE @Empname   Nvarchar(50)   -- Фамилия сотрудника


-- Подсчет количества строк по данному условию для 
-- определения необходимости вставки новой записи
SELECT  @Cntrec = COUNT(*) 
FROM    W_Timesheet_task 
WHERE   ID_Company  = @Company
  AND   Year_number = @Year
  AND   Week_number = @Week
  AND   ID_Employee = @Empl
  AND   Id_task     = @Task

-- ДОБАВЛЕНИЕ НОВОЙ ЗАПИСИ
-- Eсли нет такой записи запись добавляется
IF @Cntrec = 0 
   BEGIN
     -- Сверх работы или нет
        IF @Overtime = 0 
           BEGIN
                IF @DayWeek=1 INSERT W_Timesheet_task VALUES (@Empl,@Company,@Year,@Week,@Grp,@Task,Getdate(),Getdate(),@Hours,0,@Hours,0,0,0,0,0,0,0,0,0,0,0,1,'Понедельник',1)  
                IF @DayWeek=2 INSERT W_Timesheet_task VALUES (@Empl,@Company,@Year,@Week,@Grp,@Task,Getdate(),Getdate(),@Hours,0,0,0,@Hours,0,0,0,0,0,0,0,0,0,1,'Вторник',1)  
                IF @DayWeek=3 INSERT W_Timesheet_task VALUES (@Empl,@Company,@Year,@Week,@Grp,@Task,Getdate(),Getdate(),@Hours,0,0,0,0,0,@Hours,0,0,0,0,0,0,0,1,'Среда',1)  
                IF @DayWeek=4 INSERT W_Timesheet_task VALUES (@Empl,@Company,@Year,@Week,@Grp,@Task,Getdate(),Getdate(),@Hours,0,0,0,0,0,0,0,@Hours,0,0,0,0,0,1,'Четверг',1)  
                IF @DayWeek=5 INSERT W_Timesheet_task VALUES (@Empl,@Company,@Year,@Week,@Grp,@Task,Getdate(),Getdate(),@Hours,0,0,0,0,0,0,0,0,0,0,@Hours,0,0,1,'Пятница',1)  
            END
        ELSE
           BEGIN
                IF @DayWeek=1 INSERT W_Timesheet_task VALUES (@Empl,@Company,@Year,@Week,@Grp,@Task,Getdate(),Getdate(),0,@Hours,0,@Hours,0,0,0,0,0,0,0,0,0,0,2,'Понедельник',1)  
                IF @DayWeek=2 INSERT W_Timesheet_task VALUES (@Empl,@Company,@Year,@Week,@Grp,@Task,Getdate(),Getdate(),0,@Hours,0,0,0,@Hours,0,0,0,0,0,0,0,0,2,'Вторник',1)  
                IF @DayWeek=3 INSERT W_Timesheet_task VALUES (@Empl,@Company,@Year,@Week,@Grp,@Task,Getdate(),Getdate(),0,@Hours,0,0,0,0,0,@Hours,0,0,0,0,0,0,2,'Среда',1)  
                IF @DayWeek=4 INSERT W_Timesheet_task VALUES (@Empl,@Company,@Year,@Week,@Grp,@Task,Getdate(),Getdate(),0,@Hours,0,0,0,0,0,0,0,@Hours,0,0,0,0,2,'Четверг',1)  
                IF @DayWeek=5 INSERT W_Timesheet_task VALUES (@Empl,@Company,@Year,@Week,@Grp,@Task,Getdate(),Getdate(),0,@Hours,0,0,0,0,0,0,0,0,0,@Hours,0,0,2,'Пятница',1)  
                IF @DayWeek=6 INSERT W_Timesheet_task VALUES (@Empl,@Company,@Year,@Week,@Grp,@Task,Getdate(),Getdate(),0,@Hours,0,0,0,0,0,0,0,0,0,0,@Hours,0,2,'Суббота',1)  
                IF @DayWeek=7 INSERT W_Timesheet_task VALUES (@Empl,@Company,@Year,@Week,@Grp,@Task,Getdate(),Getdate(),0,@Hours,0,0,0,0,0,0,0,0,0,0,0,@Hours,2,'Воскресенье',1)  
           END   
   END
ELSE 

     -- ОБНОВЛЕНИЕ ceществующих часов
   BEGIN
        -- Получаем часы 
        SELECT @Norm       = Norm_0, 
               @Over       = Over_0 
          FROM W_Timesheet_task 
         WHERE ID_Company  = @Company
           AND Year_number = @Year
           AND Week_number = @Week
           AND ID_Employee = @Empl
           AND Id_task     = @Task

         -- Нормальные часы работы
         IF @Overtime = 0 
            BEGIN
               SET @Norm_sum = @Norm + @Hours
               IF  @DayWeek=1 UPDATE W_Timesheet_task  SET Finish=Getdate(), Norm_0 = @Norm_sum, Norm_1 = @Hours, Remark = @Remark, Flag=3 WHERE ID_Company  = @Company  AND Year_number = @Year  AND Week_number = @Week  AND ID_Employee = @Empl AND Id_task = @Task
               IF  @DayWeek=2 UPDATE W_Timesheet_task  SET Finish=Getdate(), Norm_0 = @Norm_sum, Norm_2 = @Hours, Remark = @Remark, Flag=3 WHERE ID_Company  = @Company  AND Year_number = @Year  AND Week_number = @Week  AND ID_Employee = @Empl AND Id_task = @Task
               IF  @DayWeek=3 UPDATE W_Timesheet_task  SET Finish=Getdate(), Norm_0 = @Norm_sum, Norm_3 = @Hours, Remark = @Remark, Flag=3 WHERE ID_Company  = @Company  AND Year_number = @Year  AND Week_number = @Week  AND ID_Employee = @Empl AND Id_task = @Task
               IF  @DayWeek=4 UPDATE W_Timesheet_task  SET Finish=Getdate(), Norm_0 = @Norm_sum, Norm_4 = @Hours, Remark = @Remark, Flag=3 WHERE ID_Company  = @Company  AND Year_number = @Year  AND Week_number = @Week  AND ID_Employee = @Empl AND Id_task = @Task
               IF  @DayWeek=5 UPDATE W_Timesheet_task  SET Finish=Getdate(), Norm_0 = @Norm_sum, Norm_5 = @Hours, Remark = @Remark, Flag=3 WHERE ID_Company  = @Company  AND Year_number = @Year  AND Week_number = @Week  AND ID_Employee = @Empl AND Id_task = @Task
         END
     ELSE
         BEGIN
              -- Сверх нормы  часы работы
              SET @Over_sum = @Over + @Hours
              IF  @DayWeek=1 UPDATE W_Timesheet_task  SET Finish=Getdate(), Over_0 = @Over_sum, Over_1 = @Hours, Remark = @Remark, Flag=4 WHERE ID_Company  = @Company  AND Year_number = @Year  AND Week_number = @Week  AND ID_Employee = @Empl AND Id_task = @Task
              IF  @DayWeek=2 UPDATE W_Timesheet_task  SET Finish=Getdate(), Over_0 = @Over_sum, Over_2 = @Hours, Remark = @Remark, Flag=4 WHERE ID_Company  = @Company  AND Year_number = @Year  AND Week_number = @Week  AND ID_Employee = @Empl AND Id_task = @Task
              IF  @DayWeek=3 UPDATE W_Timesheet_task  SET Finish=Getdate(), Over_0 = @Over_sum, Over_3 = @Hours, Remark = @Remark, Flag=4 WHERE ID_Company  = @Company  AND Year_number = @Year  AND Week_number = @Week  AND ID_Employee = @Empl AND Id_task = @Task
              IF  @DayWeek=4 UPDATE W_Timesheet_task  SET Finish=Getdate(), Over_0 = @Over_sum, Over_4 = @Hours, Remark = @Remark, Flag=4 WHERE ID_Company  = @Company  AND Year_number = @Year  AND Week_number = @Week  AND ID_Employee = @Empl AND Id_task = @Task
              IF  @DayWeek=5 UPDATE W_Timesheet_task  SET Finish=Getdate(), Over_0 = @Over_sum, Over_5 = @Hours, Remark = @Remark, Flag=4 WHERE ID_Company  = @Company  AND Year_number = @Year  AND Week_number = @Week  AND ID_Employee = @Empl AND Id_task = @Task
              IF  @DayWeek=6 UPDATE W_Timesheet_task  SET Finish=Getdate(), Over_0 = @Over_sum, Over_6 = @Hours, Remark = @Remark, Flag=4 WHERE ID_Company  = @Company  AND Year_number = @Year  AND Week_number = @Week  AND ID_Employee = @Empl AND Id_task = @Task
              IF  @DayWeek=7 UPDATE W_Timesheet_task  SET Finish=Getdate(), Over_0 = @Over_sum, Over_7 = @Hours, Remark = @Remark, Flag=4 WHERE ID_Company  = @Company  AND Year_number = @Year  AND Week_number = @Week  AND ID_Employee = @Empl AND Id_task = @Task
        END
END

-- Проверка
-- print convert('dd', getdate())

/*
Date : 17-07-2009
Winner Imports Ukreine
Процедура необходима для запуска ее из триггера основной таблицы W_timesheet
подготовка данніх для отчета который берет свои данные с
таблицы W_timesheet_task
Данные разворачиваются в структуру необходимую для отчета
*/

-- Определение ID департмента
SELECT  @Depart = Dep, @Empname = Fio FROM S_User WHERE ID = @Empl

-- Подсчет количества строк по данному условию для 
-- определения необходимости вставки новой записи
SELECT  @Cntrec     = COUNT(*) 
FROM    W_Timesheet_Report 
WHERE   ID_Company  = @Company
    AND Year_number = @Year
    AND Week_number = @Week
    AND ID_Employee = @Empl
    AND Id_task     = @Task

-- Работа с второй таблицей для отчета 
-- Eсли нет такой записи запись то добавляется нормальное время или овртайм и общее количество минут
-- Если есть то обновляется нормальное время или овертайм и общее количество пересчитываетися
IF @Cntrec = 0 
   BEGIN
     -- Сверх работы или нет
        IF @Overtime = 0 
           BEGIN
                INSERT W_Timesheet_report VALUES (@Year,@Week,@Company,@Depart,@Empl,@Grp,@Task,@Hours,0,@Hours,0,'2009-01-01','N','Норма ' + @Empname)  
            END
        ELSE
           BEGIN
               INSERT W_Timesheet_report VALUES (@Year,@Week,@Company,@Depart,@Empl,@Grp,@Task,0,@Hours,@Hours,0,'2009-01-01','N','Сверх ' + @Empname)  
           END   
   END
ELSE 

     BEGIN

     -- Получаем часы 
        SELECT @Norm       = Normal_time, 
               @Over       = Over_time 
          FROM W_Timesheet_report 
         WHERE ID_Company  = @Company
           AND Year_number = @Year
           AND Week_number = @Week
           AND ID_Employee = @Empl
           AND Id_task     = @Task

     -- Сверх работы или нет
        IF @Overtime = 0 
           BEGIN
                SET @Total_sum = ISNULL(@Norm,0) + ISNULL(@Over,0) + @Hours
                
                UPDATE W_Timesheet_report 
                   SET Total_time  = @Total_sum , 
                       Normal_time = ISNULL(Normal_time,0) + @Hours,
                       Remarks     = 'Обновление норм ' + @Empname  
                WHERE  ID_Company  = @Company
                  AND  Year_number = @Year
                  AND  Week_number = @Week
                  AND  ID_Employee = @Empl
                  AND  Id_task     = @Task

            END
        ELSE
           BEGIN
                SET @Total_sum = ISNULL(@Norm,0) + ISNULL(@Over,0) + @Hours
                
                UPDATE W_Timesheet_report 
                   SET Total_time  = @Total_sum,
                       Over_time   = ISNULL(Over_time,0) + @Hours,
                       Remarks     = 'Обновление сверхнорм '  + @Empname
                WHERE  ID_Company  = @Company
                  AND  Year_number = @Year
                  AND  Week_number = @Week
                  AND  ID_Employee = @Empl
                  AND  Id_task     = @Task

           END   
   END
GO
/****** Object:  StoredProcedure [dbo].[Upd_id_user]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Обновление справочника пользователей связной информациеей с сервера
-- EXEC upd_id_user 'WIU\arudnichenko',150
CREATE PROCEDURE [dbo].[Upd_id_user]  @Name_User NVARCHAR(30),  @Id_User int
AS
UPDATE S_USER SET SERV=@Name_User, SERV_id=SUSER_ID(@Name_User) WHERE ID=@Id_user
GO
/****** Object:  StoredProcedure [dbo].[App_UserAdd]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Creates a new record in the [dbo].[S_User] table.
CREATE PROCEDURE [dbo].[App_UserAdd]
    @p_Fio nvarchar(50),
    @p_Gr int,
    @p_Dep int,
    @p_Note nvarchar(50),
    @p_Secur nvarchar(255),
    @p_Phone char(10),
    @p_Mob char(10),
    @p_Remarks char(100),
    @p_Iskl int,
    @p_Tel_mob nvarchar(50),
    @p_Tel_dom nvarchar(50),
    @p_Tel_vnutr nvarchar(50),
    @p_Adress nvarchar(50),
    @p_Face image,
    @p_Serv nvarchar(100),
    @p_Serv_id int,
    @p_P_adres nvarchar(50),
    @p_P_Seriya nvarchar(20),
    @p_P_Nomber nvarchar(50),
    @p_P_Vudan_date smalldatetime,
    @p_P_Vudan_kem nvarchar(50),
    @p_ID_out int output
AS
BEGIN
    INSERT
    INTO [dbo].[S_User]
        (
            [Fio],
            [Gr],
            [Dep],
            [Note],
            [Secur],
            [Phone],
            [Mob],
            [Remarks],
            [Iskl],
            [Tel_mob],
            [Tel_dom],
            [Tel_vnutr],
            [Adress],
            [Face],
            [Serv],
            [Serv_id],
            [P_adres],
            [P_Seriya],
            [P_Nomber],
            [P_Vudan_date],
            [P_Vudan_kem]
        )
    VALUES
        (
             @p_Fio,
             @p_Gr,
             @p_Dep,
             @p_Note,
             @p_Secur,
             @p_Phone,
             @p_Mob,
             @p_Remarks,
             @p_Iskl,
             @p_Tel_mob,
             @p_Tel_dom,
             @p_Tel_vnutr,
             @p_Adress,
             @p_Face,
             @p_Serv,
             @p_Serv_id,
             @p_P_adres,
             @p_P_Seriya,
             @p_P_Nomber,
             @p_P_Vudan_date,
             @p_P_Vudan_kem
        )

    SET @p_ID_out = SCOPE_IDENTITY()

END
GO
/****** Object:  StoredProcedure [dbo].[Add_new_user]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- ********************************************************************************************************
-- Author :    Savchenko Arthur
-- Date Created : 20-10-2008 9:00
-- Добавление нового пользователя в систему
-- Пример использования
-- Add_new_user 'Березовский Сергей', 2, 2,'Financial Analyst', 'Pasw-777','222','8067-83838833'
-- ********************************************************************************************************
CREATE PROCEDURE [dbo].[Add_new_user]
                @Fio nvarchar(50), 
                @Group int, 
                @Sec int, 
                @Dolj nvarchar(50), 
                @Passv nvarchar(20), 
                @Vnnumber nvarchar(20), 
                @Mob nvarchar(50)
AS
/*
IF ISNULL (@FIO) 
   BEGIN
       -- RAISERROR (15550)
       -- RETURN 1
   END

*/

INSERT  S_User ([Fio],[Gr],[Dep],[Note],[Secur], [Phone], [Tel_Mob], [Iskl])
VALUES (@Fio, @Group, @Sec, @Dolj, @Passv, @Vnnumber, @Mob, 1)
GO
/****** Object:  Table [dbo].[W_Fin_Rep]    Script Date: 10/29/2010 14:30:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[W_Fin_Rep](
	[IDD] [int] IDENTITY(1,2) NOT NULL,
	[Brand] [int] NULL,
	[Week] [int] NULL,
	[Num] [int] NULL,
	[God] [int] NULL,
	[Dat] [smalldatetime] NULL,
	[Count_Car] [int] NULL,
	[Cif_Cip] [money] NULL,
	[Dlr_price] [money] NULL,
	[Dlr_pmnt] [money] NULL,
	[Dlr_proc] [money] NULL,
	[Dlr_proc_pmnt] [money] NULL,
	[Adjusted_week] [int] NULL,
	[Adjusted] [int] NULL,
	[Priz] [nvarchar](10) NULL,
	[Notes] [nvarchar](200) NULL,
	[Problem_units] [int] NULL,
 CONSTRAINT [PK__W_Fin_rep__13A8A87F] PRIMARY KEY CLUSTERED 
(
	[IDD] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY],
 CONSTRAINT [IX_W_Fin_rep] UNIQUE NONCLUSTERED 
(
	[Brand] ASC,
	[Week] ASC,
	[Num] ASC,
	[God] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Бренд' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'Brand'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Неделя (номер в году)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'Week'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Номер отчета' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'Num'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Год' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'God'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Текущая дата вставки данных' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'Dat'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Количество машин' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'Count_Car'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Сумма цен ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'Cif_Cip'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Сумма' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'Dlr_price'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Сумма оплат' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'Dlr_pmnt'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Процентное отноешнеие оплаты' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'Dlr_proc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Процентное отноешнеие оплаты' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'Dlr_proc_pmnt'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Признак обработки' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'Priz'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Примечание' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'W_Fin_Rep', @level2type=N'COLUMN',@level2name=N'Notes'
GO
/****** Object:  StoredProcedure [dbo].[Rec_cound_month]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Ежемесячный расчет среднего значения по всем брендам
-- exec Rec_cound_month
CREATE PROCEDURE [dbo].[Rec_cound_month]
AS

-- Initialization value
DECLARE @BR INT

-- Start Tranzaction
BEGIN TRANSACTION TR1

-- FORD
SET  @BR = 1
EXEC Rec_cound_brand @BR, 1
EXEC Rec_cound_brand @BR, 2
EXEC Rec_cound_brand @BR, 3
EXEC Rec_cound_brand @BR, 4
EXEC Rec_cound_brand @BR, 5
EXEC Rec_cound_brand @BR, 6
EXEC Rec_cound_brand @BR, 7
EXEC Rec_cound_brand @BR, 8
EXEC Rec_cound_brand @BR, 9

--   VOLVO
SET  @BR = 2
EXEC Rec_cound_brand @BR, 1
EXEC Rec_cound_brand @BR, 2
EXEC Rec_cound_brand @BR, 3
EXEC Rec_cound_brand @BR, 4
EXEC Rec_cound_brand @BR, 5
EXEC Rec_cound_brand @BR, 6
EXEC Rec_cound_brand @BR, 7
EXEC Rec_cound_brand @BR, 8
EXEC Rec_cound_brand @BR, 9

-- JAGUAR
SET  @BR = 3
EXEC Rec_cound_brand @BR, 1
EXEC Rec_cound_brand @BR, 2
EXEC Rec_cound_brand @BR, 3
EXEC Rec_cound_brand @BR, 4
EXEC Rec_cound_brand @BR, 5
EXEC Rec_cound_brand @BR, 6
EXEC Rec_cound_brand @BR, 7
EXEC Rec_cound_brand @BR, 8
EXEC Rec_cound_brand @BR, 9

-- LAND ROVER
SET  @BR = 4
EXEC Rec_cound_brand @BR, 1
EXEC Rec_cound_brand @BR, 2
EXEC Rec_cound_brand @BR, 3
EXEC Rec_cound_brand @BR, 4
EXEC Rec_cound_brand @BR, 5
EXEC Rec_cound_brand @BR, 6
EXEC Rec_cound_brand @BR, 7
EXEC Rec_cound_brand @BR, 8
EXEC Rec_cound_brand @BR, 9

-- PORCHE
SET  @BR = 5
EXEC Rec_cound_brand @BR, 1
EXEC Rec_cound_brand @BR, 2
EXEC Rec_cound_brand @BR, 3
EXEC Rec_cound_brand @BR, 4
EXEC Rec_cound_brand @BR, 5
EXEC Rec_cound_brand @BR, 6
EXEC Rec_cound_brand @BR, 7
EXEC Rec_cound_brand @BR, 8
EXEC Rec_cound_brand @BR, 9


-- Error 
IF (@@ERROR) > 0 
   ROLLBACK TRANSACTION TR1
ELSE
   COMMIT TRANSACTION TR1


-- Check 
/*
  SELECT * FROM w_srez
  SELECT avg(Countcar)   FROM w_srez where brand=1 and month(data)=month(getdate())-2
*/
GO
/****** Object:  View [dbo].[A_Dc]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Dc]
AS
SELECT     dbo.W_Dcn.Id, dbo.W_Dcn.Ido, dbo.S_Dc.Descr AS Descr_dc, dbo.S_Account.Descr AS Descr_pay, dbo.S_Approval.Descr AS Descr_appr, 
                      dbo.W_Dcn.Purpose, dbo.W_Dcn.Data, dbo.W_Dcn.Summ, dbo.W_Dcn.Importans
FROM         dbo.W_Dcn LEFT OUTER JOIN
                      dbo.S_Approval ON dbo.W_Dcn.Approval = dbo.S_Approval.ID LEFT OUTER JOIN
                      dbo.S_Account ON dbo.W_Dcn.Acc = dbo.S_Account.ID LEFT OUTER JOIN
                      dbo.S_Dc ON dbo.W_Dcn.Dk = dbo.S_Dc.ID
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Dcn"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 327
               Right = 257
            End
            DisplayFlags = 280
            TopColumn = 7
         End
         Begin Table = "S_Dc"
            Begin Extent = 
               Top = 129
               Left = 338
               Bottom = 237
               Right = 489
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Account"
            Begin Extent = 
               Top = 5
               Left = 308
               Bottom = 113
               Right = 459
            End
            DisplayFlags = 280
            TopColumn = 3
         End
         Begin Table = "S_Approval"
            Begin Extent = 
               Top = 248
               Left = 405
               Bottom = 426
               Right = 556
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 2205
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Dc'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Dc'
GO
/****** Object:  View [dbo].[A_Temp]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Temp]
AS
SELECT dbo.W_Temp.ID, dbo.W_Temp.Zakaz AS Ordering, 
     dbo.W_Temp.D_zakaza, dbo.S_Brend.Naz AS Brand, 
     dbo.S_Model.Naz AS Model, 
     dbo.S_Version.Naz AS Vers, 
     dbo.W_Temp.Brend AS ID_Brand, 
     dbo.W_Temp.Model AS Id_Model, 
     dbo.W_Temp.Vers AS ID_Vers, dbo.W_Temp.Dlr, 
     dbo.S_Diler.Naz AS Dealer, dbo.W_Temp.Spec1, 
     dbo.W_Temp.Spec2, dbo.W_Temp.Spec3, 
     dbo.W_Temp.VIN, dbo.W_Temp.SVIN, 
     dbo.W_Temp.Engine
FROM dbo.W_Temp LEFT OUTER JOIN
     dbo.S_Model ON 
     dbo.W_Temp.Model = dbo.S_Model.ID LEFT OUTER JOIN
     dbo.S_Brend ON 
     dbo.W_Temp.Brend = dbo.S_Brend.ID LEFT OUTER JOIN
     dbo.S_Engenie ON 
     dbo.W_Temp.Engine = dbo.S_Engenie.ID LEFT OUTER JOIN
     dbo.S_Version ON 
     dbo.W_Temp.Vers = dbo.S_Version.ID LEFT OUTER JOIN
     dbo.S_Diler ON dbo.W_Temp.Dlr = dbo.S_Diler.ID
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1[50] 4[25] 3) )"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1[50] 2[25] 3) )"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1 [56] 4 [18] 2))"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1[75] 4) )"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 9
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Temp"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 527
               Right = 256
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 84
               Left = 517
               Bottom = 200
               Right = 700
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 0
               Left = 639
               Bottom = 116
               Right = 822
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Engenie"
            Begin Extent = 
               Top = 487
               Left = 502
               Bottom = 603
               Right = 685
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 237
               Left = 488
               Bottom = 353
               Right = 671
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 360
               Left = 500
               Bottom = 476
               Right = 683
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
      PaneHidden = 
   End
   Begin DataPane = 
      PaneHidden = 
      Begin ParameterDefaults = ""
      End
      RowHeights = 240
   End
   Begin CriteriaPane = 
 ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Temp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'     Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Temp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Temp'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_Orientation', @value=0x00 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Temp'
GO
/****** Object:  View [dbo].[F_Eng]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[F_Eng]
AS
SELECT     dbo.F_1.Brand, dbo.F_1.Version, dbo.F_1.Model, dbo.F_1.ENGINE AS enginie, dbo.S_Engenie.ID
FROM         dbo.F_1 INNER JOIN
                      dbo.S_Engenie ON dbo.F_1.ENGINE = dbo.S_Engenie.Naz AND dbo.F_1.Model = dbo.S_Engenie.Model AND 
                      dbo.F_1.Version = dbo.S_Engenie.Version AND dbo.F_1.Brand = dbo.S_Engenie.Brend
GO
/****** Object:  View [dbo].[A_Package]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Package]
AS
SELECT     TOP (100) PERCENT dbo.W_Pakage.ID, dbo.S_Brend.Naz AS Name_Brand, dbo.S_Model.Naz AS Name_Model, dbo.S_Version.Naz AS Name_Vers, 
                      dbo.W_Pakage.Naz AS Name_Package, dbo.S_Engenie.Naz AS Name_Eng, dbo.W_Pakage.Spec1, dbo.W_Pakage.Spec2, dbo.W_Pakage.Spec3, 
                      dbo.W_Pakage.Trimm, dbo.W_Pakage.GearBox, dbo.W_Pakage.Cif_cip, dbo.W_Pakage.Dealer_cost, dbo.W_Pakage.MSRP, dbo.W_Pakage.Exw, 
                      dbo.W_Pakage.After, dbo.W_Pakage.Before, dbo.W_Pakage.Koef, dbo.W_Pakage.Notes
FROM         dbo.W_Pakage LEFT OUTER JOIN
                      dbo.S_Engenie ON dbo.W_Pakage.Engine = dbo.S_Engenie.ID LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Pakage.Vers = dbo.S_Version.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Pakage.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Pakage.Brend = dbo.S_Brend.ID
ORDER BY dbo.W_Pakage.ID
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[51] 4[29] 2[1] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Pakage"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 375
               Right = 232
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 12
               Left = 394
               Bottom = 120
               Right = 554
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 122
               Left = 387
               Bottom = 303
               Right = 547
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 309
               Left = 392
               Bottom = 478
               Right = 543
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Engenie"
            Begin Extent = 
               Top = 323
               Left = 370
               Bottom = 546
               Right = 521
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 2700
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         O' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Package'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'r = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Package'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Package'
GO
/****** Object:  StoredProcedure [dbo].[U_Code_Engine_Volvo]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- EXEC U_Code_Engine_Volvo
CREATE PROCEDURE [dbo].[U_Code_Engine_Volvo]
AS

-- Обновление кодов для VOLVO по двигателям
UPDATE W
SET    W.SPEC1 = D.CODE1
FROM   W_ORDER   W,
       S_engenie D
WHERE  W.ENGINE = D.ID
AND    W.BREND  = 2
--AND    W.SPEC1 IS NULL

-- Обновление кодов цвета кузова в базе
UPDATE W
SET    W.SPEC3 = D.Kod
FROM   W_ORDER   W,
       S_Colours D
WHERE  W.Colour = D.ID
AND    W.BREND  = 2
--AND    W.SPEC3  IS NULL

-- Просмотр 
-- select * from s_colours where brend=2

-- Обновление кодов цвета оббивки салона
/*
UPDATE W
SET    W.Kod = D.Kod
FROM   W_ORDER   W,
       S_Colourk D
WHERE  W.Colours = D.ID
AND    W.BREND   = 2
AND    W.Kod IS NULL
*/


-- Просмотр незаполненных цветов кузова
-- SELECT COLOUR, SPEC3 FROM W_ORDER WHERE BREND=2 AND spec3 IS NULL


/* 

-- Обновление кодов цвета кузова в базе
UPDATE W
SET    W.SPEC3 = D.Kod
FROM   W_ORDER   W,
       S_Colours D
WHERE  W.Colour = D.ID
AND    W.BREND  = 2
AND    W.SPEC3  IS NULL

SELECT *
FROM   S_colourk
where  Brend=2

-- Body
SELECT *
FROM  S_colours
WHERE Brend=2

-- Контроль
SELECT D.*
FROM   W_ORDER   W,
       S_engenie D
WHERE  W.ENGINE = D.ID
AND    W.BREND  = 2
AND    W.SPEC1 IS NULL

--
SELECT Brend, Engine, spec1 
  FROM W_order
 WHERE Brend=2 
  AND  Spec1 IS NULL

*/
GO
/****** Object:  StoredProcedure [dbo].[Ford_engine]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[Ford_engine] (@Modell int, @Verss int)
AS

-- Очистка предварительно таких сочитаний цветов
DELETE FROM [S_Engenie] WHERE Brend=1 AND Model=@Modell AND Version = @Verss

INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.25 Duratec-16V(Sigma)75PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.3 Duratec-8V(Rocam)70PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.4 Duratec-16V(Sigma)80PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.4 Duratorq-TDCi(DV)68PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.6 Duratec-16V(Sigma)100PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.6 Duratec-Ti-VCT(Sigma)110PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.6 Duratec-Ti-VCT(Sigma)115PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.6 Duratec-Ti-VCT(Sigma)125PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.6 Duratorq-TDCi(DV)90PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.8 Duratec-HE(MI4)110PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.8 Duratec-HE(MI4)125PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.8 Duratorq-TDCi(Lynx)100PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.8 Duratorq-TDCi(Lynx)110PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.8 Duratorq-TDCi(Lynx)115PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.8 Duratorq-TDCi(Lynx)125PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.8 Duratorq-TDCi(Lynx)75PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '1.8 Duratorq-TDCi(Lynx)90PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.0 Duratec-HE(MI4)145PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.0 Duratec-ST(MI4)150PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.0 Duratorq-TDCi(DW)135PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.0 Duratorq-TDCi(DW)140PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.0 Duratorq-TDCi(Puma)130PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.2 Duratorq-TDCi(Puma)110PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.2 Duratorq-TDCi(Puma)130PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.2 Duratorq-TDCi(Puma)140PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.2 Duratorq-TDCi(Puma)85PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.3 Duratec 161PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.3 Duratec-HE(MI4)145PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.4 Duratorq-TDCi(Puma)100PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.4 Duratorq-TDCi(Puma)115PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.4 Duratorq-TDCi(Puma)140PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.4 TCI 115 PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.5 Duratec(RNC I5)220PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.5 Duratec-ST(VI5)220PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.5 Duratec-ST(VI5)225PS')
INSERT INTO [S_Engenie] ([Brend], [Model], [Version], [Naz]) VALUES(1, @Modell, @Verss,  '2.5 TDCi 143PS')
GO
/****** Object:  StoredProcedure [dbo].[Change_status_vin]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Номер недели
--SELECT DATEPART( wk, GETDATE() )

-- Oткат статусов
--select status from w_order where id in(54095,54101)
--update w_order set status=9 where id in(54095,54101)

-- Откат статусов по коду
CREATE PROCEDURE [dbo].[Change_status_vin](@Vincode Nvarchar(17), @Statusnumber Int)
AS

--select brend, vin, id, status from w_order where vin like '%46788%'
UPDATE w_order SET [status]=@Statusnumber WHERE vin like '%' + @Vincode + '%'


-- Просмотр справочника статусов
--select * from s_status

SELECT * FROM S_Engenie WHERE ID=8177
GO
/****** Object:  StoredProcedure [dbo].[Fill_Package]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Заполнение справочника пакетов для форда
Author : Savchenko Arthur
Date   : May  3 2008  5:29PM
Usege  : EXEC FILL_PACKAGE 1
Note   : Fill Package Data for Fords

*/

-- CREATE PROCEDURE FILL_PACKAGE (@ID_Brand int)
CREATE PROCEDURE [dbo].[Fill_Package] (@ID_Brand int)
AS
SET NOCOUNT ON

-- Определение перменных
DECLARE @NAME          NVARCHAR(20)                   -- Имя
DECLARE @NAME1         NVARCHAR(20)                   -- Имя
DECLARE @Opisanie      NVARCHAR(40)                   -- Имя
DECLARE @SBrend        Int                            -- Код бренда
DECLARE @SModel        Int                            -- Код модели
DECLARE @SVers         Int                            -- Код версии
DECLARE @SEng          Int                            -- Код двигателя
DECLARE @II            Int                            -- Cчетчик
DECLARE @S_ID          Int                            -- Id
DECLARE @Derivate_txt  NVARCHAR(50)                   -- Derivative
DECLARE @Model_txt     NVARCHAR(50)                   -- Model name
DECLARE @Engine_txt    NVARCHAR(50)                   -- Engine name
DECLARE @Door_txt      NVARCHAR(50)                   -- Door name
DECLARE @ID_Door       Int                            -- ID

-- Определение начала счетчика
SET @II = 1
 
-- определение курсора
DECLARE Ct CURSOR FOR                                

-- наполнение курсора 
SELECT Id, Derevative, ModelTxt, EngineTxt  
FROM W_Pakage WHERE Brend = @ID_Brand                 

-- открытие курсора
OPEN Ct

-- прокрутка курсора 
WHILE 1=1 BEGIN                                       
      FETCH FROM CT INTO @S_id, @Derivate_txt, @Model_txt,  @Engine_txt  -- извлечение данных в переменные
      SET @II = @II+1
      IF @@FEtch_status = -1 BREAK
      IF @@fEtch_status = -2 CONTINUE
    --PRINT LEFT(@NAME1,4) --+ ' ' + @NAME
      
   -- Извлечение данных из справочников
      SELECT @SModel  = ID FROM S_MODEL    WHERE Brend=@ID_Brand AND Naz LIKE @Model_txt + '%'
      SELECT @SVers   = ID FROM S_Version  WHERE Brand=@ID_Brand AND Model = @SModel AND Naz LIKE LEFT(@Derivate_txt,4) + '%'
      SELECT @SEng    = ID FROM S_Engenie  WHERE Brend=@ID_Brand AND Model = @SModel AND Version = @SVers AND Naz LIKE @Engine_txt + '%'
    --SELECT @Id_Door = ID FROM S_Trim_s   WHERE Nazv LIKE RIGHT(@Derivate_txt,7) + '%'
      
      IF CHARINDEX ('2', @Derivate_txt) > 0            SET  @ID_Door = 1
      IF CHARINDEX ('3', @Derivate_txt) > 0            SET  @ID_Door = 2
      IF CHARINDEX ('4', @Derivate_txt) > 0            SET  @ID_Door = 3
      IF CHARINDEX ('5', @Derivate_txt) > 0            SET  @ID_Door = 4
      IF CHARINDEX ('Single', @Derivate_txt) > 0       SET  @ID_Door = 5
      IF CHARINDEX ('Double', @Derivate_txt) > 0       SET  @ID_Door = 6
      IF CHARINDEX ('Rear', @Derivate_txt) > 0         SET  @ID_Door = 7
      IF CHARINDEX ('Wagon', @Derivate_txt) > 0        SET  @ID_Door = 8
      IF CHARINDEX ('Van', @Derivate_txt) > 0          SET  @ID_Door = 9
      IF CHARINDEX ('Kombi', @Derivate_txt) > 0        SET  @ID_Door = 10
      IF CHARINDEX ('Convertible', @Derivate_txt) > 0  SET  @ID_Door = 11
      IF CHARINDEX ('Cabriolet', @Derivate_txt) > 0    SET  @ID_Door = 12
      
   -- PRINT @Derivate_txt + ' ' + CAST(@ID_Door AS NVARCHAR(20))
      
   -- Обновление данных в справочнике пакетов
      UPDATE W_Pakage 
         SET Brend  = 1,
             Model  = @SModel, 
             Vers   = @Svers , 
             Engine = @SEng  , 
             Trimm  = @ID_Door 
       WHERE ID     = @S_ID
END

-- закрытие курсора
DEALLOCATE CT

-- Заполнение нулями пустот
UPDATE W_Pakage SET Dealer_cost = 0 WHERE Dealer_cost IS NULL
UPDATE W_Pakage SET Msrp = 0        WHERE Msrp        IS NULL
UPDATE W_Pakage SET EXW = 0         WHERE EXW         IS NULL
UPDATE W_Pakage SET Cif_cip = 0     WHERE Cif_cip     IS NULL
UPDATE W_Pakage SET After = 0       WHERE After       IS NULL
UPDATE W_Pakage SET Before = 0      WHERE Before      IS NULL

-- количество обработанных пакетов
PRINT 'Oбработано пакетов ' + CAST(@II AS NVARCHAR(10)) + ' штук !!!'

-- Просмотр справочных данных для контроля
-- UPDATE W_Pakage  SET Brend=1, model=0, Vers =0, Engine=0
-- SELECT * FROM S_MODEL
-- SELECT * FROM S_VERSION
-- SELECT * FROM S_Engenie
-- SELECT * FROM W_Pakage WHERE ID=683
-- SELECT * FROM S_TRIM_S
-- Trimm = (SELECT ID FROM S_TRIM_S   WHERE Naz LIKE @SVers + '%')
GO
/****** Object:  StoredProcedure [dbo].[Update_cc]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Обновление кубиков в справочнике двигателей для форда
CREATE PROCEDURE [dbo].[Update_cc]   
AS
UPDATE S_ENGENIE SET VOL = DBO.VOL_ENG_FORD ([NAZ]) WHERE BREND=1
GO
/****** Object:  StoredProcedure [dbo].[InsertCar]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
 Вставка номера заказа для порше
 но можно подумать и для других брендов
 Отличие в определении номера последующего заказа
 и номера двигателя который у порше один для каждой модели и версии
 
 Применение :
 EXCE INSERTCAR (5, 68, 271, 1, 1, GETDATE(), 410, 'Porsche' ) 
*/

CREATE PROCEDURE [dbo].[InsertCar]   (@ID_Brand        Int,
                                     @ID_Model        int,
                                     @ID_Version      int,
                                     @ID_Type         int,
                                     @ID_Status       int,  
                                     @ID_Prod_Confirm smalldatetime,
                                     @ID_Dlr          int,
                                     @Remarks         nvarchar(40))
AS
SET NOCOUNT ON

-- Инициализация переменных
DECLARE @ID_Engine Int              -- Код двигателя
DECLARE @ID_Max    Nvarchar(30)     -- Максимальный следующий номер


-- Максимальный номер в порше и потом конвертация его в стринговый формат
SELECT @ID_Max = '0' +  CONVERT(NVARCHAR(5), MAX(ZAKAZ)+1)
FROM   W_ORDER
WHERE  Brend   = @ID_Brand 

-- Поиск двигателя для авто
SELECT @ID_Engine = [ID] 
  FROM S_Engenie
 WHERE Brend   = @ID_Brand 
   AND Model   = @ID_Model 
   AND Version = @ID_Version

-- Вставка машины
INSERT INTO DBO.W_ORDER (Brend, 
                         Model, 
                         Vers, 
                         Zakaz, 
                         D_Zakaza,
                         Dat_Zak,  
                         Sorder, 
                         Dlr, 
                         Dealer_Order_placed, 
                         MY, 
                         Engine, 
                         Comments, 
                         Product_Confirmed,
                         Isp,
                         Priz,
                         Note,
                         OrderType, 
                         Trimm,
                         Wiou,
                         ProductionMonth,  
                         Viev,
                         Status, OrderPlaced )
                VALUES (@ID_Brand, 
                        @ID_Model, 
                        @ID_Version, 
                        @ID_Max ,
                        Getdate(), 
                        Getdate(), 
                        @ID_Max , 
                        @ID_Dlr , 
                        @ID_Dlr , 
                        2009 , 
                        @ID_Engine , 
                        @Remarks ,
                        GETDATE(),
                        USER,
                        2,
                       'Ordering Porsche',
                        @ID_Type,  
                        1,
                       'P-' + @ID_Max,
                        @ID_Prod_Confirm,
                        0,
                        @ID_Status,
                        GETDATE())
GO
/****** Object:  StoredProcedure [dbo].[Rec_Cound]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
-- Добавление поля статус
ALTER TABLE W_SREZ ADD Status int default 0

-- Обнуление информации
DELETE FROM W_SREZ WHERE  DATA between getdate()-1 and getdate()

-- Выполнение процедуры
   EXEC Rec_Cound 1
   EXEC Rec_Cound 2
   EXEC Rec_Cound 3
   EXEC Rec_Cound 4
   EXEC Rec_Cound 5

-- Просмотр
SELECT * FROM W_Srez
*/
-- просмотр среза
-- SELECT * FROM W_sREZ

CREATE PROCEDURE [dbo].[Rec_Cound] (@Brand INT)
AS
DECLARE @Names CHAR(30)
DECLARE @Dat   SMALLDATETIME
--SELECT  @Names = Naz FROM S_BREND WHERE ID=@Brand

--SET @DAT =  CONVERT(NVARCHAR(30), GETDATE(), 104)
-- Удаление сегодняшних данных если будет повторная закачка
--DELETE FROM W_SREZ WHERE  DATA between getdate()-1 and getdate()

INSERT W_SREZ (Brand, Data, Nazv, Dc, Cif_Cip, Msrp, Suppl, Dlr, Remarks, Countcar, Status) 
SELECT @Brand, 
       GETDATE() , 
      'PENDING',
       ISNULL(SUM(Dealer_price),0), 
       ISNULL(SUM(Cif_cip), 0),
       ISNULL(SUM(Msrp),0),
       ISNULL(SUM(PMNT_Supplier),0),
       ISNULL(SUM(DLR_Payment),0),
      '1' ,
       ISNULL(COUNT(*),0),
       1
  FROM W_Order 
 WHERE Brend = @Brand 
   AND Status=1


INSERT W_SREZ (Brand, Data, Nazv, Dc, Cif_Cip, Msrp, Suppl, Dlr, Remarks, Countcar, Status) 
SELECT @Brand, 
       GETDATE() , 
      'ORDER',
       ISNULL(SUM(Dealer_price), 0),
       ISNULL(SUM(Cif_cip), 0),
       ISNULL(SUM(Msrp),0),
       ISNULL(SUM(PMNT_Supplier),0),
       ISNULL(SUM(DLR_Payment),0),
       '2' ,
       ISNULL(COUNT(*),0),
       2
  FROM W_Order 
 WHERE Brend = @Brand 
   AND Status=2


INSERT W_SREZ (Brand, Data, Nazv, Dc, Cif_Cip, Msrp, Suppl, Dlr, Remarks, Countcar, Status) 
SELECT @Brand, 
       GETDATE(), 
      'COMPLETED',
       ISNULL(SUM(Dealer_price), 0),
       ISNULL(SUM(Cif_cip), 0),
       ISNULL(SUM(Msrp),0),
       ISNULL(SUM(PMNT_Supplier),0),
       ISNULL(SUM(DLR_Payment),0),
       '3' ,
       ISNULL(COUNT(*),0),
       3
  FROM W_Order 
 WHERE Brend = @Brand 
   AND Status=3

INSERT W_SREZ (Brand, Data, Nazv, Dc, Cif_Cip, Msrp, Suppl, Dlr, Remarks, Countcar, Status) 
SELECT @Brand, 
       GETDATE() , 
      'IN TRANSIT TO UKRAINE',
       ISNULL(SUM(Dealer_price), 0),
       ISNULL(SUM(Cif_cip), 0),
       ISNULL(SUM(Msrp),0),
       ISNULL(SUM(PMNT_Supplier),0),
       ISNULL(SUM(DLR_Payment),0),
       '4',
       ISNULL(COUNT(*),0),
       4
  FROM W_Order 
 WHERE Brend = @Brand 
   AND Status=4

INSERT W_SREZ (Brand, Data, Nazv, Dc, Cif_Cip, Msrp, Suppl, Dlr, Remarks, Countcar, Status) 
SELECT @Brand, 
       GETDATE() , 
      'COMPOUND',
       ISNULL(SUM(Dealer_price), 0),
       ISNULL(SUM(Cif_cip), 0),
       ISNULL(SUM(Msrp),0),
       ISNULL(SUM(PMNT_Supplier),0),
       ISNULL(SUM(DLR_Payment),0),
      '5' ,
       ISNULL(COUNT(*),0),
       5
  FROM W_Order 
 WHERE Brend = @Brand 
   AND Status=5

INSERT W_SREZ (Brand, Data, Nazv, Dc, Cif_Cip, Msrp, Suppl, Dlr, Remarks, Countcar, Status) 
SELECT @Brand, 
       GETDATE() , 
      'ON RELEASE',
       ISNULL(SUM(Dealer_price), 0),
       ISNULL(SUM(Cif_cip), 0),
       ISNULL(SUM(Msrp),0),
       ISNULL(SUM(PMNT_Supplier),0),
       ISNULL(SUM(DLR_Payment),0),
      '6' ,
       ISNULL(COUNT(*),0),
       6
  FROM W_Order 
 WHERE Brend = @Brand 
   AND Status=6

INSERT W_SREZ (Brand, Data, Nazv, Dc, Cif_Cip, Msrp, Suppl, Dlr, Remarks, Countcar, Status) 
SELECT @Brand, 
       GETDATE(), 
      'IN ROUTE TO UKRAINE',
       ISNULL(SUM(Dealer_price),0),
       ISNULL(SUM(Cif_cip), 0),
       ISNULL(SUM(Msrp),0),
       ISNULL(SUM(PMNT_Supplier),0),
       ISNULL(SUM(DLR_Payment),0),
      '7',
       ISNULL(COUNT(*),0),
       7 
  FROM W_Order 
 WHERE Brend = @Brand 
   AND Status=7

INSERT W_SREZ (Brand, Data, Nazv, Dc, Cif_Cip, Msrp, Suppl, Dlr, Remarks, Countcar, Status) 
SELECT @Brand, 
       GETDATE(), 
      'VIC',
       ISNULL(SUM(Dealer_price),0),
       ISNULL(SUM(Cif_cip), 0),
       ISNULL(SUM(Msrp),0),
       ISNULL(SUM(PMNT_Supplier),0),
       ISNULL(SUM(DLR_Payment),0),
      '20' ,
       ISNULL(COUNT(*),0),
       20
  FROM W_Order 
 WHERE Brend  = @Brand 
   AND Status = 8
   AND LOC IN (SELECT ID FROM S_LOCATION WHERE NAZ LIKE '%VIC%' AND ZNACH = 'Y')

INSERT W_SREZ (Brand, Data, Nazv, Dc, Cif_Cip, Msrp, Suppl, Dlr, Remarks, Countcar, Status) 
SELECT @Brand, 
       GETDATE(), 
      'AT DEALER',
       ISNULL(SUM(Dealer_price),0),
       ISNULL(SUM(Cif_cip), 0),
       ISNULL(SUM(Msrp),0),
       ISNULL(SUM(PMNT_Supplier),0),
       ISNULL(SUM(DLR_Payment),0),
      '21' ,
       ISNULL(COUNT(*),0),
       21
  FROM W_Order 
 WHERE Brend  = @Brand 
   AND Status = 8
   AND LOC IN (SELECT ID FROM S_LOCATION WHERE NAZ NOT LIKE  '%VIC%' AND ZNACH = 'Y')

INSERT W_SREZ (Brand, Data, Nazv, Dc, Cif_Cip, Msrp, Suppl, Dlr, Remarks, Countcar, Status) 
SELECT @Brand, 
       GETDATE(), 
      'SOLD',
       ISNULL(SUM(Dealer_price), 0),
       ISNULL(SUM(Cif_cip), 0),
       ISNULL(SUM(Msrp),0),
       ISNULL(SUM(PMNT_Supplier),0),
       ISNULL(SUM(DLR_Payment),0),
      '9' ,
       ISNULL(COUNT(*),0),
       9
  FROM W_Order 
 WHERE Brend = @Brand 
   AND Status=9

/*
INSERT W_SREZ (Brand, Data, Nazv, Dc, Cif_Cip, Msrp, Suppl, Dlr, Remarks, Countcar) 
SELECT @Brand, 
       GETDATE(), 
      'OTHER',
       ISNULL(SUM(Dealer_price), 0),
       ISNULL(SUM(Cif_cip), 0),
       ISNULL(SUM(Msrp),0),
       ISNULL(SUM(PMNT_Supplier),0),
       ISNULL(SUM(DLR_Payment),0),
      'OTHER',
      ISNULL(COUNT(*),0)
  FROM W_Order 
 WHERE Brend = @Brand 
   AND Status > 9
*/

INSERT W_SREZ (Brand, Data, Nazv, Dc, Cif_Cip, Msrp, Suppl, Dlr, Remarks, Countcar, Status) 
SELECT @Brand, 
       GETDATE() , 
      'TOTAL SUM',
       ISNULL(SUM(Dealer_price),0), 
       ISNULL(SUM(Cif_cip),0), 
       ISNULL(SUM(Msrp),0),
       ISNULL(SUM(PMNT_Supplier),0),
       ISNULL(SUM(DLR_Payment),0),
       'ALL',
       ISNULL(COUNT(*),0),
       20
  FROM W_Order 
 WHERE Brend = @Brand 

/*
INSERT W_SREZ (Brand, Data,NAZV) VALUES(1, CONVERT(VARCHAR, GETDATE(), 103),'DDD')
INSERT W_SREZ (Brand, Data,NAZV) VALUES(1,  GETDATE()+1,'DDD')
PRINT GETDATE()
declare @dd nvarchar(20)
SET DATEFORMAT mdy
set @dd = CONVERT(VARCHAR, GETDATE(), 103)
print cast(convert(varchar(8),getdate()-1,1) as datetime)
INSERT W_SREZ (Brand, [Data],NAZV) VALUES(1,GETDATE() ,'SS')
SELECT * FROM W_SREZ WHERE DATA between getdate()-1 and getdate()
PRINT cast(convert(varchar(8),getdate()-1,1) as datetime)
*/
GO
/****** Object:  StoredProcedure [dbo].[Stock_week]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[Stock_week]
AS
-- Состояние машин по 
-- локейшенам на определенную дату
SELECT b.naz as Brand, 
       W.vin AS [VIN_code], 
       L.naz as Location 
FROM  Wdoc..w_order_010410     W,
      winner..S_Location L,
      winner..S_Brend    B
WHERE W.loc    = L.id
  AND W.brend  = B.id    
  AND W.status = 8
GO
/****** Object:  View [dbo].[Fin_01]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Fin_01]
AS
SELECT     D.Last_Name, W.VIN, W.WIU_Arrived, W.DLR_Actual_Arrival, W.Dealer_price, W.DLR_Payment, U.L_DATE, B.Naz AS BRAND, M.Naz AS MODEL
FROM         dbo.W_Order AS W WITH (NOLOCK) LEFT OUTER JOIN
                      dbo.Upd_paymnt AS U WITH (NOLOCK) ON W.Zakaz = U.N_ORD LEFT OUTER JOIN
                      dbo.S_Diler AS D WITH (NOLOCK) ON U.L_DEALER = D.Last_Name AND W.Dlr = D.ID LEFT OUTER JOIN
                      dbo.S_Brend AS B WITH (NOLOCK) ON W.Brend = B.ID LEFT OUTER JOIN
                      dbo.S_Model AS M WITH (NOLOCK) ON W.Model = M.ID
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[54] 4[7] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 291
               Right = 300
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "B"
            Begin Extent = 
               Top = 5
               Left = 493
               Bottom = 113
               Right = 653
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "M"
            Begin Extent = 
               Top = 326
               Left = 361
               Bottom = 434
               Right = 521
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "D"
            Begin Extent = 
               Top = 186
               Left = 640
               Bottom = 361
               Right = 800
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "U"
            Begin Extent = 
               Top = 93
               Left = 352
               Bottom = 201
               Right = 503
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Fin_01'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Fin_01'
GO
/****** Object:  View [dbo].[A_Fin_Credit]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Fin_Credit]
AS
SELECT     TOP (100) PERCENT dbo.W_Order.ID, dbo.W_Order.Brend AS Brend_id, dbo.W_Order.Zakaz AS [Order], dbo.W_Order.VIN, dbo.S_Brend.Naz AS Brand, 
                      dbo.S_Model.Naz AS Model, dbo.S_Version.Naz AS Version, dbo.W_Order.Status, dbo.S_Diler.Last_Name AS Dealer, 
                      dbo.W_Order.Fin_accouting_doc_issued AS Credit_Applied, dbo.W_Order.Sold_to_Client
FROM         dbo.W_Order INNER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID INNER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID INNER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID INNER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dlr = dbo.S_Diler.ID
WHERE     (dbo.W_Order.Status = 8)
ORDER BY Brand
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[20] 4[48] 2[13] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 384
               Right = 300
            End
            DisplayFlags = 280
            TopColumn = 147
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 13
               Left = 442
               Bottom = 103
               Right = 592
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 287
               Left = 437
               Bottom = 395
               Right = 597
            End
            DisplayFlags = 280
            TopColumn = 4
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 104
               Left = 441
               Bottom = 166
               Right = 592
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 178
               Left = 437
               Bottom = 269
               Right = 593
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 10
         Width = 284
         Width = 1500
         Width = 930
         Width = 840
         Width = 2310
         Width = 870
         Width = 1155
         Width = 1005
         Width = 1575
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 2790
   ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Fin_Credit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'      Alias = 2655
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Fin_Credit'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Fin_Credit'
GO
/****** Object:  View [dbo].[Reporting_2]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Reporting_2]
AS
SELECT     dbo.S_Brend.Naz, dbo.W_Order.Model, dbo.S_Model.Naz AS Expr1, dbo.W_Order.Vers, dbo.S_Version.Naz AS Expr2
FROM         dbo.W_Order INNER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID INNER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID INNER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID
GROUP BY dbo.W_Order.Model, dbo.S_Brend.Naz, dbo.S_Model.Naz, dbo.W_Order.Vers, dbo.S_Version.Naz
GO
/****** Object:  View [dbo].[A_Email_Pay]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Email_Pay]
AS
SELECT     TOP (100) PERCENT dbo.W_Order.Brend, dbo.W_Order.Status, dbo.W_Order.Dlr, dbo.S_Diler.Code, dbo.W_Order.Date_completed, 
                      dbo.W_Order.Date_completed + 9 AS DeadLineCompleted, dbo.W_Order.WIU_Arrived, dbo.W_Order.WIU_Arrived + 9 AS DeadLineArrived, 
                      dbo.W_Order.Dealer_price, dbo.W_Order.Dealer_price / 2 AS NeedHalfPrice, dbo.W_Order.ID, dbo.W_Order.VIN, dbo.S_Brend.Naz AS Brand, 
                      dbo.S_Model.Naz AS Model, dbo.S_Version.Naz AS Version
FROM         dbo.W_Order INNER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dlr = dbo.S_Diler.ID INNER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID INNER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID INNER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID
WHERE     (dbo.W_Order.Brend = 5) AND (dbo.W_Order.Status IN (3, 8))
ORDER BY dbo.W_Order.Brend, dbo.W_Order.Status, dbo.W_Order.Date_completed, DeadLineCompleted, dbo.W_Order.WIU_Arrived DESC, 
                      DeadLineArrived DESC
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[28] 4[48] 2[6] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 481
               Right = 300
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 238
               Left = 375
               Bottom = 346
               Right = 535
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 14
               Left = 374
               Bottom = 122
               Right = 534
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 350
               Left = 376
               Bottom = 458
               Right = 536
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 126
               Left = 375
               Bottom = 234
               Right = 536
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 16
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Wi' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Email_Pay'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'dth = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Email_Pay'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Email_Pay'
GO
/****** Object:  StoredProcedure [dbo].[Sale_Car_Month]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Продажа машин по бренду за месяц и год
Usage : EXEC Sale_Car_Month 5,10,2008
*/

CREATE PROCEDURE [dbo].[Sale_Car_Month]  @Brend INT,
                                @Month INT, 
                                @Year  INT 
AS

--select dealer_price from w_order where brend=5

SELECT W.Zakaz                 AS [Number Order],                  -- Номер заказа
       W.Vin                   AS [VIN Code],                      -- VIN Code 
       D.Last_Name             AS [Dealer Name],                   -- Dealer Owner
       V.Naz                   AS [Version],                       -- Version Car  
       W.Sale_Paym_Date        AS [Date Sale],                     -- Date Sale to dealer
       W.Pymnt_Date            AS [Payment Date Dealer],           -- Date Pay 
       W.Dlr_Payment           AS [Date Dealer Payment],           -- Pay sum 
       W.Dealer_price          AS [Dealer Cost],                   -- Dealer Cost
       W.Pymnt_sum_curr        AS [Payment UAH],                   -- 
       W.Pymnt_eur             AS [Rate EUR],                      -- Curs EURO
       Year (W.Sale_Paym_Date) As [Yaer]                           -- Year
FROM   W_ORDER    W, 
       S_DILER    D,
       S_Version  V
WHERE  W.Dlr    = D.Id
AND    W.Vers   = V.Id
AND    W.Brend  = @Brend
AND    Month(W.Sale_Paym_Date) = @Month
AND    Year (W.Sale_Paym_Date) = @Year
GO
/****** Object:  StoredProcedure [dbo].[Add_buildup]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
  ADD OPTIONS TO ORDER
  Дата      : 18-07-2008
  Время     : 14:28
  Ввод новых опций для выбранного автомобиля 
  Описание : Вставка призводится выбранных опций принадлежащих только выбранным
             вариантам Бренд Модель Версия
             Остальные данные разделяются на две части Оглавление и подножье инвойса
             которые формируются во всех инвойсах автоматически и заполняются
             из необходимых для этого сочетания справочников.

             Структура тела инвойса :
               * Оглавление (автоматическое заполнение )        CODS = 1,2,3,4,5
               * Опции      (выбор вручную из справочника S_Opttion) CODS = 10
               * Подножье   (автоматическое заполнение )        CODS = 11,12,13,14

  Пример использования процедуры :
  EXEC ADD_OPTION 36919, 1, 23, 789
*/

-- DELETE FROM  W_OPTIONAL
-- SELECT * FROM W_OPTIONAL
-- exec INSERT_VERSION_PROGRAMM_DATABASE 'Add new version','111'

CREATE PROCEDURE [dbo].[Add_buildup]  @IDORDER INT, 
                                      @IDBRAND INT , 
                                      @IDMODEL INT, 
                                      @IDVERS  INT
AS
DECLARE @TOTALSUM MONEY
SET @TOTALSUM = 0

-- Insert Build UP
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '100', 'EXW Price ', 100, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '104', 'Delivery to Compound ', 104, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '105', 'Insurance', 105, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '106', 'Invoice Price', 106, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '107', 'Delivery to Ukraine', 107, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '108', 'Other Expenses Abroad', 108, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '109', 'Customs Values', 109, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '110', 'Customs Procedures', 110, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '111', 'Customs Duty', 111, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '112', 'Customs Excise', 112, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '113', 'Delivery to Dealer', 113, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '114', 'Documents Arrangement', 114, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '115', 'Extended Warranty', 115, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '116', 'Heanding Fee', 116, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '117', 'Importer Mark-Up', 117, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '118', 'In Country', 118, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '119', 'Dealer Cost no VAT', 119, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '120', 'VAT', 120, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '121', 'Dealer Cost', 121, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '122', 'Discount for Model (-) w/o VAT', 122, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '123', 'Discount for Vehicle (-) w/o VAT', 123, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '124', 'Discount for Pack (-) w/o VAT', 124, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '125', 'Other Rise / Penalties Without VAT', 125, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '126', 'Total Rise / Penalties Without VAT', 126, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '127', 'Final Dealer Cost', 127, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '128', 'Dealer Mark-up', 128, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '129', 'PDI', 129, @TOTALSUM)
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @IDBRAND, @IDMODEL, @IDVERS, '130', 'MSRP + VAT', 130, @TOTALSUM)
GO
/****** Object:  StoredProcedure [dbo].[Recalc_option]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- select id , brend from w_order where id=24716
-- ALTER TABLE W_OPTIONAL ALTER COLUMN Cods     INT        -- Код сортировки
-- ALTER TABLE W_OPTIONAL ADD Cods     INT                 -- Код сортировки
-- ALTER TABLE W_OPTIONAL ADD Discount MONEY DEFAULT 0     -- Скидки
-- SELECT * FROM  W_OPTIONAL


-- Пересчет опций уже с существующими опциями введенніми в бренде
-- exec Recalc_option 23,1,22,234

-- Recalculation Options
CREATE PROCEDURE [dbo].[Recalc_option] (@IDORDER INT, @BRAND INT, @MODEL INT, @VERS INT)
AS

-- Удаление предыдущих данных 
DELETE FROM W_Optional 
WHERE       Zakaz = @IDORDER 
 AND CODS IN (1,2,3,4) 
 OR  CODS IN (11,12,13,14,15,16,17,20)    

/*
   Оглавление
   1 BASE BASE
   2 MDL  MODEL 
   3 MY   MODEL YEAR
   4 ENG  ENGINE

   Опции
   10 COD NAME OPTIONS
   10 COD NAME OPTIONS
   10 COD ............
   10 COD NAME OPTIONS 
  
   Подножье 
   11 CLB COLOR BODY
   12 TRM TRIM
   13 EXW EXWORKS
   14 FRC FREIGHT CHARGES 
   15 INS INSURANCE
   16 COR COUNTRY OF ORIGINAL
   17 WGT WEIGHT
   20 TSM TOTAL SUM
*/

-- Заголовок
-- BASE
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @BRAND, @MODEL, @VERS, 'BAZA', 'BASE : ', 1, 0)
-- MODEL
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @BRAND, @MODEL, @VERS, 'MDL', 'MODEL : ', 2, 0)
-- MODEL YEAR
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @BRAND, @MODEL, @VERS, 'MY', 'MODEL YEAR : ', 3, 0)
-- ENGINE
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @BRAND, @MODEL, @VERS, 'ENG', 'ENGINE : ', 4, 0)
-- Подножье
-- COLOR BODY
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @BRAND, @MODEL, @VERS, 'CLB', 'COLOR BODY : ', 11, 0)
-- TRIM
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @BRAND, @MODEL, @VERS, 'TRM', 'TRIM : ', 12, 0)
-- EXW
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @BRAND, @MODEL, @VERS, 'EXW', 'EXWORKS : ', 13, 0)
-- FREIGHT CHARGES 
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @BRAND, @MODEL, @VERS, 'FRC', 'FREIGHT CHARGES  : ', 14, 0)
-- INSURANCE
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @BRAND, @MODEL, @VERS, 'INS', 'INSURANCE  : ', 15, 0)
-- COUNTRY OF ORIGINAL
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @BRAND, @MODEL, @VERS, 'COR', 'COUNTRY OF ORIGINAL  : ', 16, 0)
-- WEIGHT
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @BRAND, @MODEL, @VERS, 'WGT', 'WGT WEIGHT : ', 17, 0)
-- TOTAL SUM
INSERT W_OPTIONAL (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Pr_exw) VALUES (@IDORDER, @BRAND, @MODEL, @VERS, 'TSM', 'TOTAL SUM : ', 18, 0)
GO
/****** Object:  View [dbo].[Fin_Trabls]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/* Для описания ошибок
 Для Отдела Присич
 Финансовые проблемы
 DATE : 05-032008
 TIME : 19:01*/
CREATE VIEW [dbo].[Fin_Trabls]
AS
SELECT     TOP (100) PERCENT A.ID AS [ID Code], A.[Supplier Order] AS [Order], A.[Full VIN] AS VIN, dbo.S_Brend.Naz AS Brand, A.Model, A.Version, A.[CIF/CIP], 
                      A.[Invoice Date], W.Note AS Remark, W.Sokr AS Code, W.Naz AS Options, A.[WIU Arrived], A.[Sold to Client], W.Pr_raznica, W.Pr_exw, W.Pr_dlr, 
                      W.Pr_msrp
FROM         dbo.A_Status AS A INNER JOIN
                      dbo.W_Optional AS W ON A.ID = W.Zakaz INNER JOIN
                      dbo.S_Brend ON A.Id_Brand = dbo.S_Brend.ID
ORDER BY Brand, A.Model, A.Version, A.[WIU Arrived], A.[Sold to Client]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "A"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 327
               Right = 228
            End
            DisplayFlags = 280
            TopColumn = 15
         End
         Begin Table = "W"
            Begin Extent = 
               Top = 0
               Left = 267
               Bottom = 226
               Right = 418
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 236
               Left = 272
               Bottom = 344
               Right = 423
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Fin_Trabls'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Fin_Trabls'
GO
/****** Object:  StoredProcedure [dbo].[Write_Log]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Логирование событий в базе
-- Пример : WRITE_LOG 'Savchenko', 'Sample Test', 23456, Default,'New','Old'
-- Groups 1 Brands
--        2 Finance
--        3 Logistics
--        4 Customs
--        5 Automatics operation
--        6 Other Function

CREATE PROCEDURE [dbo].[Write_Log] ( @Username    nvarchar(30),     -- Имя пользователя
                                    @Notes       nvarchar(200),    -- Примечание 
                                    @Numorder    int,              -- ID Заказа  
                                    @Groups      int = 3,          -- Группа () 
                                    @New_zn      nvarchar(50) ,    -- Новое значение
                                    @Old_zn      nvarchar(50) )    -- Старое значение 
AS
SET NOCOUNT ON
INSERT INTO [Winner].[dbo].[W_LOG]
            ([Tim]
            ,[Usr]
            ,[Usr_name]
            ,[Note]
            ,[Zakaz]
            ,[Gr]
            ,[New_val]
            ,[Old_val])
     VALUES ( GETDATE() ,       -- Текущая дата
              SYSTEM_USER ,     -- Имя пользователя на сервере
              @Username ,       -- Пользователь в программе
              @Notes ,          -- Сообщение  
              @Numorder ,       -- Номер ИД ордера
              @Groups ,         -- Группа (по умолчанию=2)
              @New_zn ,         -- Новое значение
              @Old_zn)          -- Старое значение
GO
/****** Object:  StoredProcedure [dbo].[Search_log_information]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Поиск событий в лог файле
CREATE PROCEDURE [dbo].[Search_log_information]
AS
-- Определение номеров
select id from w_order where vin like '%TTFX9K11406%'
select id from w_order where vin like '%TTFX9K11425%'
select id from w_order where vin like '%TTFX9K11444%'
select id from w_order where vin like '%TTFX9K11484%'
select id from w_order where vin like '%GAJU9G38935%'
select id from w_order where vin like '%GAJU9G44665%'
select id from w_order where vin like '%GAJJ9G70606%'


SELECT  W.Tim   AS Дата_Oперации , 
        W.Usr   AS Пользователь, 
        W.Note  AS Описание, 
        W.Zakaz AS Заказ,
        O.Vin   AS VIN
FROM    w_log   W, 
        w_Order O
WHERE   W.usr_name = 'pdiadmin' 
 AND    W.Zakaz    = O.ID
 AND    W.zakaz IN (54809,54810,54811,54813,54437,54434,54360)


-- Второй пример
SELECT  TOP 100
        W.Tim   AS Дата_Oперации , 
        W.Usr   AS Пользователь, 
        W.Note  AS Описание, 
        W.Zakaz AS Заказ,
        O.Vin   AS VIN
FROM    w_log   W, 
        w_Order O
WHERE   W.usr_name = 'pdiadmin' 
 AND    W.Zakaz    =  O.ID
 AND    W.zakaz IN (SELECT ID FROM W_ORDER  WHERE VIN LIKE '%TTFX9K11444%' 
                                               OR VIN LIKE '%TTFX9K11425%'
                                               OR VIN LIKE '%TTFX9K11444%' )
GO
/****** Object:  StoredProcedure [dbo].[Chst]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
SELECT * FROM W_HISTORY
Change status
Упрощенный вариант без анализа введенных раннее статусов
Если стаутс новый больше чем на один старого выдаем сообщение об ошибке
Если 
*/
CREATE  PROCEDURE [dbo].[Chst]  (@IdOrder     int,    -- ID Order current
                        @NewStatus   int)    -- New ststus 
AS
SET NOCOUNT ON                               -- No records  
DECLARE @MaxStatus int                       -- Max ststus for current order 
 
-- Определение максимального статуса по текущему заказу
SELECT @MaxStatus = Max(Status) FROM W_HISTORY WHERE ZAKAZ = @IdOrder

--print 'Максимальный   статус    = ' + CAST(@MaxStatus AS VARCHAR(30))
--print 'Новый вставляемый статус = ' + CAST(@NewStatus AS VARCHAR(30))

-- Если не было в истории статуса - записываем 
-- а иначе обновляем время и пользователя сделавшего замену
-- 

IF NOT EXISTS (SELECT * FROM W_HISTORY WHERE ZAKAZ = @IdOrder AND STATUS = @NewStatus) 
   BEGIN
   INSERT INTO W_History (Zakaz,Status)  VALUES (@IdOrder, @NewStatus)  -- Insert new status
   END
ELSE
   BEGIN
   UPDATE  W_History SET Dstatus = GETDATE(), Isp_Name=USER   + '' WHERE ZAKAZ = @IdOrder  AND Status = @newStatus         -- Update base information
   END

/*

IF @MaxStatus < @NewStatus 
   BEGIN
   INSERT INTO W_History (Zakaz,Status)  VALUES (@IdOrder, @NewStatus)  -- Insert new status
   END

IF @MaxStatus >= @NewStatus 
   BEGIN
   UPDATE  W_History SET Dstatus=GETDATE(), Isp_Name=USER   + '+++!! ' WHERE ZAKAZ = @IdOrder  AND Status = @maxStatus         -- Update base information
   END

*/   
  -- DELETE FROM W_HISTORY WHERE ZAKAZ = @IdOrder AND STATUS > @NewStatus


-- Eсли статуса такого нет до добавляем если есть обновляем кто его поменял и когда

  
--ELSE 
--   UPDATE  W_History SET Dstatus=GETDATE(),Isp_Name=USER()              -- Update base information
GO
/****** Object:  StoredProcedure [dbo].[Colorbody_Ford]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Типичный набор цветов для форда (кузова)
CREATE PROCEDURE [dbo].[Colorbody_Ford] (@Modell int, @Verss int)
AS

-- Очистка предварительно таких сочитаний цветов
DELETE FROM S_COLOURS WHERE Brend=1 AND Model=@Modell AND Version = @Verss

INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C0',  'AVALON MET')  
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C1',  'APPLE GREEN MET')  
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C2',  'AQUARIUS MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C3',  'BLUE AMBITION MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C4',  'BLAZER BLUE')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C5',  'CARAMELLA MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C6',  'COLORADO RED')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C7',  'GRENADINE MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C8',  'CHILL MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C9',  'DARK TRUE BLUE')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C10',  'DEEP NAVY')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C11',  'DIAMOND WHITE')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C12',  'ELECTRIC ORANGE MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C13', 'FROZEN WHITE')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C14', 'HIGHLIGHT SILVER MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C15', 'INK BLUE MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C16', 'KELP MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C17', 'LUNA MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C18', 'MACHINE SILVER MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C19', 'MAGNUM GREY MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C20', 'MOONDUST SILVER MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C21', 'MORELLO MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C22', 'MOSS GREEN')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C23', 'HYPNOTIC SILVER MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C24', 'OCEAN MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C25', 'PANTHER BLACK MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C26', 'PEPPER RED MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C27', 'PERFORMANCE BLUE MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C28', 'PLUM BLUSH MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C29', 'SAFFRON YELLOW')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C30', 'SEA GREY MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C31', 'SILVER/TITANIUM MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C32', 'SPANISH OLIVE MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C33', 'STARDUST SILVER MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C34', 'SUBLIME MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C35', 'TANGO ORANGE MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C36', 'THUNDER MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C37', 'TONIC MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C38', 'TRAFFIC YELLOW')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C39', 'VERDIGRIS MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C40', 'VIOLA MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C41', 'VISION MET')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C42', 'UPS BROWN')
INSERT INTO S_COLOURS(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss,'C43', 'WHITE GRAPE MET')
GO
/****** Object:  StoredProcedure [dbo].[Repeate_Order]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Повторение заказа несколько раз
-- EXEC Repeate_Order 1, 29859, 10, 2, GETDATE
 
--SELECT TOP 10  ID FROM W_ORDER  WHERE BREND=1
--SELECT COUNT(*) FROM W_ORDER WHERE BREND=1

CREATE PROCEDURE [dbo].[Repeate_Order]  
                @BRAND   INT ,                 -- Бренд
                @IDORDER INT,                  -- ID текущиего заказа
                @RAZ     INT,                  -- Количество повторений  
                @STATUS  INT ,                 -- Статус в который устанавливается новый заказа  
                @DATAST  DATETIME = GETDATE    -- Дата установки статуса 
AS
BEGIN
	SET NOCOUNT ON
    DECLARE @ZAKAZ     INT                     -- текущий  заказ
    DECLARE @NEXTORDER NVARCHAR(20)            -- будующий заказ
    DECLARE @MAXORDER  INT                     -- следующий номер заказа
    DECLARE @MAXID     INT                     -- максимальный ид номер заказа
   
  --Определение будующего номера заказа для опций
  --SELECT MAX(RIGHT(ZAKAZ,4)) FROM W_ORDER WHERE BREND=1
    SELECT @NEXTORDER = MAX(ZAKAZ)  FROM W_ORDER WHERE BREND = @BRAND
    SET    @MAXORDER  = SUBSTRING(@NEXTORDER,2,5) + 1
    SET    @NEXTORDER = LEFT(@NEXTORDER,1)  + CONVERT(NVARCHAR(10),@MAXORDER)   

    -- Транзакция
    BEGIN TRANSACTION

    INSERT W_Order (Zakaz,      Dat_Zak,   D_zakaza, OrderType, Brend, Model, Vers, Dlr, Loc, GearBox, Status,  Engine, Trimm, Priz, Colours, Colour, My, Client, Comments, Isppol,  Note) 
    SELECT          @NEXTORDER, GETDATE(), @DATAST,  OrderType, Brend, Model, Vers, Dlr, Loc, GearBox, @STATUS, Engine, Trimm, 10  , Colours, Colour, My, Client, 'System', USER,   ORIGINAL_LOGIN() 
    FROM   W_Order 
    WHERE  ID = @IDORDER
    
    -- Определение ID заказа 
    SELECT @MAXID = ID FROM W_ORDER WHERE BREND = @BRAND   

    -- Повтор опциий внесения в заказ
    INSERT W_Option (Zakaz, Model, Conf, Note) 
    SELECT @MAXID, Model, Conf, Note 
    FROM   W_OPTION 
    WHERE  ZAKAZ = @IDORDER

    -- Если ошибка в ходе вставке откат
    IF @@ERROR > 0 
       ROLLBACK TRANSACTION
    ELSE
       COMMIT TRANSACTION
END
GO
/****** Object:  StoredProcedure [dbo].[Colortrim_Ford]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Типичный набор цветов для форда (кузова)
CREATE PROCEDURE [dbo].[Colortrim_Ford] (@Modell int, @Verss int)
AS
-- Очистка предварительно таких сочитаний цветов
DELETE FROM S_COLOURK WHERE Brend = 1 AND Model = @Modell AND Version = @Verss
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T1',  'AIRFIELD EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T2',  'ALCANTARA EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T3',  'ALCANTARA INF BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T4',  'AMETHYST DREAM')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T5',  'ANTHRACITE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T6',  'ARASIA EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T7',  'ARAS CLOTH EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T8',  'AVANETTE LT DENIM BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T9',  'BLACK VELOUR')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T10', 'BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T11', 'BLUE DIAMOND')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T12', 'BOHEMIAN RUBY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T13', 'CRYSTAL DREAM')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T14', 'CUBICAL EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T15', 'CUBICAL MD LT STONE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T16', 'DAMSGED/BEING REPAIRED AT THE  FACTORY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T17', 'DARK FLINT')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T18', 'DARK TANZANITE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T19', 'DEBUFFET BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T20', 'EBONY ARAS CLOTH')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T21', 'EBONY BLACK LEATHER')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T22', 'EBONY CLOTH')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T23', 'ECRIN GENERIC BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T24', 'ECRIN GENERIC ORANGE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T25', 'ECRIN GENERIC SILVER')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T26', 'FLINT/SPAN EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T27', 'GENERIC ANTHRACITE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T28', 'GENERIC BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T29', 'GENERIC ORANGE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T30', 'GILLOS BISCUIT')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T31', 'GILLOS EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T32', 'GREY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T33', 'HOT COPPER')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T34', 'HUMY RED')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T35', 'INDIGO TANZANITE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T36', 'INK BLUE TRIA')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T37', 'INTEGRATE INFINITY BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T38', 'JAPANESE PEARL')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T39', 'LEATHER EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T40', 'LOUIS CAMEL LEATHER')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T41', 'MINUTE INFINITY BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T42', 'MOONLIGHT SAPPHIRE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T43', 'NAMIBIAN PEARL')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T44', 'NAPOLI LEATHER')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T45', 'NAPOLI LEATHER BISCUIT')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T46', 'NAPOLI LEATHER EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T47', 'NAPOLI LEATHER INF BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T48', 'NEW YORK EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T49', 'NEW YORK INF BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T50', 'OBSIDIAN CHARM')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T51', 'ONTARIO EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T52', 'ONYX DREAM')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T53', 'OPAL WAVE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T54', 'PEWTER/EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T55', 'PLATINUM WAVE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T56', 'RACK EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T57', 'REGIMENT PEWTER')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T58', 'REGIMENT RED')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T59', 'RHODIUM WAVE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T60', 'RIBBON EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T61', 'RIBBON INF BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T62', 'SOFT JET')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T63', 'SPAN RED/EBONY')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T64', 'STRIPY GENERIC BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T65', 'TAHITIAN PEARL')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T66', 'TRIM')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T67', 'VELOURS DARK FLINT')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T68', 'VIOLET Tanzanite')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T69', 'WAFFLE BLACK')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T70', 'WAFFLE INF BLUE')
INSERT INTO S_COLOURK(Brend, Model, Version, Kod, Naz) VALUES (1, @Modell, @Verss, 'T71', 'WAFFLE/PART LEATHER')
GO
/****** Object:  StoredProcedure [dbo].[Remeinder_dealers_scan]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
--EXEC Remeinder_dealers_scan
CREATE PROCEDURE [dbo].[Remeinder_dealers_scan] 
AS

-- Инициализация пер менных
DECLARE @NAMES    INT
DECLARE @ID_DLRS int
DECLARE @EMAIL_DLR NVARCHAR(255)

DECLARE MyCursor CURSOR FOR SELECT IDS FROM S_diler_email
OPEN    MyCursor

--WHILE @@FETCH_STATUS = 0  BEGIN

WHILE 1=1 BEGIN
IF @@FETCH_STATUS = -1 BREAK
   Print 'SSSSSSS' -- @NAMES --@ID_DLRS 
IF @@FETCH_STATUS = -2 CONTINUE

 FETCH FROM MyCursor INTO @NAMES
 SELECT @ID_DLRS = ID, @EMAIL_DLR=EMAIL FROM S_DILER_EMAIL WHERE IDS=@Names
     
     Print 'DDD' -- @NAMES --@ID_DLRS 
     --EXEC Remeinder_dealers_pay @ID_DLRS, @EMAIL_DLR 

END
PRINT 'DDDDDDDDDDDDDDDDDD'

CLOSE      MyCursor
DEALLOCATE MyCursor
GO
/****** Object:  View [dbo].[A_parts_wiu]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_parts_wiu]
AS
SELECT     TOP (100) PERCENT Articul, Descript, Dealer, Brand
FROM         dbo.W_Parts
WHERE     (Dealer = 424) AND (Descript IS NOT NULL)
ORDER BY Articul
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Parts"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 323
               Right = 198
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 9
         Width = 284
         Width = 2385
         Width = 2100
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_parts_wiu'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_parts_wiu'
GO
/****** Object:  StoredProcedure [dbo].[Add_invoice]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[Add_invoice] 
                 @IDRLS   INT, 
                 @NMRLS   NVARCHAR(30)
AS

--BEGIN TRANSACTION
INSERT INTO W_Invoice (Id_Release, Zakaz, Wiu_Invoice, Vin, Id_wiu ) 
     SELECT @IDRLS, Zakaz, Invoice_Number, RIGHT(Vin, 11), w_order.id 
       FROM W_Order 
      WHERE Rls = @NMRLS
GO
/****** Object:  StoredProcedure [dbo].[Parts_load_dealer]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- ***************************************************************************************************************
-- Сбор по информации по брендам
-- EXEC Parts_load_dealer
-- ***************************************************************************************************************
-- select * from w_parts
-- select * from w_parts_log
-- delete from w_parts

CREATE PROCEDURE [dbo].[Parts_load_dealer]
AS

-- Удаление данных за текущую дату
-- DELETE FROM W_PARTS_LOG WHERE DATA=GETDATE()


-- Закачка файлов от дилеров по всем брендам 
-- DELETE FROM w_parts
-- SELECT * FROM w_parts

EXEC Parts_Insert_dealer_xls 1 
EXEC Parts_Insert_dealer_xls 2
EXEC Parts_Insert_dealer_xls 3
EXEC Parts_Insert_dealer_xls 4
EXEC Parts_Insert_dealer_xls 5


-- SELECT * FROM a_parts
-- Расчет стоимости ???
-- UPDATE W_PARTS SET 

-- Обновление наименований запчасетей закачанных от дилеров
UPDATE W
SET    W.Descript    = A.Descript   ,         -- описание запчасти
       W.Price_imp   = A.Price_imp ,          -- Обновление цены импортера  
       W.Price_opt   = A.Price_opt ,          -- обновление оптовой цены
       W.Price_roz   = A.Price_roz ,          -- обновление розничной цены
       W.Date_update = GETDATE(),             -- дата + время обновления  
       W.Flag        = 1                      -- флаг обработки 
FROM   W_PARTS W,
       A_Parts A
WHERE  W.Articul     = A.Articul
  AND  A.Dealer      = 424
GO
/****** Object:  StoredProcedure [dbo].[P_oplata]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[P_oplata]
AS
SET NOCOUNT ON

/*
UPDATE W SET W.Dlr_payment = P.S_eur, Priz = 3, Note = GETDATE()
FROM   w_order W, a_pays P
WHERE  w.zakaz = P.n_ord
*/

-- Обновление оплаты дилерами в WIU за купленные машины
UPDATE W SET W.Payment = P.S_eur, Priz = 3, Note = GETDATE()
FROM   w_order W, 
       a_pays  P
WHERE  w.zakaz = P.n_ord

SELECT @@ROWCOUNT AS Rowcnt


--IF @@TRANCOUNT>0 COMMIT TRAN
--   SET NOCOUNT OFF
--SELECT 0 as i
--SELECT dlr_payment, priz FROM w_order WHERE priz=2
--SELECT * FROM a_pays 
--exec P_oplata
--GO
GO
/****** Object:  View [dbo].[A_Status]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Code.......:   V_0001
Version ...:   1.002
Remarks....:   Основной просмотр для формирования отчетности
Company....:   Winner Imports Ukraine, LTD
Author.....:   Savchenko Arthur
Name.......:   Dbo.Aging (Большая дата,Меньшая дата)
Date.......:   10/02/2008
Time.......:   10:37
Usege......:   SET DATEFORMAT dmy
               PRINT DBO.AGING ('06/02/2008','02/02/2008')
*/
CREATE VIEW [dbo].[A_Status]
AS
SELECT     TOP (100) PERCENT dbo.W_Order.Zakaz AS [Supplier Order], dbo.W_Order.Sorder AS [Common Order], 
                      dbo.W_Order.ProductionMonth AS [Production Month], dbo.S_Diler.Last_Name AS [Dealer Order Placed], dbo.W_Order.Svin AS [Short VIN], 
                      S_Diler_1.Last_Name AS Dlr, dbo.S_Location.Naz AS Loc, dbo.S_Status.Naz AS Status, dbo.S_Model.Naz AS Model, dbo.S_Version.Naz AS Version, 
                      dbo.W_Order.Derivate AS Derivative, dbo.W_Order.VIN AS [Full VIN], dbo.S_Engenie.Naz AS Engine, dbo.W_Order.Spec1, dbo.W_Order.Spec2, 
                      dbo.W_Order.Spec3, LEFT(dbo.W_Order.Options, 2000) AS [Optional Equipment], dbo.S_Colours.Naz AS [Colour Body], dbo.S_Colourk.Naz AS Trim, 
                      dbo.S_Type.Naz AS [Order Type], dbo.W_Order.Comments, dbo.W_Order.MY AS [Model Year], dbo.W_Order.Cif_cip AS [CIF/CIP], 
                      dbo.W_Order.Dealer_price AS [Dealer price], dbo.W_Order.MSRP, dbo.W_Order.OrderPlaced AS [Order Placed], 
                      dbo.W_Order.DeadlineChange AS [Deadline Change], dbo.W_Order.Req AS Reg, dbo.W_Order.Product_confirmed AS [Production Confirmed], 
                      dbo.W_Order.Omdp, dbo.W_Order.Get_release_Date AS [Gate Release], dbo.W_Order.Invoice_Date AS [Invoice Date], 
                      dbo.W_Order.Compound AS [Compound Arrived], dbo.W_Order.RLS AS [RLS #], dbo.W_Order.RLS_placed AS [RLS Placed], 
                      dbo.W_Order.Compound_RLS AS [Compound RLS], dbo.W_Order.Rls_left_compound AS [RLS Left Compound], 
                      dbo.W_Order.WIU_Arrived AS [WIU Arrived], dbo.W_Order.ContractDD AS [Contract Delivery Date], 
                      dbo.W_Order.DLR_Suggested_Arrival AS [DLR Estimated Arrival], dbo.W_Order.DLR_Actual_Arrival AS [DLR Actual Arrival], 
                      dbo.W_Order.Sold_to_DLR AS [Sold to DLR], dbo.W_Order.Sold_to_Client AS [Sold to Client], dbo.CntDay(dbo.W_Order.Invoice_Date, 
                      dbo.W_Order.Product_confirmed) AS [Day in Prodaction], dbo.CntDay(dbo.W_Order.Compound_RLS, dbo.W_Order.Compound) AS [Day in Compound], 
                      dbo.CntDay(dbo.W_Order.WIU_Arrived, dbo.W_Order.Compound_RLS) AS [Day in Delivery], dbo.CntDay(dbo.W_Order.DLR_Actual_Arrival, 
                      dbo.W_Order.WIU_Arrived) AS [Day at WIU], dbo.CntDay(dbo.W_Order.Sold_to_Client, dbo.W_Order.Log_actual_delivery_dlr) AS [Day at Dlr], 
                      dbo.CntDay(dbo.W_Order.Sold_to_Client, dbo.W_Order.Invoice_Date) AS [Day at Total], dbo.AGING(dbo.W_Order.Compound_RLS, 
                      dbo.W_Order.Compound, dbo.W_Order.Brend) AS [Aging in Compound], dbo.AGING(dbo.W_Order.Sold_to_Client, dbo.W_Order.DLR_Actual_Arrival, 
                      dbo.W_Order.Brend) AS [Aging at Dealer], dbo.AGING(dbo.W_Order.Sold_to_Client, dbo.W_Order.Invoice_Date, dbo.W_Order.Brend) AS [Aging Total], 
                      dbo.W_Order.DLR_Payment AS [Dealer Payment], dbo.W_Order.PMNT_Supplier AS [Payment to Supplier], dbo.W_Order.Brend AS Id_Brand, 
                      dbo.W_Order.Model AS Id_Model, dbo.W_Order.Vers AS Id_Vers, dbo.W_Order.Status AS Id_Status, dbo.W_Order.Payment_Due AS [Payment Due], 
                      dbo.W_Order.Wiou, dbo.W_Order.Kontrakt AS [Date Contract], dbo.W_Order.Date_completed AS [Date Completed], 
                      dbo.W_Order.Start_Production AS [Start Production], dbo.W_Order.Viev, dbo.W_Order.Loc AS Id_Loc, 
                      dbo.W_Order.Payment_Suppl_Date AS Pay_Suppl_Date, dbo.W_Order.Pymnt_DATE AS Pay_Dlr_Date, dbo.W_Order.ID, dbo.W_Order.Note, 
                      dbo.S_Colourk.Kod AS Code_Trim, dbo.W_Pakage.ID AS [Id Package], dbo.W_Pakage.Naz AS [Package Name], 
                      dbo.W_Order.Price_check AS [Dealer Cost Check], dbo.S_Trim_S.Nazv AS [Body Type], dbo.S_Gearbox.Naz AS [Gear Box], dbo.W_Order.PDI AS Plant, 
                      dbo.W_Order.Confirms, dbo.S_Program.NameProgram AS Programm, YEAR(dbo.W_Order.D_zakaza) AS YearZakaz, dbo.S_Brend.Naz AS Name_brand,
                       CASE WHEN [Log_Dat_priem] IS NULL THEN 'N' ELSE 'Y' END AS PDI_Ready, dbo.W_Order.Log_Dat_prib AS [Additional Works Completed], 
                      dbo.Cans(dbo.W_Order.WIU_Arrived, dbo.W_Order.Compound) AS Dif_comp_wiu, dbo.Cans(dbo.W_Order.DLR_Actual_Arrival, 
                      dbo.W_Order.Compound) AS Dif_comp_dlr, dbo.Canv(dbo.W_Order.DLR_Actual_Arrival, dbo.W_Order.WIU_Arrived) AS Dif_wiu_dlr, 
                      dbo.W_Order.Log_actual_delivery_dlr AS First_Dlr_Actual_Arrived, dbo.W_Order.Invoice_Number, dbo.S_Diler.ID AS Expr1, dbo.S_Diler.Code, 
                      dbo.W_Order.Pymnt_SUM_EUR, dbo.W_Order.Pymnt_EUR, dbo.W_Order.Pymnt_MARK, dbo.W_Order.Pymnt_SUM_CURR, 
                      dbo.W_Order.Pymnt_CURR, dbo.W_Order.Pymnt_SUM_TOTAL, dbo.W_Order.Dlr AS Dlr_owner
FROM         dbo.S_Diler AS S_Diler_1 RIGHT OUTER JOIN
                      dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Program ON dbo.W_Order.Optional = dbo.S_Program.IDN LEFT OUTER JOIN
                      dbo.W_Pakage ON dbo.W_Order.Package = dbo.W_Pakage.ID LEFT OUTER JOIN
                      dbo.S_Location ON dbo.W_Order.Loc = dbo.S_Location.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dealer_order_placed = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Type ON dbo.W_Order.OrderType = dbo.S_Type.ID LEFT OUTER JOIN
                      dbo.S_Trim_S ON dbo.W_Order.Trimm = dbo.S_Trim_S.ID LEFT OUTER JOIN
                      dbo.S_Mounth ON dbo.W_Order.Mes_zakaza = dbo.S_Mounth.ID LEFT OUTER JOIN
                      dbo.S_Colours ON dbo.W_Order.Colour = dbo.S_Colours.ID LEFT OUTER JOIN
                      dbo.S_Colourk ON dbo.W_Order.Colours = dbo.S_Colourk.ID ON S_Diler_1.ID = dbo.W_Order.Dlr LEFT OUTER JOIN
                      dbo.S_Engenie ON dbo.W_Order.Engine = dbo.S_Engenie.ID LEFT OUTER JOIN
                      dbo.S_Status ON dbo.W_Order.Status = dbo.S_Status.ID LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Gearbox ON dbo.W_Order.GearBox = dbo.S_Gearbox.ID LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID
WHERE     (dbo.W_Order.Viev = 0)
ORDER BY Id_Brand, [Production Month], [Dealer Order Placed], Loc
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[16] 4[70] 2[2] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1[50] 2[25] 3) )"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1[56] 3) )"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[33] 4[28] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1[28] 4) )"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Diler_1"
            Begin Extent = 
               Top = 201
               Left = 896
               Bottom = 288
               Right = 1056
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 9
               Left = 354
               Bottom = 1221
               Right = 693
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Program"
            Begin Extent = 
               Top = 831
               Left = 14
               Bottom = 939
               Right = 165
            End
            DisplayFlags = 280
            TopColumn = 8
         End
         Begin Table = "W_Pakage"
            Begin Extent = 
               Top = 953
               Left = 12
               Bottom = 1061
               Right = 163
            End
            DisplayFlags = 280
            TopColumn = 1
         End
         Begin Table = "S_Location"
            Begin Extent = 
               Top = 122
               Left = 9
               Bottom = 215
               Right = 170
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 9
               Left = 10
               Bottom = 117
               Right = 170
            End
            DisplayFlags = 280
            TopColumn = 1
         End
         Begin Table = "S_Type"
            Begin Extent = 
               Top = 536
               Left = 11
               Bottom = 644
               Right = 172
            End
            DisplayFlags =' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Status'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N' 280
            TopColumn = 0
         End
         Begin Table = "S_Trim_S"
            Begin Extent = 
               Top = 454
               Left = 9
               Bottom = 532
               Right = 160
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Mounth"
            Begin Extent = 
               Top = 766
               Left = 868
               Bottom = 889
               Right = 1019
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Colours"
            Begin Extent = 
               Top = 332
               Left = 0
               Bottom = 440
               Right = 161
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Colourk"
            Begin Extent = 
               Top = 622
               Left = 869
               Bottom = 730
               Right = 1020
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Engenie"
            Begin Extent = 
               Top = 423
               Left = 669
               Bottom = 578
               Right = 820
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Status"
            Begin Extent = 
               Top = 222
               Left = 0
               Bottom = 330
               Right = 161
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 120
               Left = 667
               Bottom = 193
               Right = 818
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 299
               Left = 671
               Bottom = 419
               Right = 822
            End
            DisplayFlags = 280
            TopColumn = 2
         End
         Begin Table = "S_Gearbox"
            Begin Extent = 
               Top = 651
               Left = 11
               Bottom = 827
               Right = 174
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 9
               Left = 664
               Bottom = 117
               Right = 815
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 86
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Status'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane3', @value=N'
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 8130
         Alias = 4650
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 2565
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Status'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=3 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Status'
GO
/****** Object:  View [dbo].[A_VIC_Report]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_VIC_Report]
AS
SELECT     TOP (100) PERCENT dbo.W_Vic.Id, dbo.S_Position.Description AS Coordinates, dbo.S_Brend.Naz AS Brand, dbo.S_Model.Naz AS Model, 
                      dbo.S_Version.Naz AS Version, dbo.S_Colours.Naz AS [Body Color], dbo.W_Vic.Vin AS [Full VIN], dbo.W_Order.WIU_Arrived AS [WIU Arrived], 
                      dbo.W_Order.Log_Dat_razgr AS [Pdi Order date], dbo.W_Order.Log_Vechicle_Unloaded_VIC AS [Vehicle unloaded at PDI], S_Diler_1.Last_Name AS [Dealer Owner], 
                      CASE indicator WHEN - 1 THEN 'Yes' ELSE '' END AS [Additional works need], dbo.W_Vic.Description AS Damages, 
                      dbo.W_Vic.Date_hold_start AS [Additional Works Completion Date], CASE PDI_ready WHEN 0 THEN 'No' WHEN - 1 THEN 'Yes' ELSE ' ' END AS [Ready ForPDI], 
                      dbo.W_Vic.Brend, dbo.S_Inspector.Fio AS Inspector, dbo.S_Location.Znach, dbo.S_Location.Naz, dbo.S_Position.Col, dbo.S_Position.Row, 
                      dbo.W_Vic.Description_pdi AS Comments, RIGHT(dbo.W_Order.VIN, 8) AS Short_Vin, dbo.W_Vic.Pdi_ready, dbo.W_Order.Log_VIC_departure AS [VIC Departure], 
                      dbo.A_Vic_sub.Indicator, dbo.W_Vic.Qnty, dbo.W_Vic.Date_hold_finish AS PDI_OK, dbo.S_Type.Naz AS Order_type
FROM         dbo.S_Inspector RIGHT OUTER JOIN
                      dbo.S_Location RIGHT OUTER JOIN
                      dbo.S_Type RIGHT OUTER JOIN
                      dbo.W_Order ON dbo.S_Type.ID = dbo.W_Order.OrderType ON dbo.S_Location.ID = dbo.W_Order.Loc RIGHT OUTER JOIN
                      dbo.W_Vic LEFT OUTER JOIN
                      dbo.A_Vic_sub ON dbo.W_Vic.Id = dbo.A_Vic_sub.Ids ON dbo.W_Order.ID = dbo.W_Vic.Id_Order ON dbo.S_Inspector.Id = dbo.W_Vic.Inspector LEFT OUTER JOIN
                      dbo.S_Carrier ON dbo.W_Vic.Carrier = dbo.S_Carrier.ID LEFT OUTER JOIN
                      dbo.S_Position ON dbo.W_Vic.Place = dbo.S_Position.Id LEFT OUTER JOIN
                      dbo.S_Carrier_Avto ON dbo.W_Vic.Car = dbo.S_Carrier_Avto.ID LEFT OUTER JOIN
                      dbo.S_Colours ON dbo.W_Vic.Color_body = dbo.S_Colours.ID LEFT OUTER JOIN
                      dbo.S_Carrier_Driver ON dbo.W_Vic.Driver = dbo.S_Carrier_Driver.ID LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Vic.Brend = dbo.S_Brend.ID LEFT OUTER JOIN
                      dbo.S_Diler AS S_Diler_1 ON dbo.W_Vic.Dlr = S_Diler_1.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Vic.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Vic.Vers = dbo.S_Version.ID
WHERE     (NOT (dbo.W_Order.Log_Vechicle_Unloaded_VIC IS NULL))
ORDER BY Brand
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[48] 4[4] 2[31] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1[50] 2[25] 3) )"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1[56] 3) )"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[48] 4[25] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1[45] 4) )"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Inspector"
            Begin Extent = 
               Top = 473
               Left = 568
               Bottom = 581
               Right = 719
            End
            DisplayFlags = 280
            TopColumn = 1
         End
         Begin Table = "S_Location"
            Begin Extent = 
               Top = 83
               Left = 1048
               Bottom = 176
               Right = 1199
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Type"
            Begin Extent = 
               Top = 311
               Left = 1115
               Bottom = 450
               Right = 1300
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 97
               Left = 834
               Bottom = 767
               Right = 995
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Vic"
            Begin Extent = 
               Top = 12
               Left = 273
               Bottom = 977
               Right = 455
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "A_Vic_sub"
            Begin Extent = 
               Top = 1
               Left = 567
               Bottom = 133
               Right = 718
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Carrier"
            Begin Extent = 
               Top = 233
               Left = 572
               Bottom = 341
               Right = 723
            End
            Display' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_VIC_Report'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'Flags = 280
            TopColumn = 0
         End
         Begin Table = "S_Position"
            Begin Extent = 
               Top = 792
               Left = 13
               Bottom = 970
               Right = 164
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Carrier_Avto"
            Begin Extent = 
               Top = 627
               Left = 0
               Bottom = 735
               Right = 151
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Colours"
            Begin Extent = 
               Top = 349
               Left = 571
               Bottom = 457
               Right = 722
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Carrier_Driver"
            Begin Extent = 
               Top = 462
               Left = 0
               Bottom = 570
               Right = 151
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 17
               Left = 0
               Bottom = 125
               Right = 160
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler_1"
            Begin Extent = 
               Top = 157
               Left = 567
               Bottom = 222
               Right = 727
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 112
               Left = 6
               Bottom = 177
               Right = 166
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 200
               Left = 9
               Bottom = 279
               Right = 160
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 14
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 3885
         Alias = 3330
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_VIC_Report'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_VIC_Report'
GO
/****** Object:  View [dbo].[A_VIC_Preview]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_VIC_Preview]
AS
SELECT     dbo.W_Vic.Id, dbo.W_Vic.Vin, dbo.S_Brend.Naz AS Brendname, dbo.S_Model.Naz AS ModelName, dbo.S_Version.Naz AS VersionName, 
                      dbo.S_Carrier.Naz AS Carriername, dbo.S_Inspector.Fio, dbo.W_Vic.Rls, dbo.W_Vic.Avtovoz, dbo.W_Vic.Act, dbo.W_Vic.Brend, dbo.W_Vic.Flag, 
                      dbo.S_Colours.Naz AS ColorName, dbo.S_Diler.Last_Name AS DlrName, dbo.W_Vic.Description, dbo.W_Vic.Date_hold_start, dbo.W_Vic.Date_hold_finish, 
                      dbo.W_Vic.Date_Repair, dbo.W_Vic.Date_Ready, dbo.W_Vic.Id_Order, dbo.W_Vic.Driver, dbo.S_Carrier_Driver.Fam, dbo.W_Vic.Ttns, 
                      dbo.S_Carrier_Avto.Nom AS CarGosNomer, dbo.S_Position.Description AS Place_description, dbo.S_Position.Col AS Col_description, dbo.W_Vic.Pdi_order_date, 
                      dbo.W_Vic.Description_pdi, dbo.W_Vic.Pdi_ready, dbo.W_Vic.Qnty, dbo.S_Type.Naz AS Order_type
FROM         dbo.S_Type RIGHT OUTER JOIN
                      dbo.W_Order ON dbo.S_Type.ID = dbo.W_Order.OrderType RIGHT OUTER JOIN
                      dbo.W_Vic ON dbo.W_Order.ID = dbo.W_Vic.Id_Order LEFT OUTER JOIN
                      dbo.S_Position ON dbo.W_Vic.Place = dbo.S_Position.Id LEFT OUTER JOIN
                      dbo.S_Carrier_Avto ON dbo.W_Vic.Car = dbo.S_Carrier_Avto.ID LEFT OUTER JOIN
                      dbo.S_Colours ON dbo.W_Vic.Color_body = dbo.S_Colours.ID LEFT OUTER JOIN
                      dbo.S_Carrier_Driver ON dbo.W_Vic.Driver = dbo.S_Carrier_Driver.ID LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Vic.Brend = dbo.S_Brend.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Vic.Dlr = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Vic.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Vic.Vers = dbo.S_Version.ID LEFT OUTER JOIN
                      dbo.S_Carrier ON dbo.W_Vic.Carrier = dbo.S_Carrier.ID LEFT OUTER JOIN
                      dbo.S_Inspector ON dbo.W_Vic.Inspector = dbo.S_Inspector.Id
WHERE     (dbo.W_Vic.Vin IS NOT NULL)
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[57] 4[24] 2[6] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1[68] 4[8] 3) )"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1[56] 3) )"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3) )"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 1
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Type"
            Begin Extent = 
               Top = 307
               Left = 1665
               Bottom = 483
               Right = 1825
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 209
               Left = 1255
               Bottom = 714
               Right = 1526
            End
            DisplayFlags = 280
            TopColumn = 15
         End
         Begin Table = "W_Vic"
            Begin Extent = 
               Top = 7
               Left = 481
               Bottom = 870
               Right = 663
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Position"
            Begin Extent = 
               Top = 492
               Left = 795
               Bottom = 796
               Right = 946
            End
            DisplayFlags = 280
            TopColumn = 1
         End
         Begin Table = "S_Carrier_Avto"
            Begin Extent = 
               Top = 595
               Left = 52
               Bottom = 841
               Right = 203
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Colours"
            Begin Extent = 
               Top = 244
               Left = 48
               Bottom = 352
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 2
         End
         Begin Table = "S_Carrier_Driver"
            Begin Extent = 
               Top = 468
               Left = 49
               Bottom = 576
               Right = 200
            End
        ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_VIC_Preview'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'    DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 15
               Left = 47
               Bottom = 130
               Right = 208
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 132
               Left = 47
               Bottom = 240
               Right = 207
            End
            DisplayFlags = 280
            TopColumn = 3
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 13
               Left = 764
               Bottom = 121
               Right = 924
            End
            DisplayFlags = 280
            TopColumn = 5
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 125
               Left = 786
               Bottom = 256
               Right = 943
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Carrier"
            Begin Extent = 
               Top = 262
               Left = 803
               Bottom = 475
               Right = 958
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Inspector"
            Begin Extent = 
               Top = 354
               Left = 48
               Bottom = 462
               Right = 209
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
      PaneHidden = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 31
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 1830
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_VIC_Preview'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_VIC_Preview'
GO
/****** Object:  View [dbo].[A_Status_New]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Status_New]
AS
SELECT     TOP (100) PERCENT dbo.W_Order.Zakaz AS [Supplier Order], dbo.W_Order.Sorder AS [Common Order], 
                      dbo.W_Order.ProductionMonth AS [Production Month], dbo.S_Diler.Last_Name AS [Dealer Order Placed], dbo.W_Order.Svin AS [Short VIN], 
                      S_Diler_1.Last_Name AS Dlr, dbo.S_Location.Naz AS Loc, dbo.S_Status.Naz AS Status, dbo.S_Model.Naz AS Model, dbo.S_Version.Naz AS Version, 
                      dbo.W_Order.Derivate AS Derivative, dbo.W_Order.VIN AS [Full VIN], dbo.S_Engenie.Naz AS Engine, dbo.W_Order.Spec1, dbo.W_Order.Spec2, 
                      dbo.W_Order.Spec3, LEFT(dbo.W_Order.Options, 2000) AS [Optional Equipment], dbo.S_Colours.Naz AS [Colour Body], dbo.S_Colourk.Naz AS Trim, 
                      dbo.S_Type.Naz AS [Order Type], dbo.W_Order.Comments, dbo.W_Order.MY AS [Model Year], dbo.W_Order.Cif_cip AS [CIF/CIP], 
                      dbo.W_Order.Dealer_price AS [Dealer price], dbo.W_Order.MSRP, dbo.W_Order.OrderPlaced AS [Order Placed], 
                      dbo.W_Order.DeadlineChange AS [Deadline Change], dbo.W_Order.Req AS Reg, dbo.W_Order.Product_confirmed AS [Production Confirmed], 
                      dbo.W_Order.Omdp, dbo.W_Order.Get_release_Date AS [Gate Release], dbo.W_Order.Invoice_Date AS [Invoice Date], 
                      dbo.W_Order.Compound AS [Compound Arrived], dbo.W_Order.RLS AS [RLS #], dbo.W_Order.RLS_placed AS [RLS Placed], 
                      dbo.W_Order.Compound_RLS AS [Compound RLS], dbo.W_Order.Rls_left_compound AS [RLS Left Compound], 
                      dbo.W_Order.WIU_Arrived AS [WIU Arrived], dbo.W_Order.ContractDD AS [Contract Delivery Date], 
                      dbo.W_Order.DLR_Suggested_Arrival AS [DLR Estimated Arrival], dbo.W_Order.DLR_Actual_Arrival AS [DLR Actual Arrival], 
                      dbo.W_Order.Sold_to_DLR AS [Sold to DLR], dbo.W_Order.Sold_to_Client AS [Sold to Client], dbo.CntDay(dbo.W_Order.Invoice_Date, 
                      dbo.W_Order.Product_confirmed) AS [Day in Prodaction], dbo.CntDay(dbo.W_Order.Compound_RLS, dbo.W_Order.Compound) AS [Day in Compound], 
                      dbo.CntDay(dbo.W_Order.WIU_Arrived, dbo.W_Order.Compound_RLS) AS [Day in Delivery], dbo.CntDay(dbo.W_Order.DLR_Actual_Arrival, 
                      dbo.W_Order.WIU_Arrived) AS [Day at WIU], dbo.CntDay(dbo.W_Order.Sold_to_Client, dbo.W_Order.DLR_Actual_Arrival) AS [Day at Dlr], 
                      dbo.CntDay(dbo.W_Order.Sold_to_Client, dbo.W_Order.Invoice_Date) AS [Day at Total], dbo.AGING(dbo.W_Order.Compound_RLS, 
                      dbo.W_Order.Compound, dbo.W_Order.Brend) AS [Aging in Compound], dbo.AGING(dbo.W_Order.Sold_to_Client, dbo.W_Order.WIU_Arrived, 
                      dbo.W_Order.Brend) AS [Aging at Dealer], dbo.AGING(dbo.W_Order.Sold_to_Client, dbo.W_Order.Invoice_Date, dbo.W_Order.Brend) AS [Aging Total], 
                      dbo.W_Order.DLR_Payment AS [Dealer Payment], dbo.W_Order.PMNT_Supplier AS [Payment to Supplier], dbo.W_Order.Brend AS Id_Brand, 
                      dbo.W_Order.Model AS Id_Model, dbo.W_Order.Vers AS Id_Vers, dbo.W_Order.Status AS Id_Status, dbo.W_Order.Payment_Due AS [Payment Due], 
                      dbo.W_Order.Wiou, dbo.W_Order.Kontrakt AS [Date Contract], dbo.W_Order.Date_completed AS [Date Completed], 
                      dbo.W_Order.Start_Production AS [Start Production], dbo.W_Order.Viev, dbo.W_Order.Loc AS Id_Loc, 
                      dbo.W_Order.Payment_Suppl_Date AS Pay_Suppl_Date, dbo.W_Order.Pymnt_DATE AS Pay_Dlr_Date, dbo.W_Order.ID, dbo.W_Order.Note, 
                      dbo.S_Colourk.Kod AS Code_Trim, dbo.W_Order.Confirms, dbo.S_Program.IDN, dbo.S_Program.NameProgram AS Name_Programm, 
                      CASE WHEN [Log_Dat_priem] IS NULL THEN 'N' ELSE 'Y' END AS PDI_Ready, dbo.W_Order.Log_Dat_prib
FROM         dbo.S_Engenie RIGHT OUTER JOIN
                      dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Program ON dbo.W_Order.Optional = dbo.S_Program.IDN LEFT OUTER JOIN
                      dbo.S_Location ON dbo.W_Order.Loc = dbo.S_Location.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dealer_order_placed = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Type ON dbo.W_Order.OrderType = dbo.S_Type.ID LEFT OUTER JOIN
                      dbo.S_Trim_S ON dbo.W_Order.Trimm = dbo.S_Trim_S.ID LEFT OUTER JOIN
                      dbo.S_Mounth ON dbo.W_Order.Mes_zakaza = dbo.S_Mounth.ID LEFT OUTER JOIN
                      dbo.S_Colours ON dbo.W_Order.Colour = dbo.S_Colours.ID LEFT OUTER JOIN
                      dbo.S_Colourk ON dbo.W_Order.Colours = dbo.S_Colourk.ID LEFT OUTER JOIN
                      dbo.S_Diler AS S_Diler_1 ON dbo.W_Order.Dlr = S_Diler_1.ID ON dbo.S_Engenie.ID = dbo.W_Order.Engine LEFT OUTER JOIN
                      dbo.S_Status ON dbo.W_Order.Status = dbo.S_Status.ID LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Gearbox ON dbo.W_Order.GearBox = dbo.S_Gearbox.ID LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID
WHERE     (dbo.W_Order.Viev = 0) AND (NOT (dbo.W_Order.Comments LIKE N'%HIDE%')) OR
                      (dbo.W_Order.Comments IS NULL)
ORDER BY Id_Brand, [Production Month], [Dealer Order Placed], Loc
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[47] 4[10] 2[8] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1[75] 4) )"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 12
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "S_Engenie"
            Begin Extent = 
               Top = 271
               Left = 533
               Bottom = 341
               Right = 684
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 18
               Left = 276
               Bottom = 1230
               Right = 486
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Program"
            Begin Extent = 
               Top = 817
               Left = 5
               Bottom = 1005
               Right = 156
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Location"
            Begin Extent = 
               Top = 112
               Left = 527
               Bottom = 178
               Right = 678
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 137
               Left = 6
               Bottom = 245
               Right = 166
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Type"
            Begin Extent = 
               Top = 467
               Left = 539
               Bottom = 575
               Right = 690
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Trim_S"
            Begin Extent = 
               Top = 607
               Left = 6
               Bottom = 685
               Right = 157
            End
            DisplayFla' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Status_New'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'gs = 280
            TopColumn = 0
         End
         Begin Table = "S_Mounth"
            Begin Extent = 
               Top = 928
               Left = 592
               Bottom = 1036
               Right = 743
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Colours"
            Begin Extent = 
               Top = 492
               Left = 6
               Bottom = 600
               Right = 157
            End
            DisplayFlags = 280
            TopColumn = 1
         End
         Begin Table = "S_Colourk"
            Begin Extent = 
               Top = 349
               Left = 536
               Bottom = 457
               Right = 687
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler_1"
            Begin Extent = 
               Top = 249
               Left = 1
               Bottom = 357
               Right = 161
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Status"
            Begin Extent = 
               Top = 369
               Left = 9
               Bottom = 477
               Right = 160
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 11
               Left = 7
               Bottom = 119
               Right = 158
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 186
               Left = 531
               Bottom = 262
               Right = 682
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Gearbox"
            Begin Extent = 
               Top = 698
               Left = 2
               Bottom = 806
               Right = 153
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 1
               Left = 521
               Bottom = 109
               Right = 672
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
      PaneHidden = 
   End
   Begin DataPane = 
      PaneHidden = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 76
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Status_New'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane3', @value=N'= 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      PaneHidden = 
      Begin ColumnWidths = 11
         Column = 8055
         Alias = 3150
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 2745
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Status_New'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=3 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Status_New'
GO
/****** Object:  StoredProcedure [dbo].[Hours_check]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Ежечасное выполнение процедур в базе
CREATE PROCEDURE [dbo].[Hours_check]
AS

-- Проставление кодов двигателя для Вольво
EXEC U_Code_Engine_Volvo

-- Обновление дат
UPDATE W
SET    W.D_Zakaza = W.OrderPlaced
FROM   W_ORDER   W WITH (NOLOCK)
WHERE  W.D_zakaza IS NULL

-- Обновление пустых дат
UPDATE W
SET    W.DLR_Order_Placed = W.OrderPlaced
FROM   W_ORDER   W WITH (NOLOCK)
WHERE  W.DLR_Order_Placed IS NULL

-- Автомотивские постановки на хранение 
UPDATE w_log_wa SET dlr = 410 WHERE dlr IS NULL

--Просомотр
--select * from w_log_wa WHERE dlr is null

/* При необходимости
UPDATE W
SET    W.OrderType = 1
FROM   W_ORDER   W
WHERE  W.OrderType IS NULL
*/

/*
-- Сообщение по почте 
   DECLARE @NazvanEW Nvarchar(100)
   SELECT  @NazvanEW = 'Пора закачивать оплаты ' --+ CONVERT(CHAR(20), @IDORDER)
   
-- Отсылка сообщений мне напоминаний
   EXEC msdb.dbo.sp_send_dbmail  @profile_name = 'Robot_mail',  
                                 @recipients   = 'asavchenko@winner.ua',   
                                 @body         = @NazvanEW , 
                                 @subject      = 'Data Base Reminder...'
*/

-- Обновление курсов валют в отгрузках для логистики
-- если было пропущено или оформлены документы позже
-- чем установлены курсы
UPDATE T 
   SET T.KURS = K.KURS_E
  FROM W_AVTOVOZ A WITH (NOLOCK),
       W_TTN_SUB T WITH (NOLOCK),
       S_KURS    K WITH (NOLOCK)
 WHERE A.IDN          = T.AVTOVOZ
   AND A.DATE_PLANING = K.DAT
   AND T.KURS IS NULL

-- Постановка 
-- ENABLE TRIGGER  Proverks_price ON [dbo].[W_Order]    -- Если надо разблокировать триггер

-- Сохранение первоначальной даты прибытия к дилеру машины
-- и сохранение этой даты не меняя ее никогда
-- Подготовка данных для отдела Форд по просьбе Шевчука
-- в поле Day at Dlr - учавствует это же поле в запросе A_Status
-- Дата 09-08-2010 время 9:39
 
UPDATE W_ORDER 
WITH  (ROWLOCK)
SET    Log_actual_delivery_dlr = dlr_actual_arrival 
WHERE  Log_actual_delivery_dlr IS NULL

/*
IF @@ROWCOUNT > 0
   BEGIN
        PRINT 'OБРАБОТАНО'
   END

*/
--SELECT ID,Log_actual_delivery_dlr , dlr_actual_arrival  FROM W_ORDER 
--UPDATE  W_ORDER SET Log_actual_delivery_dlr=NULL WHERE ID=24705
GO
/****** Object:  View [dbo].[A_Unloadcar]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Unloadcar]
AS
SELECT     TOP (100) PERCENT dbo.W_Ttn_Sub.Ttn, dbo.A_View.Brand_name, dbo.A_View.Model, dbo.A_View.Version, dbo.A_View.VIN, dbo.S_Diler.Last_Name, 
                      dbo.W_Ttn_Sub.Zakaz, dbo.W_Ttn_Sub.Price, dbo.W_Ttn_Sub.Act, dbo.W_Ttn_Sub.Act_Date, dbo.W_Ttn_Sub.Acc_Number, dbo.W_Ttn_Sub.Acc_Date, 
                      dbo.W_Ttn_Sub.Acc_Sum, dbo.A_View.Zakaz AS [Order], dbo.W_Ttn_Sub.Avtovoz, dbo.S_Carrier.Naz, dbo.A_View.Brend, dbo.A_View.I_status, 
                      dbo.W_Ttn_Sub.Closing, dbo.W_Ttn_Sub.Idd, dbo.W_Ttn_Sub.Act_Received, dbo.W_Ttn_Sub.Act_Printed, dbo.W_Ttn_Sub.Vubor, dbo.W_Ttn_Sub.Dlr, 
                      MONTH(dbo.W_Ttn_Sub.Act_Date) AS MMonth, DATEDIFF(DAY, dbo.W_Ttn_Sub.Act_Date, dbo.W_Ttn_Sub.Act_Received) AS Days, dbo.S_Diler.Sokr AS Dlr_FullName, 
                      dbo.W_Ttn_Sub.Type, dbo.S_Delivery_type.Naz AS Description_Delivery, dbo.W_Ttn.P_navantaj, dbo.W_Ttn.P_razvant, YEAR(dbo.W_Ttn_Sub.Act_Date) 
                      AS Year_delivery, dbo.W_Ttn_Sub.Kurs
FROM         dbo.W_Ttn_Sub LEFT OUTER JOIN
                      dbo.W_Ttn ON dbo.W_Ttn_Sub.Ttn = dbo.W_Ttn.Num LEFT OUTER JOIN
                      dbo.S_Delivery_type ON dbo.W_Ttn_Sub.Type = dbo.S_Delivery_type.ID LEFT OUTER JOIN
                      dbo.A_View ON dbo.W_Ttn_Sub.Zakaz = dbo.A_View.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Ttn_Sub.Dlr = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Carrier ON dbo.W_Ttn_Sub.Carrier = dbo.S_Carrier.ID
ORDER BY dbo.W_Ttn_Sub.Ttn, dbo.A_View.Brend, dbo.A_View.I_status
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[29] 4[2] 2[2] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Ttn_Sub"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 398
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 2
         End
         Begin Table = "W_Ttn"
            Begin Extent = 
               Top = 14
               Left = 377
               Bottom = 119
               Right = 557
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Delivery_type"
            Begin Extent = 
               Top = 472
               Left = 374
               Bottom = 587
               Right = 556
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "A_View"
            Begin Extent = 
               Top = 123
               Left = 375
               Bottom = 231
               Right = 555
            End
            DisplayFlags = 280
            TopColumn = 3
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 235
               Left = 373
               Bottom = 343
               Right = 551
            End
            DisplayFlags = 280
            TopColumn = 57
         End
         Begin Table = "S_Carrier"
            Begin Extent = 
               Top = 354
               Left = 373
               Bottom = 462
               Right = 554
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 29
         Width = 284
         Width = 1500
         Width = ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Unloadcar'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'1500
         Width = 1500
         Width = 1500
         Width = 2820
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 840
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 2940
         Alias = 1860
         Table = 2085
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Unloadcar'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Unloadcar'
GO
/****** Object:  View [dbo].[A_Unloadcar_report]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Unloadcar_report]
AS
SELECT     TOP (100) PERCENT dbo.W_Ttn_Sub.Idd, dbo.S_Diler.Last_Name AS Dealer, dbo.A_View.Brand_name AS Brand, dbo.A_View.Model, 
                      dbo.A_View.Version, dbo.A_View.VIN, dbo.W_Ttn_Sub.Act AS [Act Number], dbo.W_Ttn_Sub.Act_Date AS [Bailment open], dbo.A_View.Brend, 
                      dbo.S_Diler.ID, dbo.W_Ttn_Sub.Closing AS [Bailment Close], dbo.W_Ttn_Sub.Zakaz AS [Wiu Order], dbo.W_Ttn_Sub.Price AS [Bailment value], 
                      dbo.W_Ttn_Sub.Act_Received AS [Act received by WIU], DATEDIFF(DAY, dbo.W_Ttn_Sub.Act_Date, dbo.W_Ttn_Sub.Act_Received) AS Days
FROM         dbo.W_Ttn_Sub LEFT OUTER JOIN
                      dbo.A_View ON dbo.W_Ttn_Sub.Zakaz = dbo.A_View.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Ttn_Sub.Dlr = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Carrier ON dbo.W_Ttn_Sub.Carrier = dbo.S_Carrier.ID
ORDER BY Dealer, Brand, dbo.A_View.Model, dbo.A_View.Version, dbo.A_View.VIN, [Act Number]
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[42] 4[11] 2[4] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Ttn_Sub"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 319
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 5
         End
         Begin Table = "A_View"
            Begin Extent = 
               Top = 2
               Left = 352
               Bottom = 115
               Right = 562
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 128
               Left = 352
               Bottom = 236
               Right = 566
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Carrier"
            Begin Extent = 
               Top = 239
               Left = 352
               Bottom = 347
               Right = 566
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 16
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 2085
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 4830
         Alias = 3255
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Unloadcar_report'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 3240
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Unloadcar_report'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Unloadcar_report'
GO
/****** Object:  View [dbo].[A_Unloadedcar_2]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Unloadedcar_2]
AS
SELECT     TOP (100) PERCENT dbo.W_Ttn_Sub.Ttn, dbo.A_View.Brand_name, dbo.A_View.Model, dbo.A_View.Version, dbo.A_View.VIN, dbo.S_Diler.Last_Name, 
                      dbo.W_Ttn_Sub.Zakaz, dbo.W_Ttn_Sub.Price, dbo.W_Ttn_Sub.Act, dbo.W_Ttn_Sub.Act_Date, dbo.W_Ttn_Sub.Acc_Number, dbo.W_Ttn_Sub.Acc_Date, 
                      dbo.W_Ttn_Sub.Acc_Sum, dbo.A_View.Zakaz AS [Order], dbo.W_Ttn_Sub.Avtovoz, dbo.S_Carrier.Naz, dbo.A_View.Brend, dbo.A_View.I_status, 
                      dbo.W_Ttn_Sub.Closing, dbo.W_Ttn_Sub.Idd, dbo.W_Ttn_Sub.Act_Received, dbo.W_Ttn_Sub.Act_Printed, dbo.W_Ttn_Sub.Vubor, dbo.W_Ttn_Sub.Dlr, 
                      MONTH(dbo.W_Ttn_Sub.Act_Date) AS MMonth, DATEDIFF(DAY, dbo.W_Ttn_Sub.Act_Date, dbo.W_Ttn_Sub.Act_Received) AS Days, 
                      dbo.S_Diler.Sokr AS Dlr_FullName, dbo.W_Ttn_Sub.Type, dbo.S_Delivery_type.Naz AS Description_Delivery, dbo.W_Ttn.P_navantaj, 
                      dbo.W_Ttn.P_razvant, YEAR(dbo.W_Ttn_Sub.Act_Date) AS Year_delivery, MAX(dbo.W_Ttn.Num) AS Expr1
FROM         dbo.W_Ttn_Sub LEFT OUTER JOIN
                      dbo.W_Ttn ON dbo.W_Ttn_Sub.Ttn = dbo.W_Ttn.Num LEFT OUTER JOIN
                      dbo.S_Delivery_type ON dbo.W_Ttn_Sub.Type = dbo.S_Delivery_type.ID LEFT OUTER JOIN
                      dbo.A_View ON dbo.W_Ttn_Sub.Zakaz = dbo.A_View.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Ttn_Sub.Dlr = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Carrier ON dbo.W_Ttn_Sub.Carrier = dbo.S_Carrier.ID
GROUP BY dbo.W_Ttn_Sub.Ttn, dbo.A_View.Brand_name, dbo.A_View.Model, dbo.A_View.Version, dbo.A_View.VIN, dbo.S_Diler.Last_Name, 
                      dbo.W_Ttn_Sub.Zakaz, dbo.W_Ttn_Sub.Price, dbo.W_Ttn_Sub.Act, dbo.W_Ttn_Sub.Act_Date, dbo.W_Ttn_Sub.Acc_Number, dbo.W_Ttn_Sub.Acc_Date, 
                      dbo.W_Ttn_Sub.Acc_Sum, dbo.A_View.Zakaz, dbo.W_Ttn_Sub.Avtovoz, dbo.S_Carrier.Naz, dbo.A_View.Brend, dbo.A_View.I_status, 
                      dbo.W_Ttn_Sub.Closing, dbo.W_Ttn_Sub.Idd, dbo.W_Ttn_Sub.Act_Received, dbo.W_Ttn_Sub.Act_Printed, dbo.W_Ttn_Sub.Vubor, dbo.W_Ttn_Sub.Dlr, 
                      MONTH(dbo.W_Ttn_Sub.Act_Date), DATEDIFF(DAY, dbo.W_Ttn_Sub.Act_Date, dbo.W_Ttn_Sub.Act_Received), dbo.S_Diler.Sokr, dbo.W_Ttn_Sub.Type, 
                      dbo.S_Delivery_type.Naz, dbo.W_Ttn.P_navantaj, dbo.W_Ttn.P_razvant, YEAR(dbo.W_Ttn_Sub.Act_Date)
ORDER BY dbo.W_Ttn_Sub.Ttn, dbo.A_View.Brend, dbo.A_View.I_status
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Ttn_Sub"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 319
               Right = 189
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Ttn"
            Begin Extent = 
               Top = 9
               Left = 329
               Bottom = 117
               Right = 480
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Delivery_type"
            Begin Extent = 
               Top = 302
               Left = 376
               Bottom = 380
               Right = 527
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "A_View"
            Begin Extent = 
               Top = 57
               Left = 712
               Bottom = 165
               Right = 922
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 143
               Left = 369
               Bottom = 251
               Right = 529
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Carrier"
            Begin Extent = 
               Top = 131
               Left = 205
               Bottom = 239
               Right = 356
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 33
         Width = 284
         Width = 1500
         Width = 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Unloadedcar_2'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Unloadedcar_2'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Unloadedcar_2'
GO
/****** Object:  View [dbo].[A_Ts_grouping_department]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Ts_grouping_department]
AS
SELECT     TOP (100) PERCENT dbo.W_Timesheet.Company, dbo.S_Company.Naz AS [Company Name], dbo.W_Timesheet.Department, 
                      dbo.S_Department.Naz AS [Department Name], dbo.Min_hoursmin(SUM(dbo.W_Timesheet.Totalmin)) AS Hours_min
FROM         dbo.W_Timesheet LEFT OUTER JOIN
                      dbo.S_Department ON dbo.W_Timesheet.Department = dbo.S_Department.ID LEFT OUTER JOIN
                      dbo.S_Company ON dbo.W_Timesheet.Company = dbo.S_Company.Id
GROUP BY dbo.W_Timesheet.Company, dbo.W_Timesheet.Department, dbo.S_Company.Naz, dbo.S_Department.Naz
ORDER BY dbo.W_Timesheet.Company, dbo.W_Timesheet.Department
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Timesheet"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 274
               Right = 218
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Department"
            Begin Extent = 
               Top = 101
               Left = 285
               Bottom = 186
               Right = 452
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Company"
            Begin Extent = 
               Top = 0
               Left = 289
               Bottom = 93
               Right = 456
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 3660
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_grouping_department'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_grouping_department'
GO
/****** Object:  View [dbo].[A_Ts_grouping_category]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Ts_grouping_category]
AS
SELECT     TOP (100) PERCENT dbo.W_Timesheet.Company, dbo.S_Company.Naz AS [Company Name], dbo.W_Timesheet.Department, 
                      dbo.S_Department.Naz AS [Department Name], dbo.W_Timesheet.Category, dbo.S_Categoriy.Naz AS [Category Description], 
                      dbo.Min_hoursmin(SUM(dbo.W_Timesheet.Totalmin)) AS Hours_min, dbo.W_Timesheet.Week_namber
FROM         dbo.W_Timesheet LEFT OUTER JOIN
                      dbo.S_Categoriy ON dbo.W_Timesheet.Category = dbo.S_Categoriy.ID LEFT OUTER JOIN
                      dbo.S_Department ON dbo.W_Timesheet.Department = dbo.S_Department.ID LEFT OUTER JOIN
                      dbo.S_Company ON dbo.W_Timesheet.Company = dbo.S_Company.Id
GROUP BY dbo.W_Timesheet.Company, dbo.W_Timesheet.Department, dbo.S_Company.Naz, dbo.S_Department.Naz, dbo.W_Timesheet.Category, 
                      dbo.S_Categoriy.Naz, dbo.W_Timesheet.Week_namber
ORDER BY dbo.W_Timesheet.Company, dbo.W_Timesheet.Department, dbo.W_Timesheet.Category
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[41] 4[32] 2[8] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Timesheet"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 327
               Right = 218
            End
            DisplayFlags = 280
            TopColumn = 4
         End
         Begin Table = "S_Categoriy"
            Begin Extent = 
               Top = 221
               Left = 433
               Bottom = 299
               Right = 600
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Department"
            Begin Extent = 
               Top = 97
               Left = 423
               Bottom = 205
               Right = 590
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Company"
            Begin Extent = 
               Top = 0
               Left = 424
               Bottom = 93
               Right = 591
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 2610
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_grouping_category'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_grouping_category'
GO
/****** Object:  View [dbo].[A_Ts_grouping_empl]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Ts_grouping_empl]
AS
SELECT     TOP (100) PERCENT dbo.W_Timesheet.Company, dbo.W_Timesheet.Department, dbo.W_Timesheet.Employee, 
                      dbo.Min_hoursmin(SUM(dbo.W_Timesheet.Totalmin)) AS Hours_min, dbo.S_Company.Naz AS [Company Name], 
                      dbo.S_Department.Naz AS [Department Name], dbo.W_Timesheet.Task_id, dbo.S_Task.Naz AS [Task Description], dbo.W_Timesheet.Category, 
                      dbo.S_Categoriy.Naz AS [Category Description], dbo.S_User.Fio AS [Employee Name], dbo.W_Timesheet.Week_namber
FROM         dbo.W_Timesheet LEFT OUTER JOIN
                      dbo.S_User ON dbo.W_Timesheet.Employee = dbo.S_User.ID LEFT OUTER JOIN
                      dbo.S_Categoriy ON dbo.W_Timesheet.Category = dbo.S_Categoriy.ID LEFT OUTER JOIN
                      dbo.S_Task ON dbo.W_Timesheet.Task_id = dbo.S_Task.Id LEFT OUTER JOIN
                      dbo.S_Department ON dbo.W_Timesheet.Department = dbo.S_Department.ID LEFT OUTER JOIN
                      dbo.S_Company ON dbo.W_Timesheet.Company = dbo.S_Company.Id
GROUP BY dbo.W_Timesheet.Company, dbo.W_Timesheet.Department, dbo.W_Timesheet.Employee, dbo.S_Company.Naz, dbo.S_Department.Naz, 
                      dbo.W_Timesheet.Task_id, dbo.S_Task.Naz, dbo.W_Timesheet.Category, dbo.S_Categoriy.Naz, dbo.S_User.Fio, 
                      dbo.W_Timesheet.Week_namber
ORDER BY dbo.W_Timesheet.Company, dbo.W_Timesheet.Department, dbo.W_Timesheet.Employee
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[47] 4[32] 2[4] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Timesheet"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 393
               Right = 333
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_User"
            Begin Extent = 
               Top = 182
               Left = 468
               Bottom = 290
               Right = 635
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Categoriy"
            Begin Extent = 
               Top = 261
               Left = 468
               Bottom = 339
               Right = 635
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Task"
            Begin Extent = 
               Top = 308
               Left = 473
               Bottom = 416
               Right = 640
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Department"
            Begin Extent = 
               Top = 101
               Left = 471
               Bottom = 178
               Right = 638
            End
            DisplayFlags = 280
            TopColumn = 2
         End
         Begin Table = "S_Company"
            Begin Extent = 
               Top = 0
               Left = 468
               Bottom = 93
               Right = 635
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 3360
  ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_grouping_empl'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'       Alias = 2100
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_grouping_empl'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_grouping_empl'
GO
/****** Object:  View [dbo].[A_Ts_grouping_task]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Ts_grouping_task]
AS
SELECT     TOP (100) PERCENT dbo.W_Timesheet.Company, dbo.W_Timesheet.Department, dbo.Min_hoursmin(SUM(dbo.W_Timesheet.Totalmin)) AS Hours_min, 
                      dbo.S_Company.Naz AS [Company Name], dbo.S_Department.Naz AS [Department Name], dbo.W_Timesheet.Task_id, 
                      dbo.S_Task.Naz AS [Task Description], dbo.W_Timesheet.Category, dbo.S_Categoriy.Naz AS [Category Description]
FROM         dbo.W_Timesheet LEFT OUTER JOIN
                      dbo.S_Categoriy ON dbo.W_Timesheet.Category = dbo.S_Categoriy.ID LEFT OUTER JOIN
                      dbo.S_Task ON dbo.W_Timesheet.Task_id = dbo.S_Task.Id LEFT OUTER JOIN
                      dbo.S_Department ON dbo.W_Timesheet.Department = dbo.S_Department.ID LEFT OUTER JOIN
                      dbo.S_Company ON dbo.W_Timesheet.Company = dbo.S_Company.Id
WHERE     (dbo.W_Timesheet.Week_namber = 18)
GROUP BY dbo.W_Timesheet.Company, dbo.W_Timesheet.Department, dbo.S_Company.Naz, dbo.S_Department.Naz, dbo.W_Timesheet.Task_id, 
                      dbo.S_Task.Naz, dbo.W_Timesheet.Category, dbo.S_Categoriy.Naz
ORDER BY dbo.W_Timesheet.Company, dbo.W_Timesheet.Department
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Timesheet"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 326
               Right = 218
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Categoriy"
            Begin Extent = 
               Top = 207
               Left = 344
               Bottom = 285
               Right = 511
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Task"
            Begin Extent = 
               Top = 284
               Left = 342
               Bottom = 392
               Right = 509
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Department"
            Begin Extent = 
               Top = 95
               Left = 345
               Bottom = 203
               Right = 512
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Company"
            Begin Extent = 
               Top = 0
               Left = 347
               Bottom = 93
               Right = 514
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 12
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
    ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_grouping_task'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'     Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_grouping_task'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Ts_grouping_task'
GO
/****** Object:  StoredProcedure [dbo].[Vic_insert_new]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Дата создания      : 24-04-2009
Дата обновления    : 05-05-2009
Описание процедуры : Cинхронизация таблиц логитики и VIC 
                     Добавление новых машин из W_ORDER которых нет в системе VIC 
                     Данную процедуру необходимо зупускать для добавления новых машин
                     при открытии окна VIC
История            : Добавлена возможность обновления только новых заказов в последних автовозах

Применение 
EXEC  Vic_insert_new
*/

CREATE PROCEDURE [dbo].[Vic_insert_new]
AS

/*
 DELETE FROM W_VIC
 Добавление недостающих заказов из основной таблицы W_order в W_vic 
*/
INSERT INTO [W_Vic]
           ([Id_Order]
           ,[Brend]
           ,[Model]
           ,[Vers]
           ,[Color_body]
           ,[Dlr]
           ,[Vin]
           ,[Invoice]
           ,[Rls]
           ,[Flag]
           ,[Description]
           ,[Days_vic]
           ,[Days_incoming]
           ,[Days_actual_ship]
           ,[Days_deference]
           ,[Qty_vechicles]
           ,[Qty_ok])
    SELECT W_Order.Id,
           W_Order.Brend, 
           W_Order.Model, 
           W_Order.Vers , 
           W_Order.Colour , 
           W_Order.Dlr, 
           W_Order.Vin, 
           W_Order.Invoice_Number,
           W_Order.Rls, 
           W_Order.Status, 
           '',
           0 ,
           0 ,
           0 ,
           0 ,  
           0 ,
           0   
    FROM   W_Order WITH (NOLOCK)  LEFT JOIN W_Vic 
    ON     W_Order.ID = W_Vic.Id_Order
    WHERE (((W_Vic.Id_Order) Is Null)) 
    -- AND   Status < 9


-- UPDATE W_Vic   set [Description]=''


/*
  Обновление таблицы VIC данными из таблицы Логистики 
  где максимальные номера автовозов проставляються в таблицу VIC
  так как машина перемещалась несколько раз а номер автовоза должен
  быть наибольшим 
*/
UPDATE W_Vic  
SET    W_Vic.Numb_acc = W_TTN_SUB.ttn , 
       W_Vic.Avtovoz  = (SELECT MAX(Avtovoz) FROM W_TTN_SUB WHERE  W_Vic.Id_Order = W_TTN_SUB.Zakaz), 
       W_Vic.Carrier  = W_TTN_SUB.Carrier
FROM   W_Ttn_sub        WITH (NOLOCK)
WHERE  W_Vic.Id_Order = W_TTN_SUB.Zakaz


-- Обновление ТТН
UPDATE W_Vic  
SET    W_Vic.Ttns = W_Avtovoz.Remarks  
FROM   W_Avtovoz        WITH (NOLOCK)
WHERE  W_Vic.Avtovoz = W_Avtovoz.Idn

-- Обновление данных от Инны
EXEC Vic_update_avtovoz
GO
/****** Object:  StoredProcedure [dbo].[Parts_create_wiu]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
   Процедура формирования справочника импортера 
   1. Создание справочника импортера и его актуализация (обновление количества на складе)
   2. Вызов процедуры добавления инфолрмации от дилеров
   3. Закачка таблицы соответствия  (время выполнения 2 мин 41 сек) (2 min 59 sec)
   
   EXEC Parts_create_wiu 1   -- Обновление информации с LGpresen.txt с созданием справочника
   EXEC Parts_create_wiu 2   -- Обновление информации с LGpresen.txt без создания справочника
*/


CREATE PROCEDURE [dbo].[Parts_create_wiu] (@Updatestock INT)
AS

-- Процедура создания линкованного файла
/*
1) Create a directory for the text files. I chose E:\txtsrv
2) Add this as a linked server
EXEC sp_addlinkedserver txtsrv, 'Jet 4.0','Microsoft.Jet.OLEDB.4.0','e:\txtsrv',NULL,'Text'

3) Put an empty text file in this directory (I used empty.txt).
You can do this with master..xp_cmdshell, but I didn't. You
can't do CREATE TABLE on the linked server.

4) Create a schema.ini file to describe how this file should
represent your table. One schema.ini file is used for all the
tables of the linked server.

This is my schema.ini:

[empty.txt]
Format=FixedLength
ColNameHeader=True
Col1=CustomerNumber Long Width 11
Col2=CustomerName Text Width 30
Col3=CustomerDate DateTime Width 25

5) Populate the text-table, replacing the filename's . with # for the table name.
insert into txtsrv...empty#txt(CustomerNumber, CustomerName,CustomerDate) select orderid, customerid, orderdate from northwind..orders order by customerid
select * from OpenRowset('MSDASQL', 'Driver={Microsoft Text Driver (*.txt; *.csv)};DefaultDir=D:\txtsrv;','select * from MyText.txt')


SELECT * FROM S_brend                          -- Справочник брендов
SELECT * FROM S_diler WHERE LAST_NAME='WIU'    -- Справочник дилеров
SELECT * FROM W_PARTS                          -- Просомтр запчастей
SELECT * FROM S_Currensy                       -- Справочник валют 

-- Первоначальное обнуление справочника запчастей
 DELETE FROM W_PARTS WHERE DEALER = 424 -- and date_update < '2010-10-07'

-- TRUNCATE TABLE W_PARTS
*/

--TRUNCATE TABLE W_PARTS
--DELETE FROM W_PARTS


-- id Importers WIU
DECLARE @IDIMPORTER INT
DECLARE @Dollar     MONEY    -- доллар (840)
DECLARE @Phunt      MONEY    -- фунт   (372)
DECLARE @Euro       MONEY    -- евро   (978)
DECLARE @Sek        MONEY    -- Крона  (752)
DECLARE @Maxdata    MONEY    -- Максимальная дата


IF @Updatestock = 1 
   BEGIN
      -- Первоначальное обнуление справочника запчастей
        DELETE FROM W_PARTS WHERE DEALER = 424 -- and date_update < '2010-10-07'

        -- SELECT @Maxdata = MAX([DATE]) FROM S_Rate
        -- Определение куросов на самую свежую дату в таблице курсов валют
        -- SELECT * FROM S_rate WHERE [DATE] = (SELECT MAX([DATE]) FROM S_Rate)
        SELECT @Dollar = Rate_ed FROM S_rate WHERE Code='840' AND [DATE] = (SELECT MAX([DATE]) FROM S_Rate)
        SELECT @Phunt  = Rate_ed FROM S_rate WHERE Code='372' AND [DATE] = (SELECT MAX([DATE]) FROM S_Rate)
        SELECT @Euro   = Rate_ed FROM S_rate WHERE Code='978' AND [DATE] = (SELECT MAX([DATE]) FROM S_Rate)
        SELECT @Sek    = Rate_ed FROM S_rate WHERE Code='752' AND [DATE] = (SELECT MAX([DATE]) FROM S_Rate)

        -- Определение кода импортера
        SELECT  @IDIMPORTER = ID FROM S_DILER WHERE LAST_NAME='WIU'

        -- Форд европейский (1)
        -- Формирование справочника по европейскому форду (EUR=978)
        INSERT W_PARTS (Articul, Descript, Brand, Date_update, Dealer,       Notes,      Qty, Comments, Price_imp, Price_opt, Price_roz, Currency)
        SELECT          Ctcode,  Partno,   1,     GETDATE(),   @IDIMPORTER,  finis_code , 0 , Tax_code, List,      Base1,     Base2, 'EUR' 
        FROM OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)};DBQ=c:\nas\IT\_Out\Arthur\Partsdbf;SourceType=DBF','SELECT * FROM E_Ford')   

        -- Форд европейский (1)
        -- Формирование справочника по американскому форду (USD=840)
        INSERT W_PARTS (Articul, Descript, Brand, Date_update, Dealer,       Notes, Qty, Price_imp, Price_opt, Price_roz, Currency)
        SELECT          Ctcode,  Partno,   1,     GETDATE(),   @IDIMPORTER,  Note , 0 ,  List,      Base1,     Base2 , 'USD'
        FROM OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)};DBQ=c:\nas\IT\_Out\Arthur\Partsdbf;SourceType=DBF','SELECT * FROM Naao')      
 
        -- Volvo (2)
        -- Формирование справочника по VOLVO (SEK=752)
        INSERT W_PARTS (Articul, Descript, Brand, Date_update, Dealer,       Notes,    Qty, Price_imp, Price_opt, Price_roz, Currency)
        SELECT          Ctcode,  Partno,   2,     GETDATE(),   @IDIMPORTER,  [Desc] ,  0 ,  List,      Base1,     Base2 , 'SEK'
        FROM OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)};DBQ=c:\nas\IT\_Out\Arthur\Partsdbf;SourceType=DBF','SELECT * FROM volvo')     

        -- Jaguar (3)
        -- Формирование справочника по Jaguar (IEP=372) Phunt
        INSERT W_PARTS (Articul, Descript, Brand, Date_update, Dealer,       Notes,    Qty, Price_imp, Price_opt, Price_roz, Currency)
        SELECT          Ctcode,  Partno,   3,     GETDATE(),   @IDIMPORTER, [Desc] ,   0 ,  List,      Base1,     Base2 , 'IEP'
        FROM OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)};DBQ=c:\nas\IT\_Out\Arthur\Partsdbf;SourceType=DBF','SELECT * FROM Jaguar')    

        -- Lrover (4)
        -- Формирование справочника по Lrover (IEP=372) Phunt
        INSERT W_PARTS (Articul, Descript, Brand, Date_update, Dealer,      Notes,    Qty, Price_imp, Price_opt, Price_roz, Currency)
        SELECT          Ctcode,  Partno,   4,     GETDATE(),   @IDIMPORTER, [Desc] ,  0 ,  List,      Base1,     Base2 , 'IEP'
        FROM OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)};DBQ=c:\nas\IT\_Out\Arthur\Partsdbf;SourceType=DBF','SELECT * FROM Lrover')      

        -- Porsche (5)
        -- Формирование справочника по Porsche
        INSERT W_PARTS (Articul, Descript, Brand, Date_update, Dealer,       Notes,  Qty, Price_imp, Price_opt, Price_roz, Currency)
        SELECT          Ctcode,  Partno,   5,     GETDATE(),   @IDIMPORTER, [Desc],  0 ,  List,      Base1,     Base2, 'Eur' 
        FROM OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)};DBQ=c:\nas\IT\_Out\Arthur\Partsdbf;SourceType=DBF','SELECT * FROM Porsche')      
 END
 
/*
-- Просмотр файлов от производителей (Кухарь)
SELECT * FROM OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)};DBQ=c:\nas\IT\_Out\Arthur\Partsdbf;SourceType=DBF','SELECT * FROM E_Ford')   -- Форд европейский
SELECT * FROM OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)};DBQ=c:\nas\IT\_Out\Arthur\Partsdbf;SourceType=DBF','SELECT * FROM Naao')     -- Форд американский
SELECT * FROM OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)};DBQ=c:\nas\IT\_Out\Arthur\Partsdbf;SourceType=DBF','SELECT * FROM Volvo')    -- Вольво
SELECT * FROM OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)};DBQ=c:\nas\IT\_Out\Arthur\Partsdbf;SourceType=DBF','SELECT * FROM Jaguar')   -- Ягуар
SELECT * FROM OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)};DBQ=c:\nas\IT\_Out\Arthur\Partsdbf;SourceType=DBF','SELECT * FROM lrover')   -- Ленд Ровер
SELECT * FROM OPENROWSET('MSDASQL','Driver={Microsoft dBase Driver (*.dbf)};DBQ=c:\nas\IT\_Out\Arthur\Partsdbf;SourceType=DBF','SELECT * FROM Porsche')  -- Порше
*/

-- Актуализация данных по импортеру количества на складе и наименования
-- Обновление колличества данных на складе и даты обновления
UPDATE W 
SET    W.QTY          = L.CTACCESSIBLE,       -- L.IDERIVATION
       W.Date_update  = GETDATE()             -- текущая дата обновления
FROM   W_PARTS W,
OpenRowset('MSDASQL', 'Driver={Microsoft Text Driver (*.txt; *.csv)}; DefaultDir=C:\nas\parts\db;','SELECT * FROM LgPresen.txt') L
WHERE  W.ARTICUL = L.INOMNUM
AND    W.DEALER  = 424


-- Обновление описания запчастей
UPDATE w_parts SET Descript = Notes, Date_update  = GETDATE() WHERE DEALER = 424 AND Notes IS NOT NULL AND Brand IN (2,5)

UPDATE w_parts set Date_update  = GETDATE() WHERE DEALER = 424

-- Пустые записи 0
UPDATE w_parts SET Qty = 0 WHERE Qty IS NULL 

-- Удаление записей без признака дилера
DELETE FROM w_parts WHERE Dealer IS NULL

-- Обновление описания запчастей у диллеров согласно списка импортера (26 сек)
UPDATE W
SET    W.DESCRIPT = A.DESCRIPT
FROM   W_PARTS W, A_PARTS_WIU A
WHERE  W.ARTICUL = A.ARTICUL
AND    W.BRAND   = A.BRAND

-- UPDATE W SET    W.date_update = GETDATE() FROM   W_PARTS W
-- SELECT * FROM W_PARTS WHERE  Date_update> GETDATE() QTY>0
-- SELECT * FROM A_PARTS WHERE QTY>0
-- 
-- Обязательное пристутствие файла INI в директории с описанием структуры типоов полей
-- SELECT * FROM OpenRowset('MSDASQL', 'Driver={Microsoft Text Driver (*.txt; *.csv)}; DefaultDir=C:\nas\temp;','SELECT * FROM LgPresen.txt')
-- SELECT * FROM OpenRowset('MSDASQL', 'Driver={Microsoft Text Driver (*.txt; *.csv)}; DefaultDir=C:\External;','select top 5 * from Mytext.txt')
-- select * INTO Staging from OpenRowset('MSDASQL','Driver={Microsoft Text Driver (*.txt; *.csv)};DefaultDir=C:\nas\temp\;IMEX=1;','select * from LgPresen.txt') 
-- select * from Staging
-- SELECT * INTO txtmport FROM OPENROWSET(''Microsoft.Jet.OLEDB.4.0'',''Text;Database=C:STUDIESsql_serveropenrowset_txt_to_sql'',''SELECT * FROM dts_2_11012005.txt'') 
-- SELECT * INTO txtmport FROM OPENROWSET('Microsoft.Jet.OLEDB.4.0','Text;Database=C:\nas\temp','SELECT * FROM LgPresen.txt') 

-- Чтение МDB
-- SELECT * FROM  OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0', 'Data Source="C:\nas\temp\z.mdb"; User ID=Admin;Password=' )...w_loaded
-- SELECT * FROM  OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0', 'Data Source="C:\nas\temp\z.mdb"; User ID=Admin;Password=' )...LgPresen

-- Просмотр одного поля в тестовом файле
-- SELECT * FROM OpenRowset('MSDASQL', 'Driver={Microsoft Text Driver (*.txt; *.csv)};DefaultDir=C:\nas\temp;','select * from LgPresen.txt')

-- Не пробовал
-- SELECT o.* from OPENROWSET('MSDASQL', 'DRIVER={Microsoft Excel Driver (*.xls)}',  '<<filename>>';uid='';pwd='','select * from [1]')

-- bulk insert ##tbl from '\\[computername]\c$\tbl.txt' with (FIRSTROW=1)
-- create table tbl(nn char(30), nm char(30))
-- bulk insert tbl from 'e:\tbl.txt' with (FIRSTROW=1)
-- delete from tbl
-- ALTER TABLE  TBL ADD NM81 CHAR(50)
-- BULK INSERT tbl FROM 'e:\tbl.txt' WITH  (FIELDTERMINATOR ='|',  ROWTERMINATOR ='| \n'  )
-- BULK INSERT tbl FROM 'e:\tbl.txt' WITH  (FIELDTERMINATOR =' ',  ROWTERMINATOR ='\n'  )

/*
BULK INSERT tbl 
FROM 'e:\tbl.txt' 
WITH  (FIELDTERMINATOR =';',        -- разделитель между столбцами
       ROWTERMINATOR ='\n',         -- конец строки
       CODEPAGE =  'ACP',           -- кодировка страницы
       firstrow =6  )               -- строка с которой первой будет производится закачка

--DELETE FROM tbl

BULK INSERT tbl 
FROM 'e:\aaa.txt' 
WITH  (FIELDTERMINATOR =';',        -- разделитель между столбцами
       ROWTERMINATOR ='\n',         -- конец строки
       CODEPAGE =  'ACP')           -- кодировка страницы
                                    -- строка с которой первой будет производится закачка
--select * from tbl

--DELETE FROM dlr_payment
--SELECT * FROM dlr_payment


--SELECT * FROM OPENDATASOURCE('Microsoft.Jet.OLEDB.4.0','Data Source=C:\NAS\TEMP;Extended Properties="Text;HDR=Yes;FMT=Delimited  " ')...LgPresen#txt
--SELECT * FROM OpenDataSource( 'Microsoft.Jet.OLEDB.4.0', 'Data Source=c:\nas\temp;Extended properties="Text;HDR=yes"')...LgPresen#txt 

--select *  from OpenDataSource( 'Microsoft.Jet.OLEDB.4.0', 'Data Source=c:\nas\temp; Extended properties="Text; FMT=Delimited; HDR=yes; CODEPAGE=ACP; IMEX=2; CharacterSet=437"')...LgPresen2#txt 

--SELECT * FROM OpenDataSource('Microsoft.Jet.OLEDB.4.0', 'Data Source=c:\nas\temp; Extended properties="Text; FMT=Delimited; HDR=yes;codepage="')...LgPresen#txt 

--CODEPAGE = { 'ACP'| 'OEM'| 'RAW'| 'code_page' }
--Delimited """
--asc,csv,tab,txt
--SELECT 'Text1.txt' AS FileName, '.txt' AS FileType,  * FROM OPENROWSET(BULK N'C:\nas\temp\LgPresen.txt', SINGLE_BLOB) AS Document;
--SELECT   FROM OPENROWSET(BULK N'C:\nas\temp\LgPresen.txt', SINGLE_BLOB) AS Document;

--use finance

BULK INSERT LgPresen
FROM 'C:\nas\temp\LgPresen.txt' 
WITH  (FIELDTERMINATOR  = 'TAB',      -- разделитель между столбцами
       ROWTERMINATOR    = '\n',       -- конец строки
       CODEPAGE         = 'ACP',      -- кодировка страницы
       firstrow         = 1  )        -- строка с которой первой будет производится закачка

BULK 
FROM 'C:\nas\temp\LgPresen.txt' 
WITH  (FIELDTERMINATOR ='',         -- разделитель между столбцами
       ROWTERMINATOR   ='\n',       -- конец строки
       CODEPAGE        ='ACP',      -- кодировка страницы
       firstrow        =1 )         -- строка с которой первой будет производится закачка


--"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\\;Extended Properties='text;FMT=Delimited(;);HDR=No'";
SELECT * FROM OPENROWSET ('MSDASQL','Driver={Microsoft Text Driver (*.txt; *.csv)}; DefaultDir=c:\nas\temp;','select * from LgPresen.txt')
SELECT   * FROM OPENROWSET(BULK N'C:\nas\temp\LgPresen.txt', SINGLE_BLOB) AS Document;

--Sign In to VoteI created a schema.ini file, with all the format specifiactions for my source file. 
--Here is the code for that. However, when I import, it most of the data is imported fine, except for when the value has "" in the data.  
--eg if the data has value such as 'pending "store" ', it imports the data as only "pending", and omits the store..
--Here is my specificaiton of the schema file
---------------------

[vwConstrLendingmapLoanDefiCdDesc.txt]
ColNameHeader=False
Format=TabDelimited
MaxScanRows=0
CharacterSet=ANSI
Col1=Doccd Char Width 50
Col2=Docdesc LongChar
Col3=Docshcd Char Width 100

---- And this is the openrowset:
--   select *  from OpenRowset('MSDASQL', 'Driver={Microsoft Text Driver (*.txt; *.csv)};  DefaultDir=\\c:\SQLRSReports;','select   * from vwConstrLendingmapLoanDefiCdDesc.txt') 
--   select * from w_parts


-- Просмотр текстового файла 
select * from OpenRowset('MSDASQL', 'Driver={Microsoft Text Driver (*.txt; *.csv)}; DefaultDir=C:\nas\parts\db;','SELECT * FROM LgPresen.txt') 

*/
GO
/****** Object:  StoredProcedure [dbo].[Add_Package]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
 Процедура     : Cоздание инвойса для машины на основании пакета (Конфигурирование автомобиля обновление пакета в выбранном заказе)
 Дата          : 10-07-2008
 Время         : 17:06
 Автор         : Савченко Артур
 Организация   : Winner Imports Ukraine, LTD.
 Корректировка : 10-10-2008 16:37
 История       : 10-10-2010 16:37  
               - Доработана новя версия
               - Добавлена проверка наличия основных данных
               - Проверка пустых пакетов
               - Устраненна ошибка записи в лог  
               
               15-10-2010 19:08 
               -- Корретировка вычислений скидок 102 код Присич Юля
               -- 
               

 Remark        : Конфигурирование автомоиля из справочника пакетов а так же заполнение опциями автомобиля
  
 Q :  Необходимо продумать переброску конфигурации и заполнения с одного авто на другое для ускоренного формирования заказа
 USE FUNCTION 
 Просмотр заказа по номеру  :  SELECT MODEL, VERS, TRIMM, GEARBOX, MY, SPEC1, SPEC2, SPEC3, DERIVATE, PACKAGE, CIF_CIP, DEALER_PRICE, MSRP  FROM W_ORDER  WHERE ID=36919
 Проверка пакета по номеру  :  SELECT d, Cod, Naz, Exw, 0, Exw, Note, 1  FROM  W_PAKAGE_SUB  WHERE  zakaz = @Package
 Проверка инвойса по номеру :  SELECT  Id_Invoice, Code, Naz, [Sum], Discount, Total_sum, Remarks, Valute  FROM W_INVOICE_SUB  WHERE ID_INVOICE=36919
 Пример использования       :  EXEC Add_Package 1, 36919, 3
 Пример использования       :  Бренд, ИД заказа, Номер Пакета  EXEC Add_Package 1, 29881, 28
 
*/
CREATE PROCEDURE [dbo].[Add_Package]   @Brand     INT ,      -- ID Brand
                                      @Ord       INT ,      -- ID Order
                                      @Package   INT        -- ID Package
AS
-- Если выдается ошибка то можно отключить триггер 
-- Отключение триггера
-- DISABLE TRIGGER PerCount ON W_Invoice_sub
-- Инициализация переменных
DECLARE @NAMEUSER        NVARCHAR(20)           -- имя пользователя
DECLARE @NAMEHOST        NVARCHAR(20)           -- имя компьютера
DECLARE @NAMEMODEL       NVARCHAR(30)           -- модель автомобиля  
DECLARE @NAMEMY          NVARCHAR(30)           -- модельный год
DECLARE @NAMENGINE       NVARCHAR(30)           -- Наименование двигателя
DECLARE @COLORK          NVARCHAR(40)           -- Цвет кузова
DECLARE @COLORT          NVARCHAR(40)           -- Цвет салона
DECLARE @TS              MONEY                  -- Общая сумма
DECLARE @P_Cifcip        MONEY                  -- Cумма СIF-CIP
DECLARE @P_Dc            MONEY                  -- Cумма Dealer Cost
DECLARE @P_Msrp          MONEY                  -- Cумма Msrp
DECLARE @MAXVERPAC       INT                    -- Максимальная версия пакета
DECLARE @Insurance       MONEY                  -- Стоимсоть страховки
DECLARE @Freichate       MONEY                  -- Стоимость доставки
DECLARE @Country         Nvarchar(30)           -- Название страны доставки
DECLARE @Compaund        Nvarchar(100)          -- Название компаунда доставки
DECLARE @Brend           INT                    -- Brand
DECLARE @Model           INT                    -- Model
DECLARE @Vers            INT                    -- Version
DECLARE @Engine          INT                    -- Engine
DECLARE @Maxorder        INT                    -- Max number order
DECLARE @Colour          INT                    -- Id Color Body
DECLARE @Colours         INT                    -- Id Trim
DECLARE @IDBODYTYPE      INT                    -- Id Bodytype
DECLARE @ENGINENAME      NVARCHAR(100)          -- Наименование двигателя в куб. см.
DECLARE @VIN             NVARCHAR(17)           -- Номер VIN Code
DECLARE @DIS_BRANDN      NVARCHAR(50)           -- Наименование скидка для бренда
DECLARE @DIS_BRANDV      MONEY                  -- Значение скидки для бренда
DECLARE @DIS_MODELN      NVARCHAR(50)           -- Наименование скидка для модели
DECLARE @DIS_MODELV      MONEY                  -- Значение скидки для модели
DECLARE @DISCOUNT        MONEY                  -- Скидка
DECLARE @ZNACH           MONEY                  -- Расчетная сумма
DECLARE @SUMBASE         MONEY                  -- Сумма базы
DECLARE @SUMOPT          MONEY                  -- Сумма опций
DECLARE @ENGINEVOL       INT                    -- Количество кубических сантиметров в двигателе
DECLARE @VES             NVARCHAR(17)           -- Вес автомобиля
DECLARE @Pakage          INT                    -- Id Package
DECLARE @Invoice_data    SMALLDATETIME          -- Invoice Date
DECLARE @Invoice_number  NVARCHAR(40)           -- Invoice Number
DECLARE @Gearbox         INT                    -- Id Transmission (Gearbox) коробка передач
DECLARE @Body            INT                    -- Id Body
DECLARE @Sum_option      MONEY                  -- Сумма всех опций (100)
DECLARE @BS              MONEY                  -- Общая сумма базы производителя без скидки
DECLARE @PRICE_CHECK     DATETIME               -- Проверка даты

-- Заполнение конфигурации машины из справочника выбранного пакета
-- Цены обновляются по следующему алгоритму :
-- Cif-Cip     - по последнему Order Guide
-- Dc, Msrp    - по последнему Price List
-- Опеределение пользователя и машины в сети
SET @NAMEUSER = CONVERT(NVARCHAR(40), SYSTEM_USER)
SET @NAMEHOST = CONVERT(NVARCHAR(40), HOST_NAME())
 
 -- Опреление параметров машины в заказе
SELECT @Brend          = Brend,          -- Бренд
       @Model          = Model,          -- Модель
       @Vers           = Vers,           -- Версия
       @Engine         = Engine,         -- Двигатель
       @NAMEMY         = My,             -- Год производства  
       @Colour         = Colour,         -- Цвет кузова 
       @Colours        = Colours,        -- Цвет оббивки 
       @VIN            = VIN,            -- VIN Code
       @Pakage         = Package,        -- Номер пакета
       @Invoice_data   = Invoice_date,   -- Дата инвойса
       @Invoice_number = Invoice_number, -- Номер инвойса 
       @Gearbox        = Gearbox,        -- Id Transmission
       @Body           = Trimm,          -- Id Body
       @PRICE_CHECK    = Price_check     -- Проверка цены
  FROM W_Order 
 WHERE ID              = @Ord

-- Страховка и доставка
/*
-- Cтарый вариант
SELECT @Insurance = D.Insurance,     -- Стоимость страховки 
       @Freichate = D.Freight,       -- Стоимость доставки
       @Country   = C.Name_ang,      -- Страна производства
       @Compaund  = D.Naz,           -- Компаунд
       @Ves       = D.Notes          -- Вес автомобиля 
  FROM S_Delivery   D,
       S_Country_2  C
 WHERE D.Brand          = @Brend
   AND D.Model          = @Model
   AND D.Country_origin = C.Idd
*/

-- Новый вариант
SELECT @Insurance = Insurance,     -- Стоимость страховки 
       @Freichate = Freight  ,     -- Стоимость доставки
       @Country   = Country  ,     -- Страна производства
       @Compaund  = Compound ,     -- Компаунд
       @Ves       = Ves            -- Вес автомобиля 
FROM   A_Weight
WHERE  Vers       = @Vers          -- Версия
  AND  Body       = @Body          -- Тип кузова

-- Запрет обработки уже проверенного заказа в финансовом отделе
--IF @PRICE_CHECK IS NULL
--   BEGIN
      --Запись об ошибке в тело инвойса
      --INSERT  W_OPTION (Zakaz,Brand,Model,Vers,Sokr,Naz,Cods) VALUES(@ORD,@BRAND,@MODEL,@VERS,'ERR','Number pack is empty !!! ',0)
      --  RAISERROR('Нельзя менять цену заказа',-1,-1, N'sysadmin')
      --RAISERROR ('Обратитесь в отдел ценообразования', 16, 1)
      
 --       RETURN 1
 --  END

-- Проверка установки пакета
IF @Pakage IS NULL
   BEGIN
      --Запись об ошибке в тело инвойса
      --INSERT  W_OPTION (Zakaz,Brand,Model,Vers,Sokr,Naz,Cods) VALUES(@ORD,@BRAND,@MODEL,@VERS,'ERR','Number pack is empty !!! ',0)
        RAISERROR('Отсутствует номер пакета ',-1,-1, N'sysadmin')
        RETURN 1
   END
   
-- Проверка наличия VIN кода
IF @VIN IS NULL
   BEGIN
    -- Запись об ошибке в тело инвойса
    -- INSERT  W_OPTION (Zakaz,Brand,Model,Vers,Sokr,Naz,Cods) VALUES(@ORD,@BRAND,@MODEL,@VERS,'ERR','VIN Code is empty !!! ',0)
       RAISERROR('Для инвойса нужен вин код',-1,-1, N'sysadmin')
       RETURN 1
   END

-- Проверка наличия даты инвойса
IF @Invoice_data IS NULL
   BEGIN
      --Запись об ошибке в тело инвойса
      --INSERT  W_OPTION (Zakaz,Brand,Model,Vers,Sokr,Naz,Cods) VALUES(@ORD,@BRAND,@MODEL,@VERS,'ERR','Date Invoice is empty !!! ',0)
        RAISERROR('Для инвойса нужна дата инвойса',-1,-1, N'sysadmin')
        RETURN 1
   END

-- Проверка наличия номера инвойса
IF @Invoice_number  IS NULL
   BEGIN
      --Запись об ошибке в тело инвойса
      --INSERT  W_OPTION (Zakaz,Brand,Model,Vers,Sokr,Naz,Cods) VALUES(@ORD,@BRAND,@MODEL,@VERS,'ERR','Number Invoice is empty !!! ',0)
        RAISERROR('Для инвойса нужен номер инвойса',-1,-1, N'sysadmin')
        RETURN 1
   END

-- Начало транзакции
BEGIN TRANSACTION Outerinvoice

-- Удаление предыдущих данных по опциям в подчиненной таблице
DELETE FROM W_OPTION WHERE ZAKAZ=@Ord

/*
-- Обновление конфигурации машины согласно пакета
UPDATE W 
SET    W.Model         = P.Model ,                       -- Model
       W.Vers          = P.Vers,                         -- Version
       W.Trimm         = P.Trimm,                        -- Body Type (Door)
       W.Engine        = P.Engine ,                      -- Engine
       W.Gearbox       = P.Gearbox ,                     -- Gear Box
       W.My            = YEAR(GETDATE()),                -- Model Year   (текущий год)
       W.Spec1         = P.Spec1,                        -- Special 1
       W.Spec2         = P.Spec2,                        -- Special 2
       W.Spec3         = P.Spec3 ,                       -- Special 3
       W.Derivate      = P.Derevative ,                  -- Derivative
       W.Package       = P.ID,                           -- Пакеты
       W.Cif_Cip       = P.Cif_Cip,                      -- Price CIF-CIP
       W.Dealer_price  = P.Dealer_Cost,                  -- Price DC
       W.Msrp          = P.Msrp                          -- Price MSRP
FROM   W_ORDER  W,                                       -- Заказы  
       W_PAKAGE P                                        -- Пакеты 
WHERE  W.ID            = @Ord                            -- ИД заказа
  AND  W.Brend         = @Brand                          -- Бренд
  AND  P.ID            = @Package                        -- ИД пакета
  AND  P.ID            = W.Package                       -- ИД пакета !??? (TO DO)
*/

-- Заполнение данных для инвойса
-- (2) Добавление модели
INSERT W_OPTION (Zakaz,Sokr,Naz,Exw,Remark,Cods) SELECT @Ord,'MOD','MODEL  : '+UPPER(NAZ),0,'',2 FROM S_MODEL WITH (NOLOCK) WHERE ID=@Model

-- (3) Добавление модельного года
-- INSERT W_OPTION (Zakaz,Sokr,Naz,Exw,Remark,Cods) SELECT @Ord,'MDY','MODEL YEAR : '+CONVERT(NVARCHAR(4),@NAMEMY),0,'',3 FROM W_ORDER WITH (NOLOCK) WHERE ID=@ORD

-- (3) Добавление трансимиссии (коробки передач) 
INSERT W_OPTION (Zakaz,Sokr,Naz,Exw,Remark,Cods) SELECT @Ord,'TRM', 'TRANSMISSION : ' + UPPER(NAZ),0,'',3  FROM S_Gearbox WHERE ID=@Gearbox

-- Автоматическое определение номера года (8 символ в VIN Code говорит о номере года)
SET @VIN = '20' + DBO.CHARYEAR(SUBSTRING(@VIN, 11, 1))

-- (4) Год производства автомобиля
INSERT W_OPTION  (Zakaz, Sokr, Naz, Exw, Remark, Cods) SELECT @Ord,  'PRY', 'PRODUCTION YEAR : '+ISNULL(@VIN,'Unknown Year'),0,'',4 FROM W_ORDER WITH (NOLOCK) WHERE ID = @ORD

-- Добавление наименование двигателя 
-- INSERT W_OPTION  (Zakaz, Sokr, Naz, Exw, Remark, Cods) SELECT @Ord, 'ENG', 'ENGINE : ' + UPPER(Naz), 0, '', 4 FROM  S_ENGENIE WITH  (NOLOCK) WHERE  ID = @Engine

-- (5) Двигатель и его объем (кубические сантиметры (ENGINE NAME & CC))
SELECT @ENGINENAME  =  D.NAZ,                 -- Наименование двигателя
       @ENGINEVOL   =  D.VOL                  -- Объем двигателя в кубических сантиметрах  
  FROM W_ORDER         W  WITH (NOLOCK),
       S_ENGENIE       D  WITH (NOLOCK)
 WHERE W.ENGINE     =  D.ID  
   AND W.ID         =  @ORD

--INSERT  W_OPTION (Zakaz, Brand, Model, Vers, Sokr, Naz, Cods, Exw, Note)
--VALUES (@ORD, @BRAND, @MODEL, @VERS, 'ENG', 'ENGINE : (' + CONVERT(NVARCHAR(4),DBO.VOL_ENG_FORD(@ENGINENAME)) + ' CC)  ' + UPPER(@ENGINENAME)   , 5, 0, DBO.VOL_ENG_FORD(@ENGINENAME))
INSERT W_OPTION(Zakaz,Brand,Model,Vers,Sokr,Naz,Cods,Exw,Note) VALUES(@ORD,@BRAND,@MODEL,@VERS,'ENG','ENGINE : '+UPPER(@ENGINENAME)+' (' + CONVERT(NVARCHAR(4), @ENGINEVOL) + ' CC)  ',5,0,'Engine' )

-- (6) Добавление количества мест для COMBI NEW 6 или 9
-- Пока заблокированно 
-- INSERT  W_OPTION (Zakaz,Brand,Model,Vers,Sokr,Naz,Cods) VALUES(@ORD,@BRAND,@MODEL,@VERS,'SEAT','COUNT REAR SEAT : ', 6)

-- Проверка количества записей в пакете и если он не содержит опций прекращение дальней шего формирования инвойса
IF (SELECT COUNT(*) FROM W_Pakage_Sub WITH (NOLOCK) WHERE Zakaz=@Package) = 0
   BEGIN
     -- Удаление предыдущих вычислений если пакте нулевой - (не содержит записей опций)
     -- DELETE FROM W_OPTION WHERE Zakaz = @Ord
        RAISERROR('Sorry Packet is Empty !',-1,-1, N'sysadmin')
        RETURN 1     -- Прекращение дальнейшей обработки пакета
   END
   
-- Определение последней версии в выбранном пакете
SELECT  @Maxorder=MAX(Vers) FROM  W_Pakage_Sub WITH (NOLOCK) WHERE Zakaz=@Package

-- Определение стоимости пакета по трем ценам
SELECT @P_Cifcip = Exw, 
       @P_Msrp   = Msrp,
       @P_Dc     = Dlr  
FROM   W_PAKAGE_SUB 
WHERE  Zakaz     = @Package 
  AND  Vers      = @Maxorder
  AND  Cod       = 'Base' 
  
-------------------------------------------------------------------------------------------
-- (100) Заполенение опций из пакета  
-------------------------------------------------------------------------------------------
INSERT W_OPTION (Zakaz,Sokr,Naz,Exw,Remark,Note,Cods) 
SELECT @Ord,UPPER(Cod),UPPER(Naz),Exw,Exw AS Total_Sum,'',100 
FROM   W_PAKAGE_SUB WITH (NOLOCK) 
WHERE  Zakaz = @Package 
AND    Vers  = @Maxorder

-- Перевод в первую позицию базы автомобиля присвоением кода
UPDATE W_OPTION SET CODS=1, NOTE='Base' WHERE  SOKR='BASE' AND ZAKAZ=@Ord

-- Сумма базы
SELECT @SUMBASE=SUM(ISNULL(EXW,0)) FROM W_OPTION WITH (NOLOCK) WHERE Zakaz=@Ord AND Cods=1

-- (101) Cумма всего пакета
SELECT @ZNACH=SUM(ISNULL(EXW,0)) FROM  W_OPTION WITH (NOLOCK) WHERE  Zakaz = @Ord -- AND  Cods = 100

-- Перезапись суммы базы со скидкой
UPDATE W_OPTION SET EXW = @SUMBASE - @ZNACH * 0.08 WHERE ZAKAZ = @Ord AND Cods=1

-- Определение скидок по бренду
SELECT  @DIS_BRANDN = Discount_remark, @DIS_BRANDV = Discount_value FROM S_BREND WITH (NOLOCK) WHERE ID = @BRAND 

-- (101) Если есть скидки по бренду
   IF @DIS_BRANDV ! = 0
      BEGIN
           SET     @DIS_BRANDV = @DIS_BRANDV * -1 
           INSERT  W_OPTION (Zakaz,Brand,Model,Vers,Sokr,Naz,Exw,Cods,Note) 
           VALUES (@ORD,@BRAND,@MODEL,@VERS,'DBRD',@DIS_BRANDN,@DIS_BRANDV,101,'Discount Brand')
      END

-- Определение скидок по модели
SELECT @DIS_MODELN=Discount_remark, @DIS_MODELV=Discount_value FROM S_MODEL WITH (NOLOCK) WHERE BREND=@BRAND AND ID=@MODEL

-- (102) Если есть скидка по модели
   IF @DIS_MODELV ! = 0
      BEGIN
           SET     @DIS_MODELV = @DIS_MODELV * -1 
           INSERT  W_OPTION (Zakaz, Brand, Model,  Vers,  Sokr,    Naz,         Exw ,        Remark,      Cods,  Note)  
           VALUES           (@ORD, @BRAND, @MODEL, @VERS, 'DMDL',  @DIS_MODELN, @DIS_MODELV, @DIS_MODELV, 102,  'Discount Model')
      END

-- (103) Добавление цвета кузова
INSERT W_OPTION (Zakaz,Sokr,Naz,Exw,Remark,Cods) SELECT @Ord,'COLB', 'COLOR BODY : '+UPPER(NAZ),0,'',103 FROM S_COLOURS WITH (NOLOCK) WHERE ID=@Colour

-- (104) Добавление цвета салона и оббивки
INSERT W_OPTION (Zakaz,Sokr,Naz,Exw,Remark,Cods) SELECT  @Ord,'TRIM','TRIM : '+UPPER(Naz),0,'',104  FROM S_COLOURK WITH (NOLOCK) WHERE ID=@Colours

-- EXWORKS со скидкой 0.92 (8 %) в будующем необходимо эту велечину брать со справочника
SELECT  @TS =SUM(ISNULL(Exw,0)) FROM W_OPTION WITH (NOLOCK) WHERE Zakaz = @Ord

-- 0. Скидка 8 процентов (договоренность с производителем Форд) для других нет
--    Определяется из глобального справочника настроек   0.92 т.е. 
IF @BRAND = 1
   BEGIN 
        SELECT @DISCOUNT = Znach FROM S_Tuning WITH (NOLOCK) WHERE ID=23 
   END
ELSE
   BEGIN 
        SELECT @DISCOUNT = 1 
   END
   
-- Cумма для вычисления скидки
SELECT @ZNACH = SUM(isnull(EXW,0)) FROM W_OPTION  WITH (NOLOCK) WHERE  Zakaz = @Ord AND CODS < 105

-- Сумма всех опций (подсчет общей суммы 100)
SELECT @Sum_option = SUM(ISNULL(Exw,0)) + @SUMBASE FROM  W_OPTION  WHERE  ZAKAZ = @ORD   AND  Cods IN (100) 

-- (105) Cкидка 
INSERT W_OPTION  (Zakaz,Sokr,Naz,Exw,Discount,Remark,Cods) VALUES (@Ord, 'EXW', 'EXWORKS', @ZNACH, 8, @Sum_option ,105)

-- (106) FREIGHT CHARGES (стоимость доставка автомобиля берется из справочника)
INSERT W_OPTION  (Zakaz,Sokr,Naz,Exw,Remark,Cods)  VALUES (@Ord,'FRC','FREIGHT CHARGES',@Freichate, @Freichate, 106)

-- (107) INSURANCE (стоимость страховки берется из справочника)
-- INSERT W_OPTION  (Zakaz, Sokr, Naz, Exw, Remark, Cods)  VALUES (@Ord, 'INS', 'INSURANCE', @TS /100 * @Insurance, '', 107)
INSERT W_OPTION  (Zakaz, Sokr, Naz, Exw, Remark, Cods) VALUES (@Ord,'INS','INSURANCE',@Insurance,@Insurance,107)

-- (108) COUNTRY OF ORIGIN (берется из справочника)
INSERT W_OPTION  (Zakaz,Sokr,Naz,Exw,Remark,Cods) VALUES (@Ord,'CONT','COUNTRY OF ORIGIN : ' + UPPER(@Country),0,'',108)

-- Id weight 
/*
SELECT  @IDBODYTYPE = TRIMM   FROM  W_ORDER   WITH (NOLOCK) WHERE  BREND = @BRAND  AND  ID=@ORD
-- WEIGHT (определение веса автомобиля со справочника)
INSERT W_OPTION (Zakaz,    Brand,    Model,    Vers,    Sokr,  Naz,  Cods, Exw, Note)
SELECT TOP 1       @ORD, @BRAND, @MODEL, @VERS, 'WGT', 'WEIGHT (KG.) : ' + CONVERT(NVARCHAR(4), VES), 109, 0, CONVERT(NVARCHAR(4), VES)
  FROM S_TRIM  
  WITH (NOLOCK)
 WHERE BRAND   = @BRAND 
   AND MODEL   = @MODEL 
   AND VERSION = @VERS
   AND BODY    = @IDBODYTYPE
--SELECT *  FROM S_TRIM 
--SELECT *  FROM S_delivery

INSERT W_OPTION (Zakaz,  Brand,  Model,  Vers,  Sokr,   Naz, Cods, Note) 
VALUES (@Ord,   @BRAND, @MODEL, @VERS, 'WGT', 'WEIGHT (KG.) : ' + CONVERT(NVARCHAR(20), @Freichate ) , 109,  'WEIGHT')
*/

-- (109) WEIGHT (определение веса автомобиля со справочника)
INSERT W_OPTION (Zakaz,  Brand,  Model,  Vers,  Sokr,   Naz, Cods, Note) VALUES (@Ord,   @BRAND, @MODEL, @VERS, 'WGT', 'WEIGHT (KG.) : ' +  @Ves , 109,  'WEIGHT')

-- Обнулить пустые записи (тромозит)
UPDATE W_OPTION SET Remark = 0  WHERE Zakaz = @Ord AND Remark IS NULL
UPDATE W_OPTION SET EXW    = 0  WHERE Zakaz = @Ord AND EXW IS NULL
  
-- TOTAL SUM (подсчет общей суммы инвойса = EXWORKS 105 + FREIGHT CHARGES 106 + INSURANCE 107)
SELECT @TS = SUM(Exw) FROM  W_OPTION  WHERE  ZAKAZ = @ORD   AND  Cods IN (105,106,107)

-- Подсчет суммы цен производителя
SELECT @BS = SUM(Remark) FROM  W_OPTION WHERE Zakaz = @Ord AND Cods IN (102,105,106,107)
  
-- (200) Запись общих суммы производителя и расчетной
INSERT W_OPTION  (Zakaz, Sokr, Naz, Exw, Remark, Cods) VALUES (@Ord, 'TOTAL','FCA ' + UPPER(@Compaund), @TS, @BS, 200)

-- Смена порядка следования в инвойсе
UPDATE W_OPTION SET CODS = 7 WHERE Zakaz = @Ord AND Cods = 5
UPDATE W_OPTION SET CODS = 5 WHERE Zakaz = @Ord AND Cods = 101
UPDATE W_OPTION SET CODS = 6 WHERE Zakaz = @Ord AND Cods = 102

-- Обновление в заказе цен заказу Price_chek =  GETDATE() - только для сотрудников отдела ценообразования
UPDATE W_ORDER SET Cif_cip = ISNULL(@BS,0), Dealer_price = ISNULL(@P_dc,0) , Msrp = ISNULL(@P_Msrp,0)  WHERE ID = @Ord

-- Проверка расчитываемых данных
-- UPDATE W_OPTION SET NOTES = @P_MSRP  WHERE Zakaz = @Ord AND Cods = 200

-- Запись о проделанной работе в лог - таблице 
EXEC WRITE_LOG 'Automat', 'Created Invoice # ', @Ord, Default, @Package,  @NAMEHOST

-- Проведение транзакции
COMMIT TRANSACTION Outerinvoice

-- Включение триггера после проведенных работ
-- Выключение триггера позволяет ускорить процесс вставки большого количества заказов
-- ENABLE TRIGGER PerCount ON W_Invoice_sub

-- Настройки программы
-- SELECT * FROM S_TUNING
-- SELECT * FROM w_option
-- alter table w_option add Notes nvarchar (200)
-- ALTER TABLE w_option ALTER COLUMN REMARK MONEY
GO
/****** Object:  StoredProcedure [dbo].[Upd_Packs]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*  
    Name.........:  Upd_Packs  
    Author.......:  Savchenko Arthur
    Organization.:  Winner Imports Ukraine, Ltd
    Description..:  Обновление цен в разрезе пакетов
    Date.........:  06.06.2008 10:07
    Usage........:  EXEC Upd_Packs DEFAULT, 656, 20000, 20000
                    EXEC Upd_Packs 2, 656, 20000, 20000
                    EXEC Upd_Packs 1, 656, 20000, 20000   
*/
CREATE PROCEDURE [dbo].[Upd_Packs] (@Brand  Int ,                -- Brand (Default Ford)
                                   @Packs  Int,                 -- Number Packets
                                   @DC     Money,               -- Dealer Cost
                                   @Msrp   Money)               -- MSRP Price
AS
SET NOCOUNT ON
DECLARE @OPIS NVARCHAR(50)


--BEGIN
--BEGIN TRANSACTION T001
   -- Обновление пакетов 
      UPDATE W_ORDER 
      SET    Dealer_Price = @DC, 
             MSRP         = @MSRP 
      WHERE  Brend        = @Brand 
      AND    Package      = @Packs               -- Пкет  
      AND    Status       < 9                    -- кроме проданных

SET @OPIS = 'Update Packs Sucsefull. Count = ' + CONVERT(NVARCHAR(10),@@ROWCOUNT)

-- Анализ выполнения запроса с регистрацией в лог файле результата
--IF @@TRANCOUNT > 0
 --  BEGIN
        EXEC WRITE_LOG 'Savchenko', @OPIS, @@TRANCOUNT, Default, @DC, 'Automat'
        --ROLLBACK TRANSACTION T001
   --END
--ELSE
  -- BEGIN
    --    EXEC WRITE_LOG 'USER', 'Update Packs Error - Rollback', 0, Default,'Error','Error'
        --COMMIT TRANSACTION T001
   --END
--END

--select package, msrp, dealer_price from w_order where brend=1
GO
/****** Object:  StoredProcedure [dbo].[Change_presold]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
    Процедура корректировки ордер тайпа по истечении
    10 дней контракта и 15 дней со дня прихода к дилеру
    статус машины = 8 и ордер тайп тоже 8 
    
    Sample usege : EXEC Change_presold 1
*/

CREATE PROCEDURE [dbo].[Change_presold] @Brand  Int = 1
AS
-- Инициализация переменных 
DECLARE @COUNTCAR   INT               -- Количество обработанных машин
DECLARE @SOOBCHEN   VARCHAR(100)      -- Сообщение для оповещения
DECLARE @tableHTML  NVARCHAR(MAX)     -- Для формирования сообщения в НTML сообщении

-- Подготовка сообщения для дальнейшего использования
SET @SOOBCHEN = 'Vehicle Order Type Changed Automatically '

-- Определение есть ли вообще машины на сегодня по таким условиям
-- если есть то сначала делаем запись в лог файле и после этого
-- происходит отсылка сообщения пользователям системы
SELECT @COUNTCAR = COUNT(*) 
FROM   W_ORDER 
WHERE  Brend     = @Brand 
AND    Status    = 8
AND    OrderType = 8
AND    DATEDIFF(DAY, Kontrakt,           GETDATE()) > 10
AND    DATEDIFF(DAY, Dlr_actual_arrival, GETDATE()) > 15

-- Количество обработанных записей
-- SET @COUNTCAR = @@ROWCOUNT 

-- Отсылка сообщения Пилипчук об аннулированных машинах если были такие вообще
-- отсылка сообщения и мне для контроля 
-- Отсылка мене сообщения в случае если небыло обновлений
IF @COUNTCAR > 0
   BEGIN
        -- Запись в лог файл машин которые автоматически поменяли стаутс оредр тайпа
        INSERT W_LOG (Zakaz, Usr_Name, Note, Old_val, New_Val)
        SELECT Id, VIN, @SOOBCHEN  + ' Date Contract : ' + CONVERT(NVARCHAR(15),Kontrakt) , '8. Presold','1.Stock'
        FROM   W_ORDER 
        WHERE  Brend     = @Brand 
        AND    Status    = 8
        AND    OrderType = 8
        AND    DATEDIFF(DAY, Kontrakt,           GETDATE()) > 10
        AND    DATEDIFF(DAY, Dlr_actual_arrival, GETDATE()) > 15

        -- Запись в лог файл количества обработанных заказов
        EXEC WRITE_LOG 'Automatically', @SOOBCHEN, @COUNTCAR, Default,'1.Stock','8.Presold'

        -- Были обновления отсылка сообщения 
/*
       Old Variant
       EXEC SENDERER 'ochaika@winner.ua;npylypchuk@winner.ua;asavchenko@winner.ua',
                      @SOOBCHEN,
                     'Changed Order Type in 1.Stock with 8.Presold',
                     'SELECT W.VIN [VIN CODE], D.LAST_NAME [DEALER NAME], LEFT(D.NAZ ,20) [DEALER FULL NAME] 
                       FROM   WINNER.DBO.W_ORDER W,
                              WINNER.DBO.S_DILER D
                       WHERE  W.DLR       = D.ID
                       AND    W.Brend     = 1 
                       AND    W.Status    = 8 
                       AND    W.OrderType = 8 
                       AND    DATEDIFF(DAY, W.Kontrakt, GETDATE()) > 10 
                       AND    DATEDIFF(DAY, W.Dlr_actual_arrival, GETDATE()) > 15'
*/

-- Формирование сообщения в формате НТML
-- 
SET @tableHTML =     '<p> From: Dealer Status Automatically System ' +  LEFT(CONVERT(NVARCHAR(30),GETDATE(), 105),8) + '</p>' +
                     '<H3 style="color: #800000; text-align: left;"> Work Order Changed Order Type in 1.STOCK </H3>' +
                     '<table border = "1" cellspacing="2" style="font-size: x-small; font-family: Calibri">' +
                     '<tr> ' +
                     '<th> ID          </th> ' +
                     '<th> Order #     </th> ' +
                     '<th> VIN Code    </th> ' +
                     '<th> Model       </th> ' +
                     '<th> Version     </th> ' +
                     '<th> Contract    </th> ' +
                     '<th> Dlr Arrival </th> ' +
                     '<th> Dealer Name </th> ' +
                     '</tr>' +
    CAST (( SELECT td = W.ID,                                                             '',
                   td = W.ZAKAZ,                                                          '',
                   td = W.VIN,                                                            '',
                   td = ISNULL(M.NAZ,''),                                                 '',
                   td = ISNULL(V.NAZ,''),                                                 '', 
                   td = ISNULL(CONVERT(NVARCHAR(20),W.Kontrakt,105),'No date'),           '',
                   td = ISNULL(CONVERT(NVARCHAR(20),W.Dlr_actual_arrival,104),'No date'), '',
                   td = ISNULL(D.LAST_NAME,'')
            FROM   WINNER.DBO.W_ORDER   W ,
                   WINNER.DBO.S_DILER   D ,
                   WINNER.DBO.S_MODEL   M ,
                   WINNER.DBO.S_VERSION V 
            WHERE  W.DLR       = D.ID
            AND    W.MODEL     = M.ID
            AND    W.VERS      = V.ID
            AND    W.Brend     = 1 
            AND    W.Status    = 8 
            AND    W.OrderType = 8 
            AND    DATEDIFF(DAY, W.Kontrakt, GETDATE()) > 10 
            AND    DATEDIFF(DAY, W.Dlr_actual_arrival, GETDATE()) > 15
            FOR    XML PATH('tr'), TYPE) AS NVARCHAR(MAX) ) + 
                   '</table>' +
                   '<p class = MsoNormal><o:p>&nbsp;</o:p> </p>' +
                   '<p class = MsoNormal><o:p>&nbsp;</o:p> </p>' +
                   'Create Report Automatically in Business Process Department ' + 
                   LEFT(CONVERT(NVARCHAR(30),GETDATE(), 105),8)

        -- Отправка сообщения в HTML виде
           EXEC msdb.dbo.sp_send_dbmail 
                @profile_name  = 'Robot_mail',
                @recipients    = 'ochaika@winner.ua;npylypchuk@winner.ua;asavchenko@winner.ua',
                @subject       = 'Work Order List',
                @body          = @tableHTML,
                @body_format   = 'HTML' 

       -- Аннулирование контракта каждое утро в 8.00 по форду
       UPDATE W_Order 
       SET    OrderType = 1, 
              Kontrakt  = NULL 
       WHERE  Brend     = @Brand 
       AND    Status    = 8
       AND    OrderType = 8
       AND    DATEDIFF(DAY, Kontrakt,           GETDATE()) > 10
       AND    DATEDIFF(DAY, Dlr_actual_arrival, GETDATE()) > 15
   END
ELSE

  -- Cообщение в случае если небыло обновлений
  BEGIN
        EXEC msdb.dbo.sp_send_dbmail
             @profile_name  = 'Robot_mail',
             @recipients    = 'ochaika@winner.ua;asavchenko@winner.ua;npylypchuk@winner.ua' ,
             @subject       = 'Today No Changes for Ford to 8.PRESOLD' 
        
         -- Запись в лог файл
         EXEC WRITE_LOG 'Automatically', 'No Changed Order Type in 1.Stock with 8.Presold', 0, Default,'0','0' 
  END

/*
   Проверка вставки :
        INSERT W_LOG (Zakaz, Usr_Name, Note, Old_val, New_Val)
        SELECT Id, 'Automatically', 'Vehicle Order Type Changed Automatically  VIN = ' + vin , '8. Presold','1.Stock'
        FROM   W_ORDER 
        WHERE  Brend     = 1
        AND    Status    = 8
        AND    OrderType = 8
        AND    DATEDIFF(DAY, Kontrakt, GETDATE()) > 10
        AND    DATEDIFF(DAY, Dlr_actual_arrival, GETDATE()) > 14

   Вопросы :
   Проверка сообщения для дальнейшего развития событий по автоматческой перестановке 
1. Если машина у дилера и прошло 10 дней после пресолда Kontrakt то меняется 8.Presold - 1.Stock 
   UPDATE W_Order SET OrderType = 1, Kontrakt = NULL WHERE Brend = @Brand AND DATEDIFF(DAY, Kontrakt, GETDATE()) > 10

2. Если машина был не у дилера то  15 дней счиается от DLr_actual_arrival -  1.Stock 
   UPDATE W_Order SET OrderType = 1, Kontrakt = NULL WHERE Brend = @Brand AND Dlr IS NULL AND DATEDIFF(DAY, DLr_actual_arrival, GETDATE()) > 15

3. Если машина в СOMPOUND  то  15 дней счиается от DLr_actual_arrival -  1.Stock 
   UPDATE W_Order SET OrderType = 1, Kontrakt = NULL WHERE Brend = @Brand AND DATEDIFF(DAY, Compound, GETDATE()) > 15

   print datediff(day,'10-27-2008', getdate())

   if datediff(day,getdate(),'01-03-2008') > 3 
      print '2'
   else
      print '4'
*/

/*
Просмотр вставки по ИД и отсылка повторно если не сработает процедура

DECLARE @tableHTML  NVARCHAR(MAX) 
SET @tableHTML = 
    '<p>'  + 
    'From: Dealer Status Automatically System </p>' +
    '<H1 style="color: #800000; text-align: left;"> Work Order Changed Order Type in 1.STOCK </H1>' +
    '<table border = "4">' +
    '<tr> ' +
    '<th> ID </th> ' +
    '<th> Order #  </th> ' +
    '<th> VIN Code </th> ' +
    '<th> Contract </th> ' +
    '<th> Dlr Arrival </th>' +
    '<th> Dealer Name </th> ' +
    '<tr>' +
    CAST (( SELECT td = W.ID,                 '',
                   td = W.ZAKAZ,              '',
                   td = W.VIN,                '',
                   td = getdate()-11,         '',
                   td = W.Dlr_actual_arrival, '',
                   td = D.LAST_NAME    
            FROM   WINNER.DBO.W_ORDER W ,
                   WINNER.DBO.S_DILER D 
            WHERE  W.DLR       = D.ID
             and w.id in(38699,39319,39736,41245,42787,43442,46107,46290,47853)
            FOR    XML PATH('tr'), TYPE) AS NVARCHAR(MAX) ) + 
    '</table>' +
    '<p class = MsoNormal><o:p>&nbsp;</o:p> </p>' +
    '<p class = MsoNormal>' +
    '<o:p> Create report Automatically in Business Process Department ' +  
    CONVERT(NVARCHAR(30),GETDATE())
    
  
EXEC msdb.dbo.sp_send_dbmail 
    @profile_name  = 'Robot_mail',
    @recipients    = 'ochaika@winner.ua;npylypchuk@winner.ua;asavchenko@winner.ua',    --'asavchenko@winner.ua',
    @subject       = 'Work Order List',
    @body          = @tableHTML,
    @body_format   = 'HTML' 

-- Проверить по номерам
SELECT  W.ID,W.ZAKAZ,W.VIN, W.Kontrakt,W.Dlr_actual_arrival,D.LAST_NAME
            FROM   WINNER.DBO.W_ORDER W ,
                   WINNER.DBO.S_DILER D
            WHERE  W.DLR       = D.ID
             and w.id in(38699,39319,39736,41245,42787,43442,46107,46290,47853)
*/
GO
/****** Object:  StoredProcedure [dbo].[Upd_clear_dlr_payment]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- exec Upd_clear_dlr_payment

-- Очистка таблиц оплат
CREATE PROCEDURE [dbo].[Upd_clear_dlr_payment]
AS
DECLARE @Time1 Nvarchar(11)              -- Время старта
DECLARE @Time2 Nvarchar(11)              -- Время финиша
DECLARE @Rows1 Nvarchar(11)              -- Количество строк удаленных в продажах
DECLARE @Rows2 Nvarchar(11)              -- Количество строк удаленных в опалтах

SET @Time1 = CONVERT(nvarchar(11), GETDATE(),114)
TRUNCATE TABLE DLR_SALES

SET @Rows1 = CONVERT(nvarchar(11),@@ROWCOUNT)
TRUNCATE TABLE DLR_PAYMENT
SET @Rows2 =  CONVERT(nvarchar(12),@@ROWCOUNT)
SET @Time2 = 5 -- CONVERT(nvarchar(12), GETDATE(),114)

-- Запись результатов в лог файл
-- WRITE_LOG 'Savchenko', 'Sample Test', 23456, Default,'New','Old'

EXEC WRITE_LOG 'Payment', 'Clear table Pay and Sale', @Time2, 5, @Rows1, @Rows1




/*
 Даты в различных форматах
 print convert(nvarchar(11),getdate(),1)   -- 11/04/08
 print convert(nvarchar(11),getdate(),2)   -- 08.11.04
 print convert(nvarchar(11),getdate(),3)   -- 04/11/08
 print convert(nvarchar(11),getdate(),4)   -- 04.11.08
 print convert(nvarchar(11),getdate(),5)   -- 04-11-08
 print convert(nvarchar(11),getdate(),6)   -- 04 Nov 08
 print convert(nvarchar(11),getdate(),7)   -- Nov 04, 08
 print convert(nvarchar(11),getdate(),8)   -- 13:27:54
 print convert(nvarchar(11),getdate(),9)   -- Nov  4 2008
 print convert(nvarchar(11),getdate(),10)  -- 11-04-08
 print convert(nvarchar(11),getdate(),11)  -- 08/11/04
 print convert(nvarchar(11),getdate(),12)  -- 081104
 print convert(nvarchar(11),getdate(),13)  -- 04 Nov 2008
 print convert(nvarchar(11),getdate(),14)  -- 13:30:14:50
 print convert(nvarchar(11),getdate(),110) -- 11-04-2008
 print convert(nvarchar(11),getdate(),111) -- 2008/11/04
 print convert(nvarchar(10),getdate(),112) -- 20081104
 print convert(nvarchar(11),getdate(),113) -- 04 Nov 2008
 print convert(nvarchar(11),getdate(),114) -- 13:16:09:74
*/
GO
/****** Object:  StoredProcedure [dbo].[TM_Report_department]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- EXEC TM_Report_department 2009, 18, 1, 1
CREATE PROCEDURE [dbo].[TM_Report_department] (@Yearnum int, @Weeknum Int, @Companyid Int, @Department Int)
AS
-- DROP TABLE W_Timesheet_Report

-- создание таблицы для просмотра результатов работы сотрудников по отделу за неделю в текущем году
-- CREATE TABLE W_Timesheet_Report (Department Int , Id_emp int, Employee Nvarchar(50), Normal_time nvarchar(30), Overtime_time nvarchar(30), Total_time nvarchar(30), Approval Nvarchar(1))

DELETE FROM W_Timesheet_Report -- WHERE Department = @Department

-- Создаем временую таблицу
--CREATE TABLE ##ReportDepartment (Employee Nvarchar(50), Normal_time nvarchar(30), Overtime_time nvarchar(30), Total_time nvarchar(30), Approval Nvarchar(1))

-- Заполним основными данными
INSERT INTO W_Timesheet_Report (Id_emp, Employee , Normal_time, Overtime_time, Total_time, Approval)
SELECT Id_emp, Працівник, Тривалість, 0, Тривалість, 'Y'
FROM   A_TS
WHERE  Id_Comp    = @Companyid
  AND  Id_Dep     = @Department
  AND  Неділя     = @Weeknum
  AND  Overtime   = 'N'
  AND  Працівник  IS NOT NULL

-- Обновление овертаймов
UPDATE W
SET    W.Overtime_time = A.Тривалість , W.Total_time = A.Тривалість
FROM   W_Timesheet_Report W,
       A_TS A
WHERE  A.Працівник  = W.Employee
  AND  A.Id_Comp    = @Companyid
  AND  A.Id_Dep     = @Department
  AND  A.Неділя     = @Weeknum
  AND  A.Overtime   = 'Y'

-- создание таблицы для просмотра результатов работы сотрудников по отделу за неделю в текущем году
--CREATE TABLE W_Timesheet_Report (Employee Nvarchar(50), Normal_time nvarchar(30), Overtime_time nvarchar(30), Total_time nvarchar(30), Approval Nvarchar(1))

-- Обновим данные по овертайму
-- Покажем 
--SELECT * FROM W_Timesheet_Report
-- SELECT * FROM s_department
-- SELECT * FROM s_USER WHERE DEP IS NOT NULL
GO
/****** Object:  View [dbo].[A_pdiview]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_pdiview]
AS
SELECT     TOP (100) PERCENT dbo.W_Order.ID, dbo.W_Order.VIN, dbo.S_Brend.Naz AS Brand, dbo.S_Version.Naz AS Version, dbo.S_Model.Naz AS Model, 
                      dbo.W_Order.Invoice_Date, dbo.W_Order.Compound AS Compound_Arrived, dbo.W_Order.RLS_placed, dbo.W_Order.RLS, dbo.W_Order.Status AS Status_id, 
                      dbo.S_Status.Naz AS Status_name, dbo.W_Order.WIU_Arrived, dbo.W_Order.Log_VIC_departure AS Vic_departure, dbo.W_Order.Compound_RLS, 
                      dbo.W_Order.Get_release_Date, dbo.W_Order.Rls_left_compound, dbo.W_Order.DLR_Actual_Arrival, dbo.W_Vic.Pdi_ready, YEAR(dbo.W_Order.DLR_Actual_Arrival) 
                      AS Dlr_actual_arrival_year, MONTH(dbo.W_Order.DLR_Actual_Arrival) AS Dlr_actual_arrival_month, 
                      CASE WHEN [Pdi_ready] = - 1 THEN 'Ок' ELSE 'No' END AS Pdi_yes, dbo.W_Order.Log_Customs_clearance AS Customs_clearance, 
                      dbo.S_Diler.Naz AS Dealer_owner, dbo.S_Location.Naz AS Location_name, dbo.W_Order.Log_Vechicle_Unloaded_VIC AS Vehicle_Unloaded_at_VIC, 
                      dbo.W_Vic.Date_Income, dbo.W_Vic.Date_Ready, dbo.W_Order.Log_inbound_carrier AS Pdi_OK, dbo.W_Ttn_Sub.Avtovoz AS Truck, 
                      dbo.W_Order.Log_Dat_razgr AS Pdi_order_date, dbo.W_Order.Log_actual_delivery_dlr AS First_Dlr_Actual_Arrived
FROM         dbo.W_Order LEFT OUTER JOIN
                      dbo.W_Ttn_Sub ON dbo.W_Order.VIN = dbo.W_Ttn_Sub.Vin LEFT OUTER JOIN
                      dbo.W_Vic ON dbo.W_Order.ID = dbo.W_Vic.Id_Order LEFT OUTER JOIN
                      dbo.S_Status ON dbo.W_Order.Status = dbo.S_Status.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dlr = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Location ON dbo.W_Order.Loc = dbo.S_Location.ID LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID
WHERE     (dbo.W_Order.Brend = 1)
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[36] 2[12] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = -270
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 29
               Left = 293
               Bottom = 629
               Right = 523
            End
            DisplayFlags = 280
            TopColumn = 198
         End
         Begin Table = "W_Ttn_Sub"
            Begin Extent = 
               Top = 384
               Left = 633
               Bottom = 510
               Right = 845
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "W_Vic"
            Begin Extent = 
               Top = 6
               Left = 613
               Bottom = 136
               Right = 901
            End
            DisplayFlags = 280
            TopColumn = 30
         End
         Begin Table = "S_Status"
            Begin Extent = 
               Top = 455
               Left = 41
               Bottom = 563
               Right = 192
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 259
               Left = 662
               Bottom = 367
               Right = 812
            End
            DisplayFlags = 280
            TopColumn = 2
         End
         Begin Table = "S_Location"
            Begin Extent = 
               Top = 266
               Left = 55
               Bottom = 418
               Right = 206
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 142
               Left = 616
               Bottom = 250
               Right = 776
            End
            Display' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_pdiview'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'Flags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 112
               Left = 63
               Bottom = 218
               Right = 214
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 608
               Left = 41
               Bottom = 716
               Right = 201
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 31
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 2025
         Width = 2625
         Width = 1500
         Width = 1500
         Width = 1935
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 5430
         Alias = 4515
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_pdiview'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_pdiview'
GO
/****** Object:  View [dbo].[A_dealerseneder]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_dealerseneder]
AS
SELECT     dbo.W_Order.ID, dbo.W_Order.Zakaz AS Supplaer, dbo.W_Order.VIN, dbo.S_Brend.Naz AS Brand, dbo.S_Model.Naz AS Model, dbo.W_Order.Status AS Status_name, 
                      dbo.S_Diler.Code AS Dlr_code, dbo.S_Diler.Naz AS Dlr_fin, dbo.S_Diler.Last_Name AS Dlr_name, dbo.W_Order.Log_received_dlr AS Date_resived, 
                      dbo.W_Order.Rdf_Vid AS Notes_brand, dbo.W_Order.Rdf_prod AS Notes_bux, dbo.W_Order.Blocked_f AS Yn, dbo.W_Order.Log_invoice_out_carrier AS Date_senders, 
                      dbo.W_Order.Rdf_Zamov AS Nakl_service, dbo.W_Order.Blocked_l AS Reasons, dbo.W_Order.Vubor_pr AS Dlr_seneder, dbo.W_Order.Brend
FROM         dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Brend ON dbo.W_Order.Brend = dbo.S_Brend.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dlr = dbo.S_Diler.ID
WHERE     (dbo.W_Order.Status = 8)
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[37] 4[25] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 469
               Right = 409
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Brend"
            Begin Extent = 
               Top = 41
               Left = 588
               Bottom = 160
               Right = 757
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 300
               Left = 590
               Bottom = 456
               Right = 768
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 175
               Left = 584
               Bottom = 294
               Right = 753
            End
            DisplayFlags = 280
            TopColumn = 4
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 16
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 2280
         Width = 1500
         Width = 3135
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 4050
         Alias = 3495
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         S' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_dealerseneder'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'ortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_dealerseneder'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_dealerseneder'
GO
/****** Object:  StoredProcedure [dbo].[Remeinder_dealers_pay]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Дата :     12-03-2007
Заказчик : Финансовый директор

Краткое описание процедуры :
Процедура ежедневного напоминания дилерам по электронной почте 
об изготвовлении  автомобилей и о своечасной оплате заказов
Данная процедура должна выполняться в автмотическом режиме в 17.00.

Срок оплаты устанавливается + 10 дней от даты напоминания 
Notification Date (w_order.Fin_sale_dealer)

Эта процедура должна вызываться из другой процедуры  Remeinder_dealers_scan в 
которой будет организован цикл по всем справочнику дилеров и отсылки сообщений 
из их поля E_mail.

Пример вызова процедуры из другой процедуры
EXEC Remender_dealers 410, 'asavchenko@winner.ua'
*/

CREATE PROCEDURE [dbo].[Remeinder_dealers_pay] (@Dlr_id Int, @Dlr_Email Nvarchar(255))
AS

-- Формирование тела сообщения для рассылки дилерам
DECLARE @tableHTML    NVARCHAR(MAX) 
DECLARE @Dealer_name  NVARCHAR(50) 

-- Определение имени дилера котрому отсылается сообщение
SELECT @Dealer_name = Last_name FROM S_Diler WHERE ID=@Dlr_id 

SET @tableHTML =     '<p>  From: Dealer Status Automatically System </p>' +
                     '<H2> Winner Imports Ukraine                   </H1>' +
                     '<H2> ' + CONVERT(NVARCHAR(20),getdate ()) + ' </H1>' +
                     '<H1 style="color: #800000; text-align: left;"> Шановний партнер, повідомляемо Вам що машины по вашему замовленню виготовлені і згідно договору, вам потрібно оплатити автомобілі до указанного строка </H1>' +
                     '<table border = "1">' +
                     '<tr> ' +
                     '<th> #            </th> ' +
                     '<th> Замовлення   </th> ' +
                     '<th> VIN Code     </th> ' +
                     '<th> Бренд        </th> ' +
                     '<th> Модель       </th>' +
                     '<th> Строк оплати </th> ' +
                     '<tr>' +
    CAST (( SELECT td = W.ID,          '',
                   td = W.ZAKAZ,       '',
                   td = W.VIN,         '',
                   td = B.NAZ ,        '',
                   td = M.NAZ,         '',
                   td = ISNULL(CONVERT(nvarchar(10),DATEADD(day, 10, W.Fin_sale_dealer),104),'')  
            FROM   WINNER.DBO.W_ORDER W, 
                   WINNER.DBO.S_DILER D, 
                   WINNER.DBO.S_BREND B, 
                   WINNER.DBO.S_MODEL M 
            WHERE  W.DLR             = D.ID
              AND  W.BREND           = B.ID
              AND  W.MODEL           = M.ID
              AND  W.Fin_sale_dealer = GETDATE()
              AND  W.DLR = @Dlr_id
              FOR  XML PATH('tr'), TYPE) AS NVARCHAR(MAX)) + 
                   '</table>' +
                   '<p class = MsoNormal><o:p>&nbsp;</o:p> </p>' +
                   '<p class = MsoNormal>' +
                   '<o:p> Create report Automatically in Business Process Department ' +   CONVERT(NVARCHAR(30),GETDATE())
             
            --print @tableHTML

        -- Отправка сообщения в HTML виде
           EXEC msdb.dbo.sp_send_dbmail 
                @profile_name  = 'Robot_mail',
                @recipients    = @Dlr_Email,
                @subject       = 'Нагадування про виготовлення автмобілів та своечасну сплату замовлень',
                @body          = @tableHTML,
                @body_format   = 'HTML' 

        -- Установка признака о том что сообщение было единожды отправлено сообщение дилерам 
        -- и повторная отправка сообщений не нужна
/*
       UPDATE W_Order 
       SET    OrderType = 1, 
              Kontrakt  = NULL 
       WHERE  Brend     = @Brand 
       AND    Status    = 8
       AND    OrderType = 8
       AND    DATEDIFF(DAY, Kontrakt,           GETDATE()) > 10
       AND    DATEDIFF(DAY, Dlr_actual_arrival, GETDATE()) > 15


    -- Запись в лог файл об отсылке дилерам сообщений
         EXEC WRITE_LOG 'Automatically', 'Дилеру ' + @Dealer_name + 'отосланы сообщения', 0, Default,'0','0' 
*/
GO
/****** Object:  View [dbo].[A_stock_engine]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_stock_engine]
AS
SELECT     TOP (100) PERCENT dbo.W_Order.Status, dbo.S_Status.Naz AS Nstatus, dbo.W_Order.Brend, dbo.W_Order.Loc, DATEPART(ww, dbo.W_Order.ProductionMonth) 
                      AS NWeek, dbo.S_Diler.Last_Name AS DLR, dbo.S_Model.Naz AS Model, dbo.S_Version.Naz, dbo.W_Order.Zakaz, dbo.W_Order.Viev, dbo.S_Engenie.Naz AS Engine, 
                      dbo.W_Order.ProductionMonth
FROM         dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dlr = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Status ON dbo.W_Order.Status = dbo.S_Status.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.S_Version ON dbo.W_Order.Vers = dbo.S_Version.ID INNER JOIN
                      dbo.S_Engenie ON dbo.W_Order.Engine = dbo.S_Engenie.ID
WHERE     (dbo.W_Order.Status BETWEEN 1 AND 12) AND (dbo.W_Order.Viev = 0)
ORDER BY dbo.W_Order.Status, dbo.W_Order.Loc
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[28] 4[33] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 125
               Right = 309
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 6
               Left = 347
               Bottom = 125
               Right = 516
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Status"
            Begin Extent = 
               Top = 6
               Left = 554
               Bottom = 125
               Right = 714
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 6
               Left = 752
               Bottom = 125
               Right = 921
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Version"
            Begin Extent = 
               Top = 6
               Left = 959
               Bottom = 125
               Right = 1119
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Engenie"
            Begin Extent = 
               Top = 6
               Left = 1157
               Bottom = 125
               Right = 1317
            End
            DisplayFlags = 280
            TopColumn = 0
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 11
         Width = 284
         Width = 1500
         Width = 1500
   ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_stock_engine'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'      Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 4545
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 3210
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_stock_engine'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_stock_engine'
GO
/****** Object:  StoredProcedure [dbo].[Evriday_task]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Author         :  Savchenko Arthur
Notes          :  Evry Nith Update 
Date           :  12-09-2008
Last update    :  22-09-2008
Time update    :  16:46
Histiry Update :  30-10-2008 15:50 Добавлено оповещение брендам о неполной информации

Description procedure :
Ежечасная задача.
Назначение ночной ежедневной процедуры :
    1. Устранение повседневных возможных ошибок в базе данных (пропуск данных вычисление и т.д.)
    2. Выполнение ежедневных обязательных задач которые могут быть выполненны ночью
    3. Подготовка данных для финансовых отчетов
    4. Проверка ключевых полей
    5. Напоминание оредер специалистам о незаполненных данных

Usage : EXEC Evriday_task

*/

CREATE PROCEDURE [dbo].[Evriday_task]
AS

-- Описание переменных
   DECLARE @NazvanEW Nvarchar(100)          -- Наименование темы для оповещения   
   DECLARE @CountCar INT                    -- количество машин не имеющих дата OrderPlaced
   DECLARE @Vkl      Int                    -- Включить отключить мне сообщение


-- Вольво повторение номера заказа в втором номере только для Вольво кроме проданных
   UPDATE W_ORDER 
      SET FYON  = SORDER 
    WHERE SORDER  IS NOT NULL 
      AND BREND  = 2
      AND Status < 9

-- Форд обновление дат в нулевые кроме проданных
   UPDATE W_ORDER 
      SET Get_release_Date = NULL 
    WHERE Get_release_Date = '01-01-1900' 
      AND BREND = 1
      AND Status < 9

-- Упорядочить данные заполнить нулями данные NULL
   UPDATE W_order SET dlrs            = 0  WHERE dlrs is null
 --UPDATE W_order SET dlr             = 0  WHERE dlr  is null
   UPDATE W_order SET salesdialer     = 0  WHERE salesdialer is null
   UPDATE W_order SET priz            = 0  WHERE priz is null
   UPDATE W_order SET package         = 0  WHERE package is null
   UPDATE W_order SET vubor           = 0  WHERE vubor is null
-- UPDATE W_order SET Dealer_price    = 0  WHERE Dealer_price is null
-- UPDATE W_order SET Cif_cip         = 0  WHERE Cif_cip is null
-- UPDATE W_order SET Msrp            = 0  WHERE Msrp is null
   UPDATE W_order SET PMNT_Supplier   = 0  WHERE PMNT_Supplier is null
   UPDATE W_order SET DLR_Payment     = 0  WHERE DLR_Payment is null
   UPDATE W_order SET Pymnt_Sum_Total = 0  WHERE Pymnt_Sum_Total is null

/* 
-- Пока отключил оповещение себе за ненадобностью но можно и включить  
-- Cообщение о том что бы отработала задача
   SET  @NazvanEW     = 'Ежечасная задача выполненна' + CONVERT(CHAR(20), GETDATE())

   EXEC msdb.dbo.sp_send_dbmail  
        @profile_name = 'Robot_mail',  
        @recipients   = 'asavchenko@winner.ua',   
        @body         = @NazvanEW , 
        @subject      = 'Ежечасное обновление'
*/

-- Проверка всех брендов об всей необходимой информации
-- в частности заполненной даты OrderPlaced
SET  @NazvanEW = ' ' + CONVERT(CHAR(20), GETDATE())

-- Ford
IF (SELECT COUNT(*) FROM W_Order WHERE Brend = 1 AND Status < 9 AND OrderPlaced IS NULL) > 0 
   BEGIN
       EXEC msdb.dbo.sp_send_dbmail  
            @profile_name = 'Robot_mail',  
            @recipients   = 'npylypchuk@winner.ua',   
            @body         = @NazvanEW, 
            @subject      = 'Наташа у Вас есть машины с непроставленными датами Order Placed',
            @query        = 'SELECT Id, Status, Brend, OrderPlaced FROM Winner.dbo.W_Order WHERE Brend = 1 AND Status < 9 AND OrderPlaced IS NULL',
            @attach_query_result_as_file = 0
   END

-- Volvo
IF (SELECT COUNT(*) FROM W_Order WHERE Brend = 2 AND Status < 9 AND OrderPlaced IS NULL) > 0 
   BEGIN
       EXEC msdb.dbo.sp_send_dbmail  
            @profile_name  = 'Robot_mail',  
            @recipients    = 'vartemenko@winner.ua',   
            @body          = @NazvanEW , 
            @subject       = 'Володя у Вас есть машины с непроставленными датами Order Placed проверь пожалуйста !',
            @query         = 'SELECT Id, Status, Brend, OrderPlaced FROM Winner.dbo.W_Order WHERE Brend = 2 AND Status < 9 AND OrderPlaced IS NULL',
            @attach_query_result_as_file = 0
   END

-- Jaguar
IF (SELECT COUNT(*) FROM W_Order WHERE Brend = 3 AND Status < 9 AND OrderPlaced IS NULL) > 0 
   BEGIN
       EXEC msdb.dbo.sp_send_dbmail  
            @profile_name = 'Robot_mail',  
            @recipients   = 'svoytovych@winner.ua',   
            @body         = @NazvanEW , 
            @subject      = 'Сергей у Вас есть машины в Jaguar с непроставленными датами Order Placed проверь PLS !!',
            @query        = 'SELECT Id, Status, Brend, OrderPlaced FROM Winner.dbo.W_Order WHERE Brend = 3 AND Status < 9 AND OrderPlaced IS NULL',
            @attach_query_result_as_file = 0
   END

-- Land Rover
IF (SELECT COUNT(*) FROM W_Order WHERE Brend = 4 AND Status < 9 AND OrderPlaced IS NULL) > 0 
   BEGIN
       EXEC msdb.dbo.sp_send_dbmail  
            @profile_name = 'Robot_mail',  
            @recipients   = 'svoytovych@winner.ua',   
            @body         = @NazvanEW , 
            @subject      = 'Cергей у Вас есть машины в Land Rover с непроставленными датами Order Placed проверь PLS !!',
            @query        = 'SELECT Id, Status, Brend, OrderPlaced FROM Winner.dbo.W_Order WHERE Brend = 4 AND Status < 9 AND OrderPlaced IS NULL',
            @attach_query_result_as_file = 0
   END

-- Porsche
IF (SELECT COUNT(*) FROM W_Order WHERE Brend = 5 AND Status < 9 AND OrderPlaced IS NULL) > 0 
   BEGIN
       EXEC msdb.dbo.sp_send_dbmail  
            @profile_name = 'Robot_mail',  
            @recipients   = 'ibolhovska@winner.ua',   
            @body         = @NazvanEW, 
            @subject      = 'Ира у Вас есть машины с непроставленными датами Order Placed проверь PLS !!',
            @query        = 'SELECT Id, Status, Brend, OrderPlaced FROM Winner.dbo.W_Order WHERE Brend = 5 AND Status < 9 AND OrderPlaced IS NULL',
            @attach_query_result_as_file = 0
   END



-- Удаление ТТН которые были отмечены на удаление в логистике
-- и оповещение по почте о проделанной работе
-- Обновление : 14-07-2010 14:00
IF (SELECT COUNT(*) FROM W_TTN WHERE DELETED = -1 ) > 0 
   BEGIN
       
       EXEC msdb.dbo.sp_send_dbmail  
            @profile_name = 'Robot_mail',  
            @recipients   = 'irybatetska@winner.ua;isoldatenko@winner.ua;asavchenko@winner.ua;',   
            @body         = @NazvanEW, 
            @subject      = 'Девушки были удалены  вчерашние ТТН, которые вы отметили на удаление .',
            @query        = 'SELECT Num as Номер, Avtovoz as Автовоз  FROM W_TTN WHERE DELETED = -1',
            @attach_query_result_as_file = 0

       -- Удалене помеченных на удаление ТТН
       DELETE FROM W_TTN WHERE DELETED = -1

   END
GO
/****** Object:  StoredProcedure [dbo].[Update_sale_null]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- **************************************************************
-- Обнуление данных о продажах по VIN code
-- **************************************************************
CREATE PROC [dbo].[Update_sale_null]
AS
UPDATE W_ORDER SET Sale_vin=null, 
                   Sale_model=null,
                   Sale_ifirms=null,
                   sale_date=null,
                   Sale_curr=null,
                   Sale_sum_curr=Null,  
                   Sale_dealer=Null,
                   Sale_id=Null, 
                   Sale_oprid=Null,
                   Sale_crdcode=Null, 
                   Sale_NUM_DOC=Null,
                   Sale_Note='Upd',
                   Sale_PAYM_TERM=Null,
                   Sale_PAYM_DATE=Null,
                   Sale_EUR=Null,
                   Sale_SUM_EUR=null
             WHERE VIN='WF0HXXWPDH9C48667' 
                OR VIN='WF0HXXWPDH9C42221'



--UPDATE W_ORDER SET Pymnt_idd=null, 
--                   Pymnt_id=null,
--                   Pymnt_date=null,
--                   Pymnt_curr=null,
--                   Pymnt_curr=null,
--                   Pymnt_sum_curr=Null,  
--
--                   Sale_id=Null, 
--                   Sale_oprid=Null,
--                   Sale_crdcode=Null, 
--                   Sale_NUM_DOC=Null,
--                   Sale_Note='Upd',
--                   Sale_PAYM_TERM=Null,
--                   Sale_PAYM_DATE=Null,
--                   Sale_EUR=Null,
--                   Sale_SUM_EUR=null
--             WHERE VIN='WF0HXXWPDH9C48667' 
--                OR VIN='WF0HXXWPDH9C42221'
--




-- Контроль обновлений
Select  Sale_vin, 
        Sale_model,
        Sale_ifirms,
        sale_date, 
        Sale_curr,
        Sale_sum_curr,  
        Sale_dealer,
        Sale_id, 
        Sale_oprid,
        Sale_crdcode, 
        Sale_NUM_DOC,
        Sale_Note,
        Sale_PAYM_TERM,
        Sale_PAYM_DATE,
        Sale_EUR,
        Sale_SUM_EUR
FROM  W_ORDER
WHERE VIN = 'WF0HXXWPDH9C48667'
   OR VIN='WF0HXXWPDH9C42221'
GO
/****** Object:  StoredProcedure [dbo].[Upd_Payment_Dlr]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/********************************************************************************************************
 Author             :  Savchenko Arthur
 Date Create        :  01-01-2008   16:20
 Last Date Update   :  06-10-2008   16:40
 Description        :  Обновление оплат от дилера нам c зараннее подготовленного запроса Upd_paymnt
 Usage              :  EXEC Upd_Payment_Dlr
 History            :  Изменение в запросе 
*********************************************************************************************************/

CREATE PROCEDURE [dbo].[Upd_Payment_Dlr]
AS

-- 1. Clear Old Data
-- EXEC UPD_CLEAR_DLR_PAYMENT

-- 2. Pump Sales Dealer
-- INSERT INTO Dlr_Sales SELECT [_Sales].*   FROM _Sales

-- 3. Pump Payment for Dealer
-- INSERT INTO Dlr_Payment SELECT [_Payment].* FROM _Payment

-- Обнуление платежей на всякие пожарные если были поменянны дилеры 
--UPDATE W_Order SET Dlr_payment = 0, Pymnt_Date = NULL WHERE Status < 9


/*
--  Обнуление предыдущих данных еще под вопросом ????
--  Совет с Петей

UPDATE W_Order 
SET    W_Order.Pymnt_SUM_EUR      =  0, 
       W_Order.Pymnt_SUM_CURR     =  0, 
       W_Order.Pymnt_IDD          =  0, 
       W_Order.Pymnt_ID           =  0, 
       W_Order.Pymnt_DATE         =  Null, 
       W_Order.Pymnt_SUM_TOTAL    =  0, 
       W_Order.Pymnt_EUR          =  0, 
       W_Order.Pymnt_L_DATE       =  Null, 
       W_Order.Pymnt_NOTE         =  null, 
       W_Order.Pymnt_NUM_DOC      =  Null, 
       W_Order.DLR_Payment        =  0,
       W_Order.Fin_Payment_Dealer =  Null 
 FROM  W_Order     WITH (NOLOCK), 
       Upd_paymnt  WITH (NOLOCK),
       S_Diler     WITH (NOLOCK)
WHERE  W_Order.Zakaz     =  Upd_paymnt.N_ORD 
  AND  W_Order.Dlr       =  S_Diler.Id
  AND  S_Diler.Last_Name =  Upd_paymnt.L_Dealer



*/



/*
-- Дата 20-08-2010
-- Обнуление оплат в в основной таблице по условию
UPDATE W_Order 
SET    W_Order.Pymnt_SUM_EUR      =  0,                        -- Сумма в евро
       W_Order.Pymnt_SUM_CURR     =  0,                        -- Сумма в гривнах
       W_Order.Pymnt_IDD          =  0,                        -- ИД 
       W_Order.Pymnt_ID           =  0,                        -- ИД платежа в Финексперте  
       W_Order.Pymnt_DATE         =  NULL,                     -- Дата оплаты
       W_Order.Pymnt_SUM_TOTAL    =  0,                        -- Общая сумма в евро
       W_Order.Pymnt_EUR          =  0,                        -- Сумма в евро
       W_Order.Pymnt_L_DATE       =  NULL,                     -- Дата оплаты дилером
       W_Order.Pymnt_NOTE         =  NULL,                     -- Назначение платежа
       W_Order.Pymnt_NUM_DOC      =  NULL,                     -- Номер документа
       W_Order.DLR_Payment        =  0,                        -- Сумма евро
       W_Order.Fin_Payment_Dealer =  NULL,                     -- Дата обновления 
       W_Order.Pymnt_Mark         =  'N',                      -- Признак обновления 'U' - Update
       W_Order.Pymnt_N_Ord        =  NULL,                     -- номер ордера 
       W_Order.Pymnt_L_Num        =  CONVERT(Nvarchar(10),GETDATE(),108)    -- время обновления оплат                 CONVERT(Nvarchar(10),GETDATE(),105)  -- format =24-03-2010
 FROM  W_Order     WITH (NOLOCK) 
WHERE  W_Order.MY                 >  2009
  AND  W_Order.Brend              =  1


-- Проверка
SELECT * FROM w_order WHERE  W_Order.MY                 >  2009
                        AND  W_Order.Brend              =  1
*/


-- 4. Update Payment for Group
UPDATE W_Order 
SET    W_Order.Pymnt_SUM_EUR      =  Upd_paymnt.S_SUM_EUR,                  -- Сумма в евро
       W_Order.Pymnt_SUM_CURR     =  Upd_paymnt.S_SUM_CURR,                 -- Сумма в гривнах
       W_Order.Pymnt_IDD          =  Upd_paymnt.L_idd,                      -- ИД 
       W_Order.Pymnt_ID           =  Upd_paymnt.L_ID,                       -- ИД платежа в Финексперте  
       W_Order.Pymnt_DATE         =  Upd_paymnt.L_Date,                     -- Дата оплаты
       W_Order.Pymnt_SUM_TOTAL    =  Upd_paymnt.L_SUM_TOTAL,                -- Общая сумма в евро
       W_Order.Pymnt_EUR          =  Upd_paymnt.L_EUR,                      -- Сумма в евро
       W_Order.Pymnt_L_DATE       =  Upd_paymnt.L_L_Date,                   -- Дата оплаты дилером
       W_Order.Pymnt_NOTE         =  Upd_paymnt.L_NOTE,                     -- Назначение платежа
       W_Order.Pymnt_NUM_DOC      =  Upd_paymnt.L_NUM_DOC,                  -- Номер документа
       W_Order.DLR_Payment        =  Upd_paymnt.S_SUM_EUR,                  -- Сумма евро
       W_Order.Fin_Payment_Dealer =  Upd_paymnt.L_Date,                     -- Дата обновления 
       W_Order.Pymnt_Mark         =  'U',                                   -- Признак обновления 'U' - Update
       W_Order.Pymnt_N_Ord        =  Upd_paymnt.N_ORD,                      -- номер ордера 
       W_Order.Pymnt_L_Num        =  CONVERT(Nvarchar(10),GETDATE(),108)    -- время обновления оплат                 CONVERT(Nvarchar(10),GETDATE(),105)  -- format =24-03-2010
 FROM  W_Order     WITH (NOLOCK), 
       Upd_paymnt  WITH (NOLOCK),
       S_Diler     WITH (NOLOCK)
WHERE  W_Order.Zakaz     =  Upd_paymnt.N_ORD 
  AND  W_Order.Dlr       =  S_Diler.Id
  AND  S_Diler.Last_Name =  Upd_paymnt.L_Dealer
  AND  W_Order.MY        =  Upd_paymnt.MY
--AND  W_Order.Status    < 9


-- Update statistics if processor not busy
IF @@CPU_busy < 200000
   BEGIN
        EXEC sp_updatestats
   END  

--print @@CPU_busy

/*
-- 5. Update Sales
UPDATE W_Order LEFT JOIN dlr_Sales 
    ON W_Order.Svvin          = [dlr_Sales].VIN 
   SET W_Order.Sale_VIN       = [dlr_Sales].[vin], 
       W_Order.Sale_MARK      = [dlr_Sales].[mark], 
       W_Order.Sale_MODEL     = [dlr_Sales].[model], 
       W_Order.Sale_IFIRMS    = [dlr_Sales].[ifirms], 
       W_Order.Sale_DATE      = [dlr_Sales].[date], 
       W_Order.Sale_CURR      = [dlr_Sales].[curr], 
       W_Order.Sale_SUM_CURR  = [dlr_Sales].[sum_curr], 
       W_Order.Sale_DEALER    = [dlr_Sales].[dealer], 
       W_Order.Sale_ID        = [dlr_Sales].[id], 
       W_Order.Sale_OPRID     = [dlr_Sales].[oprid], 
       W_Order.Sale_CRDCODE   = [dlr_Sales].[crdcode], 
       W_Order.Sale_NUM_DOC   = [dlr_Sales].[num_doc], 
       W_Order.Sale_NOTE      = [dlr_Sales].[note], 
       W_Order.Sale_PAYM_TERM = [dlr_Sales].[paym_term], 
       W_Order.Sale_PAYM_DATE = [dlr_Sales].[paym_date], 
       W_Order.Sale_IS_CLOSED = [dlr_Sales].[is_closed], 
       W_Order.Sale_EUR       = [dlr_Sales].[eur],
       W_Order.Sale_SUM_EUR   = [dlr_Sales].[sum_eur], 
       W_Order.Sold_to_DLR    = [dlr_Sales].[date]
*/

/*
-- 6. Insert Volvo & Ford
-- Обновление платежей производителю по вольво и форду
-- 'Закачка данных из таблицы _SupplVF.DBF в таблицу на сервере W_Suppl_VF
INSERT INTO W_Supp_VF (Brand, VIN, [Sum], Date_Pay, Date_Load, Priz )
     SELECT [_SuppVF].BRAND, 
            [_SuppVF].VIN, 
            [_SuppVF].SUM, 
            [_SuppVF].DATE, 
            Now() AS Date_Load, 
            1 AS Priz
      FROM [_SuppVF]
*/

--7. Обновление оплат в W_Order.Pmnt_Supplier, Payment_suppl_Date
/*
UPDATE W_Order INNER JOIN W_Supp_VF 
   ON (W_Order.Brend = W_Supp_VF.Brand) AND (W_Order.VIN = W_Supp_VF.VIN) 
   SET W_Order.PMNT_Supplier      = [W_Supp_VF].[Sum], 
       W_Order.Payment_Suppl_Date = [W_Supp_VF].[Date_Pay]
WHERE (((W_Supp_VF.Priz)=1))
*/

-- 8. 'Замена 1 на 2 для исключения повторной закачки
/*
UPDATE W_Supp_VF SET W_Supp_VF.Priz = 2 WHERE (((W_Supp_VF.Priz)=1))
*/

-- 9. Удаление после закачки (в DBF помечается как удаленный)
/*
DELETE [_SuppVF].* FROM _SuppVF
*/

/* 
Проверка или контроль выполнения обновления оплат от дилера
-- Обновление данных по одному номеру ИД

select Upd_paymnt.*,
       W_Order.Pymnt_SUM_EUR,Upd_paymnt.S_SUM_EUR,  W_Order.Pymnt_SUM_CURR, Upd_paymnt.S_SUM_CURR,
       W_Order.DLR_Payment,Upd_paymnt.S_SUM_EUR
 FROM  W_Order     WITH (NOLOCK), 
       Upd_paymnt  WITH (NOLOCK),
       S_Diler     WITH (NOLOCK)
WHERE  W_Order.Zakaz     =  Upd_paymnt.N_ORD 
  AND  W_Order.Dlr       =  S_Diler.Id
  AND  S_Diler.Last_Name =  Upd_paymnt.L_Dealer
  and  w_order.id=55025

-- 
UPDATE W_Order 
SET    W_Order.Pymnt_SUM_EUR      =  ISNULL(Upd_paymnt.S_SUM_EUR,0), 
       W_Order.Pymnt_SUM_CURR     =  ISNULL(Upd_paymnt.S_SUM_CURR,0), 
       W_Order.Pymnt_IDD          =  ISNULL(Upd_paymnt.L_idd, 0),
       W_Order.Pymnt_ID           =  ISNULL(Upd_paymnt.L_ID,0), 
       W_Order.Pymnt_DATE         =  ISNULL(Upd_paymnt.L_Date, GETDATE()),    
       W_Order.Pymnt_SUM_TOTAL    =  ISNULL(Upd_paymnt.L_SUM_TOTAL, 0),
       W_Order.Pymnt_EUR          =  ISNULL(Upd_paymnt.L_EUR, 0),
       W_Order.Pymnt_L_DATE       =  ISNULL(Upd_paymnt.L_L_Date,GETDATE()),    
       W_Order.Pymnt_NOTE         =  Upd_paymnt.L_NOTE, 
       W_Order.Pymnt_NUM_DOC      =  Upd_paymnt.L_NUM_DOC, 
       W_Order.DLR_Payment        =  Upd_paymnt.S_SUM_EUR,
       W_Order.Fin_Payment_Dealer =  Upd_paymnt.L_Date 
 FROM  W_Order     WITH (NOLOCK), 
       Upd_paymnt  WITH (NOLOCK),
       S_Diler     WITH (NOLOCK)
WHERE  W_Order.Zakaz     =  Upd_paymnt.N_ORD 
  AND  W_Order.Dlr       =  S_Diler.Id
  AND  S_Diler.Last_Name =  Upd_paymnt.L_Dealer
  and  w_order.id=54878
*/
GO
/****** Object:  StoredProcedure [dbo].[A_sox]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Вставка сообщений
-- EXEC A_SOX 2
-- 



CREATE PROCEDURE [dbo].[A_sox] (@Priznak int)
AS
IF @Priznak=1
   INSERT A1 (Mnogo) VALUES ('Создание нового автовоза')
ELSE
   INSERT A1 (Mnogo) VALUES ('удаление автовоза')   
   
-- select * from a1
-- delete from a1
GO
/****** Object:  StoredProcedure [dbo].[Vic_Insert_VIC]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Закачка данных на VIC
-- EXEC Vic_Insert_VIC

CREATE Procedure [dbo].[Vic_Insert_VIC]
AS
-- DELETE FROM [W_Vic]
-- GO

INSERT INTO [W_Vic]
           ([Id_Order]
           ,[Brend]
           ,[Model]
           ,[Vers]
           ,[Dlr]
           ,[Vin]
           ,[Invoice]
           ,[Rls]
           ,[Flag])
    SELECT Id, Brend, Model, Vers , Dlr, Vin, Invoice_Number, Rls, Status
    FROM   w_order 
    WHERE  Status < 9
    
-- Обновление данных по автовозу и перевзчикам и ТТН
EXEC Vic_update_avtovoz

-- SELECT * FROM w_order
GO
/****** Object:  View [dbo].[Rep_dlr_all]    Script Date: 10/29/2010 14:30:31 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[Rep_dlr_all]
AS
SELECT     dbo.W_Order.ID, dbo.W_Order.VIN AS Vin, dbo.W_Order.Zakaz, dbo.S_Location.Naz, dbo.S_Model.Naz AS Model_naz, dbo.W_Order.WIU_Arrived, 
                      dbo.W_Order.Status, dbo.W_Order.Dealer_price, dbo.CntDay(NULL, dbo.W_Order.WIU_Arrived) AS DayUkraine, dbo.CntDay(NULL, 
                      dbo.W_Order.WIU_Arrived) + 120 AS DLR_DUE, dbo.W_Order.DLR_Payment, dbo.S_Diler.Last_Name, dbo.W_Order.Dealer_price AS DLR1, 
                      dbo.S_Diler.Sokr, dbo.S_Diler.Adres, dbo.S_Diler.Tel, dbo.Rep_dlr_ar.S_eur, dbo.Rep_dlr_ar.S_uah, dbo.Rep_dlr_ar.S_total, 
                      dbo.Rep_dlr_ar.N_ORD
FROM         dbo.W_Order LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Order.Dlr = dbo.S_Diler.ID LEFT OUTER JOIN
                      dbo.S_Location ON dbo.W_Order.Loc = dbo.S_Location.ID LEFT OUTER JOIN
                      dbo.S_Model ON dbo.W_Order.Model = dbo.S_Model.ID LEFT OUTER JOIN
                      dbo.Rep_dlr_ar ON dbo.W_Order.Zakaz = dbo.Rep_dlr_ar.N_ORD
WHERE     (dbo.W_Order.Status = 8) AND (dbo.W_Order.Dealer_price > 0) AND (dbo.W_Order.Brend = 1)
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[38] 4[40] 2[4] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Order"
            Begin Extent = 
               Top = 6
               Left = 38
               Bottom = 472
               Right = 300
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "Rep_dlr_ar"
            Begin Extent = 
               Top = 0
               Left = 470
               Bottom = 116
               Right = 621
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 123
               Left = 469
               Bottom = 231
               Right = 629
            End
            DisplayFlags = 280
            TopColumn = 10
         End
         Begin Table = "S_Location"
            Begin Extent = 
               Top = 235
               Left = 474
               Bottom = 328
               Right = 625
            End
            DisplayFlags = 280
            TopColumn = 0
         End
         Begin Table = "S_Model"
            Begin Extent = 
               Top = 334
               Left = 480
               Bottom = 442
               Right = 640
            End
            DisplayFlags = 280
            TopColumn = 3
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 22
         Width = 284
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
       ' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Rep_dlr_all'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane2', @value=N'  Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 4155
         Alias = 4845
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Rep_dlr_all'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=2 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'Rep_dlr_all'
GO
/****** Object:  View [dbo].[A_Bailment_Risk]    Script Date: 10/29/2010 14:30:30 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE VIEW [dbo].[A_Bailment_Risk]
AS
SELECT     TOP (100) PERCENT dbo.W_Ttn_Sub.Vin AS Vin_Code, dbo.S_Diler.Last_Name AS Dealer_Name, dbo.W_Ttn_Sub.Price AS Bailtment_Price2, 
                      dbo.W_Ttn_Sub.Act_Date AS Bailtment_Open, dbo.A_Status.Name_brand AS Brand, dbo.A_Status.Model AS Model_Name, dbo.A_Status.Version AS Version_Name, 
                      dbo.W_Ttn_Sub.Closing AS Bailment_Closing, dbo.W_Ttn_Sub.Act AS Act_Number, dbo.W_Ttn_Sub.Idd, dbo.W_Ttn_Sub.Closing, dbo.CntDay(GETDATE(), 
                      dbo.W_Ttn_Sub.Act_Date) AS Days_Doc, CASE WHEN id_brand = 1 THEN Price ELSE Kurs * Price END AS Bailtment_Price, dbo.A_Status.Id_Brand, 
                      dbo.S_Diler.E_logistics, dbo.S_Diler.Sokr, dbo.W_Ttn_Sub.Ttn, dbo.W_Ttn_Sub.Avtovoz
FROM         dbo.W_Ttn_Sub LEFT OUTER JOIN
                      dbo.A_Status ON dbo.W_Ttn_Sub.Vin = dbo.A_Status.[Full VIN] LEFT OUTER JOIN
                      dbo.S_Diler ON dbo.W_Ttn_Sub.Dlr = dbo.S_Diler.ID
WHERE     (dbo.W_Ttn_Sub.Act_Received IS NULL) AND (dbo.W_Ttn_Sub.Closing IS NULL) AND (dbo.W_Ttn_Sub.Act <> N'0') AND 
                      (dbo.W_Ttn_Sub.Act_Date > CONVERT(DATETIME, '2009-10-01 00:00:00', 102))
ORDER BY Brand
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[53] 4[18] 2[3] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
         Begin Table = "W_Ttn_Sub"
            Begin Extent = 
               Top = 23
               Left = 90
               Bottom = 344
               Right = 294
            End
            DisplayFlags = 280
            TopColumn = 2
         End
         Begin Table = "A_Status"
            Begin Extent = 
               Top = 9
               Left = 535
               Bottom = 131
               Right = 678
            End
            DisplayFlags = 280
            TopColumn = 54
         End
         Begin Table = "S_Diler"
            Begin Extent = 
               Top = 159
               Left = 548
               Bottom = 356
               Right = 676
            End
            DisplayFlags = 280
            TopColumn = 2
         End
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
      Begin ColumnWidths = 18
         Width = 284
         Width = 3555
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 2310
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
         Width = 1500
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 7170
         Alias = 2115
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 2610
         Filter = 7125
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Bailment_Risk'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'A_Bailment_Risk'
GO
/****** Object:  StoredProcedure [dbo].[Remeinder_dayatdealer_90_120]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
/*
Дата :     13-09-2010
Заказчик : Финансовый директор

Краткое описание процедуры :
Процедура ежедневного напоминания дилерам по электронной почте 
об автомобилях у которых поле Day at drl больше 90 или 120 дней, а поле Sold to DLR = NULL
Данная процедура должна выполняться в автмотическом режиме в 8.00.

Срок оплаты устанавливается + 10 дней от даты напоминания 
Notification Date (w_order.Fin_sale_dealer)

Эта процедура должна вызываться из другой процедуры  Remeinder_dealers_scan в 
которой будет организован цикл по всем справочнику дилеров и отсылки сообщений 
из их поля E_mail.

Пример вызова процедуры из другой процедуры
EXEC Remeinder_dayatdealer_90_120 410, 'asavchenko@winner.ua'
*/

CREATE PROCEDURE [dbo].[Remeinder_dayatdealer_90_120] (@Dlr_id Int, @Dlr_Email Nvarchar(255))
AS
-- Формирование темы сообщения для рассылки дилерам
DECLARE @Dealer_name  NVARCHAR(50)
DECLARE @Mail_Subject  NVARCHAR(100)
DECLARE @Rows_number INT
SELECT @Dealer_name = Last_name FROM S_Diler WHERE S_Diler.ID=@Dlr_id
SET @Mail_Subject = 'Автомобілі із терміном зберігання понад 90 та 120 днів  (' + @Dealer_name + ')'

-- Количество записей в таблице, чтобы не отправлять пустое письмо

SELECT @Rows_number = COUNT (A.DLR_Owner)
 FROM   WINNER.DBO.A_Status A,  
                   WINNER.DBO.S_DILER D  
                    
            WHERE  A.DLR_Owner = @Dlr_id
			  AND  A.DLR_Owner = D.ID
              AND  A.[Day at DLR] > 90
			  AND  A.Id_brand = 1
			  AND  A.[Sold to DLR] IS NULL





-- Формирование тела сообщения для рассылки дилерам
DECLARE @tableHTML    NVARCHAR(MAX) 
DECLARE @Dealer_full_name  NVARCHAR(50)




-- Определение имени дилера котрому отсылается сообщение

SELECT @Dealer_full_name = Sokr FROM S_Diler WHERE S_Diler.ID=@Dlr_id  

SET @tableHTML =     '<p>'  + 
                     --'From: Dealer Status Automatically System </p>' +
                     --'Winner Imports Ukraine ' +
                    -- CONVERT(NVARCHAR(20),getdate ()) +
                     '<H4 style="color: #800000; text-align: left;"> Шановні колеги, ' + @Dealer_full_name + '</H4>'+
					 '<p>'  + 
					 'Нижче наведено перелік автомобілів, що зберігаються у Вас на складі понад 90 днів.</p>'+
					 '<p>'+
					 'Нагадуємо, що згідно фінансових умов з 30 вересня 2010 року, якщо у дилера є невикуплені автомобілі понад 120 днів - на дилера накладаються фінансові санкції у вигляді припинення відвантаження авто та запчастин дилеру, замороження всіх виплат.' +
					 '<p style="color: #FF0000">'  +
					 'Прохання вчасно викупити автомобілі, що наближаються до критичного терміну 120 днів!'+
					 '</p>'  +
                     '<table border = "1">' +
                     '<tr> ' +
                     '<th> № п/п </th> ' +
					 '<th> Дилер  </th> ' +
                     '<th> Модель  </th> ' +
                     '<th> VIN-номер </th> ' +
                     '<th> Термін зберігання </th> ' +
                     --'<tr>' +
    
CAST (( SELECT CASE WHEN A.[Day at DLR] > 120 THEN '#FF99FF' END as "@bgcolor", --установка цвета строк у которых A.[Day at DLR] > 120
				   td = ROW_NUMBER ( ) OVER ( ORDER BY A.[Day at DLR] DESC) ,          '',
                   td = D.Sokr,       '',
                   td = ISNULL(A.Model, ''),         '',
				   td = A.[Full VIN],       '',
				   td = CONVERT(nvarchar(10), A.[Day at DLR]),  ''
  
                   
            FROM   WINNER.DBO.A_Status A,  
                   WINNER.DBO.S_DILER D  
                   --WINNER.DBO.S_MODEL M 
            WHERE  A.DLR_Owner = @Dlr_id
			  AND  A.DLR_Owner = D.ID
              AND  A.[Day at DLR] > 90
			  AND  A.Id_brand = 1
			  AND  A.[Sold to DLR] IS NULL
			  ORDER BY A.[Day at DLR] DESC
			  
              FOR  XML PATH('tr'), TYPE) AS NVARCHAR(MAX) ) + 



                   '</table>' +
                   '<p class = MsoNormal><o:p>&nbsp;</o:p> </p>' +
                   '<p class = MsoNormal>' 
                   --'<o:p> Create report Automatically in Business Process Department ' + 
                   --CONVERT(NVARCHAR(30),GETDATE())
             
            --print @tableHTML

        -- Отправка сообщения в HTML виде
		IF @Rows_number > 0
		Begin
         EXEC msdb.dbo.sp_send_dbmail 
                @profile_name  = 'Robot_mail',
                @recipients    = @Dlr_Email,	
                @subject       = @Mail_Subject,
                @body          = @tableHTML,
                @body_format   = 'HTML',
				@importance	   = 'High' 
		End
        -- Установка признака о том что сообщение было единожды отправлено сообщение дилерам 
        -- и повторная отправка сообщений не нужна
/*
       UPDATE W_Order 
       SET    OrderType = 1, 
              Kontrakt  = NULL 
       WHERE  Brend     = @Brand 
       AND    Status    = 8
       AND    OrderType = 8
       AND    DATEDIFF(DAY, Kontrakt,           GETDATE()) > 10
       AND    DATEDIFF(DAY, Dlr_actual_arrival, GETDATE()) > 15


    -- Запись в лог файл об отсылке дилерам сообщений
         EXEC WRITE_LOG 'Automatically', 'Дилеру ' + @Dealer_name + 'отосланы сообщения', 0, Default,'0','0' 
*/

--EXEC Remeinder_dayatdealer_90_120 410, 'asavchenko@winner.ua'
--EXEC Remeinder_dayatdealer_90_120 410, 'ymolchanov@winner.ua'
GO
/****** Object:  StoredProcedure [dbo].[Evry_day_once]    Script Date: 10/29/2010 14:30:35 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Процедура запускается один раз в сутки утром в 8 часов
-- и обслуживает процессы которые должны обрабатываться один раз в сутки

CREATE PROCEDURE [dbo].[Evry_day_once] 
AS

-- Запуск процедуры Order Type форд
   EXEC Change_presold 1

-- Ежедневный срез для финансового отчета по брендам Inventory History для финансового анализа по 5 брендам
   EXEC Rec_Cound 1 
   EXEC Rec_Cound 2
   EXEC Rec_Cound 3
   EXEC Rec_Cound 4
   EXEC Rec_Cound 5

-- Окончательное удаление автовозов помеченных отделом логистики на удаление
   DELETE FROM w_avtovoz WHERE priznak='D'

   
-- Если были автовозы помеченные на удаление 
-- формируется ссообщение в логитику об удалении
IF @@ROWCOUNT > 0 
   BEGIN 
 -- Отправка сообщения в HTML виде
           EXEC msdb.dbo.sp_send_dbmail 
                @profile_name  = 'Robot_mail',
                @recipients    = 'isoldatenko@winner.ua;irybatetska@winner.ua;asavchenko@winner.ua',
                @subject       = 'Deleted Avtovoz',
                @body          = '<H1>Были удалены автовозы помеченные на удаление вчера</H1>',
                @body_format   = 'HTML' 
   END


-- Проверка количество маши с несовпадающимим цветами
--SELECT     dbo.W_Vic.Id_Order, dbo.W_Order.ID, dbo.W_Vic.Color_body, dbo.W_Order.Colour
--FROM       dbo.W_Vic, dbo.W_Order
--WHERE      dbo.W_Vic.Id_Order = dbo.W_Order.ID
--AND        dbo.W_Vic.Color_body <> dbo.W_Order.Colour


-- Функция выравнивания цветов потому что при заказе цвета меняются
-- необходимо закачивать новые машины с стусом не менее 2 или 3
-- 
UPDATE V 
SET    V.Color_body = W.Colour
FROM   W_Vic V, 
       W_Order W
WHERE  V.Id_Order = W.ID
AND    V.Color_body <> W.Colour


-- Если были случаи с расхождением цвет то сообщение отправляется мне
IF @@ROWCOUNT > 0 
   BEGIN 
 -- Отправка сообщения в HTML виде
           EXEC msdb.dbo.sp_send_dbmail 
                @profile_name  = 'Robot_mail',
                @recipients    = 'asavchenko@winner.ua',
                @subject       = 'Цвет откорректирован',
                @body          = '<H2>Было расхождение в цвете</H2>',
                @body_format   = 'HTML' 
   END
GO
/****** Object:  StoredProcedure [dbo].[Remeinder_dayatdealer_90_120_general]    Script Date: 10/29/2010 14:30:36 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[Remeinder_dayatdealer_90_120_general]
AS
DECLARE curs_dealer CURSOR FOR SELECT ID, Email, Obrabotka FROM dbo.S_diler_email WHERE Obrabotka = 1 order by id;
DECLARE @id INT;
DECLARE @email NVARCHAR(1000);

DECLARE @obrabotka INT;

OPEN curs_dealer;

FETCH NEXT FROM curs_dealer into @id, @email, @obrabotka;

WHILE @@FETCH_STATUS=0
  begin
	if @obrabotka = 1
	begin

		EXEC Remeinder_dayatdealer_90_120 @id, @email
		FETCH NEXT FROM curs_dealer into  @id, @email, @obrabotka;
	end;
  end;

close curs_dealer;
DEALLOCATE curs_dealer;
GO
/****** Object:  Default [DF_A1_Uss]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[A1] ADD  CONSTRAINT [DF_A1_Uss]  DEFAULT (host_name()) FOR [Uss]
GO
/****** Object:  Default [DF_A1_Polz]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[A1] ADD  CONSTRAINT [DF_A1_Polz]  DEFAULT (user_name()) FOR [Polz]
GO
/****** Object:  Default [DF_A1_datas]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[A1] ADD  CONSTRAINT [DF_A1_datas]  DEFAULT (getdate()) FOR [datas]
GO
/****** Object:  Default [DF__Pr__Date__36C7C78A]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[Pr] ADD  DEFAULT (getdate()) FOR [Date]
GO
/****** Object:  Default [DF__Pr__Rep_by__37BBEBC3]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[Pr] ADD  DEFAULT (getdate()) FOR [Rep_by]
GO
/****** Object:  Default [DF__Pr__Sales_plan__38B00FFC]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[Pr] ADD  DEFAULT ((0)) FOR [Sales_plan]
GO
/****** Object:  Default [DF__Pr__Creater__39A43435]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[Pr] ADD  DEFAULT (user_name()) FOR [Creater]
GO
/****** Object:  Default [DF__PR_Dep__Date__3F5D0D8B]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[PR_Dep] ADD  DEFAULT (getdate()) FOR [Date]
GO
/****** Object:  Default [DF__PR_Dep__Sales_pl__405131C4]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[PR_Dep] ADD  DEFAULT ((0)) FOR [Sales_plan]
GO
/****** Object:  Default [DF__PR_Dep__Flag__414555FD]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[PR_Dep] ADD  DEFAULT ((0)) FOR [Flag]
GO
/****** Object:  Default [DF__Pr_sub__Flag__3C80A0E0]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[Pr_Sub] ADD  DEFAULT ((0)) FOR [Flag]
GO
/****** Object:  Default [DF__S_Account__Gr__76CD3E06]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Account] ADD  DEFAULT ((0)) FOR [Gr]
GO
/****** Object:  Default [DF__S_Account__Dk__77C1623F]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Account] ADD  DEFAULT ((1)) FOR [Dk]
GO
/****** Object:  Default [DF__S_Account__Priz__78B58678]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Account] ADD  DEFAULT ((0)) FOR [Priz]
GO
/****** Object:  Default [DF__S_Account__Viev__79A9AAB1]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Account] ADD  DEFAULT ((1)) FOR [Viev]
GO
/****** Object:  Default [DF__S_Approval__Priz__7D7A3B95]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Approval] ADD  DEFAULT ((0)) FOR [Priz]
GO
/****** Object:  Default [DF__S_Approval__Viev__7E6E5FCE]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Approval] ADD  DEFAULT ((1)) FOR [Viev]
GO
/****** Object:  Default [DF__S_Body__Num__3EF2F937]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Body] ADD  DEFAULT ((0)) FOR [Num]
GO
/****** Object:  Default [DF__S_Brend__Discoun__0313195A]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Brend] ADD  CONSTRAINT [DF__S_Brend__Discoun__0313195A]  DEFAULT ((0)) FOR [Discount_value]
GO
/****** Object:  Default [DF__S_Buildup__Znach__676AFEE5]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Buildup] ADD  DEFAULT ((0)) FOR [Znach]
GO
/****** Object:  Default [DF__S_Cl__Postav__3B4BBA2E]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Client] ADD  CONSTRAINT [DF__S_Cl__Postav__3B4BBA2E]  DEFAULT (getdate()) FOR [Postav]
GO
/****** Object:  Default [DF_S_Client_Priznak]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Client] ADD  CONSTRAINT [DF_S_Client_Priznak]  DEFAULT ((10)) FOR [Priznak]
GO
/****** Object:  Default [DF_S_Client_Ispol]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Client] ADD  CONSTRAINT [DF_S_Client_Ispol]  DEFAULT (user_name()) FOR [Ispol]
GO
/****** Object:  Default [DF_S_Client_Comp]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Client] ADD  CONSTRAINT [DF_S_Client_Comp]  DEFAULT (host_name()) FOR [Comp]
GO
/****** Object:  Default [DF__S_Company__Flag__2B410645]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Company] ADD  DEFAULT ((1)) FOR [Flag]
GO
/****** Object:  Default [DF_S_country_2_Procent]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Country_2] ADD  CONSTRAINT [DF_S_country_2_Procent]  DEFAULT ((0)) FOR [Procent]
GO
/****** Object:  Default [DF_S_country_2_Pay]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Country_2] ADD  CONSTRAINT [DF_S_country_2_Pay]  DEFAULT ((0)) FOR [Pay]
GO
/****** Object:  Default [DF_S_country_2_Priz]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Country_2] ADD  CONSTRAINT [DF_S_country_2_Priz]  DEFAULT ((1)) FOR [Priz]
GO
/****** Object:  Default [DF__S_Dc__Priz__014ACC79]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Dc] ADD  DEFAULT ((0)) FOR [Priz]
GO
/****** Object:  Default [DF__S_Dc__Viev__023EF0B2]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Dc] ADD  DEFAULT ((1)) FOR [Viev]
GO
/****** Object:  Default [DF__S_Deliver__Count__774C60F3]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Delivery] ADD  DEFAULT ((0)) FOR [Country_Origin]
GO
/****** Object:  Default [DF__S_Deliver__Insur__7840852C]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Delivery] ADD  DEFAULT ((0)) FOR [Insurance]
GO
/****** Object:  Default [DF__S_Deliver__Freig__7934A965]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Delivery] ADD  DEFAULT ((0)) FOR [Freight]
GO
/****** Object:  Default [DF__S_Group_t__Id_Co__2E1D72F0]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Group_Task] ADD  DEFAULT ((1)) FOR [Id_Company]
GO
/****** Object:  Default [DF__S_Group_t__Id_De__2F119729]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Group_Task] ADD  DEFAULT ((1)) FOR [Id_Department]
GO
/****** Object:  Default [DF__S_Group_ta__Flag__3005BB62]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Group_Task] ADD  DEFAULT ((1)) FOR [Flag]
GO
/****** Object:  Default [DF__S_Inspecto__Priz__34756AC4]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Inspector] ADD  DEFAULT ((1)) FOR [Priz]
GO
/****** Object:  Default [DF__S_Model__Discoun__04073D93]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Model] ADD  DEFAULT ((0)) FOR [Discount_value]
GO
/****** Object:  Default [DF_S_Optional_Vers]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Optional] ADD  CONSTRAINT [DF_S_Optional_Vers]  DEFAULT ((0)) FOR [Vers]
GO
/****** Object:  Default [CONSTR_002]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Optional] ADD  CONSTRAINT [CONSTR_002]  DEFAULT (getdate()) FOR [Datavers]
GO
/****** Object:  Default [CONSTR_001]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Optional] ADD  CONSTRAINT [CONSTR_001]  DEFAULT (getdate()) FOR [DataChange]
GO
/****** Object:  Default [DF_S_Optional_Grup]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Optional] ADD  CONSTRAINT [DF_S_Optional_Grup]  DEFAULT (1) FOR [Grup]
GO
/****** Object:  Default [DF_S_Optional_Brend]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Optional] ADD  CONSTRAINT [DF_S_Optional_Brend]  DEFAULT ((1)) FOR [Brend]
GO
/****** Object:  Default [DF_S_Optional_Pr_exw]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Optional] ADD  CONSTRAINT [DF_S_Optional_Pr_exw]  DEFAULT (0) FOR [Pr_exw]
GO
/****** Object:  Default [DF_S_Optional_Pr_dlr]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Optional] ADD  CONSTRAINT [DF_S_Optional_Pr_dlr]  DEFAULT (0) FOR [Pr_dlr]
GO
/****** Object:  Default [DF_S_Optional_Pr_msrp]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Optional] ADD  CONSTRAINT [DF_S_Optional_Pr_msrp]  DEFAULT (0) FOR [Pr_msrp]
GO
/****** Object:  Default [DF_S_Optional_Active]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Optional] ADD  CONSTRAINT [DF_S_Optional_Active]  DEFAULT ((1)) FOR [Active]
GO
/****** Object:  Default [DF_S_Optional_Pr_exw1]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Optional] ADD  CONSTRAINT [DF_S_Optional_Pr_exw1]  DEFAULT (0) FOR [Pr_dlr_ddu]
GO
/****** Object:  Default [DF_S_Optional_Pr_dlr1]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Optional] ADD  CONSTRAINT [DF_S_Optional_Pr_dlr1]  DEFAULT (0) FOR [Pr_msrp_ddu]
GO
/****** Object:  Default [DF__S_Pakage__Datt__102C51FF]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Pakage] ADD  DEFAULT (getdate()) FOR [Datt]
GO
/****** Object:  Default [DF__S_Parameter__Dat__5087998D]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT (getdate()) FOR [Dat]
GO
/****** Object:  Default [DF__S_Paramet__Freig__517BBDC6]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Freight]
GO
/****** Object:  Default [DF__S_Paramet__Insur__526FE1FF]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Insurance]
GO
/****** Object:  Default [DF__S_Paramet__Proce__53640638]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Procedura]
GO
/****** Object:  Default [DF__S_Paramete__Duty__54582A71]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Duty]
GO
/****** Object:  Default [DF__S_Paramet__Excis__554C4EAA]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Excise]
GO
/****** Object:  Default [DF__S_Parameter__Pdi__564072E3]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Pdi]
GO
/****** Object:  Default [DF__S_Parameter__Dhd__5734971C]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Dhd]
GO
/****** Object:  Default [DF__S_Paramet__Inukr__5828BB55]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Inukr]
GO
/****** Object:  Default [DF__S_Paramet__Total__591CDF8E]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Totals]
GO
/****** Object:  Default [DF__S_Paramet__Docfe__5A1103C7]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Docfee]
GO
/****** Object:  Default [DF__S_Paramet__Extwa__5B052800]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Extwar]
GO
/****** Object:  Default [DF__S_Paramet__Handf__5BF94C39]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Handfee]
GO
/****** Object:  Default [DF__S_Paramet__Count__5CED7072]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Countins]
GO
/****** Object:  Default [DF__S_Paramet__Model__5DE194AB]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Modeldisc]
GO
/****** Object:  Default [DF__S_Paramet__Dlrma__5ED5B8E4]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Dlrmarkup]
GO
/****** Object:  Default [DF__S_Paramet__Excis__5FC9DD1D]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [ExcisePet]
GO
/****** Object:  Default [DF__S_Paramet__Dutyp__60BE0156]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Dutypetr]
GO
/****** Object:  Default [DF__S_Paramet__Excdi__61B2258F]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Excdiesel]
GO
/****** Object:  Default [DF__S_Paramet__Dutyd__62A649C8]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Dutydiesel]
GO
/****** Object:  Default [DF__S_Paramet__Impma__639A6E01]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Parameters] ADD  DEFAULT ((0)) FOR [Impmarkup]
GO
/****** Object:  Default [DF__S_partscu__Datei__5CF85D6A]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Partscurrancy] ADD  DEFAULT (getdate()) FOR [Dateinput]
GO
/****** Object:  Default [DF__S_Program__Curr___1D520E4A]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Program] ADD  CONSTRAINT [DF__S_Program__Curr___1D520E4A]  DEFAULT (getdate()) FOR [Curr_Date]
GO
/****** Object:  Default [DF__S_Salesman__Isp__34B4968F]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Salesman] ADD  CONSTRAINT [DF__S_Salesman__Isp__34B4968F]  DEFAULT (user_name()) FOR [Isp]
GO
/****** Object:  Default [DF__S_Salesman__Dat__35A8BAC8]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Salesman] ADD  CONSTRAINT [DF__S_Salesman__Dat__35A8BAC8]  DEFAULT (getdate()) FOR [Dat]
GO
/****** Object:  Default [DF_S_Status_Vievs]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Status] ADD  CONSTRAINT [DF_S_Status_Vievs]  DEFAULT (0) FOR [Vievs]
GO
/****** Object:  Default [DF__S_Task__Id_Group__32E2280D]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Task] ADD  DEFAULT ((1)) FOR [Id_Group]
GO
/****** Object:  Default [DF_S_User_Changed]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_User] ADD  CONSTRAINT [DF_S_User_Changed]  DEFAULT (getdate()) FOR [Changed]
GO
/****** Object:  Default [DF_S_User_Changed1]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_User] ADD  CONSTRAINT [DF_S_User_Changed1]  DEFAULT (getdate()) FOR [Changed_user]
GO
/****** Object:  Default [DF__S_User__Approval__65F7B7BF]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_User] ADD  DEFAULT ((0)) FOR [Approval]
GO
/****** Object:  Default [DF_S_Version_EXW]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Version] ADD  CONSTRAINT [DF_S_Version_EXW]  DEFAULT (0) FOR [Exw]
GO
/****** Object:  Default [DF_S_Version_DLr_cost]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Version] ADD  CONSTRAINT [DF_S_Version_DLr_cost]  DEFAULT (0) FOR [Dlr_cost]
GO
/****** Object:  Default [DF_S_Weight_Insurance]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Weight] ADD  CONSTRAINT [DF_S_Weight_Insurance]  DEFAULT ((9.79)) FOR [Insurance]
GO
/****** Object:  Default [DF_W_Avtovoz_Date_transfer]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Avtovoz] ADD  CONSTRAINT [DF_W_Avtovoz_Date_transfer]  DEFAULT (getdate()) FOR [Date_transfer]
GO
/****** Object:  Default [DF__W_Ch_Pric__D_cha__4E739D3B]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Ch_Price] ADD  CONSTRAINT [DF__W_Ch_Pric__D_cha__4E739D3B]  DEFAULT (getdate()) FOR [D_change]
GO
/****** Object:  Default [DF__W_Ch_Pric__Isp_n__4F67C174]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Ch_Price] ADD  CONSTRAINT [DF__W_Ch_Pric__Isp_n__4F67C174]  DEFAULT (user_name()) FOR [Isp_name]
GO
/****** Object:  Default [DF__W_Ch_Price__Isp__505BE5AD]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Ch_Price] ADD  CONSTRAINT [DF__W_Ch_Price__Isp__505BE5AD]  DEFAULT (user_id()) FOR [Isp]
GO
/****** Object:  Default [DF__W_Co__Brend__1CD2EB5D]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Co] ADD  CONSTRAINT [DF__W_Co__Brend__1CD2EB5D]  DEFAULT ((1)) FOR [Brend]
GO
/****** Object:  Default [DF__W_Co__Dat__1DC70F96]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Co] ADD  CONSTRAINT [DF__W_Co__Dat__1DC70F96]  DEFAULT (getdate()) FOR [Dat]
GO
/****** Object:  Default [DF__W_Co__Engine__24740D25]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Co] ADD  CONSTRAINT [DF__W_Co__Engine__24740D25]  DEFAULT ((0)) FOR [Engine]
GO
/****** Object:  Default [DF__W_Co__Trimm__2568315E]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Co] ADD  CONSTRAINT [DF__W_Co__Trimm__2568315E]  DEFAULT ((0)) FOR [Trimm]
GO
/****** Object:  Default [DF__W_Co__Gearbox__265C5597]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Co] ADD  CONSTRAINT [DF__W_Co__Gearbox__265C5597]  DEFAULT ((0)) FOR [Gearbox]
GO
/****** Object:  Default [DF__W_Dcn__Ido__519BB957]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Ido]
GO
/****** Object:  Default [DF__W_Dcn__Brand__528FDD90]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((1)) FOR [Brand]
GO
/****** Object:  Default [DF__W_Dcn__Model__538401C9]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Model]
GO
/****** Object:  Default [DF__W_Dcn__Vers__54782602]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Vers]
GO
/****** Object:  Default [DF__W_Dcn__Dlr__556C4A3B]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Dlr]
GO
/****** Object:  Default [DF__W_Dcn__Acc__56606E74]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Acc]
GO
/****** Object:  Default [DF__W_Dcn__Data__575492AD]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT (getdate()) FOR [Data]
GO
/****** Object:  Default [DF__W_Dcn__Dk__5848B6E6]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((1)) FOR [Dk]
GO
/****** Object:  Default [DF__W_Dcn__Setll__593CDB1F]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((1)) FOR [Setll]
GO
/****** Object:  Default [DF__W_Dcn__Importans__5A30FF58]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Importans]
GO
/****** Object:  Default [DF__W_Dcn__Sal_appr__5B252391]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Sal_appr]
GO
/****** Object:  Default [DF__W_Dcn__Sal_dat__5C1947CA]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT (getdate()) FOR [Sal_dat]
GO
/****** Object:  Default [DF__W_Dcn__Br_appr__5D0D6C03]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Br_appr]
GO
/****** Object:  Default [DF__W_Dcn__Br_dat__5E01903C]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT (getdate()) FOR [Br_dat]
GO
/****** Object:  Default [DF__W_Dcn__Fin_appr__5EF5B475]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Fin_appr]
GO
/****** Object:  Default [DF__W_Dcn__Fin_dat__5FE9D8AE]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT (getdate()) FOR [Fin_dat]
GO
/****** Object:  Default [DF__W_Dcn__Dat_creat__60DDFCE7]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT (getdate()) FOR [Dat_create]
GO
/****** Object:  Default [DF__W_Dcn__User_crea__61D22120]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT (user_name()) FOR [User_create]
GO
/****** Object:  Default [DF__W_Dcn__Vukonav__62C64559]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Vukonav]
GO
/****** Object:  Default [DF__W_Dcn__Curr__63BA6992]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Curr]
GO
/****** Object:  Default [DF__W_Dcn__Status__64AE8DCB]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Status]
GO
/****** Object:  Default [DF__W_Dcn__Priz__65A2B204]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Dcn] ADD  DEFAULT ((0)) FOR [Priz]
GO
/****** Object:  Default [DF__W_Demand__Employ__4990833B]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Demand] ADD  DEFAULT (user_name()) FOR [Employee]
GO
/****** Object:  Default [DF__W_Demand__Datein__4A84A774]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Demand] ADD  DEFAULT (getdate()) FOR [Dateinput]
GO
/****** Object:  Default [DF__W_Demand__Approv__4B78CBAD]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Demand] ADD  CONSTRAINT [DF__W_Demand__Approv__4B78CBAD]  DEFAULT ((2)) FOR [Approval]
GO
/****** Object:  Default [DF__W_Demand__Approv__4C6CEFE6]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Demand] ADD  DEFAULT (user_name()) FOR [ApprovalName]
GO
/****** Object:  Default [DF__W_Demand__Prizna__4D61141F]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Demand] ADD  DEFAULT ((0)) FOR [Priznak]
GO
/****** Object:  Default [DF_W_Descree_Des_2000000A]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Descree] ADD  CONSTRAINT [DF_W_Descree_Des_2000000A]  DEFAULT (getdate()) FOR [Dat_Des]
GO
/****** Object:  Default [DF_W_Descree_Brd_2000000B]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Descree] ADD  CONSTRAINT [DF_W_Descree_Brd_2000000B]  DEFAULT ((1)) FOR [Brand]
GO
/****** Object:  Default [DF_W_Descree_Dat_2000000C]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Descree] ADD  CONSTRAINT [DF_W_Descree_Dat_2000000C]  DEFAULT (getdate()) FOR [Dat]
GO
/****** Object:  Default [DF_W_Descree_Unl_2000000D]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Descree] ADD  CONSTRAINT [DF_W_Descree_Unl_2000000D]  DEFAULT (getdate()) FOR [Dat_Depart]
GO
/****** Object:  Default [DF_W_Descree_Sum_2000000E]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Descree] ADD  CONSTRAINT [DF_W_Descree_Sum_2000000E]  DEFAULT ((0)) FOR [Total_Sum]
GO
/****** Object:  Default [DF_W_Descree_Cre_2000000F]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Descree] ADD  CONSTRAINT [DF_W_Descree_Cre_2000000F]  DEFAULT (user_name()) FOR [Creator]
GO
/****** Object:  Default [DF__W_FC__Dat__75EE2866]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fc] ADD  DEFAULT (getdate()) FOR [Dat]
GO
/****** Object:  Default [DF__W_FC__Executor__76E24C9F]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fc] ADD  DEFAULT (user_name()) FOR [Executor]
GO
/****** Object:  Default [DF__W_FC__Brand__77D670D8]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fc] ADD  DEFAULT ((1)) FOR [Brand]
GO
/****** Object:  Default [DF__W_FC__Rate__78CA9511]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fc] ADD  DEFAULT ((0)) FOR [Rate]
GO
/****** Object:  Default [DF__W_FC__Yes_no__79BEB94A]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fc] ADD  DEFAULT ('Y') FOR [Yes_no]
GO
/****** Object:  Default [DF__W_FC__Credit_bil__7AB2DD83]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fc] ADD  DEFAULT ((0)) FOR [Credit_bill]
GO
/****** Object:  Default [DF__W_FC__Due__7BA701BC]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fc] ADD  DEFAULT ((0)) FOR [Due]
GO
/****** Object:  Default [DF__W_FC__Cost__7C9B25F5]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fc] ADD  DEFAULT ((0)) FOR [Cost]
GO
/****** Object:  Default [DF__W_FC__Priznak__7D8F4A2E]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fc] ADD  DEFAULT ((1)) FOR [Priznak]
GO
/****** Object:  Default [DF_W_files_Dateload]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Files] ADD  CONSTRAINT [DF_W_files_Dateload]  DEFAULT (getdate()) FOR [Dateload]
GO
/****** Object:  Default [DF_W_files_Processed]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Files] ADD  CONSTRAINT [DF_W_files_Processed]  DEFAULT ((1)) FOR [Processed]
GO
/****** Object:  Default [DF__W_Fin_Inv__Curr___179934F4]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fin_Inventory_History] ADD  CONSTRAINT [DF__W_Fin_Inv__Curr___179934F4]  DEFAULT (getdate()) FOR [Curr_Date]
GO
/****** Object:  Default [DF_W_Fin_rep_God]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fin_Rep] ADD  CONSTRAINT [DF_W_Fin_rep_God]  DEFAULT (datepart(year,getdate())) FOR [God]
GO
/****** Object:  Default [DF__W_Fin_rep__Dat__149CCCB8]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fin_Rep] ADD  CONSTRAINT [DF__W_Fin_rep__Dat__149CCCB8]  DEFAULT (getdate()) FOR [Dat]
GO
/****** Object:  Default [DF__W_Fin_rep__Probl__171A1207]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fin_Rep] ADD  DEFAULT ((0)) FOR [Problem_units]
GO
/****** Object:  Default [DF__W_Hi_Disl__D_Exi__1BE81D6E]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Hi_Dislocation] ADD  CONSTRAINT [DF__W_Hi_Disl__D_Exi__1BE81D6E]  DEFAULT (getdate()) FOR [D_Exit]
GO
/****** Object:  Default [DF__W_Hi_Orde__D_cha__49AEE81E]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Hi_Order] ADD  CONSTRAINT [DF__W_Hi_Orde__D_cha__49AEE81E]  DEFAULT (getdate()) FOR [D_change]
GO
/****** Object:  Default [DF__W_Hi_Orde__Isp_n__4AA30C57]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Hi_Order] ADD  CONSTRAINT [DF__W_Hi_Orde__Isp_n__4AA30C57]  DEFAULT (user_name()) FOR [Isp_name]
GO
/****** Object:  Default [DF__W_Hi_Order__Isp__4B973090]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Hi_Order] ADD  CONSTRAINT [DF__W_Hi_Order__Isp__4B973090]  DEFAULT (user_id()) FOR [Isp]
GO
/****** Object:  Default [DF__W_Hi_Pay__D_chan__21A0F6C4]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Hi_Pay] ADD  CONSTRAINT [DF__W_Hi_Pay__D_chan__21A0F6C4]  DEFAULT (getdate()) FOR [D_change]
GO
/****** Object:  Default [DF_W_Hi_Pay_Isp]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Hi_Pay] ADD  CONSTRAINT [DF_W_Hi_Pay_Isp]  DEFAULT (user_id()) FOR [Isp]
GO
/****** Object:  Default [DF_W_Hi_Pay_Isp_name]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Hi_Pay] ADD  CONSTRAINT [DF_W_Hi_Pay_Isp_name]  DEFAULT (user_name()) FOR [Isp_name]
GO
/****** Object:  Default [Get_date_history]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_History] ADD  CONSTRAINT [Get_date_history]  DEFAULT (getdate()) FOR [Dstatus]
GO
/****** Object:  Default [Get_user_history]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_History] ADD  CONSTRAINT [Get_user_history]  DEFAULT (user_name()) FOR [Isp_name]
GO
/****** Object:  Default [Get_usid_history]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_History] ADD  CONSTRAINT [Get_usid_history]  DEFAULT (user_id()) FOR [Isp]
GO
/****** Object:  Default [DF__W_Insuran__Datas__613D2443]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Insurance] ADD  CONSTRAINT [DF__W_Insuran__Datas__613D2443]  DEFAULT (getdate()) FOR [Datas]
GO
/****** Object:  Default [DF__W_Insuran__Summa__6231487C]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Insurance] ADD  CONSTRAINT [DF__W_Insuran__Summa__6231487C]  DEFAULT ((0)) FOR [Summa_grn]
GO
/****** Object:  Default [DF__W_Insuran__Kurs___63256CB5]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Insurance] ADD  CONSTRAINT [DF__W_Insuran__Kurs___63256CB5]  DEFAULT ((0.01)) FOR [Kurs_val]
GO
/****** Object:  Default [DF__W_Insuran__Prizn__641990EE]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Insurance] ADD  CONSTRAINT [DF__W_Insuran__Prizn__641990EE]  DEFAULT ('O') FOR [Priznak]
GO
/****** Object:  Default [DF_W_Insurance_Request_Date]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Insurance] ADD  CONSTRAINT [DF_W_Insurance_Request_Date]  DEFAULT (getdate()) FOR [Request_Date]
GO
/****** Object:  Default [DF__W_Insuran__Summa__66F5FD99]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Insurance_Sub] ADD  CONSTRAINT [DF__W_Insuran__Summa__66F5FD99]  DEFAULT ((0)) FOR [Summa_grn]
GO
/****** Object:  Default [DF__W_Insuran__Kurs___67EA21D2]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Insurance_Sub] ADD  CONSTRAINT [DF__W_Insuran__Kurs___67EA21D2]  DEFAULT ((0.01)) FOR [Kurs_val]
GO
/****** Object:  Default [DF__W_Insuran__Prizn__68DE460B]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Insurance_Sub] ADD  CONSTRAINT [DF__W_Insuran__Prizn__68DE460B]  DEFAULT ('O') FOR [Priznak]
GO
/****** Object:  Default [DF__W_Invoice__Ex_Wo__27307E3F]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice] ADD  CONSTRAINT [DF__W_Invoice__Ex_Wo__27307E3F]  DEFAULT ((0)) FOR [Ex_Works]
GO
/****** Object:  Default [DF__W_Invoice__Fac_C__2824A278]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice] ADD  CONSTRAINT [DF__W_Invoice__Fac_C__2824A278]  DEFAULT ((0)) FOR [Fac_Cost]
GO
/****** Object:  Default [DF__W_Invoice__Fc_Re__2918C6B1]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice] ADD  CONSTRAINT [DF__W_Invoice__Fc_Re__2918C6B1]  DEFAULT ((0)) FOR [Fc_Rel]
GO
/****** Object:  Default [DF__W_Invoice__Distr__2A0CEAEA]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice] ADD  CONSTRAINT [DF__W_Invoice__Distr__2A0CEAEA]  DEFAULT ((0)) FOR [Distr_Fee]
GO
/****** Object:  Default [DF__W_Invoice__Wi_Re__2B010F23]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice] ADD  CONSTRAINT [DF__W_Invoice__Wi_Re__2B010F23]  DEFAULT ((0)) FOR [Wi_Rel]
GO
/****** Object:  Default [DF__W_Invoice__Del_C__2BF5335C]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice] ADD  CONSTRAINT [DF__W_Invoice__Del_C__2BF5335C]  DEFAULT ((0)) FOR [Del_Cost]
GO
/****** Object:  Default [DF__W_Invoice__Credi__2CE95795]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice] ADD  CONSTRAINT [DF__W_Invoice__Credi__2CE95795]  DEFAULT ((0)) FOR [Credit_Bill]
GO
/****** Object:  Default [DF__W_Invoice__Cost___2DDD7BCE]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice] ADD  CONSTRAINT [DF__W_Invoice__Cost___2DDD7BCE]  DEFAULT ((0)) FOR [Cost_Eur]
GO
/****** Object:  Default [DF__W_Invoice__Date___24A9174F]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice] ADD  DEFAULT (getdate()) FOR [Date_Change]
GO
/****** Object:  Default [DF__W_Invoice__Chang__259D3B88]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice] ADD  DEFAULT (user_name()) FOR [Changer]
GO
/****** Object:  Default [DF__W_Invoice_S__Sum__2FC5C440]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice_Sub] ADD  CONSTRAINT [DF__W_Invoice_S__Sum__2FC5C440]  DEFAULT ((0)) FOR [Sum]
GO
/****** Object:  Default [DF__W_Invoice__Disco__30B9E879]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice_Sub] ADD  CONSTRAINT [DF__W_Invoice__Disco__30B9E879]  DEFAULT ((0)) FOR [Discount]
GO
/****** Object:  Default [DF__W_Invoice__Total__31AE0CB2]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice_Sub] ADD  CONSTRAINT [DF__W_Invoice__Total__31AE0CB2]  DEFAULT ((0)) FOR [Total_Sum]
GO
/****** Object:  Default [DF_W_Load_RDF_Data]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Load_Rdf] ADD  CONSTRAINT [DF_W_Load_RDF_Data]  DEFAULT (getdate()) FOR [Data]
GO
/****** Object:  Default [DF_W_Load_RDF_Rez]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Load_Rdf] ADD  CONSTRAINT [DF_W_Load_RDF_Rez]  DEFAULT ('Ok') FOR [Rez]
GO
/****** Object:  Default [DF_W_LOG_Tim]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Log] ADD  CONSTRAINT [DF_W_LOG_Tim]  DEFAULT (getdate()) FOR [Tim]
GO
/****** Object:  Default [DF_W_LOG_Usr]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Log] ADD  CONSTRAINT [DF_W_LOG_Usr]  DEFAULT (user_name()) FOR [Usr]
GO
/****** Object:  Default [DF_W_LOG_Usr_name]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Log] ADD  CONSTRAINT [DF_W_LOG_Usr_name]  DEFAULT (N'Operation automaticly execute of sysytem') FOR [Usr_name]
GO
/****** Object:  Default [DF_W_LOG_Zakaz]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Log] ADD  CONSTRAINT [DF_W_LOG_Zakaz]  DEFAULT (0) FOR [Zakaz]
GO
/****** Object:  Default [DF_W_LOG_Gr]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Log] ADD  CONSTRAINT [DF_W_LOG_Gr]  DEFAULT (1) FOR [Gr]
GO
/****** Object:  Default [DF_W_LOG_New_val]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Log] ADD  CONSTRAINT [DF_W_LOG_New_val]  DEFAULT (getdate()) FOR [New_val]
GO
/****** Object:  Default [DF_W_LOG_Old_val]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Log] ADD  CONSTRAINT [DF_W_LOG_Old_val]  DEFAULT (getdate()) FOR [Old_val]
GO
/****** Object:  Default [DF__W_Log_Sta__Curr___343573A2]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Log_Status] ADD  CONSTRAINT [DF__W_Log_Sta__Curr___343573A2]  DEFAULT (getdate()) FOR [Curr_Date]
GO
/****** Object:  Default [DF_W_Log_WA_Dat_voda]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Log_Wa] ADD  CONSTRAINT [DF_W_Log_WA_Dat_voda]  DEFAULT (getdate()) FOR [Dat_voda]
GO
/****** Object:  Default [DF_W_Move_dealer_Dat]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Move_Dealer] ADD  CONSTRAINT [DF_W_Move_dealer_Dat]  DEFAULT (getdate()) FOR [Dat]
GO
/****** Object:  Default [DF__W_Option__DatCh__6E17FC74]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Option] ADD  DEFAULT (getdate()) FOR [DatCh]
GO
/****** Object:  Default [DF__W_Option__Change__6F0C20AD]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Option] ADD  DEFAULT (user_name()) FOR [Changer]
GO
/****** Object:  Default [DF__W_Option__Exw__700044E6]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Option] ADD  DEFAULT ((0)) FOR [Exw]
GO
/****** Object:  Default [DF__W_Option__Dc__70F4691F]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Option] ADD  DEFAULT ((0)) FOR [Dc]
GO
/****** Object:  Default [DF__W_Option__Msrp__71E88D58]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Option] ADD  DEFAULT ((0)) FOR [Msrp]
GO
/****** Object:  Default [DF__W_Option__Recalc__72DCB191]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Option] ADD  DEFAULT ((0)) FOR [Recalc]
GO
/****** Object:  Default [DF__W_Option__Raznic__73D0D5CA]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Option] ADD  DEFAULT ((0)) FOR [Raznica]
GO
/****** Object:  Default [DF__W_Option__Discou__74C4FA03]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Option] ADD  DEFAULT ((0)) FOR [Discount]
GO
/****** Object:  Default [DF_W_Optional_Pr_exw]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Optional] ADD  CONSTRAINT [DF_W_Optional_Pr_exw]  DEFAULT (0) FOR [Pr_exw]
GO
/****** Object:  Default [DF_W_Optional_Pr_dlr]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Optional] ADD  CONSTRAINT [DF_W_Optional_Pr_dlr]  DEFAULT (0) FOR [Pr_dlr]
GO
/****** Object:  Default [DF_W_Optional_Pr_msrp]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Optional] ADD  CONSTRAINT [DF_W_Optional_Pr_msrp]  DEFAULT (0) FOR [Pr_msrp]
GO
/****** Object:  Default [DF_W_Optional_Pr_msrp1]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Optional] ADD  CONSTRAINT [DF_W_Optional_Pr_msrp1]  DEFAULT (0) FOR [Pr_raznica]
GO
/****** Object:  Default [DF_W_Optional_Cods]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Optional] ADD  CONSTRAINT [DF_W_Optional_Cods]  DEFAULT ((10)) FOR [Cods]
GO
/****** Object:  Default [DF__W_Optiona__Disco__33EB5ADF]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Optional] ADD  DEFAULT ((0)) FOR [Discount]
GO
/****** Object:  Default [DF_W_Order_Dlr]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Dlr]  DEFAULT ((0)) FOR [Dlr]
GO
/****** Object:  Default [DF_W_Order_Loc]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Loc]  DEFAULT ((0)) FOR [Loc]
GO
/****** Object:  Default [DF_W_Order_Status]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Status]  DEFAULT ((1)) FOR [Status]
GO
/****** Object:  Default [DF_W_Order_Cif_cip_calc]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Cif_cip_calc]  DEFAULT ((0)) FOR [Cif_cip_calc]
GO
/****** Object:  Default [DF_W_Order_Cif_cip]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Cif_cip]  DEFAULT ((0)) FOR [Cif_cip]
GO
/****** Object:  Default [DF_W_Order_Dealer_price]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Dealer_price]  DEFAULT ((0)) FOR [Dealer_price]
GO
/****** Object:  Default [DF_W_Order_MSRP]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_MSRP]  DEFAULT ((0)) FOR [MSRP]
GO
/****** Object:  Default [DF_W_Order_DLR_Payment]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_DLR_Payment]  DEFAULT ((0)) FOR [DLR_Payment]
GO
/****** Object:  Default [DF_W_Order_PMNT_Supplier]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_PMNT_Supplier]  DEFAULT ((0)) FOR [PMNT_Supplier]
GO
/****** Object:  Default [DF_W_Order_Dat_zak]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Dat_zak]  DEFAULT (getdate()) FOR [Dat_zak]
GO
/****** Object:  Default [DF_W_Order_Aging_Compound]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Aging_Compound]  DEFAULT ((0)) FOR [Aging_Compound]
GO
/****** Object:  Default [DF_W_Order_Aging_Dealer]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Aging_Dealer]  DEFAULT ((0)) FOR [Aging_Dealer]
GO
/****** Object:  Default [DF_W_Order_Aging_Total]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Aging_Total]  DEFAULT ((0)) FOR [Aging_Total]
GO
/****** Object:  Default [DF_W_Order_Dlrs]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Dlrs]  DEFAULT ((0)) FOR [Dlrs]
GO
/****** Object:  Default [DF_W_Order_SalesDialer]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_SalesDialer]  DEFAULT ((0)) FOR [SalesDialer]
GO
/****** Object:  Default [DF_W_Order_Payment]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Payment]  DEFAULT ((0)) FOR [Payment]
GO
/****** Object:  Default [DF_W_Order_Remain]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Remain]  DEFAULT ((0)) FOR [Remain]
GO
/****** Object:  Default [DF__W_Order__Isp_dat__0F824689]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF__W_Order__Isp_dat__0F824689]  DEFAULT (getdate()) FOR [Isp_dat]
GO
/****** Object:  Default [DF__W_Order__Isp__10766AC2]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF__W_Order__Isp__10766AC2]  DEFAULT (user_name()) FOR [Isp]
GO
/****** Object:  Default [DF_W_Order_Comp]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Comp]  DEFAULT (host_name()) FOR [Comp]
GO
/****** Object:  Default [DF_W_Order_Package]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Package]  DEFAULT ((0)) FOR [Package]
GO
/****** Object:  Default [DF_W_Order_Isp_dat1]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Isp_dat1]  DEFAULT (getdate()) FOR [Rdf_DateContract]
GO
/****** Object:  Default [DF_W_Order_Rdf_PriceClient]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Rdf_PriceClient]  DEFAULT ((0)) FOR [Rdf_PriceClient]
GO
/****** Object:  Default [DF_W_Order_Viev]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Viev]  DEFAULT ((0)) FOR [Viev]
GO
/****** Object:  Default [DF_W_Order_Inv_Charges]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Inv_Charges]  DEFAULT ((0)) FOR [Inv_Charges]
GO
/****** Object:  Default [DF_W_Order_Inv_Insurance]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Inv_Insurance]  DEFAULT ((0)) FOR [Inv_Insurance]
GO
/****** Object:  Default [DF_W_Order_Akc_Dlr_price]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Akc_Dlr_price]  DEFAULT ((0)) FOR [Akc_Dlr_price]
GO
/****** Object:  Default [DF_W_Order_Akc_Msrp]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Akc_Msrp]  DEFAULT ((0)) FOR [Akc_Msrp]
GO
/****** Object:  Default [DF_W_Order_Sale_SUM_CURR]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Sale_SUM_CURR]  DEFAULT ((0)) FOR [Sale_SUM_CURR]
GO
/****** Object:  Default [DF_W_Order_Sale_EUR]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Sale_EUR]  DEFAULT ((0)) FOR [Sale_EUR]
GO
/****** Object:  Default [DF_W_Order_Sale_SUM_EUR]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Sale_SUM_EUR]  DEFAULT ((0)) FOR [Sale_SUM_EUR]
GO
/****** Object:  Default [DF_W_Order_Pymnt_SUM_CURR]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Pymnt_SUM_CURR]  DEFAULT ((0)) FOR [Pymnt_SUM_CURR]
GO
/****** Object:  Default [DF_W_Order_Pymnt_EUR]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Pymnt_EUR]  DEFAULT ((0)) FOR [Pymnt_EUR]
GO
/****** Object:  Default [DF_W_Order_Pymnt_SUM_EUR]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Pymnt_SUM_EUR]  DEFAULT ((0)) FOR [Pymnt_SUM_EUR]
GO
/****** Object:  Default [DF_W_Order_Pymnt_SUM_TOTAL]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order] ADD  CONSTRAINT [DF_W_Order_Pymnt_SUM_TOTAL]  DEFAULT ((0)) FOR [Pymnt_SUM_TOTAL]
GO
/****** Object:  Default [DF__W_Pack_Hi__Curr___0194E53C]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_Hi__Curr___0194E53C]  DEFAULT (getdate()) FOR [Curr_Date]
GO
/****** Object:  Default [DF__W_Pack_His__Base__02890975]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_His__Base__02890975]  DEFAULT ((0)) FOR [Base]
GO
/****** Object:  Default [DF__W_Pack_Hi__Metal__037D2DAE]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_Hi__Metal__037D2DAE]  DEFAULT ((0)) FOR [Metalic]
GO
/****** Object:  Default [DF__W_Pack_Hi__Door___047151E7]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_Hi__Door___047151E7]  DEFAULT ((0)) FOR [Door_Lock]
GO
/****** Object:  Default [DF__W_Pack_Hi__Mirro__05657620]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_Hi__Mirro__05657620]  DEFAULT ((0)) FOR [Mirror]
GO
/****** Object:  Default [DF__W_Pack_Hi__Alloy__06599A59]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_Hi__Alloy__06599A59]  DEFAULT ((0)) FOR [Alloys]
GO
/****** Object:  Default [DF__W_Pack_His__Roof__074DBE92]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_His__Roof__074DBE92]  DEFAULT ((0)) FOR [Roof]
GO
/****** Object:  Default [DF__W_Pack_Hi__K_092__0841E2CB]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_Hi__K_092__0841E2CB]  DEFAULT ((0)) FOR [K_092]
GO
/****** Object:  Default [DF__W_Pack_Hi__Trans__09360704]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_Hi__Trans__09360704]  DEFAULT ((0)) FOR [Transport]
GO
/****** Object:  Default [DF__W_Pack_Hi__Insur__0A2A2B3D]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_Hi__Insur__0A2A2B3D]  DEFAULT ((0)) FOR [Insurance]
GO
/****** Object:  Default [DF__W_Pack_Hi__Cif_C__0B1E4F76]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_Hi__Cif_C__0B1E4F76]  DEFAULT ((0)) FOR [Cif_Cip]
GO
/****** Object:  Default [DF__W_Pack_Histo__Dc__0C1273AF]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_Histo__Dc__0C1273AF]  DEFAULT ((0)) FOR [Dc]
GO
/****** Object:  Default [DF__W_Pack_His__Msrp__0D0697E8]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_His__Msrp__0D0697E8]  DEFAULT ((0)) FOR [Msrp]
GO
/****** Object:  Default [DF__W_Pack_His__Rate__0DFABC21]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_His__Rate__0DFABC21]  DEFAULT ((0)) FOR [Rate]
GO
/****** Object:  Default [DF_W_Pack_History_Curensy]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF_W_Pack_History_Curensy]  DEFAULT ((1)) FOR [Curensy]
GO
/****** Object:  Default [DF__W_Pack_His__Priz__0EEEE05A]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pack_History] ADD  CONSTRAINT [DF__W_Pack_His__Priz__0EEEE05A]  DEFAULT ((1)) FOR [Priz]
GO
/****** Object:  Default [DF__W_Package__P_Exw__2BC02932]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Package_Group] ADD  CONSTRAINT [DF__W_Package__P_Exw__2BC02932]  DEFAULT ((0)) FOR [P_Exw]
GO
/****** Object:  Default [DF__W_Package___P_Dc__2CB44D6B]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Package_Group] ADD  CONSTRAINT [DF__W_Package___P_Dc__2CB44D6B]  DEFAULT ((0)) FOR [P_Dc]
GO
/****** Object:  Default [DF__W_Package__P_Msr__2DA871A4]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Package_Group] ADD  CONSTRAINT [DF__W_Package__P_Msr__2DA871A4]  DEFAULT ((0)) FOR [P_Msrp]
GO
/****** Object:  Default [DF__W_Package__Ch_Da__2E9C95DD]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Package_Group] ADD  CONSTRAINT [DF__W_Package__Ch_Da__2E9C95DD]  DEFAULT (getdate()) FOR [Ch_Date]
GO
/****** Object:  Default [DF__W_Package__Ch_us__2F90BA16]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Package_Group] ADD  CONSTRAINT [DF__W_Package__Ch_us__2F90BA16]  DEFAULT (user_name()) FOR [Ch_user]
GO
/****** Object:  Default [DF_W_Package_Group_Transportation]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Package_Group] ADD  CONSTRAINT [DF_W_Package_Group_Transportation]  DEFAULT ((0)) FOR [Transportation]
GO
/****** Object:  Default [DF_W_Package_Group_Insurance]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Package_Group] ADD  CONSTRAINT [DF_W_Package_Group_Insurance]  DEFAULT ((0)) FOR [Insurance]
GO
/****** Object:  Default [DF__W_package___Wiou__75B91E3C]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_package_Plan] ADD  DEFAULT ((datepart(year,getdate())+'-')+datepart(month,getdate())) FOR [Wiou]
GO
/****** Object:  Default [DF__W_package_p__Dlr__76AD4275]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_package_Plan] ADD  DEFAULT ((0)) FOR [Dlr]
GO
/****** Object:  Default [D_11CH]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Package_Vers] ADD  CONSTRAINT [D_11CH]  DEFAULT (getdate()) FOR [D_Сhange]
GO
/****** Object:  Default [D_21OG]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Package_Vers] ADD  CONSTRAINT [D_21OG]  DEFAULT (getdate()) FOR [D_OG]
GO
/****** Object:  Default [D_31PL]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Package_Vers] ADD  CONSTRAINT [D_31PL]  DEFAULT (getdate()) FOR [D_PL]
GO
/****** Object:  Default [DF__W_Packs_P__D_cha__6B0FDBE9]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Packs_Pay] ADD  CONSTRAINT [DF__W_Packs_P__D_cha__6B0FDBE9]  DEFAULT (getdate()) FOR [D_change]
GO
/****** Object:  Default [DF__W_Packs_P__Isp_n__6C040022]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Packs_Pay] ADD  CONSTRAINT [DF__W_Packs_P__Isp_n__6C040022]  DEFAULT (user_name()) FOR [Isp_name]
GO
/****** Object:  Default [DF__W_Packs_Pay__Isp__6CF8245B]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Packs_Pay] ADD  CONSTRAINT [DF__W_Packs_Pay__Isp__6CF8245B]  DEFAULT (user_id()) FOR [Isp]
GO
/****** Object:  Default [DF__W_Pakage___Dat_I__1F5A524D]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pakage_History] ADD  DEFAULT (getdate()) FOR [Dat_Input]
GO
/****** Object:  Default [DF__W_Pakage___D_exw__204E7686]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pakage_History] ADD  DEFAULT (getdate()) FOR [D_exw]
GO
/****** Object:  Default [DF__W_Pakage_H__D_dc__21429ABF]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pakage_History] ADD  DEFAULT (getdate()) FOR [D_dc]
GO
/****** Object:  Default [DF__W_Pakage___D_msr__2236BEF8]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pakage_History] ADD  DEFAULT (getdate()) FOR [D_msrp]
GO
/****** Object:  Default [DF__W_Pakage___P_exw__232AE331]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pakage_History] ADD  DEFAULT ((0)) FOR [P_exw]
GO
/****** Object:  Default [DF__W_Pakage_H__P_dc__241F076A]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pakage_History] ADD  DEFAULT ((0)) FOR [P_dc]
GO
/****** Object:  Default [DF__W_Pakage___P_msr__25132BA3]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pakage_History] ADD  DEFAULT ((0)) FOR [P_msrp]
GO
/****** Object:  Default [DF__W_Pakage_H__Rate__26074FDC]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pakage_History] ADD  DEFAULT ((0)) FOR [Rate]
GO
/****** Object:  Default [DF__W_Parts__Brand__75F9155E]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Parts] ADD  DEFAULT ((0)) FOR [Brand]
GO
/****** Object:  Default [DF__W_Parts__Date__76ED3997]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Parts] ADD  DEFAULT (getdate()) FOR [Date]
GO
/****** Object:  Default [DF__W_Parts__Date_up__77E15DD0]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Parts] ADD  DEFAULT (getdate()) FOR [Date_update]
GO
/****** Object:  Default [DF__W_Parts__Date_ac__78D58209]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Parts] ADD  DEFAULT (getdate()) FOR [Date_actual]
GO
/****** Object:  Default [DF__W_Parts__Price_i__79C9A642]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Parts] ADD  DEFAULT ((0)) FOR [Price_imp]
GO
/****** Object:  Default [DF__W_Parts__Price_o__7ABDCA7B]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Parts] ADD  DEFAULT ((0)) FOR [Price_opt]
GO
/****** Object:  Default [DF__W_Parts__Price_r__7BB1EEB4]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Parts] ADD  DEFAULT ((0)) FOR [Price_roz]
GO
/****** Object:  Default [DF__W_Parts__Flag__7CA612ED]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Parts] ADD  DEFAULT ((0)) FOR [Flag]
GO
/****** Object:  Default [DF__W_Parts__Priz__7D9A3726]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Parts] ADD  DEFAULT ((1)) FOR [Priz]
GO
/****** Object:  Default [DF_W_parts_log_Data]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_parts_log] ADD  CONSTRAINT [DF_W_parts_log_Data]  DEFAULT (getdate()) FOR [Data]
GO
/****** Object:  Default [DF__W_Pay__Date_pay__6B84DD35]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pay] ADD  DEFAULT (getdate()) FOR [Date_pay]
GO
/****** Object:  Default [DF_W_Pay_err_DatDoc]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pay_Err] ADD  CONSTRAINT [DF_W_Pay_err_DatDoc]  DEFAULT (getdate()) FOR [DatDoc]
GO
/****** Object:  Default [DF_W_Pay_err_Polz]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pay_Err] ADD  CONSTRAINT [DF_W_Pay_err_Polz]  DEFAULT (suser_name()) FOR [Polz]
GO
/****** Object:  Default [DF_W_Pay_suppl_1_Dat_pay]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pay_suppl_1] ADD  CONSTRAINT [DF_W_Pay_suppl_1_Dat_pay]  DEFAULT (getdate()) FOR [Dat_pay]
GO
/****** Object:  Default [DF_W_Pay_suppl_1_Isp_name]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pay_suppl_1] ADD  CONSTRAINT [DF_W_Pay_suppl_1_Isp_name]  DEFAULT (user_name()) FOR [Isp_name]
GO
/****** Object:  Default [DF__W_Pay_sup__Dat_p__6E8C3269]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pay_suppl_2] ADD  CONSTRAINT [DF__W_Pay_sup__Dat_p__6E8C3269]  DEFAULT (getdate()) FOR [Dat_pay]
GO
/****** Object:  Default [DF_W_Pay_suppl_2_Zakaz]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pay_suppl_2] ADD  CONSTRAINT [DF_W_Pay_suppl_2_Zakaz]  DEFAULT (0) FOR [Zakaz]
GO
/****** Object:  Default [DF__W_Pays__Date_pay__70499252]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pays] ADD  CONSTRAINT [DF__W_Pays__Date_pay__70499252]  DEFAULT (getdate()) FOR [Date_pay]
GO
/****** Object:  Default [DF__W_RDF__D_change__664B26CC]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Rdf] ADD  CONSTRAINT [DF__W_RDF__D_change__664B26CC]  DEFAULT (getdate()) FOR [D_change]
GO
/****** Object:  Default [DF__W_RDF__Isp_name__673F4B05]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Rdf] ADD  CONSTRAINT [DF__W_RDF__Isp_name__673F4B05]  DEFAULT (user_name()) FOR [Isp_name]
GO
/****** Object:  Default [DF__W_RDF__Isp__68336F3E]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Rdf] ADD  CONSTRAINT [DF__W_RDF__Isp__68336F3E]  DEFAULT (user_id()) FOR [Isp]
GO
/****** Object:  Default [DF__W_Rdf_Contr__Dlr__0A7F30F8]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Rdf_Contract] ADD  DEFAULT ((0)) FOR [Dlr]
GO
/****** Object:  Default [DF__W_Rdf_Contr__Loc__0B735531]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Rdf_Contract] ADD  DEFAULT ((0)) FOR [Loc]
GO
/****** Object:  Default [DF__W_Rdf_Con__Statu__0C67796A]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Rdf_Contract] ADD  DEFAULT ((1)) FOR [Status]
GO
/****** Object:  Default [DF__W_Rdf_Con__Packa__0D5B9DA3]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Rdf_Contract] ADD  DEFAULT ((0)) FOR [Package]
GO
/****** Object:  Default [DF__W_Rdf_Con__Rdf_D__0E4FC1DC]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Rdf_Contract] ADD  DEFAULT (getdate()) FOR [Rdf_DateContract]
GO
/****** Object:  Default [DF__W_Rdf_Con__Rdf_P__0F43E615]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Rdf_Contract] ADD  DEFAULT ((0)) FOR [Rdf_PriceClient]
GO
/****** Object:  Default [DF__W_Rdf_Con__Rdf_c__10380A4E]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Rdf_Contract] ADD  DEFAULT (user_name()) FOR [Rdf_changed]
GO
/****** Object:  Default [DF__W_Release__Dat__24541194]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Release] ADD  CONSTRAINT [DF__W_Release__Dat__24541194]  DEFAULT (getdate()) FOR [Dat]
GO
/****** Object:  Default [DF__W_Release__Sum__254835CD]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Release] ADD  CONSTRAINT [DF__W_Release__Sum__254835CD]  DEFAULT ((0)) FOR [Sum]
GO
/****** Object:  Default [DF__W_Request__Dat__1E9B383E]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Request] ADD  CONSTRAINT [DF__W_Request__Dat__1E9B383E]  DEFAULT (getdate()) FOR [Dat]
GO
/****** Object:  Default [DF__W_Request__Sum__1F8F5C77]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Request] ADD  CONSTRAINT [DF__W_Request__Sum__1F8F5C77]  DEFAULT ((0)) FOR [Sum]
GO
/****** Object:  Default [D_001]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Srez] ADD  CONSTRAINT [D_001]  DEFAULT (getdate()) FOR [Data]
GO
/****** Object:  Default [DF__W_Srez__Status__56FF8CF2]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Srez] ADD  CONSTRAINT [DF__W_Srez__Status__56FF8CF2]  DEFAULT ((0)) FOR [Status]
GO
/****** Object:  Default [DF__W_srez_avg__Dat__4F5E6B2A]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Srez_Avg] ADD  CONSTRAINT [DF__W_srez_avg__Dat__4F5E6B2A]  DEFAULT (getdate()) FOR [Dat]
GO
/****** Object:  Default [DF__W_srez_av__Brand__50528F63]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Srez_Avg] ADD  CONSTRAINT [DF__W_srez_av__Brand__50528F63]  DEFAULT ((1)) FOR [Brand]
GO
/****** Object:  Default [DF__W_srez_av__Statu__5146B39C]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Srez_Avg] ADD  CONSTRAINT [DF__W_srez_av__Statu__5146B39C]  DEFAULT ((1)) FOR [Status]
GO
/****** Object:  Default [DF__W_srez_avg__Cavg__523AD7D5]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Srez_Avg] ADD  CONSTRAINT [DF__W_srez_avg__Cavg__523AD7D5]  DEFAULT ((0)) FOR [Cavg]
GO
/****** Object:  Default [DF__W_srez_avg__Csld__532EFC0E]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Srez_Avg] ADD  CONSTRAINT [DF__W_srez_avg__Csld__532EFC0E]  DEFAULT ((0)) FOR [Csld]
GO
/****** Object:  Default [DF__W_srez_avg__Ccal__54232047]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Srez_Avg] ADD  CONSTRAINT [DF__W_srez_avg__Ccal__54232047]  DEFAULT ((0)) FOR [Ccal]
GO
/****** Object:  Default [DF__W_srez_avg__Flag__55174480]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Srez_Avg] ADD  CONSTRAINT [DF__W_srez_avg__Flag__55174480]  DEFAULT ((1)) FOR [Flag]
GO
/****** Object:  Default [DF_Table_1_Date_load]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Supp_Vf] ADD  CONSTRAINT [DF_Table_1_Date_load]  DEFAULT (getdate()) FOR [Date_Load]
GO
/****** Object:  Default [DF_W_Supp_VF_Priz]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Supp_Vf] ADD  CONSTRAINT [DF_W_Supp_VF_Priz]  DEFAULT ((1)) FOR [Priz]
GO
/****** Object:  Default [DF_W_System_Dat]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_System] ADD  CONSTRAINT [DF_W_System_Dat]  DEFAULT (getdate()) FOR [Dat]
GO
/****** Object:  Default [DF__W_tasks__Time_st__6483A542]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Tasks] ADD  DEFAULT (getdate()) FOR [Time_start]
GO
/****** Object:  Default [DF__W_tasks__Time_fi__6577C97B]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Tasks] ADD  DEFAULT (getdate()) FOR [Time_finish]
GO
/****** Object:  Default [DF__W_Taxi__Employee__28EEA97F]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Taxi] ADD  DEFAULT (user_name()) FOR [Employee]
GO
/****** Object:  Default [DF__W_Taxi__Cost__29E2CDB8]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Taxi] ADD  DEFAULT ((0)) FOR [Cost]
GO
/****** Object:  Default [DF__W_Taxi__Dateinpu__2AD6F1F1]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Taxi] ADD  DEFAULT (getdate()) FOR [Dateinput]
GO
/****** Object:  Default [DF__W_Taxi__Approval__2BCB162A]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Taxi] ADD  DEFAULT ((2)) FOR [Approval]
GO
/****** Object:  Default [DF__W_Taxi__Approval__2CBF3A63]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Taxi] ADD  DEFAULT (user_name()) FOR [ApprovalName]
GO
/****** Object:  Default [DF__W_Taxi__Priznak__2DB35E9C]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Taxi] ADD  DEFAULT ((0)) FOR [Priznak]
GO
/****** Object:  Default [DF_W_Taxi_Employee1]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Taxi] ADD  CONSTRAINT [DF_W_Taxi_Employee1]  DEFAULT (user_name()) FOR [Employee1]
GO
/****** Object:  Default [DF_W_Taxi_Employee11]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Taxi] ADD  CONSTRAINT [DF_W_Taxi_Employee11]  DEFAULT (user_name()) FOR [DepName]
GO
/****** Object:  Default [DF__W_Temp__Status__3B2C89F4]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp] ADD  CONSTRAINT [DF__W_Temp__Status__3B2C89F4]  DEFAULT (1) FOR [Status]
GO
/****** Object:  Default [DF__W_Temp__Cif_cip__3C20AE2D]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp] ADD  CONSTRAINT [DF__W_Temp__Cif_cip__3C20AE2D]  DEFAULT (0) FOR [Cif_cip]
GO
/****** Object:  Default [DF__W_Temp__Dealer_p__3D14D266]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp] ADD  CONSTRAINT [DF__W_Temp__Dealer_p__3D14D266]  DEFAULT (0) FOR [Dealer_price]
GO
/****** Object:  Default [DF__W_Temp__MSRP__3E08F69F]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp] ADD  CONSTRAINT [DF__W_Temp__MSRP__3E08F69F]  DEFAULT (0) FOR [MSRP]
GO
/****** Object:  Default [DF__W_Temp__Dat_zak__3EFD1AD8]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp] ADD  CONSTRAINT [DF__W_Temp__Dat_zak__3EFD1AD8]  DEFAULT (getdate()) FOR [Dat_zak]
GO
/****** Object:  Default [DF__W_Temp__Isp_dat__3FF13F11]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp] ADD  CONSTRAINT [DF__W_Temp__Isp_dat__3FF13F11]  DEFAULT (getdate()) FOR [Isp_dat]
GO
/****** Object:  Default [DF__W_Temp__Isp__40E5634A]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp] ADD  CONSTRAINT [DF__W_Temp__Isp__40E5634A]  DEFAULT (user_name()) FOR [Isp]
GO
/****** Object:  Default [DF__W_Temp__Comp__41D98783]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp] ADD  CONSTRAINT [DF__W_Temp__Comp__41D98783]  DEFAULT (host_name()) FOR [Comp]
GO
/****** Object:  Default [DF__W_Temp__Viev__44B5F42E]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp] ADD  CONSTRAINT [DF__W_Temp__Viev__44B5F42E]  DEFAULT (0) FOR [Viev]
GO
/****** Object:  Default [DF__W_Temp_Op__Pr_ex__6616E7F9]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp_Optional] ADD  DEFAULT (0) FOR [Pr_exw]
GO
/****** Object:  Default [DF__W_Temp_Op__Pr_dl__670B0C32]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp_Optional] ADD  DEFAULT (0) FOR [Pr_dlr]
GO
/****** Object:  Default [DF__W_Temp_Op__Pr_ms__67FF306B]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp_Optional] ADD  DEFAULT (0) FOR [Pr_msrp]
GO
/****** Object:  Default [DF__W_Temp_Op__Pr_ra__68F354A4]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp_Optional] ADD  DEFAULT (0) FOR [Pr_raznica]
GO
/****** Object:  Default [DF__W_Timeshe__Remar__25882CEF]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet] ADD  CONSTRAINT [DF__W_Timeshe__Remar__25882CEF]  DEFAULT ('I') FOR [Remark]
GO
/****** Object:  Default [DF__W_Timeshee__Priz__267C5128]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet] ADD  CONSTRAINT [DF__W_Timeshee__Priz__267C5128]  DEFAULT ((1)) FOR [Priz]
GO
/****** Object:  Default [DF__W_Timeshee__Polz__27707561]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet] ADD  CONSTRAINT [DF__W_Timeshee__Polz__27707561]  DEFAULT (user_name()) FOR [Polz]
GO
/****** Object:  Default [DF__W_Timeshe__DataI__2864999A]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet] ADD  CONSTRAINT [DF__W_Timeshe__DataI__2864999A]  DEFAULT (getdate()) FOR [DataInsert]
GO
/****** Object:  Default [DF_W_Timesheet_Report_Num_year]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Report] ADD  CONSTRAINT [DF_W_Timesheet_Report_Num_year]  DEFAULT (datepart(year,getdate())) FOR [Year_number]
GO
/****** Object:  Default [DF_W_Timesheet_Report_Changed]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Report] ADD  CONSTRAINT [DF_W_Timesheet_Report_Changed]  DEFAULT (getdate()) FOR [Changed]
GO
/****** Object:  Default [DF__W_Timeshe__Year___74AFEB6A]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF__W_Timeshe__Year___74AFEB6A]  DEFAULT (datepart(year,getdate())) FOR [Year_number]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Week_number]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Week_number]  DEFAULT (datepart(week,getdate())) FOR [Week_number]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Norm_0]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Norm_0]  DEFAULT ((0)) FOR [Norm_0]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Over_0]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Over_0]  DEFAULT ((0)) FOR [Over_0]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Norm_10]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Norm_10]  DEFAULT ((0)) FOR [Norm_1]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Over_1]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Over_1]  DEFAULT ((0)) FOR [Over_1]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Norm_2]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Norm_2]  DEFAULT ((0)) FOR [Norm_2]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Over_2]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Over_2]  DEFAULT ((0)) FOR [Over_2]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Norm_3]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Norm_3]  DEFAULT ((0)) FOR [Norm_3]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Over_3]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Over_3]  DEFAULT ((0)) FOR [Over_3]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Norm_4]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Norm_4]  DEFAULT ((0)) FOR [Norm_4]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Over_4]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Over_4]  DEFAULT ((0)) FOR [Over_4]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Norm_5]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Norm_5]  DEFAULT ((0)) FOR [Norm_5]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Over_5]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Over_5]  DEFAULT ((0)) FOR [Over_5]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Over_6]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Over_6]  DEFAULT ((0)) FOR [Over_6]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Over_7]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Over_7]  DEFAULT ((0)) FOR [Over_7]
GO
/****** Object:  Default [DF_W_Timesheet_Task_Total_time]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF_W_Timesheet_Task_Total_time]  DEFAULT ((0)) FOR [Total_time]
GO
/****** Object:  Default [DF__W_Timeshee__Flag__75A40FA3]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Timesheet_Task] ADD  CONSTRAINT [DF__W_Timeshee__Flag__75A40FA3]  DEFAULT ((1)) FOR [Flag]
GO
/****** Object:  Default [DF_W_Ttn_Dat]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Ttn] ADD  CONSTRAINT [DF_W_Ttn_Dat]  DEFAULT (getdate()) FOR [Dat]
GO
/****** Object:  Default [DF_W_Ttn_Vub]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Ttn] ADD  CONSTRAINT [DF_W_Ttn_Vub]  DEFAULT ((0)) FOR [Vub]
GO
/****** Object:  Default [DF_W_Ttn_Deleted]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Ttn] ADD  CONSTRAINT [DF_W_Ttn_Deleted]  DEFAULT ((0)) FOR [Deleted]
GO
/****** Object:  Default [DF_W_Ttn_Sub_Type]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Ttn_Sub] ADD  CONSTRAINT [DF_W_Ttn_Sub_Type]  DEFAULT ((0)) FOR [Type]
GO
/****** Object:  Default [DF__W_Update___Curr___54C23EC5]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Update_Order] ADD  CONSTRAINT [DF__W_Update___Curr___54C23EC5]  DEFAULT (getdate()) FOR [Curr_Date]
GO
/****** Object:  Default [DF__W_Update___Count__55B662FE]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Update_Order] ADD  CONSTRAINT [DF__W_Update___Count__55B662FE]  DEFAULT ((0)) FOR [Count_Money]
GO
/****** Object:  Default [DF__W_Update___Statu__0F78F03F]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Update_Order] ADD  DEFAULT ('1,2') FOR [Statuss]
GO
/****** Object:  Default [DF__W_Update___Vin_o__106D1478]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Update_Order] ADD  DEFAULT ((1)) FOR [Vin_ord]
GO
/****** Object:  Default [DF__W_Version__D_cha__1EC48A19]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Version] ADD  DEFAULT (getdate()) FOR [D_change]
GO
/****** Object:  Default [DF_W_Version_USS]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Version] ADD  CONSTRAINT [DF_W_Version_USS]  DEFAULT (user_name()) FOR [USS]
GO
/****** Object:  Default [DF__W_Vic__Sum_acc__15F0E3A4]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Sum_acc__15F0E3A4]  DEFAULT ((0)) FOR [Sum_acc]
GO
/****** Object:  Default [DF__W_Vic__Fraxt__16E507DD]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Fraxt__16E507DD]  DEFAULT ((0)) FOR [Fraxt]
GO
/****** Object:  Default [DF__W_Vic__Damage__17D92C16]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Damage__17D92C16]  DEFAULT ((1)) FOR [Damage]
GO
/****** Object:  Default [DF__W_Vic__Date_fix__18CD504F]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Date_fix__18CD504F]  DEFAULT (getdate()) FOR [Date_fix]
GO
/****** Object:  Default [DF__W_Vic__Date_chan__19C17488]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Date_chan__19C17488]  DEFAULT (getdate()) FOR [Date_change]
GO
/****** Object:  Default [DF__W_Vic__Date_Inco__1AB598C1]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Date_Inco__1AB598C1]  DEFAULT (getdate()) FOR [Date_Income]
GO
/****** Object:  Default [DF__W_Vic__Date_Read__1BA9BCFA]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Date_Read__1BA9BCFA]  DEFAULT (getdate()) FOR [Date_Ready]
GO
/****** Object:  Default [DF__W_Vic__Date_vic__1C9DE133]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Date_vic__1C9DE133]  DEFAULT (getdate()) FOR [Date_vic]
GO
/****** Object:  Default [DF__W_Vic__Date_hold__1D92056C]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Date_hold__1D92056C]  DEFAULT (getdate()) FOR [Date_hold_start]
GO
/****** Object:  Default [DF__W_Vic__Date_hold__1E8629A5]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Date_hold__1E8629A5]  DEFAULT (getdate()) FOR [Date_hold_finish]
GO
/****** Object:  Default [DF__W_Vic__Date_expe__1F7A4DDE]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Date_expe__1F7A4DDE]  DEFAULT (getdate()) FOR [Date_expected]
GO
/****** Object:  Default [DF__W_Vic__Date_out__206E7217]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Date_out__206E7217]  DEFAULT (getdate()) FOR [Date_out]
GO
/****** Object:  Default [DF__W_Vic__Date_actu__21629650]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Date_actu__21629650]  DEFAULT (getdate()) FOR [Date_actual_ship]
GO
/****** Object:  Default [DF__W_Vic__Date_actu__2256BA89]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Date_actu__2256BA89]  DEFAULT (getdate()) FOR [Date_actual_delivery]
GO
/****** Object:  Default [DF__W_Vic__Days_vic__234ADEC2]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Days_vic__234ADEC2]  DEFAULT ((1)) FOR [Days_vic]
GO
/****** Object:  Default [DF__W_Vic__Days_inco__243F02FB]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Days_inco__243F02FB]  DEFAULT ((1)) FOR [Days_incoming]
GO
/****** Object:  Default [DF__W_Vic__Days_actu__25332734]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Days_actu__25332734]  DEFAULT ((1)) FOR [Days_actual_ship]
GO
/****** Object:  Default [DF__W_Vic__Days_defe__26274B6D]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Days_defe__26274B6D]  DEFAULT ((1)) FOR [Days_deference]
GO
/****** Object:  Default [DF__W_Vic__Qty_vechi__271B6FA6]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Qty_vechi__271B6FA6]  DEFAULT ((1)) FOR [Qty_vechicles]
GO
/****** Object:  Default [DF__W_Vic__Qty_ok__280F93DF]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Qty_ok__280F93DF]  DEFAULT ((1)) FOR [Qty_ok]
GO
/****** Object:  Default [DF__W_Vic__Flag__2903B818]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic] ADD  CONSTRAINT [DF__W_Vic__Flag__2903B818]  DEFAULT ((1)) FOR [Flag]
GO
/****** Object:  Default [DF__W_Vic_dama__Date__7425DB85]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Damage] ADD  DEFAULT (getdate()) FOR [Date]
GO
/****** Object:  Default [DF__W_Vic_dam__Date___7519FFBE]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Damage] ADD  DEFAULT (getdate()) FOR [Date_update]
GO
/****** Object:  Default [DF__W_Vic_dama__Flag__760E23F7]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Damage] ADD  DEFAULT ((0)) FOR [Flag]
GO
/****** Object:  Default [DF__W_Vic_dam__Prizn__77024830]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Damage] ADD  DEFAULT ((0)) FOR [Priznak]
GO
/****** Object:  Default [DF__W_Vic_dam__Indic__77F66C69]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Damage] ADD  DEFAULT ((1)) FOR [Indicator]
GO
/****** Object:  Default [DF__W_Vic_sub__Date__2BE024C3]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Sub] ADD  CONSTRAINT [DF__W_Vic_sub__Date__2BE024C3]  DEFAULT (getdate()) FOR [Date]
GO
/****** Object:  Default [DF__W_Vic_sub__Date___2CD448FC]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Sub] ADD  CONSTRAINT [DF__W_Vic_sub__Date___2CD448FC]  DEFAULT (getdate()) FOR [Date_update]
GO
/****** Object:  Default [DF__W_Vic_sub__Prizn__2EBC916E]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Sub] ADD  CONSTRAINT [DF__W_Vic_sub__Prizn__2EBC916E]  DEFAULT ((0)) FOR [Priznak]
GO
/****** Object:  Default [DF__W_Vic_sub__Indic__2FB0B5A7]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Sub] ADD  CONSTRAINT [DF__W_Vic_sub__Indic__2FB0B5A7]  DEFAULT ((1)) FOR [Indicator]
GO
/****** Object:  Check [COST1]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[A2]  WITH NOCHECK ADD  CONSTRAINT [COST1] CHECK  (([SSS] like '[A-Z][A-Z][A-Z][A-Z][A-Z][A-Z][A-Z][A-Z][A-Z][A-Z][A-Z][A-Z][A-Z][A-Z][A-Z][A-Z][A-Z]'))
GO
ALTER TABLE [dbo].[A2] CHECK CONSTRAINT [COST1]
GO
/****** Object:  Check [Brand_nomer]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fin_Rep]  WITH NOCHECK ADD  CONSTRAINT [Brand_nomer] CHECK  (([Brand] < 6))
GO
ALTER TABLE [dbo].[W_Fin_Rep] CHECK CONSTRAINT [Brand_nomer]
GO
/****** Object:  Check [Week_number]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Fin_Rep]  WITH NOCHECK ADD  CONSTRAINT [Week_number] CHECK  (([Week]>=(1) AND [Week]<=(53)))
GO
ALTER TABLE [dbo].[W_Fin_Rep] CHECK CONSTRAINT [Week_number]
GO
/****** Object:  ForeignKey [FK_S_Carrier_avto_S_Carrier]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Carrier_Avto]  WITH NOCHECK ADD  CONSTRAINT [FK_S_Carrier_avto_S_Carrier] FOREIGN KEY([Carr])
REFERENCES [dbo].[S_Carrier] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[S_Carrier_Avto] CHECK CONSTRAINT [FK_S_Carrier_avto_S_Carrier]
GO
/****** Object:  ForeignKey [FK_S_Carrier_driver_S_Carrier]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Carrier_Driver]  WITH NOCHECK ADD  CONSTRAINT [FK_S_Carrier_driver_S_Carrier] FOREIGN KEY([Carr])
REFERENCES [dbo].[S_Carrier] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[S_Carrier_Driver] CHECK CONSTRAINT [FK_S_Carrier_driver_S_Carrier]
GO
/****** Object:  ForeignKey [FK_S_Carrier_traller_S_Carrier]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Carrier_Traller]  WITH NOCHECK ADD  CONSTRAINT [FK_S_Carrier_traller_S_Carrier] FOREIGN KEY([Carr])
REFERENCES [dbo].[S_Carrier] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[S_Carrier_Traller] CHECK CONSTRAINT [FK_S_Carrier_traller_S_Carrier]
GO
/****** Object:  ForeignKey [FK_S_Compound_S_Brend]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Compound]  WITH NOCHECK ADD  CONSTRAINT [FK_S_Compound_S_Brend] FOREIGN KEY([Brand_id])
REFERENCES [dbo].[S_Brend] ([ID])
ON UPDATE CASCADE
GO
ALTER TABLE [dbo].[S_Compound] CHECK CONSTRAINT [FK_S_Compound_S_Brend]
GO
/****** Object:  ForeignKey [FK_S_Compound_S_country_2]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Compound]  WITH CHECK ADD  CONSTRAINT [FK_S_Compound_S_country_2] FOREIGN KEY([Country_id])
REFERENCES [dbo].[S_Country_2] ([Idd])
ON UPDATE CASCADE
GO
ALTER TABLE [dbo].[S_Compound] CHECK CONSTRAINT [FK_S_Compound_S_country_2]
GO
/****** Object:  ForeignKey [FK__S_Diler_sub__Idn__359E9927]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Diler_Sub]  WITH CHECK ADD  CONSTRAINT [FK__S_Diler_sub__Idn__359E9927] FOREIGN KEY([Idn])
REFERENCES [dbo].[S_Diler] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[S_Diler_Sub] CHECK CONSTRAINT [FK__S_Diler_sub__Idn__359E9927]
GO
/****** Object:  ForeignKey [FK__S_Diler_U__ID_Dl__603EDE69]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Diler_Unload]  WITH CHECK ADD  CONSTRAINT [FK__S_Diler_U__ID_Dl__603EDE69] FOREIGN KEY([ID_Dlr])
REFERENCES [dbo].[S_Diler] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[S_Diler_Unload] CHECK CONSTRAINT [FK__S_Diler_U__ID_Dl__603EDE69]
GO
/****** Object:  ForeignKey [FK_S_Model_S_Brend]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Model]  WITH NOCHECK ADD  CONSTRAINT [FK_S_Model_S_Brend] FOREIGN KEY([Brend])
REFERENCES [dbo].[S_Brend] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[S_Model] CHECK CONSTRAINT [FK_S_Model_S_Brend]
GO
/****** Object:  ForeignKey [K11]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Pakage_sub]  WITH CHECK ADD  CONSTRAINT [K11] FOREIGN KEY([Idd])
REFERENCES [dbo].[S_Pakage] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[S_Pakage_sub] CHECK CONSTRAINT [K11]
GO
/****** Object:  ForeignKey [FK_S_Salesman_S_Brend]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Salesman]  WITH NOCHECK ADD  CONSTRAINT [FK_S_Salesman_S_Brend] FOREIGN KEY([Brand])
REFERENCES [dbo].[S_Brend] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[S_Salesman] CHECK CONSTRAINT [FK_S_Salesman_S_Brend]
GO
/****** Object:  ForeignKey [FK_S_Salesman_S_Diler]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Salesman]  WITH NOCHECK ADD  CONSTRAINT [FK_S_Salesman_S_Diler] FOREIGN KEY([Dlr])
REFERENCES [dbo].[S_Diler] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[S_Salesman] CHECK CONSTRAINT [FK_S_Salesman_S_Diler]
GO
/****** Object:  ForeignKey [FK_S_Version_S_Model]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[S_Version]  WITH NOCHECK ADD  CONSTRAINT [FK_S_Version_S_Model] FOREIGN KEY([Model])
REFERENCES [dbo].[S_Model] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[S_Version] CHECK CONSTRAINT [FK_S_Version_S_Model]
GO
/****** Object:  ForeignKey [FK_W_Config_S_Config]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Config]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Config_S_Config] FOREIGN KEY([Conf])
REFERENCES [dbo].[S_Config] ([ID])
ON UPDATE CASCADE
GO
ALTER TABLE [dbo].[W_Config] CHECK CONSTRAINT [FK_W_Config_S_Config]
GO
/****** Object:  ForeignKey [FK_W_Config_W_Order]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Config]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Config_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Config] CHECK CONSTRAINT [FK_W_Config_W_Order]
GO
/****** Object:  ForeignKey [FK_W_Hi_Dislocation_W_Order]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Hi_Dislocation]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Hi_Dislocation_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Hi_Dislocation] CHECK CONSTRAINT [FK_W_Hi_Dislocation_W_Order]
GO
/****** Object:  ForeignKey [FK_W_Hi_Order_W_Order]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Hi_Order]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Hi_Order_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Hi_Order] CHECK CONSTRAINT [FK_W_Hi_Order_W_Order]
GO
/****** Object:  ForeignKey [FK_W_Hi_Pay_W_Order]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Hi_Pay]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Hi_Pay_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Hi_Pay] CHECK CONSTRAINT [FK_W_Hi_Pay_W_Order]
GO
/****** Object:  ForeignKey [FK_W_History_S_Status]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_History]  WITH NOCHECK ADD  CONSTRAINT [FK_W_History_S_Status] FOREIGN KEY([Status])
REFERENCES [dbo].[S_Status] ([ID])
ON UPDATE CASCADE
GO
ALTER TABLE [dbo].[W_History] CHECK CONSTRAINT [FK_W_History_S_Status]
GO
/****** Object:  ForeignKey [FK_W_History_W_Order]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_History]  WITH NOCHECK ADD  CONSTRAINT [FK_W_History_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_History] CHECK CONSTRAINT [FK_W_History_W_Order]
GO
/****** Object:  ForeignKey [FK_W_Insurance_sub_W_Insurance]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Insurance_Sub]  WITH CHECK ADD  CONSTRAINT [FK_W_Insurance_sub_W_Insurance] FOREIGN KEY([PID])
REFERENCES [dbo].[W_Insurance] ([PID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Insurance_Sub] CHECK CONSTRAINT [FK_W_Insurance_sub_W_Insurance]
GO
/****** Object:  ForeignKey [FK_W_Invoice_W_Release]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Invoice]  WITH CHECK ADD  CONSTRAINT [FK_W_Invoice_W_Release] FOREIGN KEY([ID_Release])
REFERENCES [dbo].[W_Release] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Invoice] CHECK CONSTRAINT [FK_W_Invoice_W_Release]
GO
/****** Object:  ForeignKey [FK_W_Move_dealer_W_Order]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Move_Dealer]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Move_dealer_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Move_Dealer] CHECK CONSTRAINT [FK_W_Move_dealer_W_Order]
GO
/****** Object:  ForeignKey [FK__W_Option__Zakaz__6D23D83B]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Option]  WITH CHECK ADD  CONSTRAINT [FK__W_Option__Zakaz__6D23D83B] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Option] CHECK CONSTRAINT [FK__W_Option__Zakaz__6D23D83B]
GO
/****** Object:  ForeignKey [FK_W_option_3_W_Option_2]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_option_3]  WITH NOCHECK ADD  CONSTRAINT [FK_W_option_3_W_Option_2] FOREIGN KEY([Ids])
REFERENCES [dbo].[W_Option_2] ([Idd])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_option_3] CHECK CONSTRAINT [FK_W_option_3_W_Option_2]
GO
/****** Object:  ForeignKey [FK_W_Optional_S_Optional]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Optional]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Optional_S_Optional] FOREIGN KEY([Conf])
REFERENCES [dbo].[S_Optional] ([ID])
ON UPDATE CASCADE
GO
ALTER TABLE [dbo].[W_Optional] CHECK CONSTRAINT [FK_W_Optional_S_Optional]
GO
/****** Object:  ForeignKey [FK_W_Optional_W_Order]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Optional]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Optional_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Optional] CHECK CONSTRAINT [FK_W_Optional_W_Order]
GO
/****** Object:  ForeignKey [FK_W_Order_S_Brend]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order]  WITH CHECK ADD  CONSTRAINT [FK_W_Order_S_Brend] FOREIGN KEY([Brend])
REFERENCES [dbo].[S_Brend] ([ID])
GO
ALTER TABLE [dbo].[W_Order] CHECK CONSTRAINT [FK_W_Order_S_Brend]
GO
/****** Object:  ForeignKey [FK_W_Order_S_Client]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Order_S_Client] FOREIGN KEY([Client])
REFERENCES [dbo].[S_Client] ([Id])
ON UPDATE CASCADE
GO
ALTER TABLE [dbo].[W_Order] CHECK CONSTRAINT [FK_W_Order_S_Client]
GO
/****** Object:  ForeignKey [FK_W_Order_S_Diler]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Order_S_Diler] FOREIGN KEY([Dlr])
REFERENCES [dbo].[S_Diler] ([ID])
GO
ALTER TABLE [dbo].[W_Order] NOCHECK CONSTRAINT [FK_W_Order_S_Diler]
GO
/****** Object:  ForeignKey [FK_W_Order_S_User]    Script Date: 10/29/2010 14:30:29 ******/
ALTER TABLE [dbo].[W_Order]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Order_S_User] FOREIGN KEY([Isppol])
REFERENCES [dbo].[S_User] ([ID])
ON UPDATE CASCADE
GO
ALTER TABLE [dbo].[W_Order] CHECK CONSTRAINT [FK_W_Order_S_User]
GO
/****** Object:  ForeignKey [FK_W_Packs_Pay_W_Order]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Packs_Pay]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Packs_Pay_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Packs_Pay] CHECK CONSTRAINT [FK_W_Packs_Pay_W_Order]
GO
/****** Object:  ForeignKey [FK_W_Pakage_History_W_Pakage]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pakage_History]  WITH CHECK ADD  CONSTRAINT [FK_W_Pakage_History_W_Pakage] FOREIGN KEY([IDRel])
REFERENCES [dbo].[W_Pakage] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Pakage_History] CHECK CONSTRAINT [FK_W_Pakage_History_W_Pakage]
GO
/****** Object:  ForeignKey [FK_W_Pakage_sub_W_Package_Vers]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pakage_Sub]  WITH CHECK ADD  CONSTRAINT [FK_W_Pakage_sub_W_Package_Vers] FOREIGN KEY([Vers])
REFERENCES [dbo].[W_Package_Vers] ([ID_Vers])
GO
ALTER TABLE [dbo].[W_Pakage_Sub] CHECK CONSTRAINT [FK_W_Pakage_sub_W_Package_Vers]
GO
/****** Object:  ForeignKey [FK_W_Pay_W_Order]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pay]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Pay_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Pay] CHECK CONSTRAINT [FK_W_Pay_W_Order]
GO
/****** Object:  ForeignKey [FK_W_Pay_err_W_Order]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pay_Err]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Pay_err_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Pay_Err] CHECK CONSTRAINT [FK_W_Pay_err_W_Order]
GO
/****** Object:  ForeignKey [FK_W_Pay_suppl_2_W_Pay_suppl_1]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pay_suppl_2]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Pay_suppl_2_W_Pay_suppl_1] FOREIGN KEY([IDN])
REFERENCES [dbo].[W_Pay_suppl_1] ([IDD])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Pay_suppl_2] CHECK CONSTRAINT [FK_W_Pay_suppl_2_W_Pay_suppl_1]
GO
/****** Object:  ForeignKey [FK_W_Pays_W_Order]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Pays]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Pays_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Pays] CHECK CONSTRAINT [FK_W_Pays_W_Order]
GO
/****** Object:  ForeignKey [FK_W_RDF_W_Order]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Rdf]  WITH NOCHECK ADD  CONSTRAINT [FK_W_RDF_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Rdf] CHECK CONSTRAINT [FK_W_RDF_W_Order]
GO
/****** Object:  ForeignKey [FK_W_Release_W_Request]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Release]  WITH CHECK ADD  CONSTRAINT [FK_W_Release_W_Request] FOREIGN KEY([ID_Request])
REFERENCES [dbo].[W_Request] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Release] CHECK CONSTRAINT [FK_W_Release_W_Request]
GO
/****** Object:  ForeignKey [FK_W_Temp_Optional_W_Temp]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Temp_Optional]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Temp_Optional_W_Temp] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Temp] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Temp_Optional] CHECK CONSTRAINT [FK_W_Temp_Optional_W_Temp]
GO
/****** Object:  ForeignKey [FK_W_Ttn_W_Avtovoz]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Ttn]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Ttn_W_Avtovoz] FOREIGN KEY([Avtovoz])
REFERENCES [dbo].[W_Avtovoz] ([IDN])
ON UPDATE CASCADE
ON DELETE CASCADE
NOT FOR REPLICATION
GO
ALTER TABLE [dbo].[W_Ttn] CHECK CONSTRAINT [FK_W_Ttn_W_Avtovoz]
GO
/****** Object:  ForeignKey [FK_W_Ttn_sub_W_Order]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Ttn_Sub]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Ttn_sub_W_Order] FOREIGN KEY([Zakaz])
REFERENCES [dbo].[W_Order] ([ID])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Ttn_Sub] CHECK CONSTRAINT [FK_W_Ttn_sub_W_Order]
GO
/****** Object:  ForeignKey [FK_W_Ttn_sub_W_Ttn]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Ttn_Sub]  WITH CHECK ADD  CONSTRAINT [FK_W_Ttn_sub_W_Ttn] FOREIGN KEY([Ttn])
REFERENCES [dbo].[W_Ttn] ([Num])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Ttn_Sub] CHECK CONSTRAINT [FK_W_Ttn_sub_W_Ttn]
GO
/****** Object:  ForeignKey [FK_W_Vic_S_Brend]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic]  WITH CHECK ADD  CONSTRAINT [FK_W_Vic_S_Brend] FOREIGN KEY([Brend])
REFERENCES [dbo].[S_Brend] ([ID])
GO
ALTER TABLE [dbo].[W_Vic] CHECK CONSTRAINT [FK_W_Vic_S_Brend]
GO
/****** Object:  ForeignKey [FK_W_Vic_S_Inspector]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic]  WITH NOCHECK ADD  CONSTRAINT [FK_W_Vic_S_Inspector] FOREIGN KEY([Inspector])
REFERENCES [dbo].[S_Inspector] ([Id])
NOT FOR REPLICATION
GO
ALTER TABLE [dbo].[W_Vic] NOCHECK CONSTRAINT [FK_W_Vic_S_Inspector]
GO
/****** Object:  ForeignKey [FK_W_Vic_S_Position]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic]  WITH CHECK ADD  CONSTRAINT [FK_W_Vic_S_Position] FOREIGN KEY([Vic_place])
REFERENCES [dbo].[S_Position] ([Id])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Vic] CHECK CONSTRAINT [FK_W_Vic_S_Position]
GO
/****** Object:  ForeignKey [FK_W_Vic_damage_W_Vic_sub]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Damage]  WITH CHECK ADD  CONSTRAINT [FK_W_Vic_damage_W_Vic_sub] FOREIGN KEY([Ids])
REFERENCES [dbo].[W_Vic_Sub] ([Id])
ON UPDATE CASCADE
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Vic_Damage] CHECK CONSTRAINT [FK_W_Vic_damage_W_Vic_sub]
GO
/****** Object:  ForeignKey [FK_W_Vic_sub_S_Body]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Sub]  WITH CHECK ADD  CONSTRAINT [FK_W_Vic_sub_S_Body] FOREIGN KEY([Place])
REFERENCES [dbo].[S_Body] ([Id])
GO
ALTER TABLE [dbo].[W_Vic_Sub] CHECK CONSTRAINT [FK_W_Vic_sub_S_Body]
GO
/****** Object:  ForeignKey [FK_W_Vic_sub_S_Carrier]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Sub]  WITH CHECK ADD  CONSTRAINT [FK_W_Vic_sub_S_Carrier] FOREIGN KEY([Carrier])
REFERENCES [dbo].[S_Carrier] ([ID])
GO
ALTER TABLE [dbo].[W_Vic_Sub] CHECK CONSTRAINT [FK_W_Vic_sub_S_Carrier]
GO
/****** Object:  ForeignKey [FK_W_Vic_sub_S_Inspector]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Sub]  WITH CHECK ADD  CONSTRAINT [FK_W_Vic_sub_S_Inspector] FOREIGN KEY([Inspector])
REFERENCES [dbo].[S_Inspector] ([Id])
GO
ALTER TABLE [dbo].[W_Vic_Sub] CHECK CONSTRAINT [FK_W_Vic_sub_S_Inspector]
GO
/****** Object:  ForeignKey [FK_W_Vic_sub_S_Location]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Sub]  WITH CHECK ADD  CONSTRAINT [FK_W_Vic_sub_S_Location] FOREIGN KEY([Location])
REFERENCES [dbo].[S_Location] ([ID])
GO
ALTER TABLE [dbo].[W_Vic_Sub] CHECK CONSTRAINT [FK_W_Vic_sub_S_Location]
GO
/****** Object:  ForeignKey [FK_W_Vic_sub_W_Vic]    Script Date: 10/29/2010 14:30:30 ******/
ALTER TABLE [dbo].[W_Vic_Sub]  WITH CHECK ADD  CONSTRAINT [FK_W_Vic_sub_W_Vic] FOREIGN KEY([Ids])
REFERENCES [dbo].[W_Vic] ([Id])
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[W_Vic_Sub] CHECK CONSTRAINT [FK_W_Vic_sub_W_Vic]
GO
